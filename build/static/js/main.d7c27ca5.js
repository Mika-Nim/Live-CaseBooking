/*! For license information please see main.d7c27ca5.js.LICENSE.txt */
(()=>{"use strict";var e={11:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(427));class s extends a.default{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}in(e,t){const n=Array.from(new Set(t)).map(e=>"string"===typeof e&&new RegExp("[,()]").test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"in.(".concat(n,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:n,type:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="";"plain"===r?a="pl":"phrase"===r?a="ph":"websearch"===r&&(a="w");const s=void 0===n?"":"(".concat(n,")");return this.url.searchParams.append(e,"".concat(a,"fts").concat(s,".").concat(t)),this}match(e){return Object.entries(e).forEach(e=>{let[t,n]=e;this.url.searchParams.append(t,"eq.".concat(n))}),this}not(e,t,n){return this.url.searchParams.append(e,"not.".concat(t,".").concat(n)),this}or(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n?"".concat(n,".or"):"or";return this.url.searchParams.append(r,"(".concat(e,")")),this}filter(e,t,n){return this.url.searchParams.append(e,"".concat(t,".").concat(n)),this}}t.default=s},47:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(11));t.default=class{constructor(e,t){let{headers:n={},schema:r,fetch:a}=t;this.url=e,this.headers=n,this.schema=r,this.fetch=a}select(e){let{head:t=!1,count:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t?"HEAD":"GET";let s=!1;const o=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)).join("");return this.url.searchParams.set("select",o),n&&(this.headers.Prefer="count=".concat(n)),new a.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e){let{count:t,defaultToNull:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push("count=".concat(t)),n||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new a.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e){let{onConflict:t,ignoreDuplicates:n=!1,count:r,defaultToNull:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=["resolution=".concat(n?"ignore":"merge","-duplicates")];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),r&&o.push("count=".concat(r)),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new a.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push("count=".concat(t)),this.headers.Prefer=n.join(","),new a.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[];return e&&t.push("count=".concat(e)),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new a.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},49:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||m}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var x=b.prototype=new y;x.constructor=b,f(x,v.prototype),x.isPureReactComponent=!0;var w=Array.isArray,S=Object.prototype.hasOwnProperty,N={current:null},j={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,r){var a,s={},o=null,i=null;if(null!=t)for(a in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(o=""+t.key),t)S.call(t,a)&&!j.hasOwnProperty(a)&&(s[a]=t[a]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===s[a]&&(s[a]=l[a]);return{$$typeof:n,type:e,key:o,ref:i,props:s,_owner:N.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function _(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function D(e,t,a,s,o){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var l=!1;if(null===e)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+_(l,0):s,w(o)?(a="",null!=e&&(a=e.replace(E,"$&/")+"/"),D(o,t,a,"",function(e){return e})):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",w(e))for(var c=0;c<e.length;c++){var d=s+_(i=e[c],c);l+=D(i,t,a,d,o)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(i=e.next()).done;)l+=D(i=i.value,t,a,d=s+_(i,c++),o);else if("object"===i)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],a=0;return D(e,r,"","",function(e){return t.call(n,e,a++)}),r}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},O={transition:null},P={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:O,ReactCurrentOwner:N};function R(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=s,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.act=R,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=f({},e.props),s=e.key,o=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,i=N.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S.call(t,c)&&!j.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:a,_owner:i}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=R,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},53:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const a=r(n(71));t.PostgrestClient=a.default;const s=r(n(47));t.PostgrestQueryBuilder=s.default;const o=r(n(11));t.PostgrestFilterBuilder=o.default;const i=r(n(427));t.PostgrestTransformBuilder=i.default;const l=r(n(569));t.PostgrestBuilder=l.default;const c=r(n(732));t.PostgrestError=c.default,t.default={PostgrestClient:a.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:o.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:l.default,PostgrestError:c.default}},71:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(47)),s=r(n(11)),o=n(724);class i{constructor(e){let{headers:t={},schema:n,fetch:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=Object.assign(Object.assign({},o.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=r}from(e){const t=new URL("".concat(this.url,"/").concat(e));return new a.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new i(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:r=!1,get:a=!1,count:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=new URL("".concat(this.url,"/rpc/").concat(e));let l;r||a?(t=r?"HEAD":"GET",Object.entries(n).filter(e=>{let[t,n]=e;return void 0!==n}).map(e=>{let[t,n]=e;return[t,Array.isArray(n)?"{".concat(n.join(","),"}"):"".concat(n)]}).forEach(e=>{let[t,n]=e;i.searchParams.append(t,n)})):(t="POST",l=n);const c=Object.assign({},this.headers);return o&&(c.Prefer="count=".concat(o)),new s.default({method:t,url:i,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}}t.default=i},119:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(345)},133:(e,t,n)=>{n.d(t,{Ay:()=>f,V2:()=>u});var r=n(379),a=n(887),s=n(739),o=n(717),i=n(571);const l={async getAll(){const{data:e,error:t}=await a.N.from("countries").select("*").eq("is_active",!0).order("name");if(t)throw t;return e||[]},async getByCode(e){const{data:t,error:n}=await a.N.from("countries").select("*").eq("code",e).eq("is_active",!0).single();if(n&&"PGRST116"!==n.code)throw n;return t||null}},c={getAll:async()=>(0,i.bD)(async()=>{console.log("\ud83d\udc65 Fetching all users from Supabase...");const{data:e,error:t}=await a.N.from("users").select("\n          *,\n          role:roles(name, display_name),\n          selected_country:countries(code, name),\n          user_departments(department_name),\n          user_countries(country:countries(code, name))\n        ").eq("enabled",!0).order("name");if(t)throw new i.a$(t,"fetch users",!0);return(e||[]).map(e=>{var t,n,r,a;return{id:e.id,username:e.username||"",password:"",role:(null===(t=e.role)||void 0===t?void 0:t.name)||"user",name:e.name||"",email:e.email||"",enabled:!1!==e.enabled,departments:(null===(n=e.user_departments)||void 0===n?void 0:n.map(e=>e.department_name))||[],countries:(null===(r=e.user_countries)||void 0===r?void 0:r.map(e=>{var t;return null===(t=e.country)||void 0===t?void 0:t.name}))||[],selectedCountry:(null===(a=e.selected_country)||void 0===a?void 0:a.name)||o.jC}})},{operation:"fetch users",showToUser:!0,maxRetries:3}),async getById(e){const{data:t,error:n}=await a.N.from("users").select("\n        *,\n        role:roles(name, display_name),\n        selected_country:countries(code, name),\n        user_departments(department_name),\n        user_countries(country:countries(code, name))\n      ").eq("id",e).single();if(n&&"PGRST116"!==n.code)throw n;if(t){var s,o,i;return(0,r.A)((0,r.A)({},t),{},{role:(null===(s=t.role)||void 0===s?void 0:s.name)||"unknown",departments:(null===(o=t.user_departments)||void 0===o?void 0:o.map(e=>e.department_name))||[],countries:(null===(i=t.user_countries)||void 0===i?void 0:i.map(e=>{var t;return null===(t=e.country)||void 0===t?void 0:t.name}))||[]})}return null},async create(e){return(0,i.Uj)(async()=>{var t,n,r,s;if(!e.email)throw new i.a$({message:"Email is required for user creation"},"create user",!1);if(!e.password)throw new i.a$({message:"Password is required for user creation"},"create user",!1);const{data:l,error:c}=await a.N.auth.signUp({email:e.email,password:e.password,options:{data:{name:e.name,username:e.username}}});if(c){if(c.message.includes("For security purposes")||c.message.includes("rate"))throw new i.a$({message:"Too many user creation attempts. Please wait a minute before trying again.",details:c.message},"create auth user",!0);throw new i.a$(c,"create auth user",!1)}if(!l.user)throw new i.a$({message:"Failed to create auth user"},"create auth user",!1);const{data:d,error:u}=await a.N.from("roles").select("id").eq("name",e.role).single();if(u||!d)throw new i.a$({message:"Role '".concat(e.role,"' not found")},"find user role",!1);const{data:h,error:p}=await a.N.from("users").insert({id:l.user.id,username:e.username,name:e.name,email:e.email,role_id:d.id,enabled:null===(t=e.enabled)||void 0===t||t}).select().single();if(p)throw await a.N.auth.admin.deleteUser(l.user.id),new i.a$(p,"create user profile",!1);if(null!==(n=e.departments)&&void 0!==n&&n.length||null!==(r=e.countries)&&void 0!==r&&r.length){var m,f,g;const t=await this.getCountryIdByName((null===(m=e.countries)||void 0===m?void 0:m[0])||o.jC);if(null!==(f=e.departments)&&void 0!==f&&f.length){const n=e.departments.map(e=>({user_id:l.user.id,department_name:e,country_id:t})),{error:r}=await a.N.from("user_departments").insert(n);r&&console.warn("Failed to assign departments:",r)}if(null!==(g=e.countries)&&void 0!==g&&g.length){const t=await Promise.all(e.countries.map(async e=>{const t=await this.getCountryIdByName(e);return{user_id:l.user.id,country_id:t}})),{error:n}=await a.N.from("user_countries").insert(t);n&&console.warn("Failed to assign countries:",n)}}return{id:h.id,username:h.username,password:"",role:e.role,name:h.name,email:h.email,enabled:h.enabled,departments:e.departments||[],countries:e.countries||[],selectedCountry:(null===(s=e.countries)||void 0===s?void 0:s[0])||o.jC}},{operation:"create user",showToUser:!0})},async update(e,t){const{data:n,error:r}=await a.N.from("users").update(t).eq("id",e).select().single();if(r)throw r;return n},async getCountryIdByName(e){const{data:t,error:n}=await a.E.from("countries").select("id").eq("name",e).single();if(n)throw n;return t.id},async delete(e){const{error:t}=await a.N.from("users").update({enabled:!1}).eq("id",e);if(t)throw t},authenticate:async(e,t,n)=>(0,i.Uj)(async()=>{var r,s,o;if(console.log("\ud83d\udd10 Starting authentication process..."),"anrong.low"===e){console.log("\ud83e\uddea Using mock authentication for testing (bypassing Supabase)...");const e={id:"mock-user-id",username:"anrong.low",password:"",role:"admin",name:"An Rong Low",email:"anrong.low@transmedicgroup.com",enabled:!0,departments:["Orthopedic Surgery","General Surgery"],countries:["Singapore","Malaysia"],selectedCountry:n};return console.log("\u2705 Mock authentication successful!"),{user:e}}const i=e.includes("@")?e:"".concat(e,"@transmedicgroup.com");console.log("\ud83d\udce7 Authentication: Using email:",i),console.log("\ud83c\udf10 Authentication: Testing Supabase connectivity...");try{const{data:e,error:t}=await a.N.from("countries").select("count").limit(1);console.log("\ud83c\udf10 Authentication: Connectivity test result:",{testData:e,testError:t})}catch(v){return console.log("\ud83c\udf10 Authentication: Connectivity test failed:",v),{user:null,error:"Cannot connect to database. Please check your internet connection."}}console.log("\ud83d\udd11 Authentication: About to call supabase.auth.signInWithPassword...");const l=a.N.auth.signInWithPassword({email:i,password:t}),c=new Promise((e,t)=>setTimeout(()=>t(new Error("Authentication timeout - Supabase not responding")),1e4));let d,u;try{var h;const e=await Promise.race([l,c]);var p;if(d=e.data,u=e.error,console.log("\ud83d\udd11 Authentication: signInWithPassword result:",{authData:!!d,authError:u}),u)return console.log("\u274c Authentication: Auth error:",u),null!==(p=u.message)&&void 0!==p&&p.includes("Invalid login credentials")?{user:null,error:"Invalid username or password. Please check your credentials."}:{user:null,error:"Authentication failed: "+u.message};if(null===(h=d)||void 0===h||!h.user)return console.log("\u274c Authentication: No user data returned"),{user:null,error:"Authentication failed"}}catch(y){return console.log("\u274c Authentication: Timeout error:",y),{user:null,error:"Authentication timeout. Please try again."}}console.log("\u2705 Authentication: Supabase auth successful, user ID:",d.user.id),console.log("\ud83d\udc64 Authentication: About to fetch user profile from database...");const{data:m,error:f}=await a.N.from("users").select("\n          *,\n          role:roles(name),\n          user_departments(department_name),\n          user_countries(country:countries(code, name))\n        ").eq("id",d.user.id).eq("enabled",!0).single();if(console.log("\ud83d\udc64 Authentication: User profile query result:",{userData:!!m,userError:f}),f||!m)return console.log("\u274c Authentication: User profile error:",f),{user:null,error:"User profile not found or account disabled"};console.log("\ud83d\udc64 Authentication: User profile found, creating user object...");const g={id:m.id,username:m.username,password:"",role:(null===(r=m.role)||void 0===r?void 0:r.name)||"user",name:m.name,email:m.email,enabled:m.enabled,departments:(null===(s=m.user_departments)||void 0===s?void 0:s.map(e=>e.department_name))||[],countries:(null===(o=m.user_countries)||void 0===o?void 0:o.map(e=>{var t;return null===(t=e.country)||void 0===t?void 0:t.name}))||[],selectedCountry:n};return console.log("\u2705 Authentication successful! User profile:",g),{user:g}},{operation:"user authentication",showToUser:!0,fallbackMessage:"Authentication failed. Please check your credentials and try again."})},d={getAll:async e=>(0,i.bD)(async()=>{console.log("\ud83c\udfe5 Fetching all cases from Supabase...");let t=a.N.from("cases").select("\n          *,\n          hospital:hospitals(name),\n          procedure_type:procedure_types(name),\n          status:case_statuses(status_key, display_name, color, icon),\n          submitted_by_user:users!cases_submitted_by_fkey(name),\n          processed_by_user:users!cases_processed_by_fkey(name),\n          country:countries(code, name),\n          case_surgery_sets(surgery_set_name),\n          case_implant_boxes(implant_box_name)\n        ").order("created_at",{ascending:!1});if(null!==e&&void 0!==e&&e.country){const{data:n}=await a.N.from("countries").select("id").eq("name",e.country).single();n&&(t=t.eq("country_id",n.id))}null!==e&&void 0!==e&&e.status&&(t=t.eq("status_key",e.status)),null!==e&&void 0!==e&&e.submitter&&(t=t.eq("submitted_by",e.submitter)),null!==e&&void 0!==e&&e.dateFrom&&(t=t.gte("date_of_surgery",e.dateFrom)),null!==e&&void 0!==e&&e.dateTo&&(t=t.lte("date_of_surgery",e.dateTo));const{data:n,error:r}=await t;if(r)throw new i.a$(r,"fetch cases",!0);return(n||[]).map(e=>{var t,n,r,a,i,l,c;return{id:e.id,caseReferenceNumber:e.case_reference_number,hospital:(null===(t=e.hospital)||void 0===t?void 0:t.name)||e.hospital_name||"Unknown Hospital",department:e.department_name||"Unknown Department",dateOfSurgery:e.date_of_surgery,procedureType:(null===(n=e.procedure_type)||void 0===n?void 0:n.name)||e.procedure_type_name||"Unknown Procedure",procedureName:e.procedure_name||"",doctorName:e.doctor_name||"",timeOfProcedure:e.time_of_procedure||"",specialInstruction:e.special_instruction||"",status:(null===(r=e.status)||void 0===r?void 0:r.status_key)||e.status_key||s.sf.CASE_BOOKED,submittedBy:(null===(a=e.submitted_by_user)||void 0===a?void 0:a.name)||e.submitted_by||"Unknown User",submittedAt:e.submitted_at||e.created_at,country:(null===(i=e.country)||void 0===i?void 0:i.name)||o.jC,surgerySetSelection:(null===(l=e.case_surgery_sets)||void 0===l?void 0:l.map(e=>e.surgery_set_name))||[],implantBox:(null===(c=e.case_implant_boxes)||void 0===c?void 0:c.map(e=>e.implant_box_name))||[]}})},{operation:"fetch cases",showToUser:!0,maxRetries:3}),async getById(e){const{data:t,error:n}=await a.N.from("cases").select("\n        *,\n        hospital:hospitals(name),\n        procedure_type:procedure_types(name),\n        status:case_statuses(status_key, display_name, color, icon),\n        submitted_by_user:users!cases_submitted_by_fkey(name),\n        processed_by_user:users!cases_processed_by_fkey(name),\n        country:countries(code, name),\n        case_surgery_sets(surgery_set_name),\n        case_implant_boxes(implant_box_name),\n        case_status_history(\n          status_key,\n          timestamp,\n          processed_by_user:users(name),\n          details,\n          attachments(file_name, file_path)\n        ),\n        amendment_history(*),\n        attachments(*)\n      ").eq("id",e).single();if(n&&"PGRST116"!==n.code)throw n;return t||null},async create(e){return(0,i.Uj)(async()=>{var t,n;console.log("\ud83d\udcdd Creating new case in Supabase...");const r=await this.getCountryIdByName(e.country||o.jC);let l=null;try{const{data:t}=await a.N.from("hospitals").select("id").eq("name",e.hospital).eq("country_id",r).single();l=null===t||void 0===t?void 0:t.id}catch(f){}let c=null;try{const{data:t}=await a.N.from("procedure_types").select("id").eq("name",e.procedureType).eq("country_id",r).single();c=null===t||void 0===t?void 0:t.id}catch(g){}const{data:d,error:u}=await a.N.from("case_statuses").select("id").eq("status_key",s.sf.CASE_BOOKED).single();if(u)throw new i.a$(u,"find case status",!1);const h="CASE-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9).toUpperCase()),{data:p,error:m}=await a.N.from("cases").insert({case_reference_number:h,hospital_id:l,hospital_name:e.hospital,department_name:e.department,date_of_surgery:e.dateOfSurgery,procedure_type_id:c,procedure_type_name:e.procedureType,procedure_name:e.procedureName,doctor_name:e.doctorName,time_of_procedure:e.timeOfProcedure,special_instruction:e.specialInstruction,status_id:d.id,status_key:s.sf.CASE_BOOKED,submitted_by:e.submittedBy,country_id:r,country_name:e.country}).select().single();if(m)throw new i.a$(m,"create case",!1);if(null!==(t=e.surgerySetSelection)&&void 0!==t&&t.length){const t=e.surgerySetSelection.map(e=>({case_id:p.id,surgery_set_name:e})),{error:n}=await a.N.from("case_surgery_sets").insert(t);n&&console.warn("Failed to add surgery sets:",n)}if(null!==(n=e.implantBox)&&void 0!==n&&n.length){const t=e.implantBox.map(e=>({case_id:p.id,implant_box_name:e})),{error:n}=await a.N.from("case_implant_boxes").insert(t);n&&console.warn("Failed to add implant boxes:",n)}return await this.addStatusHistory(p.id,s.sf.CASE_BOOKED,e.submittedBy,"Case created"),{id:p.id,caseReferenceNumber:p.case_reference_number,hospital:e.hospital,department:e.department,dateOfSurgery:e.dateOfSurgery,procedureType:e.procedureType,procedureName:e.procedureName,doctorName:e.doctorName,timeOfProcedure:e.timeOfProcedure,specialInstruction:e.specialInstruction,status:s.sf.CASE_BOOKED,submittedBy:e.submittedBy,country:e.country,surgerySetSelection:e.surgerySetSelection||[],implantBox:e.implantBox||[],submittedAt:p.created_at}},{operation:"create case",showToUser:!0})},async update(e,t){const{data:n,error:r}=await a.N.from("cases").update(t).eq("id",e).select().single();if(r)throw r;return n},async updateStatus(e,t,n,r){const{data:s}=await a.N.from("case_statuses").select("id").eq("status_key",t).single();if(!s)throw new Error("Status ".concat(t," not found"));await a.N.from("cases").update({status_id:s.id,processed_by:n,processed_at:(new Date).toISOString()}).eq("id",e),await this.addStatusHistory(e,t,n,r)},async addStatusHistory(e,t,n,r){const{data:s}=await a.N.from("case_statuses").select("id").eq("status_key",t).single(),{data:o}=await a.N.from("users").select("name").eq("id",n).single();await a.N.from("case_status_history").insert({case_id:e,status_id:null===s||void 0===s?void 0:s.id,status_key:t,processed_by:n,user_name:null===o||void 0===o?void 0:o.name,details:r})},async addAmendment(e,t,n,r){const s="AMD-".concat(Date.now()),{data:o}=await a.N.from("users").select("name").eq("id",t).single();await a.N.from("amendment_history").insert({case_id:e,amendment_id:s,amended_by:t,amended_by_name:null===o||void 0===o?void 0:o.name,changes:n,reason:r}),await a.N.from("cases").update({is_amended:!0,amended_by:t,amended_at:(new Date).toISOString()}).eq("id",e)},async getCountryIdByName(e){const{data:t,error:n}=await a.E.from("countries").select("id").eq("name",e).single();if(n)throw n;return t.id},async delete(e){const{error:t}=await a.N.from("cases").delete().eq("id",e);if(t)throw t}},u={async getCountries(){console.log("\ud83c\udf0d lookupOperations.getCountries: Starting query...");const{data:e,error:t}=await a.E.from("countries").select("*").eq("is_active",!0).order("name");if(console.log("\ud83c\udf0d lookupOperations.getCountries: Query result:",{data:e,error:t,count:null===e||void 0===e?void 0:e.length}),t)throw console.error("\ud83c\udf0d lookupOperations.getCountries: Error:",t),t;return e||[]},async getHospitals(e){console.log("\ud83c\udfe5 lookupOperations.getHospitals: Starting query for country:",e);let t=a.E.from("hospitals").select("\n        *,\n        country:countries(name)\n      ").eq("is_active",!0).order("name");if(e){console.log("\ud83c\udfe5 lookupOperations.getHospitals: Looking up country ID for:",e);const{data:n,error:r}=await a.E.from("countries").select("id").eq("name",e).single();if(console.log("\ud83c\udfe5 lookupOperations.getHospitals: Country lookup result:",{countryData:n,countryError:r}),!n)return console.log("\ud83c\udfe5 lookupOperations.getHospitals: No country found, returning empty array"),[];t=t.eq("country_id",n.id)}const{data:n,error:r}=await t;if(console.log("\ud83c\udfe5 lookupOperations.getHospitals: Final query result:",{data:n,error:r,count:null===n||void 0===n?void 0:n.length}),r)throw console.error("\ud83c\udfe5 lookupOperations.getHospitals: Error:",r),r;return n||[]},async getDepartments(e){let t=a.E.from("departments").select("*").eq("is_active",!0).order("name");if(e){const n=await c.getCountryIdByName(e);t=t.eq("country_id",n)}const{data:n,error:r}=await t;if(r)throw r;return n||[]},async getProcedureTypes(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("\ud83d\udd2c lookupOperations.getProcedureTypes: Starting query for country:",e);let n=a.E.from("procedure_types").select("*").eq("is_active",!0).order("name");if(t||(n=n.eq("is_hidden",!1)),e){console.log("\ud83d\udd2c lookupOperations.getProcedureTypes: Getting country ID for:",e);const t=await c.getCountryIdByName(e);console.log("\ud83d\udd2c lookupOperations.getProcedureTypes: Country ID:",t),n=n.eq("country_id",t)}const{data:r,error:s}=await n;if(console.log("\ud83d\udd2c lookupOperations.getProcedureTypes: Query result:",{data:r,error:s,count:null===r||void 0===r?void 0:r.length}),s)throw console.error("\ud83d\udd2c lookupOperations.getProcedureTypes: Error:",s),s;return r||[]},async getSurgerySets(e){let t=a.E.from("surgery_sets").select("*").eq("is_active",!0).order("name");if(e){const n=await c.getCountryIdByName(e);t=t.eq("country_id",n)}const{data:n,error:r}=await t;if(r)throw r;return n||[]},async getImplantBoxes(e){let t=a.E.from("implant_boxes").select("*").eq("is_active",!0).order("name");if(e){const n=await c.getCountryIdByName(e);t=t.eq("country_id",n)}const{data:n,error:r}=await t;if(r)throw r;return n||[]},async getCaseStatuses(){const{data:e,error:t}=await a.E.from("case_statuses").select("*").eq("is_active",!0).order("sort_order");if(t)throw t;return e||[]},async getProcedureMappings(e,t){const n=await c.getCountryIdByName(t),{data:r}=await a.N.from("procedure_types").select("id").eq("name",e).eq("country_id",n).single();if(!r)return{surgerySets:[],implantBoxes:[]};const{data:s,error:o}=await a.N.from("procedure_mappings").select("\n        surgery_set:surgery_sets(name),\n        implant_box:implant_boxes(name)\n      ").eq("procedure_type_id",r.id).eq("country_id",n);if(o)throw o;const i=(null===s||void 0===s?void 0:s.map(e=>{var t;return null===(t=e.surgery_set)||void 0===t?void 0:t.name}).filter(Boolean))||[],l=(null===s||void 0===s?void 0:s.map(e=>{var t;return null===(t=e.implant_box)||void 0===t?void 0:t.name}).filter(Boolean))||[];return{surgerySets:Array.from(new Set(i)),implantBoxes:Array.from(new Set(l))}}},h={async getUserNotifications(e){const{data:t,error:n}=await a.N.from("notifications").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;return t||[]},async createNotification(e,t,n,r,s){const{error:o}=await a.N.from("notifications").insert({user_id:e,type:t,title:n,message:r,duration:s});if(o)throw o},async markAsRead(e){const{error:t}=await a.N.from("notifications").update({is_read:!0}).eq("id",e);if(t)throw t}},p={async logAction(e,t,n,r,s){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"success";const{data:i}=await a.N.from("users").select("name").eq("id",e).single(),{error:l}=await a.N.from("audit_logs").insert({user_id:e,user_name:null===i||void 0===i?void 0:i.name,action:t,category:n,target:r,details:s,status:o});if(l)throw l},async getAuditLogs(e){let t=a.N.from("audit_logs").select("*").order("created_at",{ascending:!1});null!==e&&void 0!==e&&e.userId&&(t=t.eq("user_id",e.userId)),null!==e&&void 0!==e&&e.category&&(t=t.eq("category",e.category)),null!==e&&void 0!==e&&e.dateFrom&&(t=t.gte("created_at",e.dateFrom)),null!==e&&void 0!==e&&e.dateTo&&(t=t.lte("created_at",e.dateTo));const{data:n,error:r}=await t;if(r)throw r;return n||[]}},m={async uploadCaseAttachment(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=t.name.split(".").pop(),o="".concat(e,"/").concat(Date.now(),".").concat(s),{data:i,error:l}=await a.N.storage.from("case-attachments").upload(o,t);if(l)throw l;return await a.N.from("attachments").insert({case_id:e,file_name:t.name,file_path:i.path,file_size:t.size,file_type:t.type,uploaded_by:n,is_delivery_image:r}),i.path},async getCaseAttachments(e){const{data:t,error:n}=await a.N.from("attachments").select("*").eq("case_id",e).order("uploaded_at",{ascending:!1});if(n)throw n;return t||[]},async getFileUrl(e){const{data:t}=a.N.storage.from("case-attachments").getPublicUrl(e);return t.publicUrl}},f={countryOperations:l,userOperations:c,caseOperations:d,lookupOperations:u,notificationOperations:h,auditOperations:p,fileOperations:m,subscriptions:{subscribeToCases:e=>a.N.channel("cases").on("postgres_changes",{event:"*",schema:"public",table:"cases"},e).subscribe(),subscribeToNotifications:(e,t)=>a.N.channel("notifications:".concat(e)).on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:"user_id=eq.".concat(e)},t).subscribe()}}},166:(e,t,n)=>{n.d(t,{caseService:()=>u});var r=n(379);class a{constructor(){this.currentUser=null,this.userCache=new Map}static getInstance(){return a.instance||(a.instance=new a),a.instance}getCurrentUser(){if(this.currentUser)return this.currentUser;try{const e=localStorage.getItem("currentUser");if(e)return this.currentUser=JSON.parse(e),this.currentUser}catch(e){console.error("Error loading current user:",e),localStorage.removeItem("currentUser")}return null}setCurrentUser(e){this.currentUser=e,e?(localStorage.setItem("currentUser",JSON.stringify(e)),this.userCache.set(e.id,e)):localStorage.removeItem("currentUser")}isAuthenticated(){return null!==this.getCurrentUser()}getUserById(e){if(this.userCache.has(e))return this.userCache.get(e);try{const t=this.getAllUsers().find(t=>t.id===e)||null;return t&&this.userCache.set(e,t),t}catch(t){return console.error("Error fetching user:",t),null}}getAllUsers(){try{const e=localStorage.getItem("users");return e?JSON.parse(e):[]}catch(e){return console.error("Error loading users:",e),[]}}saveUser(e){try{var t;const n=this.getAllUsers(),r=n.findIndex(t=>t.id===e.id);return r>=0?n[r]=e:n.push(e),localStorage.setItem("users",JSON.stringify(n)),this.userCache.set(e.id,e),(null===(t=this.currentUser)||void 0===t?void 0:t.id)===e.id&&this.setCurrentUser(e),!0}catch(n){return console.error("Error saving user:",n),!1}}deleteUser(e){try{const t=this.getAllUsers().filter(t=>t.id!==e);return localStorage.setItem("users",JSON.stringify(t)),this.userCache.delete(e),!0}catch(t){return console.error("Error deleting user:",t),!1}}updateUserCountry(e){const t=this.getCurrentUser();if(!t)return!1;const n=(0,r.A)((0,r.A)({},t),{},{selectedCountry:e});return this.saveUser(n)}hasCountryAccess(e){const t=this.getCurrentUser();return!!t&&("admin"===t.role||t.countries.includes(e))}clearCache(){this.currentUser=null,this.userCache.clear()}logout(){this.clearCache(),localStorage.removeItem("currentUser")}}a.instance=void 0;const s=a.getInstance();class o{static getInstance(){return o.instance||(o.instance=new o),o.instance}constructor(){this.notifications=[],this.listeners=new Set,this.MAX_NOTIFICATIONS=100,this.loadNotifications()}loadNotifications(){try{const e=localStorage.getItem("notifications");e&&(this.notifications=JSON.parse(e))}catch(e){console.error("Error loading notifications:",e),this.notifications=[]}}saveNotifications(){try{localStorage.setItem("notifications",JSON.stringify(this.notifications))}catch(e){console.error("Error saving notifications:",e)}}notifyListeners(){this.listeners.forEach(e=>{try{e([...this.notifications])}catch(t){console.error("Error notifying listener:",t)}})}subscribe(e){return this.listeners.add(e),e([...this.notifications]),()=>{this.listeners.delete(e)}}addNotification(e){const t=(0,r.A)((0,r.A)({},e),{},{id:this.generateId(),timestamp:e.timestamp||(new Date).toISOString()});this.notifications.unshift(t),this.notifications.length>this.MAX_NOTIFICATIONS&&(this.notifications=this.notifications.slice(0,this.MAX_NOTIFICATIONS)),this.saveNotifications(),this.notifyListeners()}removeNotification(e){this.notifications=this.notifications.filter(t=>t.id!==e),this.saveNotifications(),this.notifyListeners()}clearAll(){this.notifications=[],this.saveNotifications(),this.notifyListeners()}markAsRead(e){const t=this.notifications.find(t=>t.id===e);t&&!t.read&&(t.read=!0,this.saveNotifications(),this.notifyListeners())}markAllAsRead(){let e=!1;this.notifications.forEach(t=>{t.read||(t.read=!0,e=!0)}),e&&(this.saveNotifications(),this.notifyListeners())}getNotifications(){return[...this.notifications]}getUnreadCount(){return this.notifications.filter(e=>!e.read).length}getNotificationsByType(e){return this.notifications.filter(t=>t.type===e)}generateId(){return"notif_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}success(e,t){this.addNotification({title:e,message:t,type:"success",timestamp:(new Date).toISOString()})}error(e,t){this.addNotification({title:e,message:t,type:"error",timestamp:(new Date).toISOString()})}warning(e,t){this.addNotification({title:e,message:t,type:"warning",timestamp:(new Date).toISOString()})}info(e,t){this.addNotification({title:e,message:t,type:"info",timestamp:(new Date).toISOString()})}cleanupOldNotifications(){const e=new Date;e.setDate(e.getDate()-30);const t=this.notifications.filter(t=>new Date(t.timestamp)>e);t.length!==this.notifications.length&&(this.notifications=t,this.saveNotifications(),this.notifyListeners())}}o.instance=void 0;const i=o.getInstance();n(887);var l=n(133);const c=l.Ay.caseOperations;l.Ay.userOperations,l.Ay.subscriptions;class d{constructor(){this.casesCache=new Map,this.lastFetchTime=0,this.CACHE_DURATION=3e5}static getInstance(){return d.instance||(d.instance=new d),d.instance}async getAllCases(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Date.now(),n=t-this.lastFetchTime<this.CACHE_DURATION;if(!e&&n&&this.casesCache.size>0)return Array.from(this.casesCache.values());try{const e=await c.getAll();return this.casesCache.clear(),e.forEach(e=>{this.casesCache.set(e.id,e)}),this.lastFetchTime=t,e}catch(r){return console.error("Error loading cases:",r),[]}}async getCaseById(e){if(this.casesCache.has(e))return this.casesCache.get(e);return(await this.getAllCases()).find(t=>t.id===e)||null}async saveCase(e){console.log("\ud83d\udcc1 caseService.saveCase called with:",e);try{const t=await this.getCaseById(e.id);return console.log("\ud83d\udcc1 Existing case found:",t?"Yes":"No"),t?(console.log("\ud83d\udcc1 Updating existing case via caseOperations.update"),await c.update(e.id,e)):(console.log("\ud83d\udcc1 Creating new case via caseOperations.create"),await c.create(e)),this.casesCache.set(e.id,e),console.log("\ud83d\udcc1 Case saved successfully to cache and Supabase"),!0}catch(t){return console.error("\ud83d\udcc1 Error saving case:",t),!1}}async updateCaseStatus(e,t,n,r){try{const r=await this.getCaseById(e);if(!r)return console.error("Case not found:",e),!1;const a=s.getCurrentUser();return a?(await c.updateStatus(e,t,a.name,n),this.casesCache.delete(e),i.addNotification({title:"Case Status Updated: ".concat(t),message:"Case ".concat(r.caseReferenceNumber," has been updated to ").concat(t," by ").concat(a.name),type:"success",timestamp:(new Date).toISOString()}),!0):(console.error("No current user found"),!1)}catch(a){return console.error("Error updating case status:",a),!1}}async getCasesForUser(){const e=s.getCurrentUser();if(!e)return[];const t=await this.getAllCases();return"admin"===e.role?t:t.filter(t=>{const n=e.countries.includes(t.country),r=0===e.departments.length||e.departments.includes(t.department);return n&&r})}async searchCases(e){if(!e.trim())return await this.getCasesForUser();const t=e.toLowerCase().trim();return(await this.getCasesForUser()).filter(e=>{var n;return e.caseReferenceNumber.toLowerCase().includes(t)||e.hospital.toLowerCase().includes(t)||(null===(n=e.doctorName)||void 0===n?void 0:n.toLowerCase().includes(t))||e.procedureType.toLowerCase().includes(t)||e.procedureName.toLowerCase().includes(t)||e.submittedBy.toLowerCase().includes(t)})}async getCasesByStatus(e){return(await this.getCasesForUser()).filter(t=>t.status===e)}async getCasesByDateRange(e,t){return(await this.getCasesForUser()).filter(n=>{const r=n.dateOfSurgery;return r>=e&&r<=t})}async deleteCase(e){try{return await c.delete(e),this.casesCache.delete(e),!0}catch(t){return console.error("Error deleting case:",t),!1}}async amendCase(e,t,n){try{const n=await this.getCaseById(e);if(!n)return console.error("Case not found for amendment:",e),!1;const a=s.getCurrentUser();if(!a)return console.error("No current user found"),!1;const o=[];for(const[e,r]of Object.entries(t)){const t=n[e];t!==r&&void 0!==r&&o.push({field:e,oldValue:(null===t||void 0===t?void 0:t.toString())||"",newValue:(null===r||void 0===r?void 0:r.toString())||""})}if(0===o.length)return console.log("No changes detected for amendment"),!0;const l=(0,r.A)((0,r.A)({},n),t);return await c.update(e,l),await c.addAmendment(e,a.id,o,"Case amended"),this.casesCache.set(e,l),i.addNotification({title:"Case Amended",message:"Case ".concat(n.caseReferenceNumber," has been amended by ").concat(a.name),type:"success",timestamp:(new Date).toISOString()}),!0}catch(a){return console.error("Error amending case:",a),!1}}async generateCaseReferenceNumber(){const e=await this.getAllCases(),t=(new Date).getFullYear(),n=e.filter(e=>e.caseReferenceNumber.startsWith("TMC".concat(t))).length+1;return"TMC".concat(t).concat(n.toString().padStart(4,"0"))}clearCache(){this.casesCache.clear(),this.lastFetchTime=0}async getCasesCountByStatus(){const e=await this.getCasesForUser(),t={};return["Case Booked","Order Preparation","Order Prepared","Pending Delivery (Hospital)","Delivered (Hospital)","Case Completed","Pending Delivery (Office)","Delivered (Office)","To be billed","Case Closed","Case Cancelled"].forEach(e=>{t[e]=0}),e.forEach(e=>{void 0!==t[e.status]&&t[e.status]++}),t}}d.instance=void 0;const u=d.getInstance()},324:(e,t,n)=>{n.d(t,{AJ:()=>i,Dg:()=>o,Hm:()=>c,SZ:()=>l,YC:()=>u,createOAuthManager:()=>d});const r={google:{name:"Google",authUrl:"https://accounts.google.com/o/oauth2/v2/auth",tokenUrl:"https://oauth2.googleapis.com/token",userInfoUrl:"https://www.googleapis.com/oauth2/v2/userinfo",config:{clientId:"your-prod-google-client-id",scopes:["https://www.googleapis.com/auth/gmail.send","https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile"],redirectUri:"".concat(window.location.origin,"/auth/callback")}},microsoft:{name:"Microsoft",authUrl:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",tokenUrl:"https://login.microsoftonline.com/common/oauth2/v2.0/token",userInfoUrl:"https://graph.microsoft.com/v1.0/me",config:{clientId:"766ea716-3e33-41a9-b780-c23203f5562b",scopes:["https://graph.microsoft.com/Mail.Send","https://graph.microsoft.com/User.Read","offline_access"],redirectUri:"".concat(window.location.origin,"/auth/callback")}}};async function a(){const e=function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";let n="";for(let r=0;r<e;r++)n+=t.charAt(Math.floor(66*Math.random()));return n}(128),t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(n);let a="";for(let s=0;s<r.length;s++)a+=String.fromCharCode(r[s]);return{codeVerifier:e,codeChallenge:btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}}class s{constructor(e){this.provider=void 0,this.config=void 0,this.pkceChallenge=void 0,this.provider=e,this.config=r[e]}isConfigured(){const e=this.config.config.clientId;return!(!e||"NOT_CONFIGURED"===e||e.includes("your-dev-")||e.includes("your-prod-"))}async getAuthUrl(e){console.log("[OAuth] Building auth URL for ".concat(this.provider));const t={client_id:this.config.config.clientId,response_type:"code",scope:this.config.config.scopes.join(" "),redirect_uri:this.config.config.redirectUri,state:e||"".concat(this.provider,"_").concat(Date.now())};console.log("[OAuth] Base parameters:",{provider:this.provider,clientId:this.config.config.clientId.substring(0,8)+"...",redirectUri:this.config.config.redirectUri,scopes:this.config.config.scopes}),"microsoft"!==this.provider&&"google"!==this.provider||(console.log("[OAuth] Generating PKCE challenge for ".concat(this.provider)),this.pkceChallenge=await a(),t.code_challenge=this.pkceChallenge.codeChallenge,t.code_challenge_method="S256",console.log("[OAuth] PKCE challenge generated:",{codeChallenge:this.pkceChallenge.codeChallenge.substring(0,20)+"...",method:"S256"})),"google"===this.provider&&(t.access_type="offline",t.prompt="consent",console.log("[OAuth] Added Google-specific parameters: access_type=offline, prompt=consent"));const n="".concat(this.config.authUrl,"?").concat(new URLSearchParams(t).toString());return console.log("[OAuth] Final auth URL constructed for ".concat(this.provider)),n}async exchangeCodeForTokens(e){if(!this.pkceChallenge)throw new Error("PKCE challenge not found. Make sure to call getAuthUrl first.");const t=new URLSearchParams({client_id:this.config.config.clientId,code:e,grant_type:"authorization_code",redirect_uri:this.config.config.redirectUri,code_verifier:this.pkceChallenge.codeVerifier}),n=await fetch(this.config.tokenUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t.toString()});if(!n.ok){const e=await n.text();throw console.error("Token exchange failed:",{status:n.status,statusText:n.statusText,body:e,provider:this.provider}),new Error("Token exchange failed: ".concat(n.status," ").concat(n.statusText," - ").concat(e))}const r=await n.json();console.log("Token exchange response:",{hasAccessToken:!!r.access_token,hasRefreshToken:!!r.refresh_token,expiresIn:r.expires_in});const a=Date.now()+1e3*r.expires_in;return{accessToken:r.access_token,refreshToken:r.refresh_token,expiresIn:r.expires_in,expiresAt:a}}async getUserInfo(e){const t=await fetch(this.config.userInfoUrl,{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok){const e=await t.text();throw console.error("User info request failed:",{status:t.status,statusText:t.statusText,body:e,provider:this.provider}),new Error("Failed to get user info: ".concat(t.status," ").concat(t.statusText," - ").concat(e))}const n=await t.json();return console.log("User info response:",{provider:this.provider,hasEmail:!!n.email||!!n.mail||!!n.userPrincipalName,hasId:!!n.id,hasName:!!n.name||!!n.displayName}),"google"===this.provider?{id:n.id,email:n.email,name:n.name,picture:n.picture}:{id:n.id,email:n.mail||n.userPrincipalName,name:n.displayName,picture:null===(r=n.photo)||void 0===r?void 0:r.value};var r}async sendEmail(e,t){return"google"===this.provider?this.sendGmailEmail(e,t):this.sendOutlookEmail(e,t)}async sendGmailEmail(e,t){let n;if(t.attachments&&t.attachments.length>0){const e="boundary_"+Math.random().toString(36).substr(2,9);n=["To: ".concat(t.to.join(", ")),"Subject: ".concat(t.subject),"MIME-Version: 1.0",'Content-Type: multipart/mixed; boundary="'.concat(e,'"'),"","--".concat(e),"Content-Type: text/html; charset=utf-8","",t.body,""].join("\n"),t.attachments.forEach(t=>{n+=["--".concat(e),"Content-Type: ".concat(t.contentType),'Content-Disposition: attachment; filename="'.concat(t.filename,'"'),"Content-Transfer-Encoding: base64","",t.content,""].join("\n")}),n+="--".concat(e,"--")}else n=["To: ".concat(t.to.join(", ")),"Subject: ".concat(t.subject),"Content-Type: text/html; charset=utf-8","",t.body].join("\n");const r=btoa(unescape(encodeURIComponent(n))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");return(await fetch("https://gmail.googleapis.com/gmail/v1/users/me/messages/send",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({raw:r})})).ok}async sendOutlookEmail(e,t){const n={message:{subject:t.subject,body:{contentType:"HTML",content:t.body},toRecipients:t.to.map(e=>({emailAddress:{address:e}}))}};t.attachments&&t.attachments.length>0&&(n.message.attachments=t.attachments.map(e=>({"@odata.type":"#microsoft.graph.fileAttachment",name:e.filename,contentType:e.contentType,contentBytes:e.content})));return(await fetch("https://graph.microsoft.com/v1.0/me/sendMail",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(n)})).ok}}const o=(e,t)=>{const n="email_userinfo_".concat(e,"_").concat(t),r=localStorage.getItem(n);if(!r)return null;try{return JSON.parse(r)}catch(a){return null}},i=(e,t)=>{const n="email_auth_".concat(e,"_").concat(t),r=localStorage.getItem(n);if(!r)return null;try{return JSON.parse(r)}catch(a){return null}},l=(e,t)=>{const n="email_auth_".concat(e,"_").concat(t);localStorage.removeItem(n),((e,t)=>{const n="email_userinfo_".concat(e,"_").concat(t);localStorage.removeItem(n)})(e,t)},c=e=>Date.now()>=e.expiresAt,d=e=>new s(e),u=async(e,t)=>{console.log("[OAuth] Creating OAuth manager for ".concat(e));const n=d(e);if(!n.isConfigured()){const t="google"===e?"REACT_APP_GOOGLE_CLIENT_ID":"REACT_APP_MICROSOFT_CLIENT_ID";throw new Error("".concat("google"===e?"Google":"Microsoft"," OAuth is not configured. Please set the ").concat(t," environment variable with a valid client ID."))}try{console.log("[OAuth] Generating auth URL for ".concat(e));const r=await n.getAuthUrl("".concat(t,"_").concat(Date.now()));return console.log("[OAuth] Auth URL generated:",r.substring(0,100)+"..."),new Promise((a,s)=>{console.log("[OAuth] Opening popup window for ".concat(e));const o=window.open(r,"oauth_auth","width=500,height=600,scrollbars=yes,resizable=yes");if(!o)return console.error("[OAuth] Popup blocked for ".concat(e)),void s(new Error("Popup blocked. Please allow popups for this site."));console.log("[OAuth] Popup opened successfully for ".concat(e,", waiting for callback..."));const i=async r=>{var l,c;if(console.log("[OAuth] Received message from popup:",{origin:r.origin,expectedOrigin:window.location.origin,dataType:null===(l=r.data)||void 0===l?void 0:l.type,hasCode:!(null===(c=r.data)||void 0===c||!c.code)}),r.origin===window.location.origin)if("oauth_success"!==r.data.type&&"sso_auth_success"!==r.data.type||!r.data.code)"oauth_error"===r.data.type||"sso_auth_error"===r.data.type?(console.error("[OAuth] OAuth error received:",r.data.error),window.removeEventListener("message",i),o.close(),s(new Error(r.data.error))):console.log("[OAuth] Ignoring unrecognized message:",r.data);else try{console.log("[OAuth] Received authorization code for ".concat(e,", exchanging for tokens..."));const s=await n.exchangeCodeForTokens(r.data.code);console.log("[OAuth] Token exchange successful for ".concat(e,", fetching user info..."));const l=await n.getUserInfo(s.accessToken);console.log("[OAuth] User info retrieved for ".concat(e,":"),{email:l.email,id:l.id}),console.log("[OAuth] Storing tokens and user info for ".concat(e," in ").concat(t)),((e,t,n)=>{const r="email_auth_".concat(e,"_").concat(t);localStorage.setItem(r,JSON.stringify(n))})(t,e,s),((e,t,n)=>{const r="email_userinfo_".concat(e,"_").concat(t);localStorage.setItem(r,JSON.stringify(n))})(t,e,l),console.log("[OAuth] Cleaning up event listeners and closing popup"),window.removeEventListener("message",i),o.close(),console.log("[OAuth] Resolving with tokens and userInfo"),a({tokens:s,userInfo:l})}catch(d){console.error("[OAuth] OAuth flow failed for ".concat(e,":"),d),window.removeEventListener("message",i),o.close(),s(d)}else console.warn("[OAuth] Ignoring message from different origin: ".concat(r.origin))};console.log("[OAuth] Adding message event listener for ".concat(e)),window.addEventListener("message",i);const l=setInterval(()=>{o.closed&&(console.log("[OAuth] Popup was closed manually for ".concat(e)),clearInterval(l),window.removeEventListener("message",i),s(new Error("Authentication cancelled")))},1e3);setTimeout(()=>{o.closed||(console.warn("[OAuth] Authentication timeout for ".concat(e," (2 minutes)")),clearInterval(l),window.removeEventListener("message",i),o.close(),s(new Error("Authentication timeout - please try again")))},12e4)})}catch(r){throw console.error("[OAuth] Failed to generate auth URL for ".concat(e,":"),r),new Error("Failed to generate auth URL: ".concat(r instanceof Error?r.message:"Unknown error"))}}},340:(e,t,n)=>{e.exports=n(761)},345:(e,t,n)=>{var r=n(950),a=n(340);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,i={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(i[e]=t,e=0;e<t.length;e++)o.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},m={};function f(e,t,n,r,a,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!u.call(m,e)||!u.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,y);g[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),S=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),E=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var P=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=P&&e[P]||e["@@iterator"])?e:null}var M,L=Object.assign;function F(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var B=!1;function U(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),s=r.stack.split("\n"),o=a.length-1,i=s.length-1;1<=o&&0<=i&&a[o]!==s[i];)i--;for(;1<=o&&0<=i;o--,i--)if(a[o]!==s[i]){if(1!==o||1!==i)do{if(o--,0>--i||a[o]!==s[i]){var l="\n"+a[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=i);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function z(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case S:return"Portal";case k:return"Profiler";case j:return"StrictMode";case D:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return H(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function Y(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function V(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Y(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){$(e,t);var n=Y(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,Y(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Y(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Y(n)}}function se(e,t){var n=Y(t.value),r=Y(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ie(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,he=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function pe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function ve(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ge(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(me).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]})});var ye=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function xe(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ne=null,je=null,ke=null;function Ce(e){if(e=xa(e)){if("function"!==typeof Ne)throw Error(s(280));var t=e.stateNode;t&&(t=Sa(t),Ne(e.stateNode,e.type,t))}}function Ee(e){je?ke?ke.push(e):ke=[e]:je=e}function _e(){if(je){var e=je,t=ke;if(ke=je=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function De(e,t){return e(t)}function Ae(){}var Te=!1;function Ie(e,t,n){if(Te)return e(t,n);Te=!0;try{return De(e,t,n)}finally{Te=!1,(null!==je||null!==ke)&&(Ae(),_e())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var r=Sa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Pe=!1;if(d)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(de){Pe=!1}function Me(e,t,n,r,a,s,o,i,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Le=!1,Fe=null,Be=!1,Ue=null,ze={onError:function(e){Le=!0,Fe=e}};function He(e,t,n,r,a,s,o,i,l){Le=!1,Fe=null,Me.apply(ze,arguments)}function qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ye(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(qe(e)!==e)throw Error(s(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return We(a),e;if(o===r)return We(a),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=a,r=o;else{for(var i=!1,l=a.child;l;){if(l===n){i=!0,n=a,r=o;break}if(l===r){i=!0,r=a,n=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===n){i=!0,n=o,r=a;break}if(l===r){i=!0,r=o,n=a;break}l=l.sibling}if(!i)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ke(e):null}function Ke(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ke(e);if(null!==t)return t;e=e.sibling}return null}var Ge=a.unstable_scheduleCallback,Qe=a.unstable_cancelCallback,Je=a.unstable_shouldYield,$e=a.unstable_requestPaint,Xe=a.unstable_now,Ze=a.unstable_getCurrentPriorityLevel,et=a.unstable_ImmediatePriority,tt=a.unstable_UserBlockingPriority,nt=a.unstable_NormalPriority,rt=a.unstable_LowPriority,at=a.unstable_IdlePriority,st=null,ot=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(lt(e)/ct|0)|0},lt=Math.log,ct=Math.LN2;var dt=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var i=o&~a;0!==i?r=ht(i):0!==(s&=o)&&(r=ht(s))}else 0!==(o=n&~a)?r=ht(o):0!==s&&(r=ht(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(s=t&-t)||16===a&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-it(t)),r|=e[n],t&=~a;return r}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=dt;return 0===(4194240&(dt<<=1))&&(dt=64),e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function bt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var xt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var St,Nt,jt,kt,Ct,Et=!1,_t=[],Dt=null,At=null,Tt=null,It=new Map,Ot=new Map,Pt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Dt=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":It.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Lt(e,t,n,r,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[a]},null!==t&&(null!==(t=xa(t))&&Nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ft(e){var t=ba(e.target);if(null!==t){var n=qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ye(n)))return e.blockedOn=t,void Ct(e.priority,function(){jt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=xa(n))&&Nt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Ut(e,t,n){Bt(e)&&n.delete(t)}function zt(){Et=!1,null!==Dt&&Bt(Dt)&&(Dt=null),null!==At&&Bt(At)&&(At=null),null!==Tt&&Bt(Tt)&&(Tt=null),It.forEach(Ut),Ot.forEach(Ut)}function Ht(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,zt)))}function qt(e){function t(t){return Ht(t,e)}if(0<_t.length){Ht(_t[0],e);for(var n=1;n<_t.length;n++){var r=_t[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Dt&&Ht(Dt,e),null!==At&&Ht(At,e),null!==Tt&&Ht(Tt,e),It.forEach(t),Ot.forEach(t),n=0;n<Pt.length;n++)(r=Pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Pt.shift()}var Yt=x.ReactCurrentBatchConfig,Wt=!0;function Vt(e,t,n,r){var a=xt,s=Yt.transition;Yt.transition=null;try{xt=1,Gt(e,t,n,r)}finally{xt=a,Yt.transition=s}}function Kt(e,t,n,r){var a=xt,s=Yt.transition;Yt.transition=null;try{xt=4,Gt(e,t,n,r)}finally{xt=a,Yt.transition=s}}function Gt(e,t,n,r){if(Wt){var a=Jt(e,t,n,r);if(null===a)Wr(e,t,r,Qt,n),Mt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Dt=Lt(Dt,e,t,n,r,a),!0;case"dragenter":return At=Lt(At,e,t,n,r,a),!0;case"mouseover":return Tt=Lt(Tt,e,t,n,r,a),!0;case"pointerover":var s=a.pointerId;return It.set(s,Lt(It.get(s)||null,e,t,n,r,a)),!0;case"gotpointercapture":return s=a.pointerId,Ot.set(s,Lt(Ot.get(s)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==a;){var s=xa(a);if(null!==s&&St(s),null===(s=Jt(e,t,n,r))&&Wr(e,t,r,Qt,n),s===a)break;a=s}null!==a&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Qt=null;function Jt(e,t,n,r){if(Qt=null,null!==(e=ba(e=Se(r))))if(null===(t=qe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ye(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case et:return 1;case tt:return 4;case nt:case rt:return 16;case at:return 536870912;default:return 16}default:return 16}}var Xt=null,Zt=null,en=null;function tn(){if(en)return en;var e,t,n=Zt,r=n.length,a="value"in Xt?Xt.value:Xt.textContent,s=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[s-t];t++);return en=a.slice(e,1<t?1-t:void 0)}function nn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rn(){return!0}function an(){return!1}function sn(e){function t(t,n,r,a,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?rn:an,this.isPropagationStopped=an,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rn)},persist:function(){},isPersistent:rn}),t}var on,ln,cn,dn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(dn),hn=L({},dn,{view:0,detail:0}),pn=sn(hn),mn=L({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(on=e.screenX-cn.screenX,ln=e.screenY-cn.screenY):ln=on=0,cn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),fn=sn(mn),gn=sn(L({},mn,{dataTransfer:0})),vn=sn(L({},hn,{relatedTarget:0})),yn=sn(L({},dn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=L({},dn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xn=sn(bn),wn=sn(L({},dn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=jn[e])&&!!t[e]}function Cn(){return kn}var En=L({},hn,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=nn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Nn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?nn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?nn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),_n=sn(En),Dn=sn(L({},mn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=sn(L({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Tn=sn(L({},dn,{propertyName:0,elapsedTime:0,pseudoElement:0})),In=L({},mn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=sn(In),Pn=[9,13,27,32],Rn=d&&"CompositionEvent"in window,Mn=null;d&&"documentMode"in document&&(Mn=document.documentMode);var Ln=d&&"TextEvent"in window&&!Mn,Fn=d&&(!Rn||Mn&&8<Mn&&11>=Mn),Bn=String.fromCharCode(32),Un=!1;function zn(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var qn=!1;var Yn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Yn[e.type]:"textarea"===t}function Vn(e,t,n,r){Ee(r),0<(t=Kr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,Gn=null;function Qn(e){Br(e,0)}function Jn(e){if(K(wa(e)))return e}function $n(e,t){if("change"===e)return t}var Xn=!1;if(d){var Zn;if(d){var er="oninput"in document;if(!er){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),er="function"===typeof tr.oninput}Zn=er}else Zn=!1;Xn=Zn&&(!document.documentMode||9<document.documentMode)}function nr(){Kn&&(Kn.detachEvent("onpropertychange",rr),Gn=Kn=null)}function rr(e){if("value"===e.propertyName&&Jn(Gn)){var t=[];Vn(t,Gn,e,Se(e)),Ie(Qn,t)}}function ar(e,t,n){"focusin"===e?(nr(),Gn=n,(Kn=t).attachEvent("onpropertychange",rr)):"focusout"===e&&nr()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Gn)}function or(e,t){if("click"===e)return Jn(t)}function ir(e,t){if("input"===e||"change"===e)return Jn(t)}var lr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(lr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!u.call(t,a)||!lr(e[a],t[a]))return!1}return!0}function dr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=dr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=dr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function mr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=pr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&mr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,s=Math.min(r.start,a);r=void 0===r.end?s:Math.min(r.end,a),!e.extend&&s>r&&(a=r,r=s,s=a),a=ur(n,s);var o=ur(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gr=d&&"documentMode"in document&&11>=document.documentMode,vr=null,yr=null,br=null,xr=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;xr||null==vr||vr!==G(r)||("selectionStart"in(r=vr)&&mr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&cr(br,r)||(br=r,0<(r=Kr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=vr)))}function Sr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Nr={animationend:Sr("Animation","AnimationEnd"),animationiteration:Sr("Animation","AnimationIteration"),animationstart:Sr("Animation","AnimationStart"),transitionend:Sr("Transition","TransitionEnd")},jr={},kr={};function Cr(e){if(jr[e])return jr[e];if(!Nr[e])return e;var t,n=Nr[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return jr[e]=n[t];return e}d&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete Nr.animationend.animation,delete Nr.animationiteration.animation,delete Nr.animationstart.animation),"TransitionEvent"in window||delete Nr.transitionend.transition);var Er=Cr("animationend"),_r=Cr("animationiteration"),Dr=Cr("animationstart"),Ar=Cr("transitionend"),Tr=new Map,Ir="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(e,t){Tr.set(e,t),l(t,[e])}for(var Pr=0;Pr<Ir.length;Pr++){var Rr=Ir[Pr];Or(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Or(Er,"onAnimationEnd"),Or(_r,"onAnimationIteration"),Or(Dr,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(Ar,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,i,l,c){if(He.apply(this,arguments),Le){if(!Le)throw Error(s(198));var d=Fe;Le=!1,Fe=null,Be||(Be=!0,Ue=d)}}(r,t,void 0,e),e.currentTarget=null}function Br(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var i=r[o],l=i.instance,c=i.currentTarget;if(i=i.listener,l!==s&&a.isPropagationStopped())break e;Fr(a,i,c),s=l}else for(o=0;o<r.length;o++){if(l=(i=r[o]).instance,c=i.currentTarget,i=i.listener,l!==s&&a.isPropagationStopped())break e;Fr(a,i,c),s=l}}}if(Be)throw e=Ue,Be=!1,Ue=null,e}function Ur(e,t){var n=t[ga];void 0===n&&(n=t[ga]=new Set);var r=e+"__bubble";n.has(r)||(Yr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),Yr(n,e,r,t)}var Hr="_reactListening"+Math.random().toString(36).slice(2);function qr(e){if(!e[Hr]){e[Hr]=!0,o.forEach(function(t){"selectionchange"!==t&&(Lr.has(t)||zr(t,!1,e),zr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Hr]||(t[Hr]=!0,zr("selectionchange",!1,t))}}function Yr(e,t,n,r){switch($t(t)){case 1:var a=Vt;break;case 4:a=Kt;break;default:a=Gt}n=a.bind(null,t,n,e),a=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,a){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var i=r.stateNode.containerInfo;if(i===a||8===i.nodeType&&i.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;o=o.return}for(;null!==i;){if(null===(o=ba(i)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}i=i.parentNode}}r=r.return}Ie(function(){var r=s,a=Se(n),o=[];e:{var i=Tr.get(e);if(void 0!==i){var l=un,c=e;switch(e){case"keypress":if(0===nn(n))break e;case"keydown":case"keyup":l=_n;break;case"focusin":c="focus",l=vn;break;case"focusout":c="blur",l=vn;break;case"beforeblur":case"afterblur":l=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case Er:case _r:case Dr:l=yn;break;case Ar:l=Tn;break;case"scroll":l=pn;break;case"wheel":l=On;break;case"copy":case"cut":case"paste":l=xn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Dn}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==i?i+"Capture":null:i;d=[];for(var p,m=r;null!==m;){var f=(p=m).stateNode;if(5===p.tag&&null!==f&&(p=f,null!==h&&(null!=(f=Oe(m,h))&&d.push(Vr(m,f,p)))),u)break;m=m.return}0<d.length&&(i=new l(i,c,null,n,a),o.push({event:i,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!ba(c)&&!c[fa])&&(l||i)&&(i=a.window===a?a:(i=a.ownerDocument)?i.defaultView||i.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?ba(c):null)&&(c!==(u=qe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(d=fn,f="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=Dn,f="onPointerLeave",h="onPointerEnter",m="pointer"),u=null==l?i:wa(l),p=null==c?i:wa(c),(i=new d(f,m+"leave",l,n,a)).target=u,i.relatedTarget=p,f=null,ba(a)===r&&((d=new d(h,m+"enter",c,n,a)).target=p,d.relatedTarget=u,f=d),u=f,l&&c)e:{for(h=c,m=0,p=d=l;p;p=Gr(p))m++;for(p=0,f=h;f;f=Gr(f))p++;for(;0<m-p;)d=Gr(d),m--;for(;0<p-m;)h=Gr(h),p--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=Gr(d),h=Gr(h)}d=null}else d=null;null!==l&&Qr(o,i,l,d,!1),null!==c&&null!==u&&Qr(o,u,c,d,!0)}if("select"===(l=(i=r?wa(r):window).nodeName&&i.nodeName.toLowerCase())||"input"===l&&"file"===i.type)var g=$n;else if(Wn(i))if(Xn)g=ir;else{g=sr;var v=ar}else(l=i.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(g=or);switch(g&&(g=g(e,r))?Vn(o,g,n,a):(v&&v(e,i,r),"focusout"===e&&(v=i._wrapperState)&&v.controlled&&"number"===i.type&&ee(i,"number",i.value)),v=r?wa(r):window,e){case"focusin":(Wn(v)||"true"===v.contentEditable)&&(vr=v,yr=r,br=null);break;case"focusout":br=yr=vr=null;break;case"mousedown":xr=!0;break;case"contextmenu":case"mouseup":case"dragend":xr=!1,wr(o,n,a);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":wr(o,n,a)}var y;if(Rn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else qn?zn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(qn||"onCompositionStart"!==b?"onCompositionEnd"===b&&qn&&(y=tn()):(Zt="value"in(Xt=a)?Xt.value:Xt.textContent,qn=!0)),0<(v=Kr(r,b)).length&&(b=new wn(b,e,null,n,a),o.push({event:b,listeners:v}),y?b.data=y:null!==(y=Hn(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return Hn(t);case"keypress":return 32!==t.which?null:(Un=!0,Bn);case"textInput":return(e=t.data)===Bn&&Un?null:e;default:return null}}(e,n):function(e,t){if(qn)return"compositionend"===e||!Rn&&zn(e,t)?(e=tn(),en=Zt=Xt=null,qn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Kr(r,"onBeforeInput")).length&&(a=new wn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}Br(o,t)})}function Vr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Kr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,s=a.stateNode;5===a.tag&&null!==s&&(a=s,null!=(s=Oe(e,n))&&r.unshift(Vr(e,s,a)),null!=(s=Oe(e,t))&&r.push(Vr(e,s,a))),e=e.return}return r}function Gr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,a){for(var s=t._reactName,o=[];null!==n&&n!==r;){var i=n,l=i.alternate,c=i.stateNode;if(null!==l&&l===r)break;5===i.tag&&null!==c&&(i=c,a?null!=(l=Oe(n,s))&&o.unshift(Vr(n,l,i)):a||null!=(l=Oe(n,s))&&o.push(Vr(n,l,i))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Jr=/\r\n?/g,$r=/\u0000|\uFFFD/g;function Xr(e){return("string"===typeof e?e:""+e).replace(Jr,"\n").replace($r,"")}function Zr(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(s(425))}function ea(){}var ta=null,na=null;function ra(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var aa="function"===typeof setTimeout?setTimeout:void 0,sa="function"===typeof clearTimeout?clearTimeout:void 0,oa="function"===typeof Promise?Promise:void 0,ia="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oa?function(e){return oa.resolve(null).then(e).catch(la)}:aa;function la(e){setTimeout(function(){throw e})}function ca(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void qt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);qt(t)}function da(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ua(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ha=Math.random().toString(36).slice(2),pa="__reactFiber$"+ha,ma="__reactProps$"+ha,fa="__reactContainer$"+ha,ga="__reactEvents$"+ha,va="__reactListeners$"+ha,ya="__reactHandles$"+ha;function ba(e){var t=e[pa];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fa]||n[pa]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ua(e);null!==e;){if(n=e[pa])return n;e=ua(e)}return t}n=(e=n).parentNode}return null}function xa(e){return!(e=e[pa]||e[fa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Sa(e){return e[ma]||null}var Na=[],ja=-1;function ka(e){return{current:e}}function Ca(e){0>ja||(e.current=Na[ja],Na[ja]=null,ja--)}function Ea(e,t){ja++,Na[ja]=e.current,e.current=t}var _a={},Da=ka(_a),Aa=ka(!1),Ta=_a;function Ia(e,t){var n=e.type.contextTypes;if(!n)return _a;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,s={};for(a in n)s[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Oa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pa(){Ca(Aa),Ca(Da)}function Ra(e,t,n){if(Da.current!==_a)throw Error(s(168));Ea(Da,t),Ea(Aa,n)}function Ma(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(s(108,q(e)||"Unknown",a));return L({},n,r)}function La(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_a,Ta=Da.current,Ea(Da,e),Ea(Aa,Aa.current),!0}function Fa(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Ma(e,t,Ta),r.__reactInternalMemoizedMergedChildContext=e,Ca(Aa),Ca(Da),Ea(Da,e)):Ca(Aa),Ea(Aa,n)}var Ba=null,Ua=!1,za=!1;function Ha(e){null===Ba?Ba=[e]:Ba.push(e)}function qa(){if(!za&&null!==Ba){za=!0;var e=0,t=xt;try{var n=Ba;for(xt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ba=null,Ua=!1}catch(a){throw null!==Ba&&(Ba=Ba.slice(e+1)),Ge(et,qa),a}finally{xt=t,za=!1}}return null}var Ya=[],Wa=0,Va=null,Ka=0,Ga=[],Qa=0,Ja=null,$a=1,Xa="";function Za(e,t){Ya[Wa++]=Ka,Ya[Wa++]=Va,Va=e,Ka=t}function es(e,t,n){Ga[Qa++]=$a,Ga[Qa++]=Xa,Ga[Qa++]=Ja,Ja=e;var r=$a;e=Xa;var a=32-it(r)-1;r&=~(1<<a),n+=1;var s=32-it(t)+a;if(30<s){var o=a-a%5;s=(r&(1<<o)-1).toString(32),r>>=o,a-=o,$a=1<<32-it(t)+a|n<<a|r,Xa=s+e}else $a=1<<s|n<<a|r,Xa=e}function ts(e){null!==e.return&&(Za(e,1),es(e,1,0))}function ns(e){for(;e===Va;)Va=Ya[--Wa],Ya[Wa]=null,Ka=Ya[--Wa],Ya[Wa]=null;for(;e===Ja;)Ja=Ga[--Qa],Ga[Qa]=null,Xa=Ga[--Qa],Ga[Qa]=null,$a=Ga[--Qa],Ga[Qa]=null}var rs=null,as=null,ss=!1,os=null;function is(e,t){var n=Ic(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ls(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,rs=e,as=da(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,rs=e,as=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ja?{id:$a,overflow:Xa}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ic(18,null,null,0)).stateNode=t,n.return=e,e.child=n,rs=e,as=null,!0);default:return!1}}function cs(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ds(e){if(ss){var t=as;if(t){var n=t;if(!ls(e,t)){if(cs(e))throw Error(s(418));t=da(n.nextSibling);var r=rs;t&&ls(e,t)?is(r,n):(e.flags=-4097&e.flags|2,ss=!1,rs=e)}}else{if(cs(e))throw Error(s(418));e.flags=-4097&e.flags|2,ss=!1,rs=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;rs=e}function hs(e){if(e!==rs)return!1;if(!ss)return us(e),ss=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ra(e.type,e.memoizedProps)),t&&(t=as)){if(cs(e))throw ps(),Error(s(418));for(;t;)is(e,t),t=da(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){as=da(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}as=null}}else as=rs?da(e.stateNode.nextSibling):null;return!0}function ps(){for(var e=as;e;)e=da(e.nextSibling)}function ms(){as=rs=null,ss=!1}function fs(e){null===os?os=[e]:os.push(e)}var gs=x.ReactCurrentBatchConfig;function vs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function ys(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bs(e){return(0,e._init)(e._payload)}function xs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function i(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Fc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===N?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===I&&bs(s)===t.type)?((r=a(t,n.props)).ref=vs(e,t,n),r.return=e,r):((r=Rc(n.type,n.key,n.props,null,e.mode,r)).ref=vs(e,t,n),r.return=e,r)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function u(e,t,n,r,s){return null===t||7!==t.tag?((t=Mc(n,e.mode,r,s)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Rc(t.type,t.key,t.props,null,e.mode,n)).ref=vs(e,null,t),n.return=e,n;case S:return(t=Bc(t,e.mode,n)).return=e,t;case I:return h(e,(0,t._init)(t._payload),n)}if(te(t)||R(t))return(t=Mc(t,e.mode,n,null)).return=e,t;ys(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===a?c(e,t,n,r):null;case S:return n.key===a?d(e,t,n,r):null;case I:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||R(n))return null!==a?null:u(e,t,n,r,null);ys(e,n)}return null}function m(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case S:return d(t,e=e.get(null===r.key?n:r.key)||null,r,a);case I:return m(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||R(r))return u(t,e=e.get(n)||null,r,a,null);ys(t,r)}return null}function f(a,s,i,l){for(var c=null,d=null,u=s,f=s=0,g=null;null!==u&&f<i.length;f++){u.index>f?(g=u,u=null):g=u.sibling;var v=p(a,u,i[f],l);if(null===v){null===u&&(u=g);break}e&&u&&null===v.alternate&&t(a,u),s=o(v,s,f),null===d?c=v:d.sibling=v,d=v,u=g}if(f===i.length)return n(a,u),ss&&Za(a,f),c;if(null===u){for(;f<i.length;f++)null!==(u=h(a,i[f],l))&&(s=o(u,s,f),null===d?c=u:d.sibling=u,d=u);return ss&&Za(a,f),c}for(u=r(a,u);f<i.length;f++)null!==(g=m(u,a,f,i[f],l))&&(e&&null!==g.alternate&&u.delete(null===g.key?f:g.key),s=o(g,s,f),null===d?c=g:d.sibling=g,d=g);return e&&u.forEach(function(e){return t(a,e)}),ss&&Za(a,f),c}function g(a,i,l,c){var d=R(l);if("function"!==typeof d)throw Error(s(150));if(null==(l=d.call(l)))throw Error(s(151));for(var u=d=null,f=i,g=i=0,v=null,y=l.next();null!==f&&!y.done;g++,y=l.next()){f.index>g?(v=f,f=null):v=f.sibling;var b=p(a,f,y.value,c);if(null===b){null===f&&(f=v);break}e&&f&&null===b.alternate&&t(a,f),i=o(b,i,g),null===u?d=b:u.sibling=b,u=b,f=v}if(y.done)return n(a,f),ss&&Za(a,g),d;if(null===f){for(;!y.done;g++,y=l.next())null!==(y=h(a,y.value,c))&&(i=o(y,i,g),null===u?d=y:u.sibling=y,u=y);return ss&&Za(a,g),d}for(f=r(a,f);!y.done;g++,y=l.next())null!==(y=m(f,a,g,y.value,c))&&(e&&null!==y.alternate&&f.delete(null===y.key?g:y.key),i=o(y,i,g),null===u?d=y:u.sibling=y,u=y);return e&&f.forEach(function(e){return t(a,e)}),ss&&Za(a,g),d}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===N&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,d=s;null!==d;){if(d.key===c){if((c=o.type)===N){if(7===d.tag){n(r,d.sibling),(s=a(d,o.props.children)).return=r,r=s;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&bs(c)===d.type){n(r,d.sibling),(s=a(d,o.props)).ref=vs(r,d,o),s.return=r,r=s;break e}n(r,d);break}t(r,d),d=d.sibling}o.type===N?((s=Mc(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Rc(o.type,o.key,o.props,null,r.mode,l)).ref=vs(r,s,o),l.return=r,r=l)}return i(r);case S:e:{for(d=o.key;null!==s;){if(s.key===d){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=a(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Bc(o,r.mode,l)).return=r,r=s}return i(r);case I:return e(r,s,(d=o._init)(o._payload),l)}if(te(o))return f(r,s,o,l);if(R(o))return g(r,s,o,l);ys(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=a(s,o)).return=r,r=s):(n(r,s),(s=Fc(o,r.mode,l)).return=r,r=s),i(r)):n(r,s)}}var ws=xs(!0),Ss=xs(!1),Ns=ka(null),js=null,ks=null,Cs=null;function Es(){Cs=ks=js=null}function _s(e){var t=Ns.current;Ca(Ns),e._currentValue=t}function Ds(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function As(e,t){js=e,Cs=ks=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xi=!0),e.firstContext=null)}function Ts(e){var t=e._currentValue;if(Cs!==e)if(e={context:e,memoizedValue:t,next:null},null===ks){if(null===js)throw Error(s(308));ks=e,js.dependencies={lanes:0,firstContext:e}}else ks=ks.next=e;return t}var Is=null;function Os(e){null===Is?Is=[e]:Is.push(e)}function Ps(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Os(t)):(n.next=a.next,a.next=n),t.interleaved=n,Rs(e,r)}function Rs(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ms=!1;function Ls(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Dl)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Rs(e,n)}return null===(a=r.interleaved)?(t.next=t,Os(r)):(t.next=a.next,a.next=t),r.interleaved=t,Rs(e,n)}function zs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}function Hs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?a=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?a=s=t:s=s.next=t}else a=s=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function qs(e,t,n,r){var a=e.updateQueue;Ms=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,i=a.shared.pending;if(null!==i){a.shared.pending=null;var l=i,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var d=e.alternate;null!==d&&((i=(d=d.updateQueue).lastBaseUpdate)!==o&&(null===i?d.firstBaseUpdate=c:i.next=c,d.lastBaseUpdate=l))}if(null!==s){var u=a.baseState;for(o=0,d=c=l=null,i=s;;){var h=i.lane,p=i.eventTime;if((r&h)===h){null!==d&&(d=d.next={eventTime:p,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var m=e,f=i;switch(h=t,p=n,f.tag){case 1:if("function"===typeof(m=f.payload)){u=m.call(p,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=f.payload)?m.call(p,u,h):m)||void 0===h)break e;u=L({},u,h);break e;case 2:Ms=!0}}null!==i.callback&&0!==i.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[i]:h.push(i))}else p={eventTime:p,lane:h,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===d?(c=d=p,l=u):d=d.next=p,o|=h;if(null===(i=i.next)){if(null===(i=a.shared.pending))break;i=(h=i).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===s&&(a.shared.lanes=0);Ll|=o,e.lanes=o,e.memoizedState=u}}function Ys(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(s(191,a));a.call(r)}}}var Ws={},Vs=ka(Ws),Ks=ka(Ws),Gs=ka(Ws);function Qs(e){if(e===Ws)throw Error(s(174));return e}function Js(e,t){switch(Ea(Gs,t),Ea(Ks,e),Ea(Vs,Ws),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ca(Vs),Ea(Vs,t)}function $s(){Ca(Vs),Ca(Ks),Ca(Gs)}function Xs(e){Qs(Gs.current);var t=Qs(Vs.current),n=le(t,e.type);t!==n&&(Ea(Ks,e),Ea(Vs,n))}function Zs(e){Ks.current===e&&(Ca(Vs),Ca(Ks))}var eo=ka(0);function to(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var no=[];function ro(){for(var e=0;e<no.length;e++)no[e]._workInProgressVersionPrimary=null;no.length=0}var ao=x.ReactCurrentDispatcher,so=x.ReactCurrentBatchConfig,oo=0,io=null,lo=null,co=null,uo=!1,ho=!1,po=0,mo=0;function fo(){throw Error(s(321))}function go(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!lr(e[n],t[n]))return!1;return!0}function vo(e,t,n,r,a,o){if(oo=o,io=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ao.current=null===e||null===e.memoizedState?ei:ti,e=n(r,a),ho){o=0;do{if(ho=!1,po=0,25<=o)throw Error(s(301));o+=1,co=lo=null,t.updateQueue=null,ao.current=ni,e=n(r,a)}while(ho)}if(ao.current=Zo,t=null!==lo&&null!==lo.next,oo=0,co=lo=io=null,uo=!1,t)throw Error(s(300));return e}function yo(){var e=0!==po;return po=0,e}function bo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===co?io.memoizedState=co=e:co=co.next=e,co}function xo(){if(null===lo){var e=io.alternate;e=null!==e?e.memoizedState:null}else e=lo.next;var t=null===co?io.memoizedState:co.next;if(null!==t)co=t,lo=e;else{if(null===e)throw Error(s(310));e={memoizedState:(lo=e).memoizedState,baseState:lo.baseState,baseQueue:lo.baseQueue,queue:lo.queue,next:null},null===co?io.memoizedState=co=e:co=co.next=e}return co}function wo(e,t){return"function"===typeof t?t(e):t}function So(e){var t=xo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=lo,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var i=a.next;a.next=o.next,o.next=i}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var l=i=null,c=null,d=o;do{var u=d.lane;if((oo&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,i=r):c=c.next=h,io.lanes|=u,Ll|=u}d=d.next}while(null!==d&&d!==o);null===c?i=r:c.next=l,lr(r,t.memoizedState)||(xi=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,io.lanes|=o,Ll|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function No(e){var t=xo(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var i=a=a.next;do{o=e(o,i.action),i=i.next}while(i!==a);lr(o,t.memoizedState)||(xi=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function jo(){}function ko(e,t){var n=io,r=xo(),a=t(),o=!lr(r.memoizedState,a);if(o&&(r.memoizedState=a,xi=!0),r=r.queue,Lo(_o.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==co&&1&co.memoizedState.tag){if(n.flags|=2048,Io(9,Eo.bind(null,n,r,a,t),void 0,null),null===Al)throw Error(s(349));0!==(30&oo)||Co(n,t,a)}return a}function Co(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=io.updateQueue)?(t={lastEffect:null,stores:null},io.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Eo(e,t,n,r){t.value=n,t.getSnapshot=r,Do(t)&&Ao(e)}function _o(e,t,n){return n(function(){Do(t)&&Ao(e)})}function Do(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!lr(e,n)}catch(r){return!0}}function Ao(e){var t=Rs(e,1);null!==t&&rc(t,e,1,-1)}function To(e){var t=bo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wo,lastRenderedState:e},t.queue=e,e=e.dispatch=Qo.bind(null,io,e),[t.memoizedState,e]}function Io(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=io.updateQueue)?(t={lastEffect:null,stores:null},io.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Oo(){return xo().memoizedState}function Po(e,t,n,r){var a=bo();io.flags|=e,a.memoizedState=Io(1|t,n,void 0,void 0===r?null:r)}function Ro(e,t,n,r){var a=xo();r=void 0===r?null:r;var s=void 0;if(null!==lo){var o=lo.memoizedState;if(s=o.destroy,null!==r&&go(r,o.deps))return void(a.memoizedState=Io(t,n,s,r))}io.flags|=e,a.memoizedState=Io(1|t,n,s,r)}function Mo(e,t){return Po(8390656,8,e,t)}function Lo(e,t){return Ro(2048,8,e,t)}function Fo(e,t){return Ro(4,2,e,t)}function Bo(e,t){return Ro(4,4,e,t)}function Uo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ro(4,4,Uo.bind(null,t,e),n)}function Ho(){}function qo(e,t){var n=xo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&go(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Yo(e,t){var n=xo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&go(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Wo(e,t,n){return 0===(21&oo)?(e.baseState&&(e.baseState=!1,xi=!0),e.memoizedState=n):(lr(n,t)||(n=gt(),io.lanes|=n,Ll|=n,e.baseState=!0),t)}function Vo(e,t){var n=xt;xt=0!==n&&4>n?n:4,e(!0);var r=so.transition;so.transition={};try{e(!1),t()}finally{xt=n,so.transition=r}}function Ko(){return xo().memoizedState}function Go(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Jo(e))$o(t,n);else if(null!==(n=Ps(e,t,n,r))){rc(n,e,r,tc()),Xo(n,t,r)}}function Qo(e,t,n){var r=nc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Jo(e))$o(t,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,i=s(o,n);if(a.hasEagerState=!0,a.eagerState=i,lr(i,o)){var l=t.interleaved;return null===l?(a.next=a,Os(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Ps(e,t,a,r))&&(rc(n,e,r,a=tc()),Xo(n,t,r))}}function Jo(e){var t=e.alternate;return e===io||null!==t&&t===io}function $o(e,t){ho=uo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Xo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}var Zo={readContext:Ts,useCallback:fo,useContext:fo,useEffect:fo,useImperativeHandle:fo,useInsertionEffect:fo,useLayoutEffect:fo,useMemo:fo,useReducer:fo,useRef:fo,useState:fo,useDebugValue:fo,useDeferredValue:fo,useTransition:fo,useMutableSource:fo,useSyncExternalStore:fo,useId:fo,unstable_isNewReconciler:!1},ei={readContext:Ts,useCallback:function(e,t){return bo().memoizedState=[e,void 0===t?null:t],e},useContext:Ts,useEffect:Mo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Po(4194308,4,Uo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Po(4194308,4,e,t)},useInsertionEffect:function(e,t){return Po(4,2,e,t)},useMemo:function(e,t){var n=bo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=bo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Go.bind(null,io,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},bo().memoizedState=e},useState:To,useDebugValue:Ho,useDeferredValue:function(e){return bo().memoizedState=e},useTransition:function(){var e=To(!1),t=e[0];return e=Vo.bind(null,e[1]),bo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=io,a=bo();if(ss){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Al)throw Error(s(349));0!==(30&oo)||Co(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,Mo(_o.bind(null,r,o,e),[e]),r.flags|=2048,Io(9,Eo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=bo(),t=Al.identifierPrefix;if(ss){var n=Xa;t=":"+t+"R"+(n=($a&~(1<<32-it($a)-1)).toString(32)+n),0<(n=po++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=mo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ti={readContext:Ts,useCallback:qo,useContext:Ts,useEffect:Lo,useImperativeHandle:zo,useInsertionEffect:Fo,useLayoutEffect:Bo,useMemo:Yo,useReducer:So,useRef:Oo,useState:function(){return So(wo)},useDebugValue:Ho,useDeferredValue:function(e){return Wo(xo(),lo.memoizedState,e)},useTransition:function(){return[So(wo)[0],xo().memoizedState]},useMutableSource:jo,useSyncExternalStore:ko,useId:Ko,unstable_isNewReconciler:!1},ni={readContext:Ts,useCallback:qo,useContext:Ts,useEffect:Lo,useImperativeHandle:zo,useInsertionEffect:Fo,useLayoutEffect:Bo,useMemo:Yo,useReducer:No,useRef:Oo,useState:function(){return No(wo)},useDebugValue:Ho,useDeferredValue:function(e){var t=xo();return null===lo?t.memoizedState=e:Wo(t,lo.memoizedState,e)},useTransition:function(){return[No(wo)[0],xo().memoizedState]},useMutableSource:jo,useSyncExternalStore:ko,useId:Ko,unstable_isNewReconciler:!1};function ri(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ai(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var si={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),s=Bs(r,a);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,a))&&(rc(t,e,a,r),zs(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),a=nc(e),s=Bs(r,a);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,a))&&(rc(t,e,a,r),zs(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),a=Bs(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Us(e,a,r))&&(rc(t,e,r,n),zs(t,e,r))}};function oi(e,t,n,r,a,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(a,s))}function ii(e,t,n){var r=!1,a=_a,s=t.contextType;return"object"===typeof s&&null!==s?s=Ts(s):(a=Oa(t)?Ta:Da.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ia(e,a):_a),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=si,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function li(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&si.enqueueReplaceState(t,t.state,null)}function ci(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Ls(e);var s=t.contextType;"object"===typeof s&&null!==s?a.context=Ts(s):(s=Oa(t)?Ta:Da.current,a.context=Ia(e,s)),a.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ai(e,t,s,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&si.enqueueReplaceState(a,a.state,null),qs(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function di(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var a=n}catch(s){a="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:a,digest:null}}function ui(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hi(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var pi="function"===typeof WeakMap?WeakMap:Map;function mi(e,t,n){(n=Bs(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,Vl=r),hi(0,t)},n}function fi(e,t,n){(n=Bs(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){hi(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){hi(0,t),"function"!==typeof r&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function gi(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new pi;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Cc.bind(null,e,t,n),t.then(e,e))}function vi(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yi(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Bs(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bi=x.ReactCurrentOwner,xi=!1;function wi(e,t,n,r){t.child=null===e?Ss(t,null,n,r):ws(t,e.child,n,r)}function Si(e,t,n,r,a){n=n.render;var s=t.ref;return As(t,a),r=vo(e,t,n,r,s,a),n=yo(),null===e||xi?(ss&&n&&ts(t),t.flags|=1,wi(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Wi(e,t,a))}function Ni(e,t,n,r,a){if(null===e){var s=n.type;return"function"!==typeof s||Oc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,ji(e,t,s,r,a))}if(s=e.child,0===(e.lanes&a)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(o,r)&&e.ref===t.ref)return Wi(e,t,a)}return t.flags|=1,(e=Pc(s,r)).ref=t.ref,e.return=t,t.child=e}function ji(e,t,n,r,a){if(null!==e){var s=e.memoizedProps;if(cr(s,r)&&e.ref===t.ref){if(xi=!1,t.pendingProps=r=s,0===(e.lanes&a))return t.lanes=e.lanes,Wi(e,t,a);0!==(131072&e.flags)&&(xi=!0)}}return Ei(e,t,n,r,a)}function ki(e,t,n){var r=t.pendingProps,a=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ea(Pl,Ol),Ol|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ea(Pl,Ol),Ol|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Ea(Pl,Ol),Ol|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ea(Pl,Ol),Ol|=r;return wi(e,t,a,n),t.child}function Ci(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ei(e,t,n,r,a){var s=Oa(n)?Ta:Da.current;return s=Ia(t,s),As(t,a),n=vo(e,t,n,r,s,a),r=yo(),null===e||xi?(ss&&r&&ts(t),t.flags|=1,wi(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Wi(e,t,a))}function _i(e,t,n,r,a){if(Oa(n)){var s=!0;La(t)}else s=!1;if(As(t,a),null===t.stateNode)Yi(e,t),ii(t,n,r),ci(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,i=t.memoizedProps;o.props=i;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ts(c):c=Ia(t,c=Oa(n)?Ta:Da.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate;u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(i!==r||l!==c)&&li(t,o,r,c),Ms=!1;var h=t.memoizedState;o.state=h,qs(t,r,o,a),l=t.memoizedState,i!==r||h!==l||Aa.current||Ms?("function"===typeof d&&(ai(t,n,d,r),l=t.memoizedState),(i=Ms||oi(t,n,i,r,h,l,c))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=i):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Fs(e,t),i=t.memoizedProps,c=t.type===t.elementType?i:ri(t.type,i),o.props=c,u=t.pendingProps,h=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ts(l):l=Ia(t,l=Oa(n)?Ta:Da.current);var p=n.getDerivedStateFromProps;(d="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(i!==u||h!==l)&&li(t,o,r,l),Ms=!1,h=t.memoizedState,o.state=h,qs(t,r,o,a);var m=t.memoizedState;i!==u||h!==m||Aa.current||Ms?("function"===typeof p&&(ai(t,n,p,r),m=t.memoizedState),(c=Ms||oi(t,n,c,r,h,m,l)||!1)?(d||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,m,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,m,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=m),o.props=r,o.state=m,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Di(e,t,n,r,s,a)}function Di(e,t,n,r,a,s){Ci(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&Fa(t,n,!1),Wi(e,t,s);r=t.stateNode,bi.current=t;var i=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,i,s)):wi(e,t,i,s),t.memoizedState=r.state,a&&Fa(t,n,!0),t.child}function Ai(e){var t=e.stateNode;t.pendingContext?Ra(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ra(0,t.context,!1),Js(e,t.containerInfo)}function Ti(e,t,n,r,a){return ms(),fs(a),t.flags|=256,wi(e,t,n,r),t.child}var Ii,Oi,Pi,Ri,Mi={dehydrated:null,treeContext:null,retryLane:0};function Li(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fi(e,t,n){var r,a=t.pendingProps,o=eo.current,i=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(i=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ea(eo,1&o),null===e)return ds(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,i?(a=t.mode,i=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==i?(i.childLanes=0,i.pendingProps=l):i=Lc(l,a,0,null),e=Mc(e,a,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Li(n),t.memoizedState=Mi,e):Bi(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,i){if(n)return 256&t.flags?(t.flags&=-257,Ui(e,t,i,r=ui(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Lc({mode:"visible",children:r.children},a,0,null),(o=Mc(o,a,i,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&ws(t,e.child,null,i),t.child.memoizedState=Li(i),t.memoizedState=Mi,o);if(0===(1&t.mode))return Ui(e,t,i,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var l=r.dgst;return r=l,Ui(e,t,i,r=ui(o=Error(s(419)),r,void 0))}if(l=0!==(i&e.childLanes),xi||l){if(null!==(r=Al)){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|i))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Rs(e,a),rc(r,e,a,-1))}return gc(),Ui(e,t,i,r=ui(Error(s(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,as=da(a.nextSibling),rs=t,ss=!0,os=null,null!==e&&(Ga[Qa++]=$a,Ga[Qa++]=Xa,Ga[Qa++]=Ja,$a=e.id,Xa=e.overflow,Ja=t),t=Bi(t,r.children),t.flags|=4096,t)}(e,t,l,a,r,o,n);if(i){i=a.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Pc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?i=Pc(r,i):(i=Mc(i,l,n,null)).flags|=2,i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,l=null===(l=e.child.memoizedState)?Li(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~n,t.memoizedState=Mi,a}return e=(i=e.child).sibling,a=Pc(i,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Bi(e,t){return(t=Lc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ui(e,t,n,r){return null!==r&&fs(r),ws(t,e.child,null,n),(e=Bi(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zi(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ds(e.return,t,n)}function Hi(e,t,n,r,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=a)}function qi(e,t,n){var r=t.pendingProps,a=r.revealOrder,s=r.tail;if(wi(e,t,r.children,n),0!==(2&(r=eo.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zi(e,n,t);else if(19===e.tag)zi(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ea(eo,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===to(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Hi(t,!1,a,n,s);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===to(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Hi(t,!0,n,null,s);break;case"together":Hi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Yi(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wi(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ll|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Vi(e,t){if(!ss)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ki(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Gi(e,t,n){var r=t.pendingProps;switch(ns(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ki(t),null;case 1:case 17:return Oa(t.type)&&Pa(),Ki(t),null;case 3:return r=t.stateNode,$s(),Ca(Aa),Ca(Da),ro(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==os&&(ic(os),os=null))),Oi(e,t),Ki(t),null;case 5:Zs(t);var a=Qs(Gs.current);if(n=t.type,null!==e&&null!=t.stateNode)Pi(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ki(t),null}if(e=Qs(Vs.current),hs(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[pa]=t,r[ma]=o,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(a=0;a<Mr.length;a++)Ur(Mr[a],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":J(r,o),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ur("invalid",r);break;case"textarea":ae(r,o),Ur("invalid",r)}for(var l in be(n,o),a=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Zr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Zr(r.textContent,c,e),a=["children",""+c]):i.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":V(r),Z(r,o,!0);break;case"textarea":V(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=ea)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ie(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[pa]=t,e[ma]=r,Ii(e,t,!1,!1),t.stateNode=e;e:{switch(l=xe(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),a=r;break;case"iframe":case"object":case"embed":Ur("load",e),a=r;break;case"video":case"audio":for(a=0;a<Mr.length;a++)Ur(Mr[a],e);a=r;break;case"source":Ur("error",e),a=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),a=r;break;case"details":Ur("toggle",e),a=r;break;case"input":J(e,r),a=Q(e,r),Ur("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=L({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Ur("invalid",e)}for(o in be(n,a),c=a)if(c.hasOwnProperty(o)){var d=c[o];"style"===o?ve(e,d):"dangerouslySetInnerHTML"===o?null!=(d=d?d.__html:void 0)&&he(e,d):"children"===o?"string"===typeof d?("textarea"!==n||""!==d)&&pe(e,d):"number"===typeof d&&pe(e,""+d):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(i.hasOwnProperty(o)?null!=d&&"onScroll"===o&&Ur("scroll",e):null!=d&&b(e,o,d,l))}switch(n){case"input":V(e),Z(e,r,!1);break;case"textarea":V(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+Y(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=ea)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ki(t),null;case 6:if(e&&null!=t.stateNode)Ri(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Qs(Gs.current),Qs(Vs.current),hs(t)){if(r=t.stateNode,n=t.memoizedProps,r[pa]=t,(o=r.nodeValue!==n)&&null!==(e=rs))switch(e.tag){case 3:Zr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[pa]=t,t.stateNode=r}return Ki(t),null;case 13:if(Ca(eo),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ss&&null!==as&&0!==(1&t.mode)&&0===(128&t.flags))ps(),ms(),t.flags|=98560,o=!1;else if(o=hs(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[pa]=t}else ms(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ki(t),o=!1}else null!==os&&(ic(os),os=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&eo.current)?0===Rl&&(Rl=3):gc())),null!==t.updateQueue&&(t.flags|=4),Ki(t),null);case 4:return $s(),Oi(e,t),null===e&&qr(t.stateNode.containerInfo),Ki(t),null;case 10:return _s(t.type._context),Ki(t),null;case 19:if(Ca(eo),null===(o=t.memoizedState))return Ki(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Vi(o,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=to(e))){for(t.flags|=128,Vi(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ea(eo,1&eo.current|2),t.child}e=e.sibling}null!==o.tail&&Xe()>ql&&(t.flags|=128,r=!0,Vi(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=to(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Vi(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ss)return Ki(t),null}else 2*Xe()-o.renderingStartTime>ql&&1073741824!==n&&(t.flags|=128,r=!0,Vi(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Xe(),t.sibling=null,n=eo.current,Ea(eo,r?1&n|2:1&n),t):(Ki(t),null);case 22:case 23:return hc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ol)&&(Ki(t),6&t.subtreeFlags&&(t.flags|=8192)):Ki(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Qi(e,t){switch(ns(t),t.tag){case 1:return Oa(t.type)&&Pa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return $s(),Ca(Aa),Ca(Da),ro(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zs(t),null;case 13:if(Ca(eo),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ms()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ca(eo),null;case 4:return $s(),null;case 10:return _s(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ii=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Oi=function(){},Pi=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,Qs(Vs.current);var s,o=null;switch(n){case"input":a=Q(e,a),r=Q(e,r),o=[];break;case"select":a=L({},a,{value:void 0}),r=L({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=ea)}for(d in be(n,r),n=null,a)if(!r.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var l=a[d];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(i.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var c=r[d];if(l=null!=a?a[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(i.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Ur("scroll",e),o||l===c||(o=[])):(o=o||[]).push(d,c))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}},Ri=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ji=!1,$i=!1,Xi="function"===typeof WeakSet?WeakSet:Set,Zi=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){kc(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){kc(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,void 0!==s&&tl(t,n,s)}a=a.next}while(a!==r)}}function al(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pa],delete t[ma],delete t[ga],delete t[va],delete t[ya])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=ea));else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function dl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(dl(e,t,n),e=e.sibling;null!==e;)dl(e,t,n),e=e.sibling}var ul=null,hl=!1;function pl(e,t,n){for(n=n.child;null!==n;)ml(e,t,n),n=n.sibling}function ml(e,t,n){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(st,n)}catch(i){}switch(n.tag){case 5:$i||el(n,t);case 6:var r=ul,a=hl;ul=null,pl(e,t,n),hl=a,null!==(ul=r)&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(hl?(e=ul,n=n.stateNode,8===e.nodeType?ca(e.parentNode,n):1===e.nodeType&&ca(e,n),qt(e)):ca(ul,n.stateNode));break;case 4:r=ul,a=hl,ul=n.stateNode.containerInfo,hl=!0,pl(e,t,n),ul=r,hl=a;break;case 0:case 11:case 14:case 15:if(!$i&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var s=a,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&tl(n,t,o),a=a.next}while(a!==r)}pl(e,t,n);break;case 1:if(!$i&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(i){kc(n,t,i)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?($i=(r=$i)||null!==n.memoizedState,pl(e,t,n),$i=r):pl(e,t,n);break;default:pl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xi),t.forEach(function(t){var r=Dc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,i=t,l=i;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));ml(o,i,a),ul=null,hl=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(d){kc(a,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),yl(e),4&r){try{rl(3,e,e.return),al(3,e)}catch(g){kc(e,e.return,g)}try{rl(5,e,e.return)}catch(g){kc(e,e.return,g)}}break;case 1:gl(t,e),yl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(gl(t,e),yl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var a=e.stateNode;try{pe(a,"")}catch(g){kc(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,i=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&$(a,o),xe(l,i);var d=xe(l,o);for(i=0;i<c.length;i+=2){var u=c[i],h=c[i+1];"style"===u?ve(a,h):"dangerouslySetInnerHTML"===u?he(a,h):"children"===u?pe(a,h):b(a,u,h,d)}switch(l){case"input":X(a,o);break;case"textarea":se(a,o);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var m=o.value;null!=m?ne(a,!!o.multiple,m,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[ma]=o}catch(g){kc(e,e.return,g)}}break;case 6:if(gl(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(s(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(g){kc(e,e.return,g)}}break;case 3:if(gl(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(g){kc(e,e.return,g)}break;case 4:default:gl(t,e),yl(e);break;case 13:gl(t,e),yl(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Hl=Xe())),4&r&&fl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?($i=(d=$i)||u,gl(t,e),$i=d):gl(t,e),yl(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Zi=e,u=e.child;null!==u;){for(h=Zi=u;null!==Zi;){switch(m=(p=Zi).child,p.tag){case 0:case 11:case 14:case 15:rl(4,p,p.return);break;case 1:el(p,p.return);var f=p.stateNode;if("function"===typeof f.componentWillUnmount){r=p,n=p.return;try{t=r,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){kc(r,n,g)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){Sl(h);continue}}null!==m?(m.return=p,Zi=m):Sl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{a=h.stateNode,d?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=h.stateNode,i=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",i))}catch(g){kc(e,e.return,g)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(g){kc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gl(t,e),yl(e),4&r&&fl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(il(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(pe(a,""),r.flags&=-33),dl(e,ll(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;cl(e,ll(e),o);break;default:throw Error(s(161))}}catch(i){kc(e,e.return,i)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){Zi=e,xl(e,t,n)}function xl(e,t,n){for(var r=0!==(1&e.mode);null!==Zi;){var a=Zi,s=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Ji;if(!o){var i=a.alternate,l=null!==i&&null!==i.memoizedState||$i;i=Ji;var c=$i;if(Ji=o,($i=l)&&!c)for(Zi=a;null!==Zi;)l=(o=Zi).child,22===o.tag&&null!==o.memoizedState?Nl(a):null!==l?(l.return=o,Zi=l):Nl(a);for(;null!==s;)Zi=s,xl(s,t,n),s=s.sibling;Zi=a,Ji=i,$i=c}wl(e)}else 0!==(8772&a.subtreeFlags)&&null!==s?(s.return=a,Zi=s):wl(e)}}function wl(e){for(;null!==Zi;){var t=Zi;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$i||al(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!$i)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:ri(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Ys(t,o,r);break;case 3:var i=t.updateQueue;if(null!==i){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ys(t,i,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&qt(h)}}}break;default:throw Error(s(163))}$i||512&t.flags&&sl(t)}catch(ue){kc(t,t.return,ue)}}if(t===e){Zi=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zi=n;break}Zi=t.return}}function Sl(e){for(;null!==Zi;){var t=Zi;if(t===e){Zi=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zi=n;break}Zi=t.return}}function Nl(e){for(;null!==Zi;){var t=Zi;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{al(4,t)}catch(l){kc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(l){kc(t,a,l)}}var s=t.return;try{sl(t)}catch(l){kc(t,s,l)}break;case 5:var o=t.return;try{sl(t)}catch(l){kc(t,o,l)}}}catch(l){kc(t,t.return,l)}if(t===e){Zi=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Zi=i;break}Zi=t.return}}var jl,kl=Math.ceil,Cl=x.ReactCurrentDispatcher,El=x.ReactCurrentOwner,_l=x.ReactCurrentBatchConfig,Dl=0,Al=null,Tl=null,Il=0,Ol=0,Pl=ka(0),Rl=0,Ml=null,Ll=0,Fl=0,Bl=0,Ul=null,zl=null,Hl=0,ql=1/0,Yl=null,Wl=!1,Vl=null,Kl=null,Gl=!1,Ql=null,Jl=0,$l=0,Xl=null,Zl=-1,ec=0;function tc(){return 0!==(6&Dl)?Xe():-1!==Zl?Zl:Zl=Xe()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Dl)&&0!==Il?Il&-Il:null!==gs.transition?(0===ec&&(ec=gt()),ec):0!==(e=xt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function rc(e,t,n,r){if(50<$l)throw $l=0,Xl=null,Error(s(185));yt(e,n,r),0!==(2&Dl)&&e===Al||(e===Al&&(0===(2&Dl)&&(Fl|=n),4===Rl&&lc(e,Il)),ac(e,r),1===n&&0===Dl&&0===(1&t.mode)&&(ql=Xe()+500,Ua&&qa()))}function ac(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-it(s),i=1<<o,l=a[o];-1===l?0!==(i&n)&&0===(i&r)||(a[o]=mt(i,t)):l<=t&&(e.expiredLanes|=i),s&=~i}}(e,t);var r=pt(e,e===Al?Il:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Ua=!0,Ha(e)}(cc.bind(null,e)):Ha(cc.bind(null,e)),ia(function(){0===(6&Dl)&&qa()}),n=null;else{switch(wt(r)){case 1:n=et;break;case 4:n=tt;break;case 16:default:n=nt;break;case 536870912:n=at}n=Ac(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Zl=-1,ec=0,0!==(6&Dl))throw Error(s(327));var n=e.callbackNode;if(Nc()&&e.callbackNode!==n)return null;var r=pt(e,e===Al?Il:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var a=Dl;Dl|=2;var o=fc();for(Al===e&&Il===t||(Yl=null,ql=Xe()+500,pc(e,t));;)try{bc();break}catch(l){mc(e,l)}Es(),Cl.current=o,Dl=a,null!==Tl?t=0:(Al=null,Il=0,t=Rl)}if(0!==t){if(2===t&&(0!==(a=ft(e))&&(r=a,t=oc(e,a))),1===t)throw n=Ml,pc(e,0),lc(e,r),ac(e,Xe()),n;if(6===t)lc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],s=a.getSnapshot;a=a.value;try{if(!lr(s(),a))return!1}catch(i){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=vc(e,r))&&(0!==(o=ft(e))&&(r=o,t=oc(e,o))),1===t))throw n=Ml,pc(e,0),lc(e,r),ac(e,Xe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:Sc(e,zl,Yl);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=Hl+500-Xe())){if(0!==pt(e,0))break;if(((a=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=aa(Sc.bind(null,e,zl,Yl),t);break}Sc(e,zl,Yl);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var i=31-it(r);o=1<<i,(i=t[i])>a&&(a=i),r&=~o}if(r=a,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kl(r/1960))-r)){e.timeoutHandle=aa(Sc.bind(null,e,zl,Yl),r);break}Sc(e,zl,Yl);break;default:throw Error(s(329))}}}return ac(e,Xe()),e.callbackNode===n?sc.bind(null,e):null}function oc(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=zl,zl=n,null!==t&&ic(t)),e}function ic(e){null===zl?zl=e:zl.push.apply(zl,e)}function lc(e,t){for(t&=~Bl,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Dl))throw Error(s(327));Nc();var t=pt(e,0);if(0===(1&t))return ac(e,Xe()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Ml,pc(e,0),lc(e,t),ac(e,Xe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sc(e,zl,Yl),ac(e,Xe()),null}function dc(e,t){var n=Dl;Dl|=1;try{return e(t)}finally{0===(Dl=n)&&(ql=Xe()+500,Ua&&qa())}}function uc(e){null!==Ql&&0===Ql.tag&&0===(6&Dl)&&Nc();var t=Dl;Dl|=1;var n=_l.transition,r=xt;try{if(_l.transition=null,xt=1,e)return e()}finally{xt=r,_l.transition=n,0===(6&(Dl=t))&&qa()}}function hc(){Ol=Pl.current,Ca(Pl)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,sa(n)),null!==Tl)for(n=Tl.return;null!==n;){var r=n;switch(ns(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Pa();break;case 3:$s(),Ca(Aa),Ca(Da),ro();break;case 5:Zs(r);break;case 4:$s();break;case 13:case 19:Ca(eo);break;case 10:_s(r.type._context);break;case 22:case 23:hc()}n=n.return}if(Al=e,Tl=e=Pc(e.current,null),Il=Ol=t,Rl=0,Ml=null,Bl=Fl=Ll=0,zl=Ul=null,null!==Is){for(t=0;t<Is.length;t++)if(null!==(r=(n=Is[t]).interleaved)){n.interleaved=null;var a=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=a,r.next=o}n.pending=r}Is=null}return e}function mc(e,t){for(;;){var n=Tl;try{if(Es(),ao.current=Zo,uo){for(var r=io.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}uo=!1}if(oo=0,co=lo=io=null,ho=!1,po=0,El.current=null,null===n||null===n.return){Rl=1,Ml=t,Tl=null;break}e:{var o=e,i=n.return,l=n,c=t;if(t=Il,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=vi(i);if(null!==m){m.flags&=-257,yi(m,i,l,0,t),1&m.mode&&gi(o,d,t),c=d;var f=(t=m).updateQueue;if(null===f){var g=new Set;g.add(c),t.updateQueue=g}else f.add(c);break e}if(0===(1&t)){gi(o,d,t),gc();break e}c=Error(s(426))}else if(ss&&1&l.mode){var v=vi(i);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),yi(v,i,l,0,t),fs(di(c,l));break e}}o=c=di(c,l),4!==Rl&&(Rl=2),null===Ul?Ul=[o]:Ul.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Hs(o,mi(0,c,t));break e;case 1:l=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Kl||!Kl.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Hs(o,fi(o,l,t));break e}}o=o.return}while(null!==o)}wc(n)}catch(x){t=x,Tl===n&&null!==n&&(Tl=n=n.return);continue}break}}function fc(){var e=Cl.current;return Cl.current=Zo,null===e?Zo:e}function gc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Al||0===(268435455&Ll)&&0===(268435455&Fl)||lc(Al,Il)}function vc(e,t){var n=Dl;Dl|=2;var r=fc();for(Al===e&&Il===t||(Yl=null,pc(e,t));;)try{yc();break}catch(a){mc(e,a)}if(Es(),Dl=n,Cl.current=r,null!==Tl)throw Error(s(261));return Al=null,Il=0,Rl}function yc(){for(;null!==Tl;)xc(Tl)}function bc(){for(;null!==Tl&&!Je();)xc(Tl)}function xc(e){var t=jl(e.alternate,e,Ol);e.memoizedProps=e.pendingProps,null===t?wc(e):Tl=t,El.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Gi(n,t,Ol)))return void(Tl=n)}else{if(null!==(n=Qi(n,t)))return n.flags&=32767,void(Tl=n);if(null===e)return Rl=6,void(Tl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Tl=t);Tl=t=e}while(null!==t);0===Rl&&(Rl=5)}function Sc(e,t,n){var r=xt,a=_l.transition;try{_l.transition=null,xt=1,function(e,t,n,r){do{Nc()}while(null!==Ql);if(0!==(6&Dl))throw Error(s(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-it(n),s=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~s}}(e,o),e===Al&&(Tl=Al=null,Il=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Gl||(Gl=!0,Ac(nt,function(){return Nc(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=_l.transition,_l.transition=null;var i=xt;xt=1;var l=Dl;Dl|=4,El.current=null,function(e,t){if(ta=Wt,mr(e=pr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var i=0,l=-1,c=-1,d=0,u=0,h=e,p=null;t:for(;;){for(var m;h!==n||0!==a&&3!==h.nodeType||(l=i+a),h!==o||0!==r&&3!==h.nodeType||(c=i+r),3===h.nodeType&&(i+=h.nodeValue.length),null!==(m=h.firstChild);)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++d===a&&(l=i),p===o&&++u===r&&(c=i),null!==(m=h.nextSibling))break;p=(h=p).parentNode}h=m}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(na={focusedElem:e,selectionRange:n},Wt=!1,Zi=t;null!==Zi;)if(e=(t=Zi).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zi=e;else for(;null!==Zi;){t=Zi;try{var f=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==f){var g=f.memoizedProps,v=f.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:ri(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(s(163))}}catch(w){kc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Zi=e;break}Zi=t.return}f=nl,nl=!1}(e,n),vl(n,e),fr(na),Wt=!!ta,na=ta=null,e.current=n,bl(n,e,a),$e(),Dl=l,xt=i,_l.transition=o}else e.current=n;if(Gl&&(Gl=!1,Ql=e,Jl=a),o=e.pendingLanes,0===o&&(Kl=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(st,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ac(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Wl)throw Wl=!1,e=Vl,Vl=null,e;0!==(1&Jl)&&0!==e.tag&&Nc(),o=e.pendingLanes,0!==(1&o)?e===Xl?$l++:($l=0,Xl=e):$l=0,qa()}(e,t,n,r)}finally{_l.transition=a,xt=r}return null}function Nc(){if(null!==Ql){var e=wt(Jl),t=_l.transition,n=xt;try{if(_l.transition=null,xt=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Jl=0,0!==(6&Dl))throw Error(s(331));var a=Dl;for(Dl|=4,Zi=e.current;null!==Zi;){var o=Zi,i=o.child;if(0!==(16&Zi.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Zi=d;null!==Zi;){var u=Zi;switch(u.tag){case 0:case 11:case 15:rl(8,u,o)}var h=u.child;if(null!==h)h.return=u,Zi=h;else for(;null!==Zi;){var p=(u=Zi).sibling,m=u.return;if(ol(u),u===d){Zi=null;break}if(null!==p){p.return=m,Zi=p;break}Zi=m}}}var f=o.alternate;if(null!==f){var g=f.child;if(null!==g){f.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Zi=o}}if(0!==(2064&o.subtreeFlags)&&null!==i)i.return=o,Zi=i;else e:for(;null!==Zi;){if(0!==(2048&(o=Zi).flags))switch(o.tag){case 0:case 11:case 15:rl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Zi=y;break e}Zi=o.return}}var b=e.current;for(Zi=b;null!==Zi;){var x=(i=Zi).child;if(0!==(2064&i.subtreeFlags)&&null!==x)x.return=i,Zi=x;else e:for(i=b;null!==Zi;){if(0!==(2048&(l=Zi).flags))try{switch(l.tag){case 0:case 11:case 15:al(9,l)}}catch(S){kc(l,l.return,S)}if(l===i){Zi=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Zi=w;break e}Zi=l.return}}if(Dl=a,qa(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(st,e)}catch(S){}r=!0}return r}finally{xt=n,_l.transition=t}}return!1}function jc(e,t,n){e=Us(e,t=mi(0,t=di(n,t),1),1),t=tc(),null!==e&&(yt(e,1,t),ac(e,t))}function kc(e,t,n){if(3===e.tag)jc(e,e,n);else for(;null!==t;){if(3===t.tag){jc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Kl||!Kl.has(r))){t=Us(t,e=fi(t,e=di(n,e),1),1),e=tc(),null!==t&&(yt(t,1,e),ac(t,e));break}}t=t.return}}function Cc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Al===e&&(Il&n)===n&&(4===Rl||3===Rl&&(130023424&Il)===Il&&500>Xe()-Hl?pc(e,0):Bl|=n),ac(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=Rs(e,t))&&(yt(e,t,n),ac(e,n))}function _c(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ec(e,n)}function Dc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Ec(e,n)}function Ac(e,t){return Ge(e,t)}function Tc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ic(e,t,n,r){return new Tc(e,t,n,r)}function Oc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Ic(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rc(e,t,n,r,a,o){var i=2;if(r=e,"function"===typeof e)Oc(e)&&(i=1);else if("string"===typeof e)i=5;else e:switch(e){case N:return Mc(n.children,a,o,t);case j:i=8,a|=8;break;case k:return(e=Ic(12,n,t,2|a)).elementType=k,e.lanes=o,e;case D:return(e=Ic(13,n,t,a)).elementType=D,e.lanes=o,e;case A:return(e=Ic(19,n,t,a)).elementType=A,e.lanes=o,e;case O:return Lc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:i=10;break e;case E:i=9;break e;case _:i=11;break e;case T:i=14;break e;case I:i=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ic(i,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Mc(e,t,n,r){return(e=Ic(7,e,r,t)).lanes=n,e}function Lc(e,t,n,r){return(e=Ic(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return(e=Ic(6,e,null,t)).lanes=n,e}function Bc(e,t,n){return(t=Ic(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,a,s,o,i,l){return e=new Uc(e,t,n,i,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ic(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ls(s),e}function Hc(e){if(!e)return _a;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Oa(n))return Ma(e,n,t)}return t}function qc(e,t,n,r,a,s,o,i,l){return(e=zc(n,r,!0,e,0,s,0,i,l)).context=Hc(null),n=e.current,(s=Bs(r=tc(),a=nc(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,a),e.current.lanes=a,yt(e,a,r),ac(e,r),e}function Yc(e,t,n,r){var a=t.current,s=tc(),o=nc(a);return n=Hc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Bs(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Us(a,t,o))&&(rc(e,a,o,s),zs(e,a,o)),o}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}jl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Aa.current)xi=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xi=!1,function(e,t,n){switch(t.tag){case 3:Ai(t),ms();break;case 5:Xs(t);break;case 1:Oa(t.type)&&La(t);break;case 4:Js(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ea(Ns,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ea(eo,1&eo.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fi(e,t,n):(Ea(eo,1&eo.current),null!==(e=Wi(e,t,n))?e.sibling:null);Ea(eo,1&eo.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return qi(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ea(eo,eo.current),r)break;return null;case 22:case 23:return t.lanes=0,ki(e,t,n)}return Wi(e,t,n)}(e,t,n);xi=0!==(131072&e.flags)}else xi=!1,ss&&0!==(1048576&t.flags)&&es(t,Ka,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Yi(e,t),e=t.pendingProps;var a=Ia(t,Da.current);As(t,n),a=vo(null,t,r,e,a,n);var o=yo();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oa(r)?(o=!0,La(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ls(t),a.updater=si,t.stateNode=a,a._reactInternals=t,ci(t,r,e,n),t=Di(null,t,r,!0,o,n)):(t.tag=0,ss&&o&&ts(t),wi(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Yi(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Oc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===_)return 11;if(e===T)return 14}return 2}(r),e=ri(r,e),a){case 0:t=Ei(null,t,r,e,n);break e;case 1:t=_i(null,t,r,e,n);break e;case 11:t=Si(null,t,r,e,n);break e;case 14:t=Ni(null,t,r,ri(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Ei(e,t,r,a=t.elementType===r?a:ri(r,a),n);case 1:return r=t.type,a=t.pendingProps,_i(e,t,r,a=t.elementType===r?a:ri(r,a),n);case 3:e:{if(Ai(t),null===e)throw Error(s(387));r=t.pendingProps,a=(o=t.memoizedState).element,Fs(e,t),qs(t,r,null,n);var i=t.memoizedState;if(r=i.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ti(e,t,r,n,a=di(Error(s(423)),t));break e}if(r!==a){t=Ti(e,t,r,n,a=di(Error(s(424)),t));break e}for(as=da(t.stateNode.containerInfo.firstChild),rs=t,ss=!0,os=null,n=Ss(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ms(),r===a){t=Wi(e,t,n);break e}wi(e,t,r,n)}t=t.child}return t;case 5:return Xs(t),null===e&&ds(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,i=a.children,ra(r,a)?i=null:null!==o&&ra(r,o)&&(t.flags|=32),Ci(e,t),wi(e,t,i,n),t.child;case 6:return null===e&&ds(t),null;case 13:return Fi(e,t,n);case 4:return Js(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ws(t,null,r,n):wi(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,Si(e,t,r,a=t.elementType===r?a:ri(r,a),n);case 7:return wi(e,t,t.pendingProps,n),t.child;case 8:case 12:return wi(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,i=a.value,Ea(Ns,r._currentValue),r._currentValue=i,null!==o)if(lr(o.value,i)){if(o.children===a.children&&!Aa.current){t=Wi(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){i=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Bs(-1,n&-n)).tag=2;var d=o.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ds(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)i=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(i=o.return))throw Error(s(341));i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Ds(i,n,t),i=o.sibling}else i=o.child;if(null!==i)i.return=o;else for(i=o;null!==i;){if(i===t){i=null;break}if(null!==(o=i.sibling)){o.return=i.return,i=o;break}i=i.return}o=i}wi(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,As(t,n),r=r(a=Ts(a)),t.flags|=1,wi(e,t,r,n),t.child;case 14:return a=ri(r=t.type,t.pendingProps),Ni(e,t,r,a=ri(r.type,a),n);case 15:return ji(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:ri(r,a),Yi(e,t),t.tag=1,Oa(r)?(e=!0,La(t)):e=!1,As(t,n),ii(t,r,a),ci(t,r,a,n),Di(null,t,r,!0,e,n);case 19:return qi(e,t,n);case 22:return ki(e,t,n)}throw Error(s(156,t.tag))};var Gc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function ed(e,t,n,r,a){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof a){var i=a;a=function(){var e=Wc(o);i.call(e)}}Yc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var s=r;r=function(){var e=Wc(o);s.call(e)}}var o=qc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=o,e[fa]=o.current,qr(8===e.nodeType?e.parentNode:e),uc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var i=r;r=function(){var e=Wc(l);i.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[fa]=l.current,qr(8===e.nodeType?e.parentNode:e),uc(function(){Yc(t,l,n,r)}),l}(n,t,e,a,r);return Wc(o)}Jc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Yc(e,t,null,null)},Jc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc(function(){Yc(null,e,null,null)}),t[fa]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Ft(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(bt(t,1|n),ac(t,Xe()),0===(6&Dl)&&(ql=Xe()+500,qa()))}break;case 13:uc(function(){var t=Rs(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}}),Kc(e,1)}},Nt=function(e){if(13===e.tag){var t=Rs(e,134217728);if(null!==t)rc(t,e,134217728,tc());Kc(e,134217728)}},jt=function(e){if(13===e.tag){var t=nc(e),n=Rs(e,t);if(null!==n)rc(n,e,t,tc());Kc(e,t)}},kt=function(){return xt},Ct=function(e,t){var n=xt;try{return xt=e,t()}finally{xt=n}},Ne=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Sa(r);if(!a)throw Error(s(90));K(r),X(r,a)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},De=dc,Ae=uc;var td={usingClientEntryPoint:!1,Events:[xa,wa,Sa,Ee,_e,dc]},nd={findFiberByHostInstance:ba,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rd={bundleType:nd.bundleType,version:nd.version,rendererPackageName:nd.rendererPackageName,rendererConfig:nd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:nd.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ad=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ad.isDisabled&&ad.supportsFiber)try{st=ad.inject(rd),ot=ad}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=td,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$c(e))throw Error(s(299));var n=!1,r="",a=Gc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,a),e[fa]=t.current,qr(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(s(200));return ed(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$c(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",i=Gc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(i=n.onRecoverableError)),t=qc(t,null,e,1,null!=n?n:null,a,0,o,i),e[fa]=t.current,qr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Jc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(s(200));return ed(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(s(40));return!!e._reactRootContainer&&(uc(function(){ed(null,null,e,!1,function(){e._reactRootContainer=null,e[fa]=null})}),!0)},t.unstable_batchedUpdates=dc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return ed(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},352:(e,t,n)=>{var r=n(119);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},379:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(705);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){(0,r.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}},414:(e,t,n)=>{e.exports=n(654)},427:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(569));class s extends a.default{select(e){let t=!1;const n=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e){let{ascending:t=!0,nullsFirst:n,foreignTable:r,referencedTable:a=r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=a?"".concat(a,".order"):"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,"".concat(o?"".concat(o,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===n?"":n?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r="undefined"===typeof n?"limit":"".concat(n,".limit");return this.url.searchParams.set(r,"".concat(e)),this}range(e,t){let{foreignTable:n,referencedTable:r=n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a="undefined"===typeof r?"offset":"".concat(r,".offset"),s="undefined"===typeof r?"limit":"".concat(r,".limit");return this.url.searchParams.set(a,"".concat(e)),this.url.searchParams.set(s,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain(){let{analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:r=!1,wal:a=!1,format:s="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var o;const i=[e?"analyze":null,t?"verbose":null,n?"settings":null,r?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.Accept)&&void 0!==o?o:"application/json";return this.headers.Accept="application/vnd.pgrst.plan+".concat(s,'; for="').concat(l,'"; options=').concat(i,";"),this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=s},569:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(n(621)),s=r(n(732));t.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=a.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,n,r;let a=null,o=null,i=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(o="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),s=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");r&&s&&s.length>1&&(i=parseInt(s[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(o)&&(o.length>1?(a={code:"PGRST116",details:"Results contain ".concat(o.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,i=null,l=406,c="Not Acceptable"):o=1===o.length?o[0]:null)}else{const t=await e.text();try{a=JSON.parse(t),Array.isArray(a)&&404===e.status&&(o=[],a=null,l=200,c="OK")}catch(d){404===e.status&&""===t?(l=204,c="No Content"):a={message:t}}if(a&&this.isMaybeSingle&&(null===(r=null===a||void 0===a?void 0:a.details)||void 0===r?void 0:r.includes("0 rows"))&&(a=null,l=200,c="OK"),a&&this.shouldThrowOnError)throw new s.default(a)}return{error:a,data:o,count:i,status:l,statusText:c}});return this.shouldThrowOnError||(n=n.catch(e=>{var t,n,r;return{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:"".concat(null!==(n=null===e||void 0===e?void 0:e.stack)&&void 0!==n?n:""),hint:"",code:"".concat(null!==(r=null===e||void 0===e?void 0:e.code)&&void 0!==r?r:"")},data:null,count:null,status:0,statusText:""}})),n.then(e,t)}returns(){return this}overrideTypes(){return this}}},571:(e,t,n)=>{n.d(t,{Uj:()=>s,a$:()=>r,bD:()=>o});class r extends Error{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(e.message),this.code=void 0,this.details=void 0,this.hint=void 0,this.operation=void 0,this.retryable=void 0,this.name="DatabaseError",this.code=e.code,this.details=e.details,this.hint=e.hint,this.operation=t,this.retryable=n}}function a(e,t){const n=t.operation;console.error("\u274c Supabase ".concat(n," failed:"),e);const a=function(e){var t,n,r;return["08000","08003","08006","53000","53100","53200","53300","PGRST301","NETWORK_ERROR"].includes(null===e||void 0===e?void 0:e.code)||(null===e||void 0===e||null===(t=e.message)||void 0===t?void 0:t.includes("network"))||(null===e||void 0===e||null===(n=e.message)||void 0===n?void 0:n.includes("timeout"))||(null===e||void 0===e||null===(r=e.message)||void 0===r?void 0:r.includes("connection"))}(e),s=function(e,t){if(t.fallbackMessage)return t.fallbackMessage;const n=t.operation.toLowerCase();switch(null===e||void 0===e?void 0:e.code){case"23505":return"This ".concat(n," already exists. Please use a different name or value.");case"23503":return"Cannot ".concat(n," because it's still being used by other records. Please remove dependencies first.");case"23502":return"Required information is missing for this ".concat(n,". Please fill in all required fields.");case"42501":return"You don't have permission to perform this ".concat(n,". Please contact your administrator.");case"PGRST116":return"The requested ".concat(n," was not found. It may have been deleted by another user.");case"08000":case"08003":case"08006":case"PGRST301":return"Connection lost. Please check your internet connection and try again.";case"53000":case"53100":case"53200":case"53300":return"The server is currently overloaded. Please try again in a few moments.";default:return n.includes("create")||n.includes("add")||n.includes("save")?"Failed to save ".concat(n,". Please try again."):n.includes("update")||n.includes("edit")?"Failed to update ".concat(n,". Please try again."):n.includes("delete")||n.includes("remove")?"Failed to delete ".concat(n,". Please try again."):n.includes("load")||n.includes("fetch")||n.includes("get")?"Failed to load ".concat(n,". Please refresh the page."):"Operation failed: ".concat(n,". Please try again.")}}(e,t),o=new r({code:null===e||void 0===e?void 0:e.code,message:s,details:null===e||void 0===e?void 0:e.details,hint:null===e||void 0===e?void 0:e.hint},n,a);return t.showToUser&&function(e){console.error("\ud83d\udea8 User Error [".concat(e.operation,"]:"),e.message)}(o),o}async function s(e,t){try{return await e()}catch(n){throw a(n,t)}}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{operation:"unknown operation",showToUser:!1};const n=t.maxRetries||3,r=t.retryDelay||1e3;let a=null;for(let i=1;i<=n;i++)try{return await s(e,t)}catch(o){if(a=o,!a.retryable||i===n)throw a;console.log("\u23f3 Retrying ".concat(t.operation," (attempt ").concat(i+1,"/").concat(n,")...")),await new Promise(e=>setTimeout(e,r*i))}throw a}},621:(e,t,n)=>{n.r(t),n.d(t,{Headers:()=>o,Request:()=>i,Response:()=>l,default:()=>s,fetch:()=>a});var r=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("unable to locate global object")}();const a=r.fetch,s=r.fetch.bind(r),o=r.Headers,i=r.Request,l=r.Response},654:(e,t,n)=>{var r=n(950),a=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:d,props:s,_owner:i.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},705:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{A:()=>s})},709:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},717:(e,t,n)=>{n.d(t,{DU:()=>c,FS:()=>r,Me:()=>l,cD:()=>i,jC:()=>a,q8:()=>o,uy:()=>s});const r=["Singapore","Malaysia","Philippines","Indonesia","Vietnam","Hongkong","Thailand"],a=r[0],s=["Cardiology","Orthopedics","Neurosurgery","Oncology","Emergency","Radiology","General Surgery","Pediatrics"],o=["Knee","Head","Hip","Hands","Neck","Spine"],i=["Spine Surgery Set A","Spine Surgery Set B","Joint Replacement Set","Sports Medicine Set","Orthobiologics Set","Neuromonitoring Set","General Orthopedic Set"],l=["Spine Implant Box 1","Spine Implant Box 2","Hip Implant Box","Knee Implant Box","Shoulder Implant Box","Sports Med Implant Box","Biologics Box"],c={Spine:{surgerySets:["Spine Surgery Set A","Spine Surgery Set B","Neuromonitoring Set","General Orthopedic Set"],implantBoxes:["Spine Implant Box 1","Spine Implant Box 2","Biologics Box"]},Knee:{surgerySets:["Joint Replacement Set","Sports Medicine Set","General Orthopedic Set"],implantBoxes:["Knee Implant Box","Sports Med Implant Box","Biologics Box"]},Hip:{surgerySets:["Joint Replacement Set","Orthobiologics Set","General Orthopedic Set"],implantBoxes:["Hip Implant Box","Biologics Box"]},Head:{surgerySets:["Neuromonitoring Set","General Orthopedic Set"],implantBoxes:["Biologics Box"]},Hands:{surgerySets:["Sports Medicine Set","General Orthopedic Set"],implantBoxes:["Sports Med Implant Box"]},Neck:{surgerySets:["Spine Surgery Set A","Neuromonitoring Set","General Orthopedic Set"],implantBoxes:["Spine Implant Box 1","Biologics Box"]}}},724:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;const r=n(709);t.DEFAULT_HEADERS={"X-Client-Info":"postgrest-js/".concat(r.version)}},732:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=n},739:(e,t,n)=>{n.d(t,{fd:()=>a,sf:()=>r});const r={CASE_BOOKED:"Case Booked",ORDER_PREPARATION:"Order Preparation",ORDER_PREPARED:"Order Prepared",PENDING_DELIVERY_HOSPITAL:"Pending Delivery (Hospital)",DELIVERED_HOSPITAL:"Delivered (Hospital)",CASE_COMPLETED:"Case Completed",PENDING_DELIVERY_OFFICE:"Pending Delivery (Office)",DELIVERED_OFFICE:"Delivered (Office)",TO_BE_BILLED:"To be billed",CASE_CLOSED:"Case Closed",CASE_CANCELLED:"Case Cancelled"},a=[r.CASE_BOOKED,r.ORDER_PREPARATION,r.ORDER_PREPARED,r.PENDING_DELIVERY_HOSPITAL,r.DELIVERED_HOSPITAL,r.CASE_COMPLETED,r.PENDING_DELIVERY_OFFICE,r.DELIVERED_OFFICE,r.TO_BE_BILLED];r.CASE_BOOKED,r.ORDER_PREPARATION,r.ORDER_PREPARED,r.PENDING_DELIVERY_HOSPITAL,r.DELIVERED_HOSPITAL,r.CASE_COMPLETED,r.PENDING_DELIVERY_OFFICE,r.DELIVERED_OFFICE,r.TO_BE_BILLED,r.CASE_CLOSED,r.CASE_CANCELLED,r.CASE_BOOKED,r.ORDER_PREPARATION,r.ORDER_PREPARED,r.PENDING_DELIVERY_HOSPITAL,r.DELIVERED_HOSPITAL,r.CASE_COMPLETED,r.PENDING_DELIVERY_OFFICE,r.DELIVERED_OFFICE,r.TO_BE_BILLED,r.CASE_CLOSED,r.CASE_CANCELLED,r.CASE_BOOKED,r.ORDER_PREPARATION,r.ORDER_PREPARED,r.PENDING_DELIVERY_HOSPITAL,r.DELIVERED_HOSPITAL,r.CASE_COMPLETED,r.PENDING_DELIVERY_OFFICE,r.DELIVERED_OFFICE,r.TO_BE_BILLED,r.CASE_CLOSED,r.CASE_CANCELLED,r.CASE_BOOKED,r.ORDER_PREPARATION,r.ORDER_PREPARED,r.PENDING_DELIVERY_HOSPITAL,r.DELIVERED_HOSPITAL,r.CASE_COMPLETED,r.PENDING_DELIVERY_OFFICE,r.DELIVERED_OFFICE,r.TO_BE_BILLED,r.CASE_CLOSED,r.CASE_CANCELLED,r.CASE_BOOKED,r.ORDER_PREPARATION,r.ORDER_PREPARED,r.PENDING_DELIVERY_HOSPITAL,r.DELIVERED_HOSPITAL,r.CASE_COMPLETED,r.PENDING_DELIVERY_OFFICE,r.DELIVERED_OFFICE,r.TO_BE_BILLED,r.CASE_BOOKED,r.PENDING_DELIVERY_HOSPITAL,r.DELIVERED_HOSPITAL,r.CASE_CLOSED,r.CASE_CANCELLED},761:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<s(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var i=2*(r+1)-1,l=e[i],c=i+1,d=e[c];if(0>s(l,n))c<a&&0>s(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[i]=n,r=i);else{if(!(c<a&&0>s(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],d=[],u=1,h=null,p=3,m=!1,f=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function w(e){if(g=!1,x(e),!f)if(null!==r(c))f=!0,O(S);else{var t=r(d);null!==t&&P(w,t.startTime-e)}}function S(e,n){f=!1,g&&(g=!1,y(C),C=-1),m=!0;var s=p;try{for(x(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!D());){var o=h.callback;if("function"===typeof o){h.callback=null,p=h.priorityLevel;var i=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof i?h.callback=i:h===r(c)&&a(c),x(n)}else a(c);h=r(c)}if(null!==h)var l=!0;else{var u=r(d);null!==u&&P(w,u.startTime-n),l=!1}return l}finally{h=null,p=s,m=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,j=!1,k=null,C=-1,E=5,_=-1;function D(){return!(t.unstable_now()-_<E)}function A(){if(null!==k){var e=t.unstable_now();_=e;var n=!0;try{n=k(!0,e)}finally{n?N():(j=!1,k=null)}}else j=!1}if("function"===typeof b)N=function(){b(A)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,I=T.port2;T.port1.onmessage=A,N=function(){I.postMessage(null)}}else N=function(){v(A,0)};function O(e){k=e,j||(j=!0,N())}function P(e,n){C=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||m||(f=!0,O(S))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:s,expirationTime:i=s+i,sortIndex:-1},s>o?(e.sortIndex=s,n(d,e),null===r(c)&&e===r(d)&&(g?(y(C),C=-1):g=!0,P(w,s-o))):(e.sortIndex=i,n(c,e),f||m||(f=!0,O(S))),e},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},887:(e,t,n)=>{n.d(t,{N:()=>Vt,E:()=>Kt});class r extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",n=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=n}}class a extends r{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class s extends r{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class o extends r{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var i;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(i||(i={}));var l=function(e,t,n,r){return new(n||(n=Promise))(function(a,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function i(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,i)}l((r=r.apply(e,t||[])).next())})};class c{constructor(e){let{headers:t={},customFetch:r,region:a=i.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=a,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,621)).then(e=>{let{default:n}=e;return n(...t)})}:fetch),function(){return t(...arguments)}})(r)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;return l(this,void 0,void 0,function*(){try{const{headers:r,method:i,body:l}=t;let c={},{region:d}=t;d||(d=this.region);const u=new URL("".concat(this.url,"/").concat(e));let h;d&&"any"!==d&&(c["x-region"]=d,u.searchParams.set("forceFunctionRegion",d)),l&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",h=l):"string"===typeof l?(c["Content-Type"]="text/plain",h=l):"undefined"!==typeof FormData&&l instanceof FormData?h=l:(c["Content-Type"]="application/json",h=JSON.stringify(l)));const p=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),r),body:h}).catch(e=>{throw new a(e)}),m=p.headers.get("x-relay-error");if(m&&"true"===m)throw new s(p);if(!p.ok)throw new o(p);let f,g=(null!==(n=p.headers.get("Content-Type"))&&void 0!==n?n:"text/plain").split(";")[0].trim();return f="application/json"===g?yield p.json():"application/octet-stream"===g?yield p.blob():"text/event-stream"===g?p:"multipart/form-data"===g?yield p.formData():yield p.text(),{data:f,error:null,response:p}}catch(r){return{data:null,error:r,response:r instanceof o||r instanceof s?r.context:void 0}}})}}var d=n(53);const{PostgrestClient:u,PostgrestQueryBuilder:h,PostgrestFilterBuilder:p,PostgrestTransformBuilder:m,PostgrestBuilder:f,PostgrestError:g}=d;const v=function(){if("undefined"!==typeof WebSocket)return WebSocket;if("undefined"!==typeof global.WebSocket)return global.WebSocket;if("undefined"!==typeof window.WebSocket)return window.WebSocket;if("undefined"!==typeof self.WebSocket)return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}(),y="realtime-js/".concat("2.11.15");var b,x,w,S,N,j;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(b||(b={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(x||(x={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(w||(w={})),function(e){e.websocket="websocket"}(S||(S={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(N||(N={}));class k{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const r=t.getUint8(1),a=t.getUint8(2);let s=this.HEADER_LENGTH+2;const o=n.decode(e.slice(s,s+r));s+=r;const i=n.decode(e.slice(s,s+a));s+=a;return{ref:null,topic:o,event:i,payload:JSON.parse(n.decode(e.slice(s,e.byteLength)))}}}class C{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(j||(j={}));const E=function(e,t){var n;const r=null!==(n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce((n,a)=>(n[a]=_(a,e,t,r),n),{})},_=(e,t,n,r)=>{const a=t.find(t=>t.name===e),s=null===a||void 0===a?void 0:a.type,o=n[e];return s&&!r.includes(s)?D(s,o):A(o)},D=(e,t)=>{if("_"===e.charAt(0)){const n=e.slice(1,e.length);return P(t,n)}switch(e){case j.bool:return T(t);case j.float4:case j.float8:case j.int2:case j.int4:case j.int8:case j.numeric:case j.oid:return I(t);case j.json:case j.jsonb:return O(t);case j.timestamp:return R(t);case j.abstime:case j.date:case j.daterange:case j.int4range:case j.int8range:case j.money:case j.reltime:case j.text:case j.time:case j.timestamptz:case j.timetz:case j.tsrange:case j.tstzrange:default:return A(t)}},A=e=>e,T=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},I=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},O=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log("JSON parse error: ".concat(t)),e}return e},P=(e,t)=>{if("string"!==typeof e)return e;const n=e.length-1,r=e[n];if("{"===e[0]&&"}"===r){let r;const s=e.slice(1,n);try{r=JSON.parse("["+s+"]")}catch(a){r=s?s.split(","):[]}return r.map(e=>D(t,e))}return e},R=e=>"string"===typeof e?e.replace(" ","T"):e,M=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class L{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;this.channel=e,this.event=t,this.payload=n,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t(null===(n=this.receivedResp)||void 0===n?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:n}=e;this.recHooks.filter(e=>e.status===t).forEach(e=>e.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var F,B,U,z;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(F||(F={}));class H{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=H.syncState(this.state,e,t,n),this.pendingDiffs.forEach(e=>{this.state=H.syncDiff(this.state,e,t,n)}),this.pendingDiffs=[],r()}),this.channel._on(n.diff,{},e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=H.syncDiff(this.state,e,t,n),r())}),this.onJoin((e,t,n)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:n})}),this.onLeave((e,t,n)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:n})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,r){const a=this.cloneDeep(e),s=this.transformState(t),o={},i={};return this.map(a,(e,t)=>{s[e]||(i[e]=t)}),this.map(s,(e,t)=>{const n=a[e];if(n){const r=t.map(e=>e.presence_ref),a=n.map(e=>e.presence_ref),s=t.filter(e=>a.indexOf(e.presence_ref)<0),l=n.filter(e=>r.indexOf(e.presence_ref)<0);s.length>0&&(o[e]=s),l.length>0&&(i[e]=l)}else o[e]=t}),this.syncDiff(a,{joins:o,leaves:i},n,r)}static syncDiff(e,t,n,r){const{joins:a,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),r||(r=()=>{}),this.map(a,(t,r)=>{var a;const s=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(r),s.length>0){const n=e[t].map(e=>e.presence_ref),r=s.filter(e=>n.indexOf(e.presence_ref)<0);e[t].unshift(...r)}n(t,s,r)}),this.map(s,(t,n)=>{let a=e[t];if(!a)return;const s=n.map(e=>e.presence_ref);a=a.filter(e=>s.indexOf(e.presence_ref)<0),e[t]=a,r(t,a,n),0===a.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const r=e[n];return t[n]="metas"in r?r.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(B||(B={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(U||(U={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(z||(z={}));class q{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},n=arguments.length>2?arguments[2]:void 0;this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=x.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new L(this,w.join,this.params,this.timeout),this.rejoinTimer=new C(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=x.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=x.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=x.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=x.errored,this.rejoinTimer.scheduleTimeout())}),this._on(w.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new H(this),this.broadcastEndpointURL=M(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var n,r;if(this.socket.isConnected()||this.socket.connect(),this.state==x.closed){const{config:{broadcast:a,presence:s,private:o}}=this.params;this._onError(t=>null===e||void 0===e?void 0:e(z.CHANNEL_ERROR,t)),this._onClose(()=>null===e||void 0===e?void 0:e(z.CLOSED));const i={},l={broadcast:a,presence:s,postgres_changes:null!==(r=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map(e=>e.filter))&&void 0!==r?r:[],private:o};this.socket.accessTokenValue&&(i.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},i)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async t=>{let{postgres_changes:n}=t;var r;if(this.socket.setAuth(),void 0!==n){const t=this.bindings.postgres_changes,a=null!==(r=null===t||void 0===t?void 0:t.length)&&void 0!==r?r:0,s=[];for(let r=0;r<a;r++){const a=t[r],{filter:{event:o,schema:i,table:l,filter:c}}=a,d=n&&n[r];if(!d||d.event!==o||d.schema!==i||d.table!==l||d.filter!==c)return this.unsubscribe(),this.state=x.errored,void(null===e||void 0===e||e(z.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));s.push(Object.assign(Object.assign({},a),{id:d.id}))}return this.bindings.postgres_changes=s,void(e&&e(z.SUBSCRIBED))}null===e||void 0===e||e(z.SUBSCRIBED)}).receive("error",t=>{this.state=x.errored,null===e||void 0===e||e(z.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null===e||void 0===e||e(z.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,r;if(this._canPush()||"broadcast"!==e.type)return new Promise(n=>{var r,a,s;const o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(a=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===a?void 0:a.broadcast)||void 0===s?void 0:s.ack)||n("ok"),o.receive("ok",()=>n("ok")),o.receive("error",()=>n("error")),o.receive("timeout",()=>n("timed out"))});{const{event:s,payload:o}=e,i={method:"POST",headers:{Authorization:this.socket.accessTokenValue?"Bearer ".concat(this.socket.accessTokenValue):"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,i,null!==(n=t.timeout)&&void 0!==n?n:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=x.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(w.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(r=>{n=new L(this,w.leave,{},e),n.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{null===n||void 0===n||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,n){const r=new AbortController,a=setTimeout(()=>r.abort(),n),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(a),s}_push(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let r=new L(this,e,t,n);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var r,a;const s=e.toLocaleLowerCase(),{close:o,error:i,leave:l,join:c}=w;if(n&&[o,i,l,c].indexOf(s)>=0&&n!==this._joinRef())return;let d=this._onMessage(s,t,n);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter(e=>{var t,n,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(n=e.filter)||void 0===n?void 0:n.event)||void 0===r?void 0:r.toLocaleLowerCase())===s}).map(e=>e.callback(d,n)):null===(a=this.bindings[s])||void 0===a||a.filter(e=>{var n,r,a,o,i,l;if(["broadcast","presence","postgres_changes"].includes(s)){if("id"in e){const s=e.id,o=null===(n=e.filter)||void 0===n?void 0:n.event;return s&&(null===(r=t.ids)||void 0===r?void 0:r.includes(s))&&("*"===o||(null===o||void 0===o?void 0:o.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))}{const n=null===(i=null===(o=null===e||void 0===e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===i?void 0:i.toLocaleLowerCase();return"*"===n||n===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===s}).map(e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:n,commit_timestamp:r,type:a,errors:s}=e,o={schema:t,table:n,commit_timestamp:r,eventType:a,new:{},old:{},errors:s};d=Object.assign(Object.assign({},o),this._getPayloadRecords(e))}e.callback(d,n)})}_isClosed(){return this.state===x.closed}_isJoined(){return this.state===x.joined}_isJoining(){return this.state===x.joining}_isLeaving(){return this.state===x.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,n){const r=e.toLocaleLowerCase(),a={type:r,filter:t,callback:n};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===n&&q.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(w.close,{},e)}_onError(e){this._on(w.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=x.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=E(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=E(e.columns,e.old_record)),t}}const Y=()=>{};class W{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Y,this.ref=0,this.logger=Y,this.conn=null,this.sendBuffer=[],this.serializer=new k,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,621)).then(e=>{let{default:n}=e;return n(...t)})}:fetch),function(){return t(...arguments)}},this.endPoint="".concat(e,"/").concat(S.websocket),this.httpEndpoint=M(e),(null===t||void 0===t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null===t||void 0===t?void 0:t.params)&&(this.params=t.params),(null===t||void 0===t?void 0:t.timeout)&&(this.timeout=t.timeout),(null===t||void 0===t?void 0:t.logger)&&(this.logger=t.logger),((null===t||void 0===t?void 0:t.logLevel)||(null===t||void 0===t?void 0:t.log_level))&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),(null===t||void 0===t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const a=null===(r=null===t||void 0===t?void 0:t.params)||void 0===r?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=(null===t||void 0===t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null===t||void 0===t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null===t||void 0===t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new C(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch),null===t||void 0===t?void 0:t.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null===t||void 0===t?void 0:t.worker)||!1,this.workerUrl=null===t||void 0===t?void 0:t.workerUrl}this.accessToken=(null===t||void 0===t?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=v),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(e=>e.teardown()))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case b.connecting:return N.Connecting;case b.open:return N.Open;case b.closing:return N.Closing;default:return N.Closed}}isConnected(){return this.connectionState()===N.Open}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const n="realtime:".concat(e),r=this.getChannels().find(e=>e.topic===n);if(r)return r;{const n=new q("realtime:".concat(e),t,this);return this.channels.push(n),n}}push(e){const{topic:t,event:n,payload:r,ref:a}=e,s=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push","".concat(t," ").concat(n," (").concat(a,")"),r),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(){let e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{const n={access_token:e,version:y};e&&t.updateJoinPayload(n),t.joinedOnce&&t._isJoined()&&t._push(w.access_token,{access_token:e})}))}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}else this.heartbeatCallback("disconnected")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:n,payload:r,ref:a}=e;"phoenix"===t&&"phx_reply"===n&&this.heartbeatCallback("ok"==e.payload.status?"ok":"error"),a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive","".concat(r.status||""," ").concat(t," ").concat(n," ").concat(a&&"("+a+")"||""),r),Array.from(this.channels).filter(e=>e._isMember(t)).forEach(e=>e._trigger(n,r,a)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}_onConnOpen(){this.log("transport","connected to ".concat(this.endpointURL())),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport","".concat(e)),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(w.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return"".concat(e).concat(n).concat(r)}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class V extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function K(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class G extends V{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Q extends V{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var J=function(e,t,n,r){return new(n||(n=Promise))(function(a,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function i(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,i)}l((r=r.apply(e,t||[])).next())})};const $=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,621)).then(e=>{let{default:n}=e;return n(...t)})}:fetch),function(){return t(...arguments)}},X=e=>{if(Array.isArray(e))return e.map(e=>X(e));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(e=>{let[n,r]=e;const a=n.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[a]=X(r)}),t};var Z=function(e,t,n,r){return new(n||(n=Promise))(function(a,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function i(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,i)}l((r=r.apply(e,t||[])).next())})};const ee=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),te=(e,t,r)=>Z(void 0,void 0,void 0,function*(){const a=yield J(void 0,void 0,void 0,function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(n.bind(n,621))).Response:Response});e instanceof a&&!(null===r||void 0===r?void 0:r.noResolveJson)?e.json().then(n=>{t(new G(ee(n),e.status||500))}).catch(e=>{t(new Q(ee(e),e))}):t(new Q(ee(e),e))});function ne(e,t,n,r,a,s){return Z(this,void 0,void 0,function*(){return new Promise((o,i)=>{e(n,((e,t,n,r)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))})(t,r,a,s)).then(e=>{if(!e.ok)throw e;return(null===r||void 0===r?void 0:r.noResolveJson)?e:e.json()}).then(e=>o(e)).catch(e=>te(e,i,r))})})}function re(e,t,n,r){return Z(this,void 0,void 0,function*(){return ne(e,"GET",t,n,r)})}function ae(e,t,n,r,a){return Z(this,void 0,void 0,function*(){return ne(e,"POST",t,r,a,n)})}function se(e,t,n,r,a){return Z(this,void 0,void 0,function*(){return ne(e,"DELETE",t,r,a,n)})}var oe=function(e,t,n,r){return new(n||(n=Promise))(function(a,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function i(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,i)}l((r=r.apply(e,t||[])).next())})};const ie={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},le={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ce{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;this.url=e,this.headers=t,this.bucketId=n,this.fetch=$(r)}uploadOrUpdate(e,t,n,r){return oe(this,void 0,void 0,function*(){try{let a;const s=Object.assign(Object.assign({},le),r);let o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(s.upsert)});const i=s.metadata;"undefined"!==typeof Blob&&n instanceof Blob?(a=new FormData,a.append("cacheControl",s.cacheControl),i&&a.append("metadata",this.encodeMetadata(i)),a.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(a=n,a.append("cacheControl",s.cacheControl),i&&a.append("metadata",this.encodeMetadata(i))):(a=n,o["cache-control"]="max-age=".concat(s.cacheControl),o["content-type"]=s.contentType,i&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(i)))),(null===r||void 0===r?void 0:r.headers)&&(o=Object.assign(Object.assign({},o),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield this.fetch("".concat(this.url,"/object/").concat(c),Object.assign({method:e,body:a,headers:o},(null===s||void 0===s?void 0:s.duplex)?{duplex:s.duplex}:{})),u=yield d.json();if(d.ok)return{data:{path:l,id:u.Id,fullPath:u.Key},error:null};return{data:null,error:u}}catch(a){if(K(a))return{data:null,error:a};throw a}})}upload(e,t,n){return oe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,r){return oe(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),s=this._getFinalPath(a),o=new URL(this.url+"/object/upload/sign/".concat(s));o.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:le.upsert},r),s=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",t.cacheControl)):(e=n,s["cache-control"]="max-age=".concat(t.cacheControl),s["content-type"]=t.contentType);const i=yield this.fetch(o.toString(),{method:"PUT",body:e,headers:s}),l=yield i.json();if(i.ok)return{data:{path:a,fullPath:l.Key},error:null};return{data:null,error:l}}catch(i){if(K(i))return{data:null,error:i};throw i}})}createSignedUploadUrl(e,t){return oe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const r=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(r["x-upsert"]="true");const a=yield ae(this.fetch,"".concat(this.url,"/object/upload/sign/").concat(n),{},{headers:r}),s=new URL(this.url+a.url),o=s.searchParams.get("token");if(!o)throw new V("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:o},error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}})}update(e,t,n){return oe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return oe(this,void 0,void 0,function*(){try{return{data:yield ae(this.fetch,"".concat(this.url,"/object/move"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}})}copy(e,t,n){return oe(this,void 0,void 0,function*(){try{return{data:{path:(yield ae(this.fetch,"".concat(this.url,"/object/copy"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,n){return oe(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),a=yield ae(this.fetch,"".concat(this.url,"/object/sign/").concat(r),Object.assign({expiresIn:t},(null===n||void 0===n?void 0:n.transform)?{transform:n.transform}:{}),{headers:this.headers});const s=(null===n||void 0===n?void 0:n.download)?"&download=".concat(!0===n.download?"":n.download):"";return a={signedUrl:encodeURI("".concat(this.url).concat(a.signedURL).concat(s))},{data:a,error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,n){return oe(this,void 0,void 0,function*(){try{const r=yield ae(this.fetch,"".concat(this.url,"/object/sign/").concat(this.bucketId),{expiresIn:t,paths:e},{headers:this.headers}),a=(null===n||void 0===n?void 0:n.download)?"&download=".concat(!0===n.download?"":n.download):"";return{data:r.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI("".concat(this.url).concat(e.signedURL).concat(a)):null})),error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}})}download(e,t){return oe(this,void 0,void 0,function*(){const n="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),a=r?"?".concat(r):"";try{const t=this._getFinalPath(e),r=yield re(this.fetch,"".concat(this.url,"/").concat(n,"/").concat(t).concat(a),{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(s){if(K(s))return{data:null,error:s};throw s}})}info(e){return oe(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield re(this.fetch,"".concat(this.url,"/object/info/").concat(t),{headers:this.headers});return{data:X(e),error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}})}exists(e){return oe(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,n,r){return Z(this,void 0,void 0,function*(){return ne(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}(this.fetch,"".concat(this.url,"/object/").concat(t),{headers:this.headers}),{data:!0,error:null}}catch(n){if(K(n)&&n instanceof Q){const e=n.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),r=[],a=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==a&&r.push(a);const s="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==o&&r.push(o);let i=r.join("&");return""!==i&&(i="?".concat(i)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(s,"/public/").concat(n).concat(i))}}}remove(e){return oe(this,void 0,void 0,function*(){try{return{data:yield se(this.fetch,"".concat(this.url,"/object/").concat(this.bucketId),{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}list(e,t,n){return oe(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},ie),t),{prefix:e||""});return{data:yield ae(this.fetch,"".concat(this.url,"/object/list/").concat(this.bucketId),r,{headers:this.headers},n),error:null}}catch(r){if(K(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e)}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}}const de={"X-Client-Info":"storage-js/".concat("2.7.1")};var ue=function(e,t,n,r){return new(n||(n=Promise))(function(a,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function i(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,i)}l((r=r.apply(e,t||[])).next())})};class he{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.url=e,this.headers=Object.assign(Object.assign({},de),t),this.fetch=$(n)}listBuckets(){return ue(this,void 0,void 0,function*(){try{return{data:yield re(this.fetch,"".concat(this.url,"/bucket"),{headers:this.headers}),error:null}}catch(e){if(K(e))return{data:null,error:e};throw e}})}getBucket(e){return ue(this,void 0,void 0,function*(){try{return{data:yield re(this.fetch,"".concat(this.url,"/bucket/").concat(e),{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return ue(this,void 0,void 0,function*(){try{return{data:yield ae(this.fetch,"".concat(this.url,"/bucket"),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}})}updateBucket(e,t){return ue(this,void 0,void 0,function*(){try{const n=yield function(e,t,n,r,a){return Z(this,void 0,void 0,function*(){return ne(e,"PUT",t,r,a,n)})}(this.fetch,"".concat(this.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:n,error:null}}catch(n){if(K(n))return{data:null,error:n};throw n}})}emptyBucket(e){return ue(this,void 0,void 0,function*(){try{return{data:yield ae(this.fetch,"".concat(this.url,"/bucket/").concat(e,"/empty"),{},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ue(this,void 0,void 0,function*(){try{return{data:yield se(this.fetch,"".concat(this.url,"/bucket/").concat(e),{},{headers:this.headers}),error:null}}catch(t){if(K(t))return{data:null,error:t};throw t}})}}class pe extends he{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0)}from(e){return new ce(this.url,this.headers,e,this.fetch)}}let me="";me="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const fe={headers:{"X-Client-Info":"supabase-js-".concat(me,"/").concat("2.50.3")}},ge={schema:"public"},ve={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ye={};var be=n(621),xe=function(e,t,n,r){return new(n||(n=Promise))(function(a,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function i(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,i)}l((r=r.apply(e,t||[])).next())})};const we=e=>{let t;return t=e||("undefined"===typeof fetch?be.default:fetch),function(){return t(...arguments)}},Se=(e,t,n)=>{const r=we(n),a="undefined"===typeof Headers?be.Headers:Headers;return(n,s)=>xe(void 0,void 0,void 0,function*(){var o;const i=null!==(o=yield t())&&void 0!==o?o:e;let l=new a(null===s||void 0===s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization","Bearer ".concat(i)),r(n,Object.assign(Object.assign({},s),{headers:l}))})};var Ne=function(e,t,n,r){return new(n||(n=Promise))(function(a,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function i(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,i)}l((r=r.apply(e,t||[])).next())})};const je="2.70.0",ke=3e4,Ce=9e4,Ee={"X-Client-Info":"gotrue-js/".concat(je)},_e="X-Supabase-Api-Version",De={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Ae=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Te extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Ie(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class Oe extends Te{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}class Pe extends Te{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Re extends Te{constructor(e,t,n,r){super(e,n,r),this.name=t,this.status=n}}class Me extends Re{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Le extends Re{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Fe extends Re{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Be extends Re{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ue extends Re{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ze extends Re{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function He(e){return Ie(e)&&"AuthRetryableFetchError"===e.name}class qe extends Re{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class Ye extends Re{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const We="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ve=" \t\n\r=".split(""),Ke=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Ve.length;t+=1)e[Ve[t].charCodeAt(0)]=-2;for(let t=0;t<We.length;t+=1)e[We[t].charCodeAt(0)]=t;return e})();function Ge(e,t,n){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;n(We[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;n(We[e]),t.queuedBits-=6}}function Qe(e,t,n){const r=Ke[e];if(!(r>-1)){if(-2===r)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Je(e){const t=[],n=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=e=>{!function(e,t,n){if(0===t.utf8seq){if(e<=127)return void n(e);for(let n=1;n<6;n+=1)if(0===(e>>7-n&1)){t.utf8seq=n;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&n(t.codepoint)}}(e,r,n)};for(let o=0;o<e.length;o+=1)Qe(e.charCodeAt(o),a,s);return t.join("")}function $e(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}t(e)}function Xe(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(n+1)-56320&65535|t),n+=1}$e(r,t)}}function Ze(e){const t=[],n={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let a=0;a<e.length;a+=1)Qe(e.charCodeAt(a),n,r);return new Uint8Array(t)}function et(e){const t=[],n={queue:0,queuedBits:0},r=e=>{t.push(e)};return e.forEach(e=>Ge(e,n,r)),Ge(null,n,r),t.join("")}const tt=()=>"undefined"!==typeof window&&"undefined"!==typeof document,nt={tested:!1,writable:!1},rt=()=>{if(!tt())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(nt.tested)return nt.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),nt.tested=!0,nt.writable=!0}catch(t){nt.tested=!0,nt.writable=!1}return nt.writable};const at=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,621)).then(e=>{let{default:n}=e;return n(...t)})}:fetch),function(){return t(...arguments)}},st=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},ot=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(Lo){return n}},it=async(e,t)=>{await e.removeItem(t)};class lt{constructor(){this.promise=new lt.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function ct(e){const t=e.split(".");if(3!==t.length)throw new Ye("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Ae.test(t[n]))throw new Ye("JWT not in base64url format");return{header:JSON.parse(Je(t[0])),payload:JSON.parse(Je(t[1])),signature:Ze(t[2]),raw:{header:t[0],payload:t[1]}}}function dt(e){return("0"+e.toString(16)).substr(-2)}async function ut(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(n);return Array.from(r).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ht(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let r=0;r<56;r++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(e),Array.from(e,dt).join("")}();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await st(e,"".concat(t,"-code-verifier"),a);const s=await ut(r);return[s,r===s?"plain":"s256"]}lt.promiseConstructor=Promise;const pt=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const mt=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ft(e){if(!mt.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var gt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};const vt=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),yt=[502,503,504];async function bt(e){var t,n;if(!("object"===typeof(n=e)&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"===typeof n.json))throw new ze(vt(e),0);if(yt.includes(e.status))throw new ze(vt(e),e.status);let r,a;try{r=await e.json()}catch(o){throw new Pe(vt(o),o)}const s=function(e){const t=e.headers.get(_e);if(!t)return null;if(!t.match(pt))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(o){return null}}(e);if(s&&s.getTime()>=De.timestamp&&"object"===typeof r&&r&&"string"===typeof r.code?a=r.code:"object"===typeof r&&r&&"string"===typeof r.error_code&&(a=r.error_code),a){if("weak_password"===a)throw new qe(vt(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new Me}else if("object"===typeof r&&r&&"object"===typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0))throw new qe(vt(r),e.status,r.weak_password.reasons);throw new Oe(vt(r),e.status||500,a)}async function xt(e,t,n,r){var a;const s=Object.assign({},null===r||void 0===r?void 0:r.headers);s[_e]||(s[_e]=De.name),(null===r||void 0===r?void 0:r.jwt)&&(s.Authorization="Bearer ".concat(r.jwt));const o=null!==(a=null===r||void 0===r?void 0:r.query)&&void 0!==a?a:{};(null===r||void 0===r?void 0:r.redirectTo)&&(o.redirect_to=r.redirectTo);const i=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await async function(e,t,n,r,a,s){const o=((e,t,n,r)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))})(t,r,a,s);let i;try{i=await e(n,Object.assign({},o))}catch(l){throw console.error(l),new ze(vt(l),0)}i.ok||await bt(i);if(null===r||void 0===r?void 0:r.noResolveJson)return i;try{return await i.json()}catch(l){await bt(l)}}(e,t,n+i,{headers:s,noResolveJson:null===r||void 0===r?void 0:r.noResolveJson},{},null===r||void 0===r?void 0:r.body);return(null===r||void 0===r?void 0:r.xform)?null===r||void 0===r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function wt(e){var t;let n=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function St(e){const t=wt(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function Nt(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function jt(e){return{data:e,error:null}}function kt(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:a,verification_type:s}=e,o=gt(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:n,hashed_token:r,redirect_to:a,verification_type:s},user:Object.assign({},o)},error:null}}function Ct(e){return e}const Et=["global","local","others"];var _t=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};class Dt{constructor(e){let{url:t="",headers:n={},fetch:r}=e;this.url=t,this.headers=n,this.fetch=at(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Et[0];if(Et.indexOf(t)<0)throw new Error("@supabase/auth-js: Parameter scope must be one of ".concat(Et.join(", ")));try{return await xt(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ie(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await xt(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Nt})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=_t(e,["options"]),r=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(r.new_email=null===n||void 0===n?void 0:n.newEmail,delete r.newEmail),await xt(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:r,headers:this.headers,xform:kt,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(Ie(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await xt(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:Nt})}catch(t){if(Ie(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,r,a,s,o,i;try{const l={nextPage:null,lastPage:0,total:0},c=await xt(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(a=null===(r=null===e||void 0===e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==a?a:""},xform:Ct});if(c.error)throw c.error;const d=await c.json(),u=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,h=null!==(i=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==i?i:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(n,"Page")]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Ie(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){ft(e);try{return await xt(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:Nt})}catch(t){if(Ie(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){ft(e);try{return await xt(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:Nt})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];ft(e);try{return await xt(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:Nt})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){ft(e.userId);try{const{data:t,error:n}=await xt(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:n}}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async _deleteFactor(e){ft(e.userId),ft(e.id);try{return{data:await xt(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(Ie(t))return{data:null,error:t};throw t}}}const At={getItem:e=>rt()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{rt()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{rt()&&globalThis.localStorage.removeItem(e)}};function Tt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const It=!!(globalThis&&rt()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class Ot extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Pt extends Ot{}async function Rt(e,t,n){It&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),It&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async r=>{if(!r){if(0===t)throw It&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Pt('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(It)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}It&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await n()}finally{It&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}))}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const Mt={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ee,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Lt(e,t,n){return await n()}class Ft{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ft.nextInstanceID,Ft.nextInstanceID+=1,this.instanceID>0&&tt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Mt),e);if(this.logDebugMessages=!!r.debug,"function"===typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new Dt({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=at(r.fetch),this.lock=r.lock||Lt,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:tt()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=Rt:this.lock=Lt,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:rt()?this.storage=At:(this.memoryStorage={},this.storage=Tt(this.memoryStorage)):(this.memoryStorage={},this.storage=Tt(this.memoryStorage)),tt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}null===(n=this.broadcastChannel)||void 0===n||n.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger("GoTrueClient@".concat(this.instanceID," (").concat(je,") ").concat((new Date).toISOString()),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},n=new URL(e);if(n.hash&&"#"===n.hash[0])try{new URLSearchParams(n.hash.substring(1)).forEach((e,n)=>{t[n]=e})}catch(r){}return n.searchParams.forEach((e,n)=>{t[n]=e}),t}(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),tt()&&this.detectSessionInUrl&&"none"!==n){const{data:r,error:a}=await this._getSessionFromURL(t,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),function(e){return Ie(e)&&"AuthImplicitGrantRedirectError"===e.name}(a)){const t=null===(e=a.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return await this._removeSession(),{error:a}}const{session:s,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{"recovery"===o?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ie(t)?{error:t}:{error:new Pe("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,r;try{const a=await xt(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(n=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(r=null===e||void 0===e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:wt}),{data:s,error:o}=a;if(o||!s)return{data:{user:null,session:null},error:o};const i=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",i)),{data:{user:l,session:i},error:null}}catch(a){if(Ie(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,n,r;try{let a;if("email"in e){const{email:n,password:r,options:s}=e;let o=null,i=null;"pkce"===this.flowType&&([o,i]=await ht(this.storage,this.storageKey)),a=await xt(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo,body:{email:n,password:r,data:null!==(t=null===s||void 0===s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},code_challenge:o,code_challenge_method:i},xform:wt})}else{if(!("phone"in e))throw new Fe("You must provide either an email or phone number and a password");{const{phone:t,password:s,options:o}=e;a=await xt(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:s,data:null!==(n=null===o||void 0===o?void 0:o.data)&&void 0!==n?n:{},channel:null!==(r=null===o||void 0===o?void 0:o.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null===o||void 0===o?void 0:o.captchaToken}},xform:wt})}}const{data:s,error:o}=a;if(o||!s)return{data:{user:null,session:null},error:o};const i=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",i)),{data:{user:l,session:i},error:null}}catch(a){if(Ie(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:r,options:a}=e;t=await xt(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:n,password:r,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:St})}else{if(!("phone"in e))throw new Fe("You must provide either an email or phone number and a password");{const{phone:n,password:r,options:a}=e;t=await xt(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:n,password:r,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:St})}}const{data:n,error:r}=t;return r?{data:{user:null,session:null},error:r}:n&&n.session&&n.user?(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:r}):{data:{user:null,session:null},error:new Le}}catch(t){if(Ie(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,r,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw new Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}async signInWithSolana(e){var t,n,r,a,s,o,i,l,c,d,u,h;let p,m;if("message"in e)p=e.message,m=e.signature;else{const{chain:u,wallet:h,statement:f,options:g}=e;let v;if(tt())if("object"===typeof h)v=h;else{const e=window;if(!("solana"in e)||"object"!==typeof e.solana||!("signIn"in e.solana&&"function"===typeof e.solana.signIn||"signMessage"in e.solana&&"function"===typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");v=e.solana}else{if("object"!==typeof h||!(null===g||void 0===g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=h}const y=new URL(null!==(t=null===g||void 0===g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in v&&v.signIn){const e=await v.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null===g||void 0===g?void 0:g.signInWithSolana),{version:"1",domain:y.host,uri:y.href}),f?{statement:f}:null));let t;if(Array.isArray(e)&&e[0]&&"object"===typeof e[0])t=e[0];else{if(!(e&&"object"===typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"===typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");p="string"===typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),m=t.signature}else{if(!("signMessage"in v)||"function"!==typeof v.signMessage||!("publicKey"in v)||"object"!==typeof v||!v.publicKey||!("toBase58"in v.publicKey)||"function"!==typeof v.publicKey.toBase58)throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=["".concat(y.host," wants you to sign in with your Solana account:"),v.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1","URI: ".concat(y.href),"Issued At: ".concat(null!==(r=null===(n=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===n?void 0:n.issuedAt)&&void 0!==r?r:(new Date).toISOString()),...(null===(a=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===a?void 0:a.notBefore)?["Not Before: ".concat(g.signInWithSolana.notBefore)]:[],...(null===(s=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===s?void 0:s.expirationTime)?["Expiration Time: ".concat(g.signInWithSolana.expirationTime)]:[],...(null===(o=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===o?void 0:o.chainId)?["Chain ID: ".concat(g.signInWithSolana.chainId)]:[],...(null===(i=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===i?void 0:i.nonce)?["Nonce: ".concat(g.signInWithSolana.nonce)]:[],...(null===(l=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?["Request ID: ".concat(g.signInWithSolana.requestId)]:[],...(null===(d=null===(c=null===g||void 0===g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===d?void 0:d.length)?["Resources",...g.signInWithSolana.resources.map(e=>"- ".concat(e))]:[]].join("\n");const e=await v.signMessage((new TextEncoder).encode(p),"utf8");if(!e||!(e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=e}}try{const{data:t,error:n}=await xt(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:et(m)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:wt});if(n)throw n;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:n}):{data:{user:null,session:null},error:new Le}}catch(f){if(Ie(f))return{data:{user:null,session:null},error:f};throw f}}async _exchangeCodeForSession(e){const t=await ot(this.storage,"".concat(this.storageKey,"-code-verifier")),[n,r]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:a}=await xt(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:wt});if(await it(this.storage,"".concat(this.storageKey,"-code-verifier")),a)throw a;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==r&&void 0!==r?r:null}),error:a}):{data:{user:null,session:null,redirectType:null},error:new Le}}catch(a){if(Ie(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:n,token:r,access_token:a,nonce:s}=e,o=await xt(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:n,id_token:r,access_token:a,nonce:s,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:wt}),{data:i,error:l}=o;return l?{data:{user:null,session:null},error:l}:i&&i.session&&i.user?(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:i,error:l}):{data:{user:null,session:null},error:new Le}}catch(t){if(Ie(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,r,a,s;try{if("email"in e){const{email:r,options:a}=e;let s=null,o=null;"pkce"===this.flowType&&([s,o]=await ht(this.storage,this.storageKey));const{error:i}=await xt(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:r,data:null!==(t=null===a||void 0===a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(n=null===a||void 0===a?void 0:a.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken},code_challenge:s,code_challenge_method:o},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:t,options:n}=e,{data:o,error:i}=await xt(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(r=null===n||void 0===n?void 0:n.data)&&void 0!==r?r:{},create_user:null===(a=null===n||void 0===n?void 0:n.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken},channel:null!==(s=null===n||void 0===n?void 0:n.channel)&&void 0!==s?s:"sms"}});return{data:{user:null,session:null,messageId:null===o||void 0===o?void 0:o.message_id},error:i}}throw new Fe("You must provide either an email or phone number.")}catch(o){if(Ie(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,n;try{let r,a;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:s,error:o}=await xt(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:wt});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const i=s.session,l=s.user;return(null===i||void 0===i?void 0:i.access_token)&&(await this._saveSession(i),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",i)),{data:{user:l,session:i},error:null}}catch(r){if(Ie(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,n,r;try{let a=null,s=null;return"pkce"===this.flowType&&([a,s]=await ht(this.storage,this.storageKey)),await xt(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==n?n:void 0}),(null===(r=null===e||void 0===e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:s}),headers:this.headers,xform:jt})}catch(a){if(Ie(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Me;const{error:r}=await xt(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(Ie(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:n,type:r,options:a}=e,{error:s}=await xt(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:r,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:s}}if("phone"in e){const{phone:n,type:r,options:a}=e,{data:s,error:o}=await xt(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:r,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null===s||void 0===s?void 0:s.message_id},error:o}}throw new Fe("You must provide either an email or phone number and a type")}catch(t){if(Ie(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch(e){}})()),n}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await ot(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=!!e.expires_at&&1e3*e.expires_at-Date.now()<Ce;if(this._debug("#__loadSession()","session has".concat(n?"":" not"," expired"),"expires_at",e.expires_at),!n){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,n,r)=>(t||"user"!==n||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,n,r))})}return{data:{session:e},error:null}}const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await xt(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:Nt}):await this._useSession(async e=>{var t,n,r;const{data:a,error:s}=e;if(s)throw s;return(null===(t=a.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await xt(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(r=null===(n=a.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0,xform:Nt}):{data:{user:null},error:new Me}})}catch(t){if(Ie(t))return function(e){return Ie(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await it(this.storage,"".concat(this.storageKey,"-code-verifier"))),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession(async n=>{const{data:r,error:a}=n;if(a)throw a;if(!r.session)throw new Me;const s=r.session;let o=null,i=null;"pkce"===this.flowType&&null!=e.email&&([o,i]=await ht(this.storage,this.storageKey));const{data:l,error:c}=await xt(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:i}),jwt:s.access_token,xform:Nt});if(c)throw c;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(Ie(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Me;const t=Date.now()/1e3;let n=t,r=!0,a=null;const{payload:s}=ct(e.access_token);if(s.exp&&(n=s.exp,r=n<=t),r){const{session:t,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{user:null,session:null},error:n};if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:r,error:s}=await this._getUser(e.access_token);if(s)throw s;a={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(Ie(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:r,error:a}=t;if(a)throw a;e=null!==(n=r.session)&&void 0!==n?n:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new Me;const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Ie(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!tt())throw new Be("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Be(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Ue("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Be("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ue("No code detected.");const{data:t,error:n}=await this._exchangeCodeForSession(e.code);if(n)throw n;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:r,access_token:a,refresh_token:s,expires_in:o,expires_at:i,token_type:l}=e;if(!a||!o||!s||!l)throw new Be("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(o);let u=c+d;i&&(u=parseInt(i));const h=u-c;1e3*h<=ke&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(h,"s, should have been closer to ").concat(d,"s"));const p=u-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,u,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,u,c);const{data:m,error:f}=await this._getUser(a);if(f)throw f;const g={provider_token:n,provider_refresh_token:r,access_token:a,expires_in:d,expires_at:u,refresh_token:s,token_type:l,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(n){if(Ie(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ot(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession(async t=>{var n;const{data:r,error:a}=t;if(a)return{error:a};const s=null===(n=r.session)||void 0===n?void 0:n.access_token;if(s){const{error:t}=await this.admin.signOut(s,e);if(t&&(!function(e){return Ie(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await it(this.storage,"".concat(this.storageKey,"-code-verifier"))),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,r;try{const{data:{session:r},error:a}=t;if(a)throw a;await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(a){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=null;"pkce"===this.flowType&&([n,r]=await ht(this.storage,this.storageKey,!0));try{return await xt(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:n,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(Ie(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:r}=await this._useSession(async t=>{var n,r,a,s,o;const{data:i,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:!0});return await xt(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(o=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==o?o:void 0})});if(r)throw r;return tt()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===n||void 0===n?void 0:n.url),{data:{provider:e.provider,url:null===n||void 0===n?void 0:n.url},error:null}}catch(n){if(Ie(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,r;const{data:a,error:s}=t;if(s)throw s;return await xt(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!==(r=null===(n=a.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0})})}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const a=Date.now();return await(n=async n=>(n>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await xt(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:wt})),r=(e,t)=>{const n=200*Math.pow(2,e);return t&&He(t)&&Date.now()+n-a<ke},new Promise((e,t)=>{(async()=>{for(let s=0;s<1/0;s++)try{const t=await n(s);if(!r(s,null,t))return void e(t)}catch(a){if(!r(s,a))return void t(a)}})()}))}catch(a){if(this._debug(t,"error",a),Ie(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}var n,r}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),tt()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await ot(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n))return this._debug(t,"session is not valid"),void(null!==n&&await this._removeSession());const r=1e3*(null!==(e=n.expires_at)&&void 0!==e?e:1/0)-Date.now()<Ce;if(this._debug(t,"session has".concat(r?"":" not"," expired with margin of ").concat(Ce,"s")),r){if(this.autoRefreshToken&&n.refresh_token){const{error:e}=await this._callRefreshToken(n.refresh_token);e&&(console.error(e),He(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){return this._debug(t,"error",n),void console.error(n)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Me;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(r,"begin");try{this.refreshingDeferred=new lt;const{data:t,error:n}=await this._refreshAccessToken(e);if(n)throw n;if(!t.session)throw new Me;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(a){if(this._debug(r,"error",a),Ie(a)){const e={session:null,error:a};return He(a)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r="#_notifyAllSubscribers(".concat(e,")");this._debug(r,"begin",t,"broadcast = ".concat(n));try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],a=Array.from(this.stateChangeEmitters.values()).map(async n=>{try{await n.callback(e,t)}catch(a){r.push(a)}});if(await Promise.all(a),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await st(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await it(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&tt()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ke);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*n.expires_at-t)/ke);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(r," ticks, a tick lasts ").concat(ke,"ms, refresh threshold is ").concat(3," ticks")),r<=3&&await this._callRefreshToken(n.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof Ot))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!tt()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const r=["provider=".concat(encodeURIComponent(t))];if((null===n||void 0===n?void 0:n.redirectTo)&&r.push("redirect_to=".concat(encodeURIComponent(n.redirectTo))),(null===n||void 0===n?void 0:n.scopes)&&r.push("scopes=".concat(encodeURIComponent(n.scopes))),"pkce"===this.flowType){const[e,t]=await ht(this.storage,this.storageKey),n=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});r.push(n.toString())}if(null===n||void 0===n?void 0:n.queryParams){const e=new URLSearchParams(n.queryParams);r.push(e.toString())}return(null===n||void 0===n?void 0:n.skipBrowserRedirect)&&r.push("skip_http_redirect=".concat(n.skipBrowserRedirect)),"".concat(e,"?").concat(r.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:r,error:a}=t;return a?{data:null,error:a}:await xt(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token})})}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,r;const{data:a,error:s}=t;if(s)return{data:null,error:s};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:i,error:l}=await xt(this.fetch,"POST","".concat(this.url,"/factors"),{body:o,headers:this.headers,jwt:null===(n=null===a||void 0===a?void 0:a.session)||void 0===n?void 0:n.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null===i||void 0===i?void 0:i.totp)||void 0===r?void 0:r.qr_code)&&(i.totp.qr_code="data:image/svg+xml;utf-8,".concat(i.totp.qr_code)),{data:i,error:null})})}catch(t){if(Ie(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:r,error:a}=t;if(a)return{data:null,error:a};const{data:s,error:o}=await xt(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(t){if(Ie(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:r,error:a}=t;return a?{data:null,error:a}:await xt(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:{channel:e.channel},headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token})})}catch(t){if(Ie(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(null===e||void 0===e?void 0:e.factors)||[],r=n.filter(e=>"totp"===e.factor_type&&"verified"===e.status),a=n.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:n,totp:r,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:r},error:a}=e;if(a)return{data:null,error:a};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=ct(r.access_token);let o=null;s.aal&&(o=s.aal);let i=o;(null!==(n=null===(t=r.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==n?n:[]).length>0&&(i="aal2");return{data:{currentLevel:o,nextLevel:i,currentAuthenticationMethods:s.amr||[]},error:null}}))}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find(t=>t.kid===e);if(t)return t;if(t=this.jwks.keys.find(t=>t.kid===e),t&&this.jwks_cached_at+6e5>Date.now())return t;const{data:n,error:r}=await xt(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(r)throw r;if(!n.keys||0===n.keys.length)throw new Ye("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),t=n.keys.find(t=>t.kid===e),!t)throw new Ye("No matching signing key found in JWKS");return t}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]};try{let n=e;if(!n){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};n=e.session.access_token}const{header:r,payload:a,signature:s,raw:{header:o,payload:i}}=ct(n);if(function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(a.exp),!r.kid||"HS256"===r.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:e}=await this.getUser(n);if(e)throw e;return{data:{claims:a,header:r,signature:s},error:null}}const l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),c=await this.fetchJwk(r.kid,t),d=await crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!await crypto.subtle.verify(l,d,s,function(e){const t=[];return Xe(e,e=>t.push(e)),new Uint8Array(t)}("".concat(o,".").concat(i))))throw new Ye("Invalid JWT signature");return{data:{claims:a,header:r,signature:s},error:null}}catch(n){if(Ie(n))return{data:null,error:n};throw n}}}Ft.nextInstanceID=0;const Bt=Ft;class Ut extends Bt{constructor(e){super(e)}}var zt=function(e,t,n,r){return new(n||(n=Promise))(function(a,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function i(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,i)}l((r=r.apply(e,t||[])).next())})};class Ht{constructor(e,t,n){var r,a,s;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=(i=e).endsWith("/")?i:i+"/";var i;const l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c="sb-".concat(l.hostname.split(".")[0],"-auth-token"),d=function(e,t){var n,r;const{db:a,auth:s,realtime:o,global:i}=e,{db:l,auth:c,realtime:d,global:u}=t,h={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},d),o),global:Object.assign(Object.assign(Object.assign({},u),i),{headers:Object.assign(Object.assign({},null!==(n=null===u||void 0===u?void 0:u.headers)&&void 0!==n?n:{}),null!==(r=null===i||void 0===i?void 0:i.headers)&&void 0!==r?r:{})}),accessToken:()=>Ne(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!==n&&void 0!==n?n:{},{db:ge,realtime:ye,auth:Object.assign(Object.assign({},ve),{storageKey:c}),global:fe});this.storageKey=null!==(r=d.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(a=d.global.headers)&&void 0!==a?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(s=d.auth)&&void 0!==s?s:{},this.headers,d.global.fetch),this.fetch=Se(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new u(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new c(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new pe(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,n)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return zt(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return null!==(t=null===(e=n.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null})}_initSupabaseAuthClient(e,t,n){let{autoRefreshToken:r,persistSession:a,detectSessionInUrl:s,storage:o,storageKey:i,flowType:l,lock:c,debug:d}=e;const u={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new Ut({url:this.authUrl.href,headers:Object.assign(Object.assign({},u),t),storageKey:i,autoRefreshToken:r,persistSession:a,detectSessionInUrl:s,storage:o,flowType:l,lock:c,debug:d,fetch:n,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new W(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)})}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=n}}const qt=(e,t,n)=>new Ht(e,t,n),Yt="https://yjllfmmzgnapsqfddbwt.supabase.co",Wt="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlqbGxmbW16Z25hcHNxZmRkYnd0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA5OTMyMzUsImV4cCI6MjA2NjU2OTIzNX0.jnTiQM7XgrgztqWmC9iRhp_GFEXk_VyRZooWKEIwR1M";console.log("\ud83d\udd27 Creating Supabase client with:",{url:Yt,keyExists:!0});const Vt=qt(Yt,Wt,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1},realtime:{params:{eventsPerSecond:10}},global:{headers:{"X-Client-Info":"case-booking-app@1.2.1"}}});console.log("\u2705 Supabase client created successfully");const Kt=qt(Yt,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB1cHBvZ2J4emtwcGRlc2p2aGV2Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MTQ3MDcxNiwiZXhwIjoyMDY3MDQ2NzE2fQ.FRN7Z5BP7YtQ3i974Ev1CJ0XtbSlYzlN11T5lu5KCgY",{auth:{autoRefreshToken:!1,persistSession:!1},global:{headers:{"X-Client-Info":"case-booking-app-admin@1.2.1"}}});console.log("\u2705 Supabase admin client created for lookup operations")},950:(e,t,n)=>{e.exports=n(49)}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var i=2&a&&r;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach(e=>o[e]=()=>r[e]);return o.default=()=>r,n.d(s,o),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r=n(950),a=n.t(r,2),s=n(352),o=n(717),i=n(414);const l=e=>{let{id:t,value:n,onChange:a,options:s,placeholder:o="Select an option",className:l="",required:c=!1,disabled:d=!1}=e;const[u,h]=(0,r.useState)(!1),[p,m]=(0,r.useState)(""),[f,g]=(0,r.useState)(-1),v=(0,r.useRef)(null),y=(0,r.useRef)(null),b=s.map(e=>"string"===typeof e?{value:e,label:e}:e),x=b.filter(e=>e.label.toLowerCase().includes(p.toLowerCase())||p.toLowerCase().split("").every(t=>e.label.toLowerCase().includes(t)));(0,r.useEffect)(()=>{const e=e=>{v.current&&!v.current.contains(e.target)&&(h(!1),m(""),g(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const w=e=>{var t;a(e.value),h(!1),m(""),g(-1),null===(t=y.current)||void 0===t||t.blur()},S=()=>{d||(h(!u),u||(m(""),g(-1)))},N=b.find(e=>e.value===n),j=N?N.label:"";return(0,i.jsxs)("div",{ref:v,className:"searchable-dropdown ".concat(l," ").concat(d?"disabled":""),children:[(0,i.jsxs)("div",{className:"dropdown-input-container",children:[(0,i.jsx)("input",{ref:y,id:t,type:"text",value:u?p:j,onChange:e=>{const t=e.target.value;m(t),h(!0),g(-1)},onClick:S,onKeyDown:e=>{var t;if(!d)switch(e.key){case"ArrowDown":e.preventDefault(),u?g(e=>e<x.length-1?e+1:0):h(!0);break;case"ArrowUp":e.preventDefault(),u&&g(e=>e>0?e-1:x.length-1);break;case"Enter":e.preventDefault(),u&&f>=0&&x[f]?w(x[f]):u||h(!0);break;case"Escape":h(!1),m(""),g(-1),null===(t=y.current)||void 0===t||t.blur();break;case"Tab":h(!1),m(""),g(-1)}},placeholder:o,className:"dropdown-input ".concat(n?"has-value":""),disabled:d,required:c,autoComplete:"off"}),(0,i.jsx)("button",{type:"button",className:"dropdown-arrow ".concat(u?"open":""),onClick:S,disabled:d,tabIndex:-1,children:(0,i.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor",children:(0,i.jsx)("path",{d:"M2 4l4 4 4-4",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),u&&!d&&(0,i.jsx)("div",{className:"dropdown-options",children:x.length>0?(0,i.jsxs)(i.Fragment,{children:[p&&(0,i.jsxs)("div",{className:"search-info",children:[x.length," result",1!==x.length?"s":""," found"]}),x.map((e,t)=>(0,i.jsx)("div",{className:"dropdown-option ".concat(t===f?"focused":""," ").concat(n===e.value?"selected":""),onClick:()=>w(e),onMouseEnter:()=>g(t),children:p?(0,i.jsx)("span",{dangerouslySetInnerHTML:{__html:e.label.replace(new RegExp("(".concat(p.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),")"),"gi"),"<mark>$1</mark>")}}):e.label},e.value))]}):(0,i.jsxs)("div",{className:"no-results",children:['No results found for "',p,'"']})})]})};var c=n(887),d=n(133);const u=(0,r.createContext)(void 0),h=e=>{let{children:t}=e;const[n,a]=(0,r.useState)(null),[s,o]=(0,r.useState)(!0),[l,h]=(0,r.useState)(null),[p,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{const{data:{session:e}}=await c.N.auth.getSession();if(null!==e&&void 0!==e&&e.user){const t=await d.Ay.userOperations.getById(e.user.id);t&&a(t)}}catch(e){console.error("Error checking session:",e),h("Failed to check authentication status")}finally{o(!1)}})();const{data:{subscription:e}}=c.N.auth.onAuthStateChange(async(e,t)=>{if("SIGNED_IN"===e&&null!==t&&void 0!==t&&t.user)try{const e=await d.Ay.userOperations.getById(t.user.id);e&&a(e)}catch(n){console.error("Error fetching user profile:",n)}else"SIGNED_OUT"===e&&a(null)});return()=>e.unsubscribe()},[]);const f={user:n,loading:s,error:l,login:async(e,t,n)=>{try{console.log("\ud83d\udd10 AuthContext: Starting login..."),o(!0),h(null);const r=await d.Ay.userOperations.authenticate(e,t,n);return console.log("\ud83d\udd0d AuthContext: Auth result:",r),r.user?(console.log("\u2705 AuthContext: Setting user in context"),console.log("\u2705 AuthContext: User object to set:",r.user),a(r.user),console.log("\u2705 AuthContext: User state updated, isAuthenticated should now be true"),{user:r.user}):(console.error("\u274c AuthContext: Login failed:",r.error),h(r.error||"Login failed"),{user:null,error:r.error})}catch(r){console.error("\u274c AuthContext: Exception during login:",r);const e="Login failed. Please try again.";return h(e),{user:null,error:e}}finally{console.log("\ud83d\udd10 AuthContext: Setting loading to false"),o(!1)}},logout:async()=>{if(p)console.log("\ud83d\udd04 AuthContext: Logout already in progress, skipping...");else try{console.log("\ud83d\udeaa AuthContext: Starting logout..."),m(!0),o(!0),console.log("\ud83e\uddea AuthContext: Using mock logout (skipping Supabase)..."),a(null),h(null),console.log("\u2705 AuthContext: User cleared from context")}catch(e){console.error("\u274c AuthContext: Error during logout:",e),h("Failed to sign out"),a(null)}finally{o(!1),m(!1),console.log("\ud83d\udeaa AuthContext: Logout complete")}},isAuthenticated:!!n};return(0,i.jsx)(u.Provider,{value:f,children:t})},p=()=>{const e=(0,r.useContext)(u);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},m=e=>{let{onLogin:t}=e;const{login:n}=p(),[a,s]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[u,h]=(0,r.useState)(""),[m,f]=(0,r.useState)(""),[g,v]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1),[x,w]=(0,r.useState)([]);(0,r.useEffect)(()=>{console.log("\ud83d\udcdd Login: availableCountries state changed:",x)},[x]);const[S,N]=(0,r.useState)(!1),j=(0,r.useRef)(null);(0,r.useEffect)(()=>{(async()=>{try{console.log("\ud83d\udcdd Login: Using fallback countries for login page"),console.log("\ud83d\udcdd Login: COUNTRIES array:",o.FS);const e=[...o.FS];console.log("\ud83d\udcdd Login: Setting available countries to:",e),w(e)}catch(m){console.error("Error loading countries:",m),w([...o.FS])}})();const e=localStorage.getItem("rememberedCredentials");if(console.log("\ud83d\udcdd Login: Checking saved credentials:",e),e)try{const{username:t,country:n}=JSON.parse(e);console.log("\ud83d\udcdd Login: Loaded saved credentials:",{username:t,country:n}),s(t||""),h(n||""),N(!0)}catch(m){console.error("Error loading saved credentials:",m),localStorage.removeItem("rememberedCredentials")}else console.log("\ud83d\udcdd Login: No saved credentials found")},[]),(0,r.useEffect)(()=>{j.current&&j.current.setCustomValidity(u?"":"Please select a country.")},[u]);return(0,i.jsx)("div",{className:"modern-login-container",children:(0,i.jsxs)("div",{className:"login-split-screen",children:[(0,i.jsx)("div",{className:"login-left",children:(0,i.jsxs)("div",{className:"login-branding",children:[(0,i.jsx)("div",{className:"brand-logo",children:(0,i.jsx)("img",{src:"https://www.transmedicgroup.com/wp-content/themes/transmedic/transmedic_assets/images/logo/logo-v5-transmedic-header-small.svg",alt:"Transmedic Logo",className:"logo-image"})}),(0,i.jsx)("h2",{className:"brand-subtitle",children:"Case Booking System"}),(0,i.jsx)("p",{className:"brand-description",children:"Streamline your medical case management with our comprehensive booking platform"}),(0,i.jsxs)("div",{className:"feature-list",children:[(0,i.jsxs)("div",{className:"feature-item",children:[(0,i.jsx)("span",{className:"feature-icon",children:"\ud83d\udccb"}),(0,i.jsx)("span",{children:"Easy Case Management"})]}),(0,i.jsxs)("div",{className:"feature-item",children:[(0,i.jsx)("span",{className:"feature-icon",children:"\u26a1"}),(0,i.jsx)("span",{children:"Real-time Updates"})]}),(0,i.jsxs)("div",{className:"feature-item",children:[(0,i.jsx)("span",{className:"feature-icon",children:"\ud83d\udd12"}),(0,i.jsx)("span",{children:"Secure & Reliable"})]})]})]})}),(0,i.jsx)("div",{className:"login-right",children:(0,i.jsxs)("div",{className:"login-form-container",children:[(0,i.jsxs)("div",{className:"form-header",children:[(0,i.jsx)("h3",{className:"welcome-title",children:"Welcome Back"}),(0,i.jsx)("p",{className:"welcome-subtitle",children:"Please sign in to your account"})]}),(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),v(!0),f(""),!u)return f("Please select a country"),void v(!1);if(!a)return f("Please enter your username"),void v(!1);if(!c)return f("Please enter your password"),void v(!1);try{console.log("\ud83d\udcdd Login: Attempting login with:",{username:a,country:u}),console.log("\ud83d\udcdd Login: About to call login function...");const e=await n(a,c,u);console.log("\ud83d\udcdd Login: Login result received:",e),e.user?(console.log("\ud83d\udcdd Login: Login successful, AuthContext should handle state automatically"),console.log("\ud83d\udcdd Login: User object:",e.user),S?localStorage.setItem("rememberedCredentials",JSON.stringify({username:a,country:u})):localStorage.removeItem("rememberedCredentials"),console.log("\ud83d\udcdd Login: Waiting for AuthContext to handle authentication state...")):(console.log("\ud83d\udcdd Login: Login failed:",e.error),f(e.error||"Login failed"))}catch(m){console.error("\ud83d\udcdd Login: Exception during login:",m),f("Login failed. Please try again.")}finally{console.log("\ud83d\udcdd Login: Setting loading to false"),v(!1)}},className:"modern-login-form",children:[(0,i.jsxs)("div",{className:"floating-input-group",children:[(0,i.jsx)("input",{type:"text",id:"username",value:a,onChange:e=>s(e.target.value),className:a?"has-value":"",disabled:g,autoComplete:"username"}),(0,i.jsx)("label",{htmlFor:"username",children:"Username"}),(0,i.jsx)("div",{className:"input-underline"})]}),(0,i.jsxs)("div",{className:"floating-input-group password-input-group",children:[(0,i.jsx)("input",{type:y?"text":"password",id:"password",value:c,onChange:e=>d(e.target.value),className:c?"has-value":"",disabled:g,autoComplete:"current-password"}),(0,i.jsx)("label",{htmlFor:"password",children:"Password"}),(0,i.jsx)("button",{type:"button",className:"btn btn-secondary btn-sm password-toggle",onClick:()=>b(!y),disabled:g,"aria-label":y?"Hide password":"Show password",children:y?"\ud83d\udc41\ufe0f":"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f"}),(0,i.jsx)("div",{className:"input-underline"})]}),(0,i.jsxs)("div",{className:"remember-me-container",children:[(0,i.jsxs)("div",{className:"toggle-container",children:[(0,i.jsx)("input",{type:"checkbox",id:"rememberMe",checked:S,onChange:e=>N(e.target.checked),disabled:g,className:"toggle-input"}),(0,i.jsx)("label",{htmlFor:"rememberMe",className:"toggle-label",children:(0,i.jsx)("span",{className:"toggle-slider"})})]}),(0,i.jsxs)("div",{className:"remember-text",children:[(0,i.jsx)("span",{className:"remember-main",children:"Remember me"}),(0,i.jsx)("span",{className:"remember-sub",children:"Save my username and country"})]})]}),(0,i.jsxs)("div",{className:"dropdown-input-group",children:[(0,i.jsx)("label",{htmlFor:"country",className:"dropdown-label required",children:"Country"}),(0,i.jsx)(l,{id:"country",options:x.map(e=>({value:e,label:e})),value:u,onChange:e=>h(e),placeholder:"Select Country",disabled:g,className:"login-dropdown"})]}),m&&(0,i.jsxs)("div",{className:"modern-error-message",children:[(0,i.jsx)("span",{className:"error-icon",children:"\u26a0\ufe0f"}),m]}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg full-width-button ".concat(g?"loading":""),disabled:g,children:g?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"button-spinner"}),(0,i.jsx)("span",{children:"Signing In..."})]}):"Sign In"})]})]})})]})})};var f=n(379);const g="case-booking-users",v="case-booking-session",y=()=>{const e=localStorage.getItem(g);if(e){return JSON.parse(e).map(e=>(0,f.A)((0,f.A)({},e),{},{countries:e.countries||[],departments:e.departments||(e.department?[e.department]:[])}))}const t=[{id:"1",username:"Admin",password:"Admin",role:"admin",name:"Administrator",departments:[],countries:[...o.FS]}];return localStorage.setItem(g,JSON.stringify(t)),t},b=()=>{const e=localStorage.getItem(v);return e?JSON.parse(e):null},x=e=>{if(!e)return"";if(e.includes(":")){const t=e.split(":");return t.length>1?t[1].trim():e}return e.trim()},w=(e,t)=>{if(!e||0===e.length)return!1;if(!t)return!1;const n=x(t);return e.some(e=>x(e)===n)},S=(e,t)=>!(!e||0===e.length)&&(!t||0===t.length||t.some(t=>w(e,t))),N=e=>{const t=(e=>{const t=localStorage.getItem("simplified_email_configs");if(!t)return null;try{return JSON.parse(t)[e]||null}catch(n){return console.error("Failed to parse email configs:",n),null}})(e);if(!t||!t.activeProvider)return null;const n=t.providers[t.activeProvider];return n&&n.isAuthenticated&&n.tokens?{provider:t.activeProvider,tokens:n.tokens,userInfo:n.userInfo}:null},j=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e;console.log("\ud83d\udd04 Applying template variables to:",e.substring(0,100)+"..."),console.log("\ud83d\udccb Case data:",{caseReference:t.caseReferenceNumber,hospital:t.hospital,submittedBy:t.submittedBy,dateOfSurgery:t.dateOfSurgery});const a=(0,f.A)({caseReferenceNumber:t.caseReferenceNumber||"N/A",hospital:t.hospital||"N/A",department:t.department||"N/A",dateOfSurgery:t.dateOfSurgery||"N/A",timeOfProcedure:t.timeOfProcedure||"N/A",procedureType:t.procedureType||"N/A",procedureName:t.procedureName||"N/A",doctorName:t.doctorName||"N/A",status:t.status||"N/A",submittedBy:t.submittedBy||"N/A",submittedAt:t.submittedAt?new Date(t.submittedAt).toLocaleDateString():"N/A",country:t.country||"N/A",specialInstruction:t.specialInstruction||"None",surgerySetSelection:Array.isArray(t.surgerySetSelection)?t.surgerySetSelection.join(", "):"N/A",implantBox:Array.isArray(t.implantBox)?t.implantBox.join(", "):"N/A",processOrderDetails:t.processOrderDetails||"N/A",caseReference:t.caseReferenceNumber||"N/A",date:t.dateOfSurgery||"N/A",submitter:t.submittedBy||"N/A",procedure:t.procedureName||"N/A",doctor:t.doctorName||"N/A",specialInstructions:t.specialInstruction||"None",processedBy:t.processedBy||"N/A",processedAt:t.processedAt?new Date(t.processedAt).toLocaleDateString():"N/A",orderSummary:t.orderSummary||"N/A",doNumber:t.doNumber||"N/A",currentDateTime:(new Date).toLocaleString(),deliveryDetails:t.deliveryDetails||"N/A",deliveryImage:t.deliveryImage||"N/A",attachments:Array.isArray(t.attachments)?t.attachments.join(", "):"N/A",amendedBy:t.amendedBy||"N/A",amendedAt:t.amendedAt?new Date(t.amendedAt).toLocaleDateString():"N/A",isAmended:t.isAmended?"Yes":"No"},n);return console.log("\ud83d\udd27 Available variables:",Object.keys(a)),Object.entries(a).forEach(t=>{let[n,a]=t;const s=new RegExp("{{".concat(n,"}}"),"g");e.match(s)&&console.log("\u2705 Replacing {{".concat(n,'}} with "').concat(a,'"')),r=r.replace(s,String(a))}),r=r.replace(/\n/g,"<br>"),console.log("\ud83d\udce7 Final template result:",r.substring(0,200)+"..."),r},k=e=>({"image/jpeg":"jpg","image/png":"png","image/gif":"gif","image/webp":"webp","application/pdf":"pdf","text/plain":"txt","application/msword":"doc","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"docx"}[e]||"bin"),C=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{var a;if(console.log("\ud83d\udd14 Attempting to send email notification:",{caseRef:e.caseReferenceNumber,status:t,country:e.country}),!(()=>{try{const e=localStorage.getItem("app-settings");return!e||!1!==JSON.parse(e).emailNotificationsEnabled}catch(e){return console.warn("Failed to check global email notification settings:",e),!0}})())return console.log("\ud83d\udcf5 Email notifications are globally disabled"),!1;console.log("\ud83d\udd0d DEBUG: Checking localStorage for notification matrix...");const i="email-matrix-configs-by-country",l=localStorage.getItem(i);if(console.log("\ud83d\udccb Stored matrix raw:",l?"Found":"Not found"),l)try{const t=JSON.parse(l);var s;if(console.log("\ud83d\udcca Available countries in matrix:",Object.keys(t)),t[e.country])console.log("\u2705 Matrix found for ".concat(e.country,", rules count:"),null===(s=t[e.country].rules)||void 0===s?void 0:s.length);else console.warn("\u274c No matrix found for ".concat(e.country,", available:"),Object.keys(t))}catch(o){console.error("\u274c Error parsing matrix:",o)}const c=(e=>{console.log('\ud83d\udd0d getNotificationMatrix called for country: "'.concat(e,'"'));const t=localStorage.getItem("email-matrix-configs-by-country");if(console.log("\ud83d\udccb Raw localStorage data:",t?"Found":"Not found"),!t)return console.warn("\u274c No stored notification matrix found in localStorage"),null;try{var n;const r=JSON.parse(t);console.log("\ud83d\udcca Available countries in matrix:",Object.keys(r));const a=r[e]||null;return console.log('\ud83c\udfaf Matrix for "'.concat(e,'":'),a?"Found with ".concat(null===(n=a.rules)||void 0===n?void 0:n.length," rules"):"Not found"),a}catch(r){return console.error("Failed to parse notification matrix configs:",r),null}})(e.country);if(!c)return console.warn("\u26a0\ufe0f No email notification matrix found for country:",e.country),console.warn("\ud83d\udca1 Solution: Visit Email Configuration page to initialize notification rules"),console.warn('\ud83d\udd0d Expected localStorage key: "email-matrix-configs-by-country"'),!1;console.log("\u2705 Notification matrix found for country:",e.country),console.log("\ud83d\udccb Total rules in matrix:",c.rules.length);const d=c.rules.find(e=>e.status===t);if(!d)return console.warn('\u274c No notification rule found for status: "'.concat(t,'"')),console.warn("\ud83d\udccb Available statuses in matrix:",c.rules.map(e=>e.status)),console.warn("\ud83d\udca1 Solution: Visit Email Configuration \u2192 Notification Rules and configure this status"),!1;const u=(e=>{const t=[];return e.status&&"string"===typeof e.status||t.push("Status is required and must be a string"),"boolean"!==typeof e.enabled&&t.push("Enabled flag must be a boolean"),e.recipients?(Array.isArray(e.recipients.roles)||t.push("Recipients roles must be an array"),Array.isArray(e.recipients.specificEmails)||t.push("Specific emails must be an array"),"boolean"!==typeof e.recipients.includeSubmitter&&t.push("Include submitter must be a boolean"),Array.isArray(e.recipients.departmentFilter)||t.push("Department filter must be an array"),"boolean"!==typeof e.recipients.requireSameDepartment&&t.push("Require same department must be a boolean"),void 0!==e.recipients.adminOverride&&"boolean"!==typeof e.recipients.adminOverride&&t.push("Admin override must be a boolean"),void 0!==e.recipients.adminGlobalAccess&&"boolean"!==typeof e.recipients.adminGlobalAccess&&t.push("Admin global access must be a boolean"),void 0!==e.recipients.legacyRoleMapping&&"object"!==typeof e.recipients.legacyRoleMapping&&t.push("Legacy role mapping must be an object")):t.push("Recipients configuration is required"),e.template?(e.template.subject&&"string"===typeof e.template.subject||t.push("Template subject is required and must be a string"),e.template.body&&"string"===typeof e.template.body||t.push("Template body is required and must be a string")):t.push("Template configuration is required"),{isValid:0===t.length,errors:t}})(d);if(!u.isValid)return console.error('\u274c Invalid notification rule configuration for status: "'.concat(t,'"')),console.error("\ud83d\udd0d Validation errors:",u.errors),console.error("\ud83d\udca1 Solution: Fix the notification rule configuration in Email Configuration"),!1;if(!d.enabled)return console.log('\ud83d\udcf5 Email notifications disabled for status: "'.concat(t,'"')),console.log("\ud83d\udca1 Enable this status in Email Configuration \u2192 Notification Rules"),!1;console.log('\u2705 Found enabled notification rule for: "'.concat(t,'"')),console.log("\ud83d\udc65 Configured roles:",d.recipients.roles),console.log("\ud83d\udce7 Specific emails:",d.recipients.specificEmails),console.log("\ud83d\udd04 Include submitter:",d.recipients.includeSubmitter);const h=N(e.country);if(!h)return console.warn("\ud83d\udd10 No authenticated email provider found for country:",e.country),!1;console.log("\ud83d\udea8 CRITICAL DEBUG: About to call getRecipientEmails"),console.log("\ud83d\udccb Status rule recipients config:",d.recipients);const p=((e,t)=>{const n=y(),r=[];if(console.log("\ud83d\udd0d Filtering recipients based on rules:"),console.log("   - Required roles:",e.roles),console.log("   - Case country:",t.country),console.log("   - Case department:",t.department),console.log("   - Department filter:",e.departmentFilter),console.log("   - Require same department:",e.requireSameDepartment),n.forEach(n=>{var a,s;console.log("\n\ud83d\udc64 Evaluating user: ".concat(n.name," (").concat(n.role,")")),console.log("   - Email: ".concat(n.email||"NOT SET")),console.log("   - Countries: [".concat((null===(a=n.countries)||void 0===a?void 0:a.join(", "))||"none","]")),console.log("   - Departments: [".concat((null===(s=n.departments)||void 0===s?void 0:s.join(", "))||"none","]"));let o=e.roles.includes(n.role);if(!o&&e.legacyRoleMapping){const t=e.legacyRoleMapping[n.role];t&&e.roles.includes(t)&&(o=!0,console.log('   \ud83d\udd04 LEGACY ROLE MAPPING: "'.concat(n.role,'" \u2192 "').concat(t,'"')))}if(!o&&"operation-manager"===n.role&&e.roles.includes("operations-manager")&&(o=!0,console.log('   \ud83d\udd04 FALLBACK LEGACY ROLE MATCH: "'.concat(n.role,'" \u2192 "operations-manager"'))),o){if(console.log("   \u2705 Role match: ".concat(n.role)),n.countries&&n.countries.includes(t.country)){if(console.log("   \u2705 Country access: ".concat(t.country)),e.departmentFilter.length>0){var i;if(!S(n.departments,e.departmentFilter))return console.log("   \u274c Department filter failed: user doesn't have access to [".concat(e.departmentFilter.join(", "),"]")),void console.log("   \ud83d\udd0d User departments: [".concat((null===(i=n.departments)||void 0===i?void 0:i.join(", "))||"none","]"));console.log("   \u2705 Department filter passed")}if(e.requireSameDepartment){var l;if(!w(n.departments,t.department))return console.log("   \u274c Same department requirement failed: user doesn't have access to \"".concat(t.department,'"')),void console.log("   \ud83d\udd0d User departments: [".concat((null===(l=n.departments)||void 0===l?void 0:l.join(", "))||"none","]"));console.log("   \u2705 Same department requirement passed")}n.email?(console.log("   \u2705 ADDED TO RECIPIENTS: ".concat(n.email)),r.push(n.email)):console.warn("   \u26a0\ufe0f User ".concat(n.name," (").concat(n.role,") has no email address configured"))}else console.log("   \u274c Country access denied: user doesn't have access to \"".concat(t.country,'"'));const a=!1!==e.adminOverride;"admin"===n.role&&n.email&&a&&(!n.countries||n.countries.includes(t.country)||!1!==e.adminGlobalAccess?0===e.departmentFilter.length||S(n.departments,e.departmentFilter)?r.includes(n.email)||(console.log("   \ud83d\udc51 ADMIN OVERRIDE: Added ".concat(n.email," (admin bypass enabled)")),r.push(n.email)):console.log("   \ud83d\udc51 Admin override available but blocked by department filter"):console.log("   \ud83d\udc51 Admin override disabled or country restricted"))}else console.log('   \u274c Role mismatch: "'.concat(n.role,'" not in [').concat(e.roles.join(", "),"]"))}),e.specificEmails&&e.specificEmails.length>0&&(console.log("\n\ud83d\udce7 Adding specific emails: [".concat(e.specificEmails.join(", "),"]")),r.push(...e.specificEmails)),e.includeSubmitter&&t.submittedBy){console.log("\n\ud83d\udc64 Checking submitter: ".concat(t.submittedBy));const e=n.find(e=>e.name===t.submittedBy);e&&e.email?(console.log("   \u2705 ADDED SUBMITTER: ".concat(e.email)),r.push(e.email)):console.log("   \u274c Submitter not found or has no email")}const a=Array.from(new Set(r));return console.log("\n\ud83d\udcca FINAL RECIPIENT SUMMARY:"),console.log("   - Total unique recipients: ".concat(a.length)),console.log("   - Recipients: [".concat(a.join(", "),"]")),0===a.length&&(console.warn("\n\u26a0\ufe0f WARNING: No recipients found!"),console.warn("   Check that users have:"),console.warn("   1. Correct roles: [".concat(e.roles.join(", "),"]")),console.warn("   2. Access to country: ".concat(t.country)),console.warn("   3. Email addresses configured"),console.warn("   4. Department access (if required)")),a})(d.recipients,e);if(console.log("\ud83d\udea8 CRITICAL DEBUG: getRecipientEmails returned:",p),0===p.length)return console.warn("\ud83d\udced No recipient emails found for rules:",d.recipients),!1;const m=j(d.template.subject,e,r),f=j(d.template.body,e,r),g=((e,t)=>{const n=[];try{if("Case Completed"===t&&e.attachments&&e.attachments.length>0&&e.attachments.forEach((e,t)=>{if(e.startsWith("data:")){const[r,a]=e.split(","),s=r.split(":")[1].split(";")[0];n.push({filename:"case_completion_".concat(t+1,".").concat(k(s)),content:a,contentType:s})}}),"Delivered (Hospital)"===t&&e.deliveryImage){const t=e.deliveryImage;if(t.startsWith("data:")){const[e,r]=t.split(","),a=e.split(":")[1].split(";")[0];n.push({filename:"delivery_confirmation.".concat(k(a)),content:r,contentType:a})}}console.log("\ud83d\udcce Prepared ".concat(n.length," email attachments for status: ").concat(t))}catch(r){console.error("\ud83d\udca5 Error preparing email attachments:",r)}return n})(e,t),{createOAuthManager:v}=await Promise.resolve().then(n.bind(n,324)),b=v(h.provider);return await b.sendEmail(h.tokens.accessToken,{to:p,subject:m,body:f,from:(null===(a=h.userInfo)||void 0===a?void 0:a.name)||"Case Booking System",attachments:g.length>0?g:void 0})?(console.log("\u2705 Email notification sent successfully:",{caseRef:e.caseReferenceNumber,status:t,recipients:p,provider:h.provider}),!0):(console.error("\u274c Failed to send email notification"),!1)}catch(i){return console.error("\ud83d\udca5 Error sending email notification:",i),!1}};var E=n(571);const _="case-booking-cases",D="case-booking-counter",A=async()=>{try{const{caseService:t}=await Promise.resolve().then(n.bind(n,166)),r=T();if(console.log("\ud83d\udd04 Found",r.length,"cases in localStorage to migrate"),0===r.length)return void console.log("\u2705 No cases to migrate");const a=[],s=[];for(const n of r)try{console.log("\ud83d\udd04 Migrating case:",n.caseReferenceNumber),await t.saveCase(n),a.push(n.caseReferenceNumber),console.log("\u2705 Migrated case:",n.caseReferenceNumber)}catch(e){s.push(n.caseReferenceNumber),console.error("\u274c Failed to migrate case:",n.caseReferenceNumber,e)}if(console.log("\ud83d\udcca Migration summary: ".concat(a.length," successful, ").concat(s.length," failed")),0===s.length)console.log("\ud83d\uddd1\ufe0f All cases migrated successfully, clearing localStorage"),localStorage.removeItem(_),localStorage.removeItem(D),console.log("\u2705 Migration completed successfully");else{console.warn("\u26a0\ufe0f Some cases failed to migrate, keeping localStorage data"),console.warn("\u274c Failed cases:",s);const e=r.filter(e=>!a.includes(e.caseReferenceNumber));e.length>0&&(localStorage.setItem(_,JSON.stringify(e)),console.log("\ud83d\udcdd Kept ".concat(e.length," failed cases in localStorage")))}}catch(e){console.error("\u274c Migration failed:",e)}},T=()=>{const e=localStorage.getItem(_);return e?JSON.parse(e):[]},I=(e,t,n,r)=>{const a=T(),s=a.findIndex(t=>t.id===e);if(s>=0){var o;const e=a[s],l=(new Date).toISOString();e.statusHistory||(e.statusHistory=[],e.statusHistory.push({status:"Case Booked",timestamp:e.submittedAt,processedBy:e.submittedBy,details:"Case initially submitted"}));const c={status:t,timestamp:l,processedBy:n||"System",details:r};if(e.statusHistory.push(c),e.status=t,n&&(e.processedBy=n,e.processedAt=l),r)try{const n=JSON.parse(r);"Delivered (Hospital)"===t&&void 0!==n.deliveryDetails?(e.deliveryDetails=n.deliveryDetails,e.deliveryImage=n.deliveryImage):"Case Completed"===t&&void 0!==n.attachments?(e.attachments=n.attachments,e.orderSummary=n.orderSummary,e.doNumber=n.doNumber):"Order Prepared"!==t&&"Order Preparation"!==t||(e.processOrderDetails=r)}catch(i){"Order Prepared"!==t&&"Order Preparation"!==t||(e.processOrderDetails=r)}a.splice(s,1),a.unshift(e),localStorage.setItem(_,JSON.stringify(a));const d=(null===(o=e.statusHistory[e.statusHistory.length-2])||void 0===o?void 0:o.status)||"Unknown";(async(e,t,n,r)=>C(e,t,{eventType:"Status Change",previousStatus:n,changedBy:r,changedAt:(new Date).toLocaleString()}))(e,t,d,n||"System").then(n=>{n?console.log("\u2705 Email notification sent for status change:",{caseRef:e.caseReferenceNumber,status:t,previousStatus:d}):console.warn("\u26a0\ufe0f Failed to send email notification for status change:",e.caseReferenceNumber)}).catch(e=>{console.error("\ud83d\udca5 Error sending status change email notification:",e)})}},O=(e,t)=>{t?localStorage.setItem("categorized-sets-".concat(t),JSON.stringify(e)):localStorage.setItem("categorized-sets",JSON.stringify(e))},P=async e=>(0,E.Uj)(async()=>{console.log("\u2699\ufe0f Getting categorized sets from Supabase for country:",e);const t=await d.V2.getProcedureTypes(e),n={};for(const a of t)try{const t=await d.V2.getProcedureMappings(a.name,e||"Singapore");(t.surgerySets.length>0||t.implantBoxes.length>0)&&(n[a.name]={surgerySets:t.surgerySets,implantBoxes:t.implantBoxes})}catch(r){console.warn("Failed to get mappings for ".concat(a.name,":"),r)}return n},{operation:"fetch categorized sets",showToUser:!0,fallbackMessage:"Unable to load surgery sets and implant boxes".concat(e?" for ".concat(e):"",". Please try again.")}),R="custom_procedure_types",M="hidden_procedure_types",L=e=>{try{const t=e?"".concat(R,"_").concat(e):R,n=localStorage.getItem(t);if(n)return JSON.parse(n);if(e){const t=localStorage.getItem(R);if(t){const n=JSON.parse(t);return F(n,e),n}}return[]}catch(t){return console.error("Error loading custom procedure types:",t),[]}},F=(e,t)=>{try{const n=t?"".concat(R,"_").concat(t):R;localStorage.setItem(n,JSON.stringify(e))}catch(n){console.error("Error saving custom procedure types:",n)}},B=e=>{try{const t=e?"".concat(M,"_").concat(e):M,n=localStorage.getItem(t);if(n)return JSON.parse(n);if(e){const t=localStorage.getItem(M);if(t){const n=JSON.parse(t);return U(n,e),n}}return[]}catch(t){return console.error("Error loading hidden procedure types:",t),[]}},U=(e,t)=>{try{const n=t?"".concat(M,"_").concat(t):M;localStorage.setItem(n,JSON.stringify(e))}catch(n){console.error("Error saving hidden procedure types:",n)}},z=async e=>(0,E.Uj)(async()=>{console.log("\ud83d\udd2c Getting procedure types from Supabase for country:",e);const t=await d.V2.getProcedureTypes(e);return 0===t.length?(console.warn("\u26a0\ufe0f No procedure types found".concat(e?" for ".concat(e):"",". This country may not be set up yet.")),[]):t.filter(e=>!e.is_hidden).map(e=>e.name).sort()},{operation:"fetch procedure types",showToUser:!0,fallbackMessage:"Unable to load procedure types".concat(e?" for ".concat(e):"",". Please try again.")});var H=n(166);const q=async e=>(0,E.Uj)(async()=>{console.log("\ud83d\udd0d Getting code tables from Supabase for country:",e);const t=await Y(e);if(0===t.length)throw new E.a$({message:"No code tables found".concat(e?" for country: ".concat(e):"",". Please contact your administrator to set up the system data.")},"fetch code tables",!0);return console.log("\u2705 Got code tables from Supabase:",t.length,"tables"),t},{operation:"fetch code tables",showToUser:!0,fallbackMessage:"Unable to load system configuration. Please check your connection and try again."}),Y=async e=>{const t=[];try{const n=await d.V2.getHospitals(e);n.length>0&&t.push({id:"hospitals",name:"Hospitals",description:"List of available hospitals",items:n.map(e=>e.name)});const r=await d.V2.getDepartments(e);r.length>0&&t.push({id:"departments",name:"Departments",description:"Medical departments",items:r.map(e=>e.name)});const a=await d.V2.getProcedureTypes(e);a.length>0&&t.push({id:"procedureTypes",name:"Procedure Types",description:"Available procedure types",items:a.map(e=>e.name)});const s=await d.V2.getSurgerySets(e);s.length>0&&t.push({id:"surgerySets",name:"Surgery Sets",description:"Available surgery sets",items:s.map(e=>e.name)});const o=await d.V2.getImplantBoxes(e);if(o.length>0&&t.push({id:"implantBoxes",name:"Implant Boxes",description:"Available implant boxes",items:o.map(e=>e.name)}),!e){const e=await d.V2.getCountries();e.length>0&&t.push({id:"countries",name:"Countries",description:"Supported countries",items:e.map(e=>e.name)})}return t}catch(n){return console.error("Error getting code tables from Supabase:",n),[]}},W=e=>[{id:"hospitals",name:"Hospitals",description:"List of available hospitals",items:ae(e)},{id:"departments",name:"Departments",description:"Medical departments",items:[...o.uy]},{id:"countries",name:"Countries",description:"Supported countries",items:[...o.FS]}],V=async e=>(0,E.Uj)(async()=>{console.log("\ud83d\udd0d Getting hospitals for country:",e);const t=await d.V2.getHospitals(e);return 0===t.length?(console.warn("\u26a0\ufe0f No hospitals found for ".concat(e,". This country may not be set up yet.")),[]):(console.log("\u2705 Got hospitals from Supabase:",t.map(e=>e.name)),t.map(e=>e.name))},{operation:"fetch hospitals",showToUser:!0,fallbackMessage:"Unable to load hospitals for ".concat(e,". Please try again.")}),K=async(e,t)=>(0,E.Uj)(async()=>{const n=(await d.V2.getDepartments(t)).map(e=>e.name);return e&&e.length>0?n.filter(t=>e.includes(t)):n},{operation:"fetch departments",showToUser:!0,fallbackMessage:"Unable to load departments".concat(t?" for ".concat(t):"",". Please try again.")}),G=async()=>(0,E.Uj)(async()=>{const e=await d.V2.getCountries();if(0===e.length)throw new E.a$({message:"No countries configured in the system. Please contact your administrator."},"fetch countries",!0);return e.map(e=>e.name)},{operation:"fetch countries",showToUser:!0,fallbackMessage:"Unable to load countries. Please try again."}),Q=async()=>(0,E.Uj)(async()=>{const e=await d.V2.getCountries(),t={};for(const r of e)try{const e=await d.V2.getDepartments(r.name);t[r.name]=e.map(e=>e.name)}catch(n){console.error("Error loading departments for ".concat(r.name,":"),n),t[r.name]=[]}return t},{operation:"fetch departments by country",showToUser:!1}),J=async e=>{const t=await Q(),n=new Set;return e.forEach(e=>{t[e]&&t[e].forEach(e=>n.add(e))}),Array.from(n).sort()},$=(e,t)=>"".concat(e,":").concat(t),X=e=>{if(e.includes(":")){const[t,n]=e.split(":",2);return{country:t,department:n}}return{country:"",department:e}},Z=e=>e.includes(":"),ee=async(e,t)=>{const n=new Set;for(const r of e)if(Z(r)){const{country:e,department:a}=X(r);t.includes(e)&&n.add(a)}else{(await J(t)).includes(r)&&n.add(r)}return Array.from(n).sort()},te=(e,t)=>{try{const n=t?"codeTables-".concat(t):"codeTables";localStorage.setItem(n,JSON.stringify(e))}catch(n){console.error("Error saving code tables to localStorage:",n)}},ne=()=>{const e=localStorage.getItem("codeTables");if(e)try{const t=JSON.parse(e).find(e=>"countries"===e.id),n=W().find(e=>"countries"===e.id);if(t&&n&&t.items.length<n.items.length){console.log("Detected corrupted countries table, resetting to defaults...");const e=W();te(e)}}catch(t){console.error("Error checking code tables, resetting to defaults:",t);const e=W();te(e)}else{const e=W();te(e)}},re=e=>{const t="codeTables-".concat(e),n=localStorage.getItem(t);if(n)try{const t=JSON.parse(n);if(!t.find(e=>"hospitals"===e.id)){console.log("Missing hospitals table for ".concat(e,", reinitializing..."));const t=W(e).filter(e=>"countries"!==e.id);te(t,e)}}catch(r){console.error("Error parsing country code tables for ".concat(e,", reinitializing:"),r);const t=W(e).filter(e=>"countries"!==e.id);te(t,e)}else{const t=W(e).filter(e=>"countries"!==e.id);te(t,e),console.log("Initialized country-specific code tables for ".concat(e))}},ae=e=>{switch(console.log("\ud83d\udd0d getDefaultHospitalsForCountry called with country:",e),e){case"Singapore":return console.log("\u2705 Matched Singapore case - returning Singapore hospitals"),["Singapore General Hospital","Mount Elizabeth Hospital","Raffles Hospital","National University Hospital","Changi General Hospital","Tan Tock Seng Hospital","KK Women's and Children's Hospital","Institute of Mental Health","National Cancer Centre Singapore","Singapore National Eye Centre"];case"Malaysia":return console.log("\u2705 Matched Malaysia case - returning Malaysia hospitals"),["Kuala Lumpur Hospital","University Malaya Medical Centre","Gleneagles Kuala Lumpur","Pantai Hospital Kuala Lumpur","Prince Court Medical Centre","Sunway Medical Centre","Hospital Sultanah Aminah","Penang General Hospital"];case"Philippines":return["Philippine General Hospital","St. Luke's Medical Center","The Medical City","Makati Medical Center","Asian Hospital and Medical Center","Cardinal Santos Medical Center","Jose Reyes Memorial Medical Center"];case"Indonesia":return["Cipto Mangunkusumo Hospital","Siloam Hospitals","RS Pondok Indah","Mayapada Hospital","MRCCC Siloam Hospitals Semanggi","Jakarta Heart Center","Rumah Sakit Premier Bintaro"];case"Vietnam":return["Cho Ray Hospital","Bach Mai Hospital","Vinmec Central Park","FV Hospital","University Medical Center HCMC","Gia Dinh People's Hospital","Columbia Asia Saigon"];case"Hong Kong":return["Queen Mary Hospital","Prince of Wales Hospital","Hong Kong Sanatorium & Hospital","Baptist Hospital","Gleneagles Hong Kong Hospital","Union Hospital","St. Paul's Hospital"];case"Thailand":return["Siriraj Hospital","Chulalongkorn Hospital","Bumrungrad International Hospital","Bangkok Hospital","Samitivej Hospital","BNH Hospital","Ramathibodi Hospital"];default:return console.log("\u26a0\ufe0f No match found - using default Singapore hospitals for country:",e),["Singapore General Hospital","Mount Elizabeth Hospital","Raffles Hospital","National University Hospital"]}},se=e=>{let{id:t,label:n,options:a,value:s,onChange:o,placeholder:l="Select options...",required:c=!1,className:d=""}=e;const[u,h]=(0,r.useState)(!1),[p,m]=(0,r.useState)(""),f=(0,r.useRef)(null),g=(0,r.useRef)(null);(0,r.useEffect)(()=>{const e=e=>{f.current&&!f.current.contains(e.target)&&(h(!1),m(""))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&u&&(h(!1),m(""))};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[u]),(0,r.useEffect)(()=>{u&&g.current&&g.current.focus()},[u]);const v=()=>{if(!p.trim())return[...a];const e=p.toLowerCase();return a.filter(t=>t.toLowerCase().includes(e)||e.split("").every((n,r)=>{const a=e.slice(r);return t.toLowerCase().includes(a.charAt(0))}))},y=(0,r.useMemo)(()=>0===s.length?l:1===s.length?s[0]:"".concat(s.length," items selected"),[s,l]);return(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:t,className:c?"required":"",children:n}),(0,i.jsxs)("div",{ref:f,className:"custom-multi-select ".concat(d),children:[(0,i.jsxs)("div",{className:"multi-select-trigger",onClick:()=>h(!u),tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),h(!u))},children:[(0,i.jsx)("span",{className:0===s.length?"placeholder":"selected-text",children:y}),(0,i.jsx)("span",{className:"dropdown-arrow ".concat(u?"open":""),children:"\u25bc"})]}),u&&(0,i.jsxs)("div",{className:"multi-select-dropdown-content",children:[(0,i.jsxs)("div",{className:"dropdown-header",children:[(0,i.jsx)("input",{ref:g,type:"text",className:"search-input",placeholder:"Search options...",value:p,onChange:e=>m(e.target.value),onClick:e=>e.stopPropagation()}),(0,i.jsx)("button",{type:"button",className:"btn btn-outline-secondary btn-sm select-all-btn",onClick:()=>{const e=v();if(e.every(e=>s.includes(e))){const t=s.filter(t=>!e.includes(t));o(t)}else{const t=Array.from(new Set([...s,...e]));o(t)}},children:v().every(e=>s.includes(e))?"Deselect All":"Select All"})]}),(0,i.jsxs)("div",{className:"options-container",children:[v().map(e=>(0,i.jsxs)("label",{className:"multi-select-option",children:[(0,i.jsx)("input",{type:"checkbox",checked:s.includes(e),onChange:()=>(e=>{const t=s.includes(e)?s.filter(t=>t!==e):[...s,e];o(t)})(e)}),(0,i.jsx)("span",{className:"checkmark"}),(0,i.jsx)("span",{className:"option-text",children:e})]},e)),0===v().length&&(0,i.jsx)("div",{className:"no-options",children:"No options found"})]})]})]})]})},oe=(0,r.memo)(se),ie=e=>{let{id:t,value:n,onChange:a,className:s="",disabled:o=!1,placeholder:l="Select time","aria-describedby":c,required:d=!1,step:u=15}=e;const[h,p]=(0,r.useState)(!1),[m,f]=(0,r.useState)(""),g=(0,r.useRef)(null),v=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(n){const[e,t]=n.split(":").map(Number);if(!isNaN(e)&&!isNaN(t)){const n=new Date;n.setHours(e,t),f(n.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}))}}else f("")},[n]),(0,r.useEffect)(()=>{const e=e=>{g.current&&!g.current.contains(e.target)&&p(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,r.useEffect)(()=>{const e=e=>{var t;"Escape"===e.key&&h&&(p(!1),null===(t=v.current)||void 0===t||t.focus())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[h]);const y=e=>{a(e),p(!1)},b=(()=>{const e=[];for(let t=0;t<24;t++)for(let n=0;n<60;n+=u){const r="".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0")),a=new Date;a.setHours(t,n);const s=a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});e.push({value:r,display:s})}return e})();return(0,i.jsxs)("div",{className:"time-picker-container ".concat(s),ref:g,children:[(0,i.jsxs)("div",{className:"time-picker-input ".concat(o?"disabled":""," ").concat(h?"open":""),onClick:()=>{o||p(!h)},children:[(0,i.jsx)("input",{ref:v,id:t,type:"text",value:m,placeholder:l,readOnly:!0,disabled:o,className:"time-display-input","aria-describedby":c,required:d,"aria-expanded":h,"aria-haspopup":"listbox","aria-controls":"time-options-list",role:"combobox"}),(0,i.jsxs)("div",{className:"time-picker-icons",children:[n&&!o&&(0,i.jsx)("button",{type:"button",className:"time-clear-button",onClick:e=>{e.stopPropagation(),a(""),p(!1)},"aria-label":"Clear time",children:"\u2715"}),(0,i.jsx)("span",{className:"time-picker-icon",children:"\ud83d\udd50"})]})]}),h&&(0,i.jsxs)("div",{className:"time-picker-dropdown",children:[(0,i.jsxs)("div",{className:"time-picker-header",children:[(0,i.jsx)("h4",{children:"Select Time"}),(0,i.jsx)("button",{type:"button",className:"time-picker-close",onClick:()=>p(!1),"aria-label":"Close time picker",children:"\u2715"})]}),(0,i.jsxs)("div",{className:"time-input-section",children:[(0,i.jsx)("label",{htmlFor:"".concat(t,"-native"),children:"Enter specific time:"}),(0,i.jsx)("input",{id:"".concat(t,"-native"),type:"time",value:n,onChange:e=>{const t=e.target.value;a(t),p(!1)},className:"native-time-input"})]}),(0,i.jsxs)("div",{className:"time-shortcuts-section",children:[(0,i.jsx)("h5",{children:"Common Procedure Times:"}),(0,i.jsx)("div",{className:"time-shortcuts",children:[{value:"08:00",display:"8:00 AM"},{value:"09:00",display:"9:00 AM"},{value:"10:00",display:"10:00 AM"},{value:"11:00",display:"11:00 AM"},{value:"13:00",display:"1:00 PM"},{value:"14:00",display:"2:00 PM"},{value:"15:00",display:"3:00 PM"},{value:"16:00",display:"4:00 PM"}].map(e=>(0,i.jsx)("button",{type:"button",onClick:()=>y(e.value),className:"time-shortcut-button ".concat(n===e.value?"selected":""),children:e.display},e.value))})]}),(0,i.jsxs)("div",{className:"time-options-section",children:[(0,i.jsx)("h5",{children:"All Times:"}),(0,i.jsx)("div",{className:"time-options-list",id:"time-options-list",children:b.map(e=>(0,i.jsx)("button",{type:"button",onClick:()=>y(e.value),className:"time-option-button ".concat(n===e.value?"selected":""),children:e.display},e.value))})]})]})]})},le=e=>{let{isOpen:t,onClose:n,title:a,message:s,type:o="alert",actions:l,autoClose:c=!1,autoCloseDelay:d=3e3}=e;if(r.useEffect(()=>{if(t&&c){const e=setTimeout(()=>{n()},d);return()=>clearTimeout(e)}},[t,c,d,n]),r.useEffect(()=>{const e=e=>{"Escape"===e.key&&t&&n()};return t&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,n]),!t)return null;const u=l||("confirm"===o?[{label:"Cancel",onClick:n,style:"secondary"},{label:"Confirm",onClick:()=>{n()},style:"danger"}]:[{label:"OK",onClick:n,style:"primary"}]);return(0,i.jsx)("div",{className:"custom-modal-overlay",onClick:n,children:(0,i.jsxs)("div",{className:"custom-modal custom-modal-".concat(o),onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"custom-modal-header",children:[(0,i.jsx)("div",{className:"custom-modal-icon",children:(()=>{switch(o){case"success":return"\u2705";case"error":return"\u274c";case"warning":return"\u26a0\ufe0f";case"confirm":return"\u2753";case"info":return"\u2139\ufe0f";default:return"\ud83d\udcac"}})()}),(0,i.jsx)("h3",{className:"custom-modal-title",children:a}),(0,i.jsx)("button",{className:"custom-modal-close",onClick:n,"aria-label":"Close modal",children:"\xd7"})]}),(0,i.jsx)("div",{className:"custom-modal-body",children:(0,i.jsx)("p",{className:"custom-modal-message",children:s})}),(0,i.jsx)("div",{className:"custom-modal-footer",children:u.map((e,t)=>(0,i.jsx)("button",{className:"custom-modal-btn custom-modal-btn-".concat(e.style||"primary"),onClick:e.onClick,children:e.label},t))})]})})},ce={isOpen:!1,title:"",message:"",type:"alert",onConfirm:void 0,autoClose:!1,autoCloseDelay:3e3},de=()=>{const[e,t]=(0,r.useState)(ce),n=(0,r.useCallback)(()=>{t(ce)},[]),a=(0,r.useCallback)(function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info";t({isOpen:!0,title:e,message:n,type:r,autoClose:"success"===r,autoCloseDelay:3e3})},[]),s=(0,r.useCallback)((e,r,a)=>{t({isOpen:!0,title:e,message:r,type:"confirm",onConfirm:()=>{a(),n()},autoClose:!1})},[n]),o=(0,r.useCallback)(e=>{a("Alert",e,"info")},[a]),i=(0,r.useCallback)(e=>new Promise(r=>{t({isOpen:!0,title:"Confirm",message:e,type:"confirm",onConfirm:()=>{r(!0),n()},autoClose:!1});const a=n;t(e=>(0,f.A)((0,f.A)({},e),{},{onConfirm:()=>{r(!0),a()}}))}),[n]),l=(0,r.useCallback)(function(e){a(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Success",e,"success")},[a]),c=(0,r.useCallback)(function(e){a(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Error",e,"error")},[a]),d=(0,r.useCallback)(function(e){a(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Warning",e,"warning")},[a]),u=(0,r.useCallback)(function(e){a(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Information",e,"info")},[a]);return{modal:e,closeModal:n,showAlert:a,showConfirm:s,alert:o,confirm:i,showSuccess:l,showError:c,showWarning:d,showInfo:u}};function ue(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=ue(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function he(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=ue(e))&&(r&&(r+=" "),r+=t);return r}Math.pow(10,8);const pe=6048e5,me=6e4,fe=36e5,ge=Symbol.for("constructDateFrom");function ve(e,t){return"function"===typeof e?e(t):e&&"object"===typeof e&&ge in e?e[ge](t):e instanceof Date?new e.constructor(t):new Date(t)}function ye(e,t){return ve(t||e,e)}function be(e,t){var n;const r=()=>ve(null===t||void 0===t?void 0:t.in,NaN),a=null!==(n=null===t||void 0===t?void 0:t.additionalDigits)&&void 0!==n?n:2,s=function(e){const t={},n=e.split(xe.dateTimeDelimiter);let r;if(n.length>2)return t;/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],xe.timeZoneDelimiter.test(t.date)&&(t.date=e.split(xe.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length)));if(r){const e=xe.timezone.exec(r);e?(t.time=r.replace(e[1],""),t.timezone=e[1]):t.time=r}return t}(e);let o;if(s.date){const e=function(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,s=r[2]?parseInt(r[2]):null;return{year:null===s?a:100*s,restDateString:e.slice((r[1]||r[2]).length)}}(s.date,a);o=function(e,t){if(null===t)return new Date(NaN);const n=e.match(we);if(!n)return new Date(NaN);const r=!!n[4],a=je(n[1]),s=je(n[2])-1,o=je(n[3]),i=je(n[4]),l=je(n[5])-1;if(r)return function(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}(0,i,l)?function(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const a=r.getUTCDay()||7,s=7*(t-1)+n+1-a;return r.setUTCDate(r.getUTCDate()+s),r}(t,i,l):new Date(NaN);{const e=new Date(0);return function(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(Ce[t]||(Ee(e)?29:28))}(t,s,o)&&function(e,t){return t>=1&&t<=(Ee(e)?366:365)}(t,a)?(e.setUTCFullYear(t,s,Math.max(a,o)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!o||isNaN(+o))return r();const i=+o;let l,c=0;if(s.time&&(c=function(e){const t=e.match(Se);if(!t)return NaN;const n=ke(t[1]),r=ke(t[2]),a=ke(t[3]);if(!function(e,t,n){if(24===e)return 0===t&&0===n;return n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}(n,r,a))return NaN;return n*fe+r*me+1e3*a}(s.time),isNaN(c)))return r();if(!s.timezone){const e=new Date(i+c),n=ye(0,null===t||void 0===t?void 0:t.in);return n.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),n.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),n}return l=function(e){if("Z"===e)return 0;const t=e.match(Ne);if(!t)return 0;const n="+"===t[1]?-1:1,r=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;if(!function(e,t){return t>=0&&t<=59}(0,a))return NaN;return n*(r*fe+a*me)}(s.timezone),isNaN(l)?r():ye(i+c+l,null===t||void 0===t?void 0:t.in)}const xe={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},we=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Se=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Ne=/^([+-])(\d{2})(?::?(\d{2}))?$/;function je(e){return e?parseInt(e):1}function ke(e){return e&&parseFloat(e.replace(",","."))||0}const Ce=[31,null,31,30,31,30,31,31,30,31,30,31];function Ee(e){return e%400===0||e%4===0&&e%100!==0}const _e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function De(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const Ae={date:De({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:De({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:De({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Te={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Ie(e){return(t,n)=>{let r;if("formatting"===(null!==n&&void 0!==n&&n.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,a=null!==n&&void 0!==n&&n.width?String(n.width):t;r=e.formattingValues[a]||e.formattingValues[t]}else{const t=e.defaultWidth,a=null!==n&&void 0!==n&&n.width?String(n.width):e.defaultWidth;r=e.values[a]||e.values[t]}return r[e.argumentCallback?e.argumentCallback(t):t]}}const Oe={ordinalNumber:(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:Ie({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Ie({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ie({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Ie({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Ie({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function Pe(e){return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=t.match(a);if(!s)return null;const o=s[0],i=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(i)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(i,e=>e.test(o)):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(i,e=>e.test(o));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;return{value:c,rest:t.slice(o.length)}}}const Re={ordinalNumber:(Me={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.match(Me.matchPattern);if(!n)return null;const r=n[0],a=e.match(Me.parsePattern);if(!a)return null;let s=Me.valueCallback?Me.valueCallback(a[0]):a[0];return s=t.valueCallback?t.valueCallback(s):s,{value:s,rest:e.slice(r.length)}}),era:Pe({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:Pe({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:Pe({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:Pe({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:Pe({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};var Me;const Le={code:"en-US",formatDistance:(e,t,n)=>{let r;const a=_e[e];return r="string"===typeof a?a:1===t?a.one:a.other.replace("{{count}}",t.toString()),null!==n&&void 0!==n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},formatLong:Ae,formatRelative:(e,t,n,r)=>Te[e],localize:Oe,match:Re,options:{weekStartsOn:0,firstWeekContainsDate:1}},Fe=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},Be=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Ue={p:Be,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return Fe(e,t);let s;switch(r){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;default:s=t.dateTime({width:"full"})}return s.replace("{{date}}",Fe(r,t)).replace("{{time}}",Be(a,t))}},ze=/^D+$/,He=/^Y+$/,qe=["D","DD","YY","YYYY"];function Ye(e){return ze.test(e)}function We(e){return He.test(e)}function Ve(e,t,n){const r=function(e,t,n){const r="Y"===e[0]?"years":"days of the month";return"Use `".concat(e.toLowerCase(),"` instead of `").concat(e,"` (in `").concat(t,"`) for formatting ").concat(r," to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md")}(e,t,n);if(console.warn(r),qe.includes(e))throw new RangeError(r)}let Ke={};function Ge(){return Ke}function Qe(){return Object.assign({},Ge())}var Je=n(705);function $e(e,t){const n=function(e){var t;return"function"===typeof e&&(null===(t=e.prototype)||void 0===t?void 0:t.constructor)===e}(t)?new t(0):ve(t,0);return n.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),n.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),n}class Xe{constructor(){(0,Je.A)(this,"subPriority",0)}validate(e,t){return!0}}class Ze extends Xe{constructor(e,t,n,r,a){super(),this.value=e,this.validateValue=t,this.setValue=n,this.priority=r,a&&(this.subPriority=a)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,n){return this.setValue(e,t,this.value,n)}}class et extends Xe{constructor(e,t){super(),(0,Je.A)(this,"priority",10),(0,Je.A)(this,"subPriority",-1),this.context=e||(e=>ve(t,e))}set(e,t){return t.timestampIsSet?e:ve(e,$e(e,this.context))}}class tt{run(e,t,n,r){const a=this.parse(e,t,n,r);return a?{setter:new Ze(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}validate(e,t,n){return!0}}const nt=/^(1[0-2]|0?\d)/,rt=/^(3[0-1]|[0-2]?\d)/,at=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,st=/^(5[0-3]|[0-4]?\d)/,ot=/^(2[0-3]|[0-1]?\d)/,it=/^(2[0-4]|[0-1]?\d)/,lt=/^(1[0-1]|0?\d)/,ct=/^(1[0-2]|0?\d)/,dt=/^[0-5]?\d/,ut=/^[0-5]?\d/,ht=/^\d/,pt=/^\d{1,2}/,mt=/^\d{1,3}/,ft=/^\d{1,4}/,gt=/^-?\d+/,vt=/^-?\d/,yt=/^-?\d{1,2}/,bt=/^-?\d{1,3}/,xt=/^-?\d{1,4}/,wt=/^([+-])(\d{2})(\d{2})?|Z/,St=/^([+-])(\d{2})(\d{2})|Z/,Nt=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,jt=/^([+-])(\d{2}):(\d{2})|Z/,kt=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function Ct(e,t){return e?{value:t(e.value),rest:e.rest}:e}function Et(e,t){const n=t.match(e);return n?{value:parseInt(n[0],10),rest:t.slice(n[0].length)}:null}function _t(e,t){const n=t.match(e);if(!n)return null;if("Z"===n[0])return{value:0,rest:t.slice(1)};const r="+"===n[1]?1:-1,a=n[2]?parseInt(n[2],10):0,s=n[3]?parseInt(n[3],10):0,o=n[5]?parseInt(n[5],10):0;return{value:r*(a*fe+s*me+1e3*o),rest:t.slice(n[0].length)}}function Dt(e){return Et(gt,e)}function At(e,t){switch(e){case 1:return Et(ht,t);case 2:return Et(pt,t);case 3:return Et(mt,t);case 4:return Et(ft,t);default:return Et(new RegExp("^\\d{1,"+e+"}"),t)}}function Tt(e,t){switch(e){case 1:return Et(vt,t);case 2:return Et(yt,t);case 3:return Et(bt,t);case 4:return Et(xt,t);default:return Et(new RegExp("^-?\\d{1,"+e+"}"),t)}}function It(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function Ot(e,t){const n=t>0,r=n?t:1-t;let a;if(r<=50)a=e||100;else{const t=r+50;a=e+100*Math.trunc(t/100)-(e>=t%100?100:0)}return n?a:1-a}function Pt(e){return e%400===0||e%4===0&&e%100!==0}function Rt(e,t){var n,r,a,s,o,i;const l=Ge(),c=null!==(n=null!==(r=null!==(a=null!==(s=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==s?s:null===t||void 0===t||null===(o=t.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==a?a:l.weekStartsOn)&&void 0!==r?r:null===(i=l.locale)||void 0===i||null===(i=i.options)||void 0===i?void 0:i.weekStartsOn)&&void 0!==n?n:0,d=ye(e,null===t||void 0===t?void 0:t.in),u=d.getDay(),h=(u<c?7:0)+u-c;return d.setDate(d.getDate()-h),d.setHours(0,0,0,0),d}function Mt(e,t){var n,r,a,s,o,i;const l=ye(e,null===t||void 0===t?void 0:t.in),c=l.getFullYear(),d=Ge(),u=null!==(n=null!==(r=null!==(a=null!==(s=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==s?s:null===t||void 0===t||null===(o=t.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==a?a:d.firstWeekContainsDate)&&void 0!==r?r:null===(i=d.locale)||void 0===i||null===(i=i.options)||void 0===i?void 0:i.firstWeekContainsDate)&&void 0!==n?n:1,h=ve((null===t||void 0===t?void 0:t.in)||e,0);h.setFullYear(c+1,0,u),h.setHours(0,0,0,0);const p=Rt(h,t),m=ve((null===t||void 0===t?void 0:t.in)||e,0);m.setFullYear(c,0,u),m.setHours(0,0,0,0);const f=Rt(m,t);return+l>=+p?c+1:+l>=+f?c:c-1}function Lt(e,t){return Rt(e,(0,f.A)((0,f.A)({},t),{},{weekStartsOn:1}))}function Ft(e,t){var n,r,a,s,o,i;const l=Ge(),c=null!==(n=null!==(r=null!==(a=null!==(s=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==s?s:null===t||void 0===t||null===(o=t.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==a?a:l.firstWeekContainsDate)&&void 0!==r?r:null===(i=l.locale)||void 0===i||null===(i=i.options)||void 0===i?void 0:i.firstWeekContainsDate)&&void 0!==n?n:1,d=Mt(e,t),u=ve((null===t||void 0===t?void 0:t.in)||e,0);u.setFullYear(d,0,c),u.setHours(0,0,0,0);return Rt(u,t)}function Bt(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in),r=+Rt(n,t)-+Ft(n,t);return Math.round(r/pe)+1}function Ut(e,t,n){const r=ye(e,null===n||void 0===n?void 0:n.in),a=Bt(r,n)-t;return r.setDate(r.getDate()-7*a),ye(r,null===n||void 0===n?void 0:n.in)}function zt(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in),r=n.getFullYear(),a=ve(n,0);a.setFullYear(r+1,0,4),a.setHours(0,0,0,0);const s=Lt(a),o=ve(n,0);o.setFullYear(r,0,4),o.setHours(0,0,0,0);const i=Lt(o);return n.getTime()>=s.getTime()?r+1:n.getTime()>=i.getTime()?r:r-1}function Ht(e,t){const n=zt(e,t),r=ve((null===t||void 0===t?void 0:t.in)||e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Lt(r)}function qt(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in),r=+Lt(n)-+Ht(n);return Math.round(r/pe)+1}function Yt(e,t,n){const r=ye(e,null===n||void 0===n?void 0:n.in),a=qt(r,n)-t;return r.setDate(r.getDate()-7*a),r}const Wt=[31,28,31,30,31,30,31,31,30,31,30,31],Vt=[31,29,31,30,31,30,31,31,30,31,30,31];function Kt(e,t,n){const r=ye(e,null===n||void 0===n?void 0:n.in);return isNaN(t)?ve((null===n||void 0===n?void 0:n.in)||e,NaN):t?(r.setDate(r.getDate()+t),r):r}function Gt(e,t,n){var r,a,s,o,i,l;const c=Ge(),d=null!==(r=null!==(a=null!==(s=null!==(o=null===n||void 0===n?void 0:n.weekStartsOn)&&void 0!==o?o:null===n||void 0===n||null===(i=n.locale)||void 0===i||null===(i=i.options)||void 0===i?void 0:i.weekStartsOn)&&void 0!==s?s:c.weekStartsOn)&&void 0!==a?a:null===(l=c.locale)||void 0===l||null===(l=l.options)||void 0===l?void 0:l.weekStartsOn)&&void 0!==r?r:0,u=ye(e,null===n||void 0===n?void 0:n.in),h=u.getDay(),p=7-d;return Kt(u,t<0||t>6?t-(h+p)%7:((t%7+7)%7+p)%7-(h+p)%7,n)}function Qt(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in).getDay();return 0===n?7:n}function Jt(e,t,n){const r=ye(e,null===n||void 0===n?void 0:n.in);return Kt(r,t-Qt(r,n),n)}function $t(e){const t=ye(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}const Xt={G:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",140),(0,Je.A)(this,"incompatibleTokens",["R","u","t","T"])}parse(e,t,n){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}}set(e,t,n){return t.era=n,e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}},y:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",130),(0,Je.A)(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(e,t,n){const r=e=>({year:e,isTwoDigitYear:"yy"===t});switch(t){case"y":return Ct(At(4,e),r);case"yo":return Ct(n.ordinalNumber(e,{unit:"year"}),r);default:return Ct(At(t.length,e),r)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,n){const r=e.getFullYear();if(n.isTwoDigitYear){const t=Ot(n.year,r);return e.setFullYear(t,0,1),e.setHours(0,0,0,0),e}const a="era"in t&&1!==t.era?1-n.year:n.year;return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}},Y:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",130),(0,Je.A)(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(e,t,n){const r=e=>({year:e,isTwoDigitYear:"YY"===t});switch(t){case"Y":return Ct(At(4,e),r);case"Yo":return Ct(n.ordinalNumber(e,{unit:"year"}),r);default:return Ct(At(t.length,e),r)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,n,r){const a=Mt(e,r);if(n.isTwoDigitYear){const t=Ot(n.year,a);return e.setFullYear(t,0,r.firstWeekContainsDate),e.setHours(0,0,0,0),Rt(e,r)}const s="era"in t&&1!==t.era?1-n.year:n.year;return e.setFullYear(s,0,r.firstWeekContainsDate),e.setHours(0,0,0,0),Rt(e,r)}},R:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",130),(0,Je.A)(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(e,t){return Tt("R"===t?4:t.length,e)}set(e,t,n){const r=ve(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Lt(r)}},u:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",130),(0,Je.A)(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(e,t){return Tt("u"===t?4:t.length,e)}set(e,t,n){return e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}},Q:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",120),(0,Je.A)(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(e,t,n){switch(t){case"Q":case"QQ":return At(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,n){return e.setMonth(3*(n-1),1),e.setHours(0,0,0,0),e}},q:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",120),(0,Je.A)(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(e,t,n){switch(t){case"q":case"qq":return At(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,n){return e.setMonth(3*(n-1),1),e.setHours(0,0,0,0),e}},M:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),(0,Je.A)(this,"priority",110)}parse(e,t,n){const r=e=>e-1;switch(t){case"M":return Ct(Et(nt,e),r);case"MM":return Ct(At(2,e),r);case"Mo":return Ct(n.ordinalNumber(e,{unit:"month"}),r);case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}},L:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",110),(0,Je.A)(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(e,t,n){const r=e=>e-1;switch(t){case"L":return Ct(Et(nt,e),r);case"LL":return Ct(At(2,e),r);case"Lo":return Ct(n.ordinalNumber(e,{unit:"month"}),r);case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}},w:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",100),(0,Je.A)(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(e,t,n){switch(t){case"w":return Et(st,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return At(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,n,r){return Rt(Ut(e,n,r),r)}},I:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",100),(0,Je.A)(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(e,t,n){switch(t){case"I":return Et(st,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return At(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,n){return Lt(Yt(e,n))}},d:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",90),(0,Je.A)(this,"subPriority",1),(0,Je.A)(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(e,t,n){switch(t){case"d":return Et(rt,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return At(t.length,e)}}validate(e,t){const n=Pt(e.getFullYear()),r=e.getMonth();return n?t>=1&&t<=Vt[r]:t>=1&&t<=Wt[r]}set(e,t,n){return e.setDate(n),e.setHours(0,0,0,0),e}},D:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",90),(0,Je.A)(this,"subpriority",1),(0,Je.A)(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(e,t,n){switch(t){case"D":case"DD":return Et(at,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return At(t.length,e)}}validate(e,t){return Pt(e.getFullYear())?t>=1&&t<=366:t>=1&&t<=365}set(e,t,n){return e.setMonth(0,n),e.setHours(0,0,0,0),e}},E:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",90),(0,Je.A)(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(e,t,n){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,r){return(e=Gt(e,n,r)).setHours(0,0,0,0),e}},e:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",90),(0,Je.A)(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(e,t,n,r){const a=e=>{const t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return Ct(At(t.length,e),a);case"eo":return Ct(n.ordinalNumber(e,{unit:"day"}),a);case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,r){return(e=Gt(e,n,r)).setHours(0,0,0,0),e}},c:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",90),(0,Je.A)(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(e,t,n,r){const a=e=>{const t=7*Math.floor((e-1)/7);return(e+r.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return Ct(At(t.length,e),a);case"co":return Ct(n.ordinalNumber(e,{unit:"day"}),a);case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,r){return(e=Gt(e,n,r)).setHours(0,0,0,0),e}},i:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",90),(0,Je.A)(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(e,t,n){const r=e=>0===e?7:e;switch(t){case"i":case"ii":return At(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return Ct(n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r);case"iiiii":return Ct(n.day(e,{width:"narrow",context:"formatting"}),r);case"iiiiii":return Ct(n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r);default:return Ct(n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),r)}}validate(e,t){return t>=1&&t<=7}set(e,t,n){return(e=Jt(e,n)).setHours(0,0,0,0),e}},a:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",80),(0,Je.A)(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(e,t,n){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(It(n),0,0,0),e}},b:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",80),(0,Je.A)(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(e,t,n){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(It(n),0,0,0),e}},B:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",80),(0,Je.A)(this,"incompatibleTokens",["a","b","t","T"])}parse(e,t,n){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(It(n),0,0,0),e}},h:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",70),(0,Je.A)(this,"incompatibleTokens",["H","K","k","t","T"])}parse(e,t,n){switch(t){case"h":return Et(ct,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return At(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,n){const r=e.getHours()>=12;return r&&n<12?e.setHours(n+12,0,0,0):r||12!==n?e.setHours(n,0,0,0):e.setHours(0,0,0,0),e}},H:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",70),(0,Je.A)(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(e,t,n){switch(t){case"H":return Et(ot,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return At(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,n){return e.setHours(n,0,0,0),e}},K:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",70),(0,Je.A)(this,"incompatibleTokens",["h","H","k","t","T"])}parse(e,t,n){switch(t){case"K":return Et(lt,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return At(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.getHours()>=12&&n<12?e.setHours(n+12,0,0,0):e.setHours(n,0,0,0),e}},k:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",70),(0,Je.A)(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(e,t,n){switch(t){case"k":return Et(it,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return At(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,n){const r=n<=24?n%24:n;return e.setHours(r,0,0,0),e}},m:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",60),(0,Je.A)(this,"incompatibleTokens",["t","T"])}parse(e,t,n){switch(t){case"m":return Et(dt,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return At(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,n){return e.setMinutes(n,0,0),e}},s:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",50),(0,Je.A)(this,"incompatibleTokens",["t","T"])}parse(e,t,n){switch(t){case"s":return Et(ut,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return At(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,n){return e.setSeconds(n,0),e}},S:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",30),(0,Je.A)(this,"incompatibleTokens",["t","T"])}parse(e,t){return Ct(At(t.length,e),e=>Math.trunc(e*Math.pow(10,3-t.length)))}set(e,t,n){return e.setMilliseconds(n),e}},X:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",10),(0,Je.A)(this,"incompatibleTokens",["t","T","x"])}parse(e,t){switch(t){case"X":return _t(wt,e);case"XX":return _t(St,e);case"XXXX":return _t(Nt,e);case"XXXXX":return _t(kt,e);default:return _t(jt,e)}}set(e,t,n){return t.timestampIsSet?e:ve(e,e.getTime()-$t(e)-n)}},x:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",10),(0,Je.A)(this,"incompatibleTokens",["t","T","X"])}parse(e,t){switch(t){case"x":return _t(wt,e);case"xx":return _t(St,e);case"xxxx":return _t(Nt,e);case"xxxxx":return _t(kt,e);default:return _t(jt,e)}}set(e,t,n){return t.timestampIsSet?e:ve(e,e.getTime()-$t(e)-n)}},t:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",40),(0,Je.A)(this,"incompatibleTokens","*")}parse(e){return Dt(e)}set(e,t,n){return[ve(e,1e3*n),{timestampIsSet:!0}]}},T:new class extends tt{constructor(){super(...arguments),(0,Je.A)(this,"priority",20),(0,Je.A)(this,"incompatibleTokens","*")}parse(e){return Dt(e)}set(e,t,n){return[ve(e,n),{timestampIsSet:!0}]}}},Zt=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,en=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,tn=/^'([^]*?)'?$/,nn=/''/g,rn=/\S/,an=/[a-zA-Z]/;function sn(e,t,n,r){var a,s,o,i,l,c,d,u,h,p,m,f,g,v;const y=()=>ve((null===r||void 0===r?void 0:r.in)||n,NaN),b=Qe(),x=null!==(a=null!==(s=null===r||void 0===r?void 0:r.locale)&&void 0!==s?s:b.locale)&&void 0!==a?a:Le,w=null!==(o=null!==(i=null!==(l=null!==(c=null===r||void 0===r?void 0:r.firstWeekContainsDate)&&void 0!==c?c:null===r||void 0===r||null===(d=r.locale)||void 0===d||null===(d=d.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==l?l:b.firstWeekContainsDate)&&void 0!==i?i:null===(u=b.locale)||void 0===u||null===(u=u.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==o?o:1,S=null!==(h=null!==(p=null!==(m=null!==(f=null===r||void 0===r?void 0:r.weekStartsOn)&&void 0!==f?f:null===r||void 0===r||null===(g=r.locale)||void 0===g||null===(g=g.options)||void 0===g?void 0:g.weekStartsOn)&&void 0!==m?m:b.weekStartsOn)&&void 0!==p?p:null===(v=b.locale)||void 0===v||null===(v=v.options)||void 0===v?void 0:v.weekStartsOn)&&void 0!==h?h:0;if(!t)return e?y():ye(n,null===r||void 0===r?void 0:r.in);const N={firstWeekContainsDate:w,weekStartsOn:S,locale:x},j=[new et(null===r||void 0===r?void 0:r.in,n)],k=t.match(en).map(e=>{const t=e[0];if(t in Ue){return(0,Ue[t])(e,x.formatLong)}return e}).join("").match(Zt),C=[];for(let A of k){null!==r&&void 0!==r&&r.useAdditionalWeekYearTokens||!We(A)||Ve(A,t,e),null!==r&&void 0!==r&&r.useAdditionalDayOfYearTokens||!Ye(A)||Ve(A,t,e);const n=A[0],a=Xt[n];if(a){const{incompatibleTokens:t}=a;if(Array.isArray(t)){const e=C.find(e=>t.includes(e.token)||e.token===n);if(e)throw new RangeError("The format string mustn't contain `".concat(e.fullToken,"` and `").concat(A,"` at the same time"))}else if("*"===a.incompatibleTokens&&C.length>0)throw new RangeError("The format string mustn't contain `".concat(A,"` and any other token at the same time"));C.push({token:n,fullToken:A});const r=a.run(e,A,x.match,N);if(!r)return y();j.push(r.setter),e=r.rest}else{if(n.match(an))throw new RangeError("Format string contains an unescaped latin alphabet character `"+n+"`");if("''"===A?A="'":"'"===n&&(A=on(A)),0!==e.indexOf(A))return y();e=e.slice(A.length)}}if(e.length>0&&rn.test(e))return y();const E=j.map(e=>e.priority).sort((e,t)=>t-e).filter((e,t,n)=>n.indexOf(e)===t).map(e=>j.filter(t=>t.priority===e).sort((e,t)=>t.subPriority-e.subPriority)).map(e=>e[0]);let _=ye(n,null===r||void 0===r?void 0:r.in);if(isNaN(+_))return y();const D={};for(const A of E){if(!A.validate(_,N))return y();const e=A.set(_,D,N);Array.isArray(e)?(_=e[0],Object.assign(D,e[1])):_=e}return _}function on(e){return e.match(tn)[1].replace(nn,"'")}function ln(e){return e instanceof Date||"object"===typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function cn(e){return!(!ln(e)&&"number"!==typeof e||isNaN(+ye(e)))}function dn(e,t){return+ye(e)<+ye(t)}function un(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const a=ve.bind(null,e||n.find(e=>"object"===typeof e));return n.map(a)}function hn(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in);return n.setHours(0,0,0,0),n}function pn(e,t,n){const[r,a]=un(null===n||void 0===n?void 0:n.in,e,t),s=hn(r),o=hn(a),i=+s-$t(s),l=+o-$t(o);return Math.round((i-l)/864e5)}function mn(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function fn(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in);return pn(n,mn(n))+1}function gn(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const vn={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return gn("yy"===t?r%100:r,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):gn(n+1,2)},d:(e,t)=>gn(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>gn(e.getHours()%12||12,t.length),H:(e,t)=>gn(e.getHours(),t.length),m:(e,t)=>gn(e.getMinutes(),t.length),s:(e,t)=>gn(e.getSeconds(),t.length),S(e,t){const n=t.length,r=e.getMilliseconds();return gn(Math.trunc(r*Math.pow(10,n-3)),t.length)}},yn="midnight",bn="noon",xn="morning",wn="afternoon",Sn="evening",Nn="night",jn={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),r=t>0?t:1-t;return n.ordinalNumber(r,{unit:"year"})}return vn.y(e,t)},Y:function(e,t,n,r){const a=Mt(e,r),s=a>0?a:1-a;if("YY"===t){return gn(s%100,2)}return"Yo"===t?n.ordinalNumber(s,{unit:"year"}):gn(s,t.length)},R:function(e,t){return gn(zt(e),t.length)},u:function(e,t){return gn(e.getFullYear(),t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return gn(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return gn(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return vn.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return gn(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const a=Bt(e,r);return"wo"===t?n.ordinalNumber(a,{unit:"week"}):gn(a,t.length)},I:function(e,t,n){const r=qt(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):gn(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):vn.d(e,t)},D:function(e,t,n){const r=fn(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):gn(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const a=e.getDay(),s=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return gn(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const a=e.getDay(),s=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return gn(s,t.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),a=0===r?7:r;switch(t){case"i":return String(a);case"ii":return gn(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let a;switch(a=12===r?bn:0===r?yn:r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let a;switch(a=r>=17?Sn:r>=12?wn:r>=4?xn:Nn,t){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return vn.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):vn.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):gn(r,t.length)},k:function(e,t,n){let r=e.getHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):gn(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):vn.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):vn.s(e,t)},S:function(e,t){return vn.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(0===r)return"Z";switch(t){case"X":return Cn(r);case"XXXX":case"XX":return En(r);default:return En(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return Cn(r);case"xxxx":case"xx":return En(r);default:return En(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+kn(r,":");default:return"GMT"+En(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+kn(r,":");default:return"GMT"+En(r,":")}},t:function(e,t,n){return gn(Math.trunc(+e/1e3),t.length)},T:function(e,t,n){return gn(+e,t.length)}};function kn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),s=r%60;return 0===s?n+String(a):n+String(a)+t+gn(s,2)}function Cn(e,t){if(e%60===0){return(e>0?"-":"+")+gn(Math.abs(e)/60,2)}return En(e,t)}function En(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e>0?"-":"+",r=Math.abs(e);return n+gn(Math.trunc(r/60),2)+t+gn(r%60,2)}const _n=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Dn=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,An=/^'([^]*?)'?$/,Tn=/''/g,In=/[a-zA-Z]/;function On(e,t,n){var r,a,s,o,i,l,c,d,u,h,p,m,f,g;const v=Ge(),y=null!==(r=null!==(a=null===n||void 0===n?void 0:n.locale)&&void 0!==a?a:v.locale)&&void 0!==r?r:Le,b=null!==(s=null!==(o=null!==(i=null!==(l=null===n||void 0===n?void 0:n.firstWeekContainsDate)&&void 0!==l?l:null===n||void 0===n||null===(c=n.locale)||void 0===c||null===(c=c.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==i?i:v.firstWeekContainsDate)&&void 0!==o?o:null===(d=v.locale)||void 0===d||null===(d=d.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==s?s:1,x=null!==(u=null!==(h=null!==(p=null!==(m=null===n||void 0===n?void 0:n.weekStartsOn)&&void 0!==m?m:null===n||void 0===n||null===(f=n.locale)||void 0===f||null===(f=f.options)||void 0===f?void 0:f.weekStartsOn)&&void 0!==p?p:v.weekStartsOn)&&void 0!==h?h:null===(g=v.locale)||void 0===g||null===(g=g.options)||void 0===g?void 0:g.weekStartsOn)&&void 0!==u?u:0,w=ye(e,null===n||void 0===n?void 0:n.in);if(!cn(w))throw new RangeError("Invalid time value");let S=t.match(Dn).map(e=>{const t=e[0];if("p"===t||"P"===t){return(0,Ue[t])(e,y.formatLong)}return e}).join("").match(_n).map(e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:Pn(e)};if(jn[t])return{isToken:!0,value:e};if(t.match(In))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});y.localize.preprocessor&&(S=y.localize.preprocessor(w,S));const N={firstWeekContainsDate:b,weekStartsOn:x,locale:y};return S.map(r=>{if(!r.isToken)return r.value;const a=r.value;(null!==n&&void 0!==n&&n.useAdditionalWeekYearTokens||!We(a))&&(null!==n&&void 0!==n&&n.useAdditionalDayOfYearTokens||!Ye(a))||Ve(a,t,String(e));return(0,jn[a[0]])(w,a,y.localize,N)}).join("")}function Pn(e){const t=e.match(An);return t?t[1].replace(Tn,"'"):e}function Rn(e,t,n){const r=ye(e,null===n||void 0===n?void 0:n.in);return r.setHours(t),r}function Mn(e,t,n){const r=ye(e,null===n||void 0===n?void 0:n.in);return r.setMinutes(t),r}function Ln(e,t,n){const r=ye(e,null===n||void 0===n?void 0:n.in);return r.setSeconds(t),r}function Fn(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function Bn(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in),r=n.getMonth(),a=r-r%3;return n.setMonth(a,1),n.setHours(0,0,0,0),n}function Un(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in);return n.setHours(23,59,59,999),n}function zn(e,t){var n,r,a,s,o,i;const l=Ge(),c=null!==(n=null!==(r=null!==(a=null!==(s=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==s?s:null===t||void 0===t||null===(o=t.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==a?a:l.weekStartsOn)&&void 0!==r?r:null===(i=l.locale)||void 0===i||null===(i=i.options)||void 0===i?void 0:i.weekStartsOn)&&void 0!==n?n:0,d=ye(e,null===t||void 0===t?void 0:t.in),u=d.getDay(),h=6+(u<c?-7:0)-(u-c);return d.setDate(d.getDate()+h),d.setHours(23,59,59,999),d}function Hn(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function qn(e,t,n){const[r,a]=un(null===n||void 0===n?void 0:n.in,e,t);return r.getFullYear()===a.getFullYear()}function Yn(e,t,n){const[r,a]=un(null===n||void 0===n?void 0:n.in,e,t);return r.getFullYear()===a.getFullYear()&&r.getMonth()===a.getMonth()}function Wn(e,t,n){const[r,a]=un(null===n||void 0===n?void 0:n.in,e,t);return+Bn(r)===+Bn(a)}function Vn(e,t,n){const[r,a]=un(null===n||void 0===n?void 0:n.in,e,t);return+hn(r)===+hn(a)}function Kn(e,t){return+ye(e)===+ye(t)}function Gn(e,t,n){const r=+ye(e,null===n||void 0===n?void 0:n.in),[a,s]=[+ye(t.start,null===n||void 0===n?void 0:n.in),+ye(t.end,null===n||void 0===n?void 0:n.in)].sort((e,t)=>e-t);return r>=a&&r<=s}function Qn(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in),r=n.getFullYear(),a=n.getMonth(),s=ve(n,0);return s.setFullYear(r,a+1,0),s.setHours(0,0,0,0),s.getDate()}function Jn(e,t,n){const r=ye(e,null===n||void 0===n?void 0:n.in),a=r.getFullYear(),s=r.getDate(),o=ve((null===n||void 0===n?void 0:n.in)||e,0);o.setFullYear(a,t,15),o.setHours(0,0,0,0);const i=Qn(o);return r.setMonth(t,Math.min(s,i)),r}function $n(e,t,n){const r=ye(e,null===n||void 0===n?void 0:n.in),a=t-(Math.trunc(r.getMonth()/3)+1);return Jn(r,r.getMonth()+3*a)}function Xn(e,t){return ye(e,null===t||void 0===t?void 0:t.in).getFullYear()}function Zn(e,t){return ye(e,null===t||void 0===t?void 0:t.in).getMonth()}function er(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function tr(e,t){const n=ye(e,null===t||void 0===t?void 0:t.in);return Math.trunc(n.getMonth()/3)+1}function nr(e,t){return ye(e,null===t||void 0===t?void 0:t.in).getHours()}function rr(e,t){return ye(e,null===t||void 0===t?void 0:t.in).getMinutes()}function ar(e){return ye(e).getSeconds()}function sr(e,t,n){const r=ye(e,null===n||void 0===n?void 0:n.in);if(isNaN(t))return ve((null===n||void 0===n?void 0:n.in)||e,NaN);if(!t)return r;const a=r.getDate(),s=ve((null===n||void 0===n?void 0:n.in)||e,r.getTime());s.setMonth(r.getMonth()+t+1,0);return a>=s.getDate()?s:(r.setFullYear(s.getFullYear(),s.getMonth(),a),r)}function or(e,t,n){return sr(e,-t,n)}function ir(e,t,n){const[r,a]=un(null===n||void 0===n?void 0:n.in,e,t);return 12*(r.getFullYear()-a.getFullYear())+(r.getMonth()-a.getMonth())}function lr(e,t,n){return sr(e,3*t,n)}function cr(e,t,n){return lr(e,-t,n)}function dr(e,t,n){const[r,a]=un(null===n||void 0===n?void 0:n.in,e,t);return 4*(r.getFullYear()-a.getFullYear())+(tr(r)-tr(a))}function ur(e,t,n){return sr(e,12*t,n)}function hr(e,t,n){return ur(e,-t,n)}function pr(e,t,n){const[r,a]=un(null===n||void 0===n?void 0:n.in,e,t);return r.getFullYear()-a.getFullYear()}function mr(e,t){let n,r=null===t||void 0===t?void 0:t.in;return e.forEach(e=>{r||"object"!==typeof e||(r=ve.bind(null,e));const t=ye(e,r);(!n||n>t||isNaN(+t))&&(n=t)}),ve(r,n||NaN)}function fr(e,t){let n,r=null===t||void 0===t?void 0:t.in;return e.forEach(e=>{r||"object"!==typeof e||(r=ve.bind(null,e));const t=ye(e,r);(!n||n<t||isNaN(+t))&&(n=t)}),ve(r,n||NaN)}function gr(e,t,n){return ve((null===n||void 0===n?void 0:n.in)||e,+ye(e)+t)}function vr(e,t,n){return gr(e,t*fe,n)}function yr(e,t,n){const r=ye(e,null===n||void 0===n?void 0:n.in);return r.setTime(r.getTime()+t*me),r}function br(e,t,n){return gr(e,1e3*t,n)}function xr(e,t){return+ye(e)>+ye(t)}function wr(e,t){return ye(e,null===t||void 0===t?void 0:t.in).getDay()}function Sr(e,t){return ye(e,null===t||void 0===t?void 0:t.in).getDate()}function Nr(e,t,n){return Kt(e,7*t,n)}function jr(e){return+ye(e)}function kr(e,t,n){const r=ye(e,null===n||void 0===n?void 0:n.in);return isNaN(+r)?ve((null===n||void 0===n?void 0:n.in)||e,NaN):(r.setFullYear(t),r)}function Cr(e,t,n){const[r,a]=un(null===n||void 0===n?void 0:n.in,e,t),s=Er(r,a),o=Math.abs(pn(r,a));r.setDate(r.getDate()-s*o);const i=s*(o-Number(Er(r,a)===-s));return 0===i?0:i}function Er(e,t){const n=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return n<0?-1:n>0?1:n}function _r(e,t,n){return Nr(e,-t,n)}function Dr(e,t,n){return Kt(e,-t,n)}function Ar(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Tr="undefined"!==typeof document?r.useLayoutEffect:function(){};const Ir=(0,f.A)({},a).useInsertionEffect||(e=>e());function Or(){return"undefined"!==typeof window}function Pr(e){return Lr(e)?(e.nodeName||"").toLowerCase():"#document"}function Rr(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function Mr(e){var t;return null==(t=(Lr(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function Lr(e){return!!Or()&&(e instanceof Node||e instanceof Rr(e).Node)}function Fr(e){return!!Or()&&(e instanceof Element||e instanceof Rr(e).Element)}function Br(e){return!!Or()&&(e instanceof HTMLElement||e instanceof Rr(e).HTMLElement)}function Ur(e){return!(!Or()||"undefined"===typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof Rr(e).ShadowRoot)}const zr=new Set(["inline","contents"]);function Hr(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=ea(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!zr.has(a)}const qr=new Set(["table","td","th"]);function Yr(e){return qr.has(Pr(e))}const Wr=[":popover-open",":modal"];function Vr(e){return Wr.some(t=>{try{return e.matches(t)}catch(n){return!1}})}const Kr=["transform","translate","scale","rotate","perspective"],Gr=["transform","translate","scale","rotate","perspective","filter"],Qr=["paint","layout","strict","content"];function Jr(e){const t=$r(),n=Fr(e)?ea(e):e;return Kr.some(e=>!!n[e]&&"none"!==n[e])||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||Gr.some(e=>(n.willChange||"").includes(e))||Qr.some(e=>(n.contain||"").includes(e))}function $r(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const Xr=new Set(["html","body","#document"]);function Zr(e){return Xr.has(Pr(e))}function ea(e){return Rr(e).getComputedStyle(e)}function ta(e){return Fr(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function na(e){if("html"===Pr(e))return e;const t=e.assignedSlot||e.parentNode||Ur(e)&&e.host||Mr(e);return Ur(t)?t.host:t}function ra(e){const t=na(e);return Zr(t)?e.ownerDocument?e.ownerDocument.body:e.body:Br(t)&&Hr(t)?t:ra(t)}function aa(e,t,n){var r;void 0===t&&(t=[]),void 0===n&&(n=!0);const a=ra(e),s=a===(null==(r=e.ownerDocument)?void 0:r.body),o=Rr(a);if(s){const e=sa(o);return t.concat(o,o.visualViewport||[],Hr(a)?a:[],e&&n?aa(e):[])}return t.concat(a,aa(a,[],n))}function sa(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}var oa=n(119);const ia=Math.min,la=Math.max,ca=Math.round,da=Math.floor,ua=e=>({x:e,y:e}),ha={left:"right",right:"left",bottom:"top",top:"bottom"},pa={start:"end",end:"start"};function ma(e,t){return"function"===typeof e?e(t):e}function fa(e){return e.split("-")[0]}function ga(e){return e.split("-")[1]}function va(e){return"y"===e?"height":"width"}const ya=new Set(["top","bottom"]);function ba(e){return ya.has(fa(e))?"y":"x"}function xa(e){return"x"===ba(e)?"y":"x"}function wa(e){return e.replace(/start|end/g,e=>pa[e])}const Sa=["left","right"],Na=["right","left"],ja=["top","bottom"],ka=["bottom","top"];function Ca(e,t,n,r){const a=ga(e);let s=function(e,t,n){switch(e){case"top":case"bottom":return n?t?Na:Sa:t?Sa:Na;case"left":case"right":return t?ja:ka;default:return[]}}(fa(e),"start"===n,r);return a&&(s=s.map(e=>e+"-"+a),t&&(s=s.concat(s.map(wa)))),s}function Ea(e){return e.replace(/left|right|bottom|top/g,e=>ha[e])}function _a(e){return"number"!==typeof e?function(e){return(0,f.A)({top:0,right:0,bottom:0,left:0},e)}(e):{top:e,right:e,bottom:e,left:e}}function Da(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}const Aa=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"];function Ta(e,t,n){let{reference:r,floating:a}=e;const s=ba(t),o=xa(t),i=va(o),l=fa(t),c="y"===s,d=r.x+r.width/2-a.width/2,u=r.y+r.height/2-a.height/2,h=r[i]/2-a[i]/2;let p;switch(l){case"top":p={x:d,y:r.y-a.height};break;case"bottom":p={x:d,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:u};break;case"left":p={x:r.x-a.width,y:u};break;default:p={x:r.x,y:r.y}}switch(ga(t)){case"start":p[o]-=h*(n&&c?-1:1);break;case"end":p[o]+=h*(n&&c?-1:1)}return p}async function Ia(e,t){var n;void 0===t&&(t={});const{x:r,y:a,platform:s,rects:o,elements:i,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:h=!1,padding:p=0}=ma(t,e),m=_a(p),f=i[h?"floating"===u?"reference":"floating":u],g=Da(await s.getClippingRect({element:null==(n=await(null==s.isElement?void 0:s.isElement(f)))||n?f:f.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(i.floating)),boundary:c,rootBoundary:d,strategy:l})),v="floating"===u?{x:r,y:a,width:o.floating.width,height:o.floating.height}:o.reference,y=await(null==s.getOffsetParent?void 0:s.getOffsetParent(i.floating)),b=await(null==s.isElement?void 0:s.isElement(y))&&await(null==s.getScale?void 0:s.getScale(y))||{x:1,y:1},x=Da(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:i,rect:v,offsetParent:y,strategy:l}):v);return{top:(g.top-x.top+m.top)/b.y,bottom:(x.bottom-g.bottom+m.bottom)/b.y,left:(g.left-x.left+m.left)/b.x,right:(x.right-g.right+m.right)/b.x}}const Oa=new Set(["left","top"]);function Pa(e){const t=ea(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=Br(e),s=a?e.offsetWidth:n,o=a?e.offsetHeight:r,i=ca(n)!==s||ca(r)!==o;return i&&(n=s,r=o),{width:n,height:r,$:i}}function Ra(e){return Fr(e)?e:e.contextElement}function Ma(e){const t=Ra(e);if(!Br(t))return ua(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:s}=Pa(t);let o=(s?ca(n.width):n.width)/r,i=(s?ca(n.height):n.height)/a;return o&&Number.isFinite(o)||(o=1),i&&Number.isFinite(i)||(i=1),{x:o,y:i}}const La=ua(0);function Fa(e){const t=Rr(e);return $r()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:La}function Ba(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=!1);const a=e.getBoundingClientRect(),s=Ra(e);let o=ua(1);t&&(r?Fr(r)&&(o=Ma(r)):o=Ma(e));const i=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==Rr(e))&&t}(s,n,r)?Fa(s):ua(0);let l=(a.left+i.x)/o.x,c=(a.top+i.y)/o.y,d=a.width/o.x,u=a.height/o.y;if(s){const e=Rr(s),t=r&&Fr(r)?Rr(r):r;let n=e,a=sa(n);for(;a&&r&&t!==n;){const e=Ma(a),t=a.getBoundingClientRect(),r=ea(a),s=t.left+(a.clientLeft+parseFloat(r.paddingLeft))*e.x,o=t.top+(a.clientTop+parseFloat(r.paddingTop))*e.y;l*=e.x,c*=e.y,d*=e.x,u*=e.y,l+=s,c+=o,n=Rr(a),a=sa(n)}}return Da({width:d,height:u,x:l,y:c})}function Ua(e,t){const n=ta(e).scrollLeft;return t?t.left+n:Ba(Mr(e)).left+n}function za(e,t,n){void 0===n&&(n=!1);const r=e.getBoundingClientRect();return{x:r.left+t.scrollLeft-(n?0:Ua(e,r)),y:r.top+t.scrollTop}}const Ha=new Set(["absolute","fixed"]);function qa(e,t,n){let r;if("viewport"===t)r=function(e,t){const n=Rr(e),r=Mr(e),a=n.visualViewport;let s=r.clientWidth,o=r.clientHeight,i=0,l=0;if(a){s=a.width,o=a.height;const e=$r();(!e||e&&"fixed"===t)&&(i=a.offsetLeft,l=a.offsetTop)}return{width:s,height:o,x:i,y:l}}(e,n);else if("document"===t)r=function(e){const t=Mr(e),n=ta(e),r=e.ownerDocument.body,a=la(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=la(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+Ua(e);const i=-n.scrollTop;return"rtl"===ea(r).direction&&(o+=la(t.clientWidth,r.clientWidth)-a),{width:a,height:s,x:o,y:i}}(Mr(e));else if(Fr(t))r=function(e,t){const n=Ba(e,!0,"fixed"===t),r=n.top+e.clientTop,a=n.left+e.clientLeft,s=Br(e)?Ma(e):ua(1);return{width:e.clientWidth*s.x,height:e.clientHeight*s.y,x:a*s.x,y:r*s.y}}(t,n);else{const n=Fa(e);r={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return Da(r)}function Ya(e,t){const n=na(e);return!(n===t||!Fr(n)||Zr(n))&&("fixed"===ea(n).position||Ya(n,t))}function Wa(e,t,n){const r=Br(t),a=Mr(t),s="fixed"===n,o=Ba(e,!0,s,t);let i={scrollLeft:0,scrollTop:0};const l=ua(0);function c(){l.x=Ua(a)}if(r||!r&&!s)if(("body"!==Pr(t)||Hr(a))&&(i=ta(t)),r){const e=Ba(t,!0,s,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else a&&c();s&&!r&&a&&c();const d=!a||r||s?ua(0):za(a,i);return{x:o.left+i.scrollLeft-l.x-d.x,y:o.top+i.scrollTop-l.y-d.y,width:o.width,height:o.height}}function Va(e){return"static"===ea(e).position}function Ka(e,t){if(!Br(e)||"fixed"===ea(e).position)return null;if(t)return t(e);let n=e.offsetParent;return Mr(e)===n&&(n=n.ownerDocument.body),n}function Ga(e,t){const n=Rr(e);if(Vr(e))return n;if(!Br(e)){let t=na(e);for(;t&&!Zr(t);){if(Fr(t)&&!Va(t))return t;t=na(t)}return n}let r=Ka(e,t);for(;r&&Yr(r)&&Va(r);)r=Ka(r,t);return r&&Zr(r)&&Va(r)&&!Jr(r)?n:r||function(e){let t=na(e);for(;Br(t)&&!Zr(t);){if(Jr(t))return t;if(Vr(t))return null;t=na(t)}return null}(e)||n}const Qa={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const s="fixed"===a,o=Mr(r),i=!!t&&Vr(t.floating);if(r===o||i&&s)return n;let l={scrollLeft:0,scrollTop:0},c=ua(1);const d=ua(0),u=Br(r);if((u||!u&&!s)&&(("body"!==Pr(r)||Hr(o))&&(l=ta(r)),Br(r))){const e=Ba(r);c=Ma(r),d.x=e.x+r.clientLeft,d.y=e.y+r.clientTop}const h=!o||u||s?ua(0):za(o,l,!0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+d.x+h.x,y:n.y*c.y-l.scrollTop*c.y+d.y+h.y}},getDocumentElement:Mr,getClippingRect:function(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const s=[..."clippingAncestors"===n?Vr(t)?[]:function(e,t){const n=t.get(e);if(n)return n;let r=aa(e,[],!1).filter(e=>Fr(e)&&"body"!==Pr(e)),a=null;const s="fixed"===ea(e).position;let o=s?na(e):e;for(;Fr(o)&&!Zr(o);){const t=ea(o),n=Jr(o);n||"fixed"!==t.position||(a=null),(s?!n&&!a:!n&&"static"===t.position&&a&&Ha.has(a.position)||Hr(o)&&!n&&Ya(e,o))?r=r.filter(e=>e!==o):a=t,o=na(o)}return t.set(e,r),r}(t,this._c):[].concat(n),r],o=s[0],i=s.reduce((e,n)=>{const r=qa(t,n,a);return e.top=la(r.top,e.top),e.right=ia(r.right,e.right),e.bottom=ia(r.bottom,e.bottom),e.left=la(r.left,e.left),e},qa(t,o,a));return{width:i.right-i.left,height:i.bottom-i.top,x:i.left,y:i.top}},getOffsetParent:Ga,getElementRects:async function(e){const t=this.getOffsetParent||Ga,n=this.getDimensions,r=await n(e.floating);return{reference:Wa(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:n}=Pa(e);return{width:t,height:n}},getScale:Ma,isElement:Fr,isRTL:function(e){return"rtl"===ea(e).direction}};function Ja(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function $a(e,t,n,r){void 0===r&&(r={});const{ancestorScroll:a=!0,ancestorResize:s=!0,elementResize:o="function"===typeof ResizeObserver,layoutShift:i="function"===typeof IntersectionObserver,animationFrame:l=!1}=r,c=Ra(e),d=a||s?[...c?aa(c):[],...aa(t)]:[];d.forEach(e=>{a&&e.addEventListener("scroll",n,{passive:!0}),s&&e.addEventListener("resize",n)});const u=c&&i?function(e,t){let n,r=null;const a=Mr(e);function s(){var e;clearTimeout(n),null==(e=r)||e.disconnect(),r=null}return function o(i,l){void 0===i&&(i=!1),void 0===l&&(l=1),s();const c=e.getBoundingClientRect(),{left:d,top:u,width:h,height:p}=c;if(i||t(),!h||!p)return;const m={rootMargin:-da(u)+"px "+-da(a.clientWidth-(d+h))+"px "+-da(a.clientHeight-(u+p))+"px "+-da(d)+"px",threshold:la(0,ia(1,l))||1};let g=!0;function v(t){const r=t[0].intersectionRatio;if(r!==l){if(!g)return o();r?o(!1,r):n=setTimeout(()=>{o(!1,1e-7)},1e3)}1!==r||Ja(c,e.getBoundingClientRect())||o(),g=!1}try{r=new IntersectionObserver(v,(0,f.A)((0,f.A)({},m),{},{root:a.ownerDocument}))}catch(y){r=new IntersectionObserver(v,m)}r.observe(e)}(!0),s}(c,n):null;let h,p=-1,m=null;o&&(m=new ResizeObserver(e=>{let[r]=e;r&&r.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var e;null==(e=m)||e.observe(t)})),n()}),c&&!l&&m.observe(c),m.observe(t));let g=l?Ba(e):null;return l&&function t(){const r=Ba(e);g&&!Ja(g,r)&&n();g=r,h=requestAnimationFrame(t)}(),n(),()=>{var e;d.forEach(e=>{a&&e.removeEventListener("scroll",n),s&&e.removeEventListener("resize",n)}),null==u||u(),null==(e=m)||e.disconnect(),m=null,l&&cancelAnimationFrame(h)}}const Xa=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:s,placement:o,middlewareData:i}=t,l=await async function(e,t){const{placement:n,platform:r,elements:a}=e,s=await(null==r.isRTL?void 0:r.isRTL(a.floating)),o=fa(n),i=ga(n),l="y"===ba(n),c=Oa.has(o)?-1:1,d=s&&l?-1:1,u=ma(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:m}="number"===typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return i&&"number"===typeof m&&(p="end"===i?-1*m:m),l?{x:p*d,y:h*c}:{x:h*c,y:p*d}}(t,e);return o===(null==(n=i.offset)?void 0:n.placement)&&null!=(r=i.arrow)&&r.alignmentOffset?{}:{x:a+l.x,y:s+l.y,data:(0,f.A)((0,f.A)({},l),{},{placement:o})}}}},Za=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:s,rects:o,initialPlacement:i,platform:l,elements:c}=t,d=ma(e,t),{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:p,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:g=!0}=d,v=Ar(d,Aa);if(null!=(n=s.arrow)&&n.alignmentOffset)return{};const y=fa(a),b=ba(i),x=fa(i)===i,w=await(null==l.isRTL?void 0:l.isRTL(c.floating)),S=p||(x||!g?[Ea(i)]:function(e){const t=Ea(e);return[wa(e),t,wa(t)]}(i)),N="none"!==f;!p&&N&&S.push(...Ca(i,g,f,w));const j=[i,...S],k=await Ia(t,v),C=[];let E=(null==(r=s.flip)?void 0:r.overflows)||[];if(u&&C.push(k[y]),h){const e=function(e,t,n){void 0===n&&(n=!1);const r=ga(e),a=xa(e),s=va(a);let o="x"===a?r===(n?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[s]>t.floating[s]&&(o=Ea(o)),[o,Ea(o)]}(a,o,w);C.push(k[e[0]],k[e[1]])}if(E=[...E,{placement:a,overflows:C}],!C.every(e=>e<=0)){var _,D;const e=((null==(_=s.flip)?void 0:_.index)||0)+1,t=j[e];if(t){if(!("alignment"===h&&b!==ba(t))||E.every(e=>e.overflows[0]>0&&ba(e.placement)===b))return{data:{index:e,overflows:E},reset:{placement:t}}}let n=null==(D=E.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:D.placement;if(!n)switch(m){case"bestFit":{var A;const e=null==(A=E.filter(e=>{if(N){const t=ba(e.placement);return t===b||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:A[0];e&&(n=e);break}case"initialPlacement":n=i}if(a!==n)return{reset:{placement:n}}}return{}}}},es=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:s,platform:o,elements:i,middlewareData:l}=t,{element:c,padding:d=0}=ma(e,t)||{};if(null==c)return{};const u=_a(d),h={x:n,y:r},p=xa(a),m=va(p),g=await o.getDimensions(c),v="y"===p,y=v?"top":"left",b=v?"bottom":"right",x=v?"clientHeight":"clientWidth",w=s.reference[m]+s.reference[p]-h[p]-s.floating[m],S=h[p]-s.reference[p],N=await(null==o.getOffsetParent?void 0:o.getOffsetParent(c));let j=N?N[x]:0;j&&await(null==o.isElement?void 0:o.isElement(N))||(j=i.floating[x]||s.floating[m]);const k=w/2-S/2,C=j/2-g[m]/2-1,E=ia(u[y],C),_=ia(u[b],C),D=E,A=j-g[m]-_,T=j/2-g[m]/2+k,I=la(D,ia(T,A));const O=!l.arrow&&null!=ga(a)&&T!==I&&s.reference[m]/2-(T<D?E:_)-g[m]/2<0,P=O?T<D?T-D:T-A:0;return{[p]:h[p]+P,data:(0,f.A)({[p]:I,centerOffset:T-I-P},O&&{alignmentOffset:P}),reset:O}}}),ts=(e,t,n)=>{const r=new Map,a=(0,f.A)({platform:Qa},n),s=(0,f.A)((0,f.A)({},a.platform),{},{_c:r});return(async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:s=[],platform:o}=n,i=s.filter(Boolean),l=await(null==o.isRTL?void 0:o.isRTL(t));let c=await o.getElementRects({reference:e,floating:t,strategy:a}),{x:d,y:u}=Ta(c,r,l),h=r,p={},m=0;for(let g=0;g<i.length;g++){const{name:n,fn:s}=i[g],{x:v,y:y,data:b,reset:x}=await s({x:d,y:u,initialPlacement:r,placement:h,strategy:a,middlewareData:p,rects:c,platform:o,elements:{reference:e,floating:t}});d=null!=v?v:d,u=null!=y?y:u,p=(0,f.A)((0,f.A)({},p),{},{[n]:(0,f.A)((0,f.A)({},p[n]),b)}),x&&m<=50&&(m++,"object"===typeof x&&(x.placement&&(h=x.placement),x.rects&&(c=!0===x.rects?await o.getElementRects({reference:e,floating:t,strategy:a}):x.rects),({x:d,y:u}=Ta(c,h,l))),g=-1)}return{x:d,y:u,placement:h,strategy:a,middlewareData:p}})(e,t,(0,f.A)((0,f.A)({},a),{},{platform:s}))};var ns="undefined"!==typeof document?r.useLayoutEffect:function(){};function rs(e,t){if(e===t)return!0;if(typeof e!==typeof t)return!1;if("function"===typeof e&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&"object"===typeof e){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;0!==r--;)if(!rs(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;0!==r--;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;0!==r--;){const n=a[r];if(("_owner"!==n||!e.$$typeof)&&!rs(e[n],t[n]))return!1}return!0}return e!==e&&t!==t}function as(e){if("undefined"===typeof window)return 1;return(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ss(e,t){const n=as(e);return Math.round(t*n)/n}function os(e){const t=r.useRef(e);return ns(()=>{t.current=e}),t}const is=(e,t)=>(0,f.A)((0,f.A)({},Xa(e)),{},{options:[e,t]}),ls=(e,t)=>(0,f.A)((0,f.A)({},(e=>({name:"arrow",options:e,fn(t){const{element:n,padding:r}="function"===typeof e?e(t):e;return n&&(a=n,{}.hasOwnProperty.call(a,"current"))?null!=n.current?es({element:n.current,padding:r}).fn(t):{}:n?es({element:n,padding:r}).fn(t):{};var a}}))(e)),{},{options:[e,t]}),cs=["transform"],ds=["context","width","height","tipRadius","strokeWidth","staticOffset","stroke","d","style"];const us="ArrowLeft",hs="ArrowRight",ps="ArrowUp",ms="ArrowDown";const fs=[us,hs],gs=[ps,ms],vs=(0,f.A)({},a);let ys=!1,bs=0;const xs=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+bs++;const ws=vs.useId||function(){const[e,t]=r.useState(()=>ys?xs():void 0);return Tr(()=>{null==e&&t(xs())},[]),r.useEffect(()=>{ys=!0},[]),e};const Ss=r.forwardRef(function(e,t){const{context:{placement:n,elements:{floating:a},middlewareData:{arrow:s,shift:o}},width:l=14,height:c=7,tipRadius:d=0,strokeWidth:u=0,staticOffset:h,stroke:p,d:m,style:{transform:g}={}}=e,v=Ar(e.style,cs),y=Ar(e,ds);const b=ws(),[x,w]=r.useState(!1);if(Tr(()=>{if(!a)return;"rtl"===ea(a).direction&&w(!0)},[a]),!a)return null;const[S,N]=n.split("-"),j="top"===S||"bottom"===S;let k=h;(j&&null!=o&&o.x||!j&&null!=o&&o.y)&&(k=null);const C=2*u,E=C/2,_=l/2*(d/-8+1),D=c/2*d/4,A=!!m,T=k&&"end"===N?"bottom":"top";let I=k&&"end"===N?"right":"left";k&&x&&(I="end"===N?"left":"right");const O=null!=(null==s?void 0:s.x)?k||s.x:"",P=null!=(null==s?void 0:s.y)?k||s.y:"",R=m||"M0,0 H"+l+" L"+(l-_)+","+(c-D)+" Q"+l/2+","+c+" "+_+","+(c-D)+" Z",M={top:A?"rotate(180deg)":"",left:A?"rotate(90deg)":"rotate(-90deg)",bottom:A?"":"rotate(180deg)",right:A?"rotate(-90deg)":"rotate(90deg)"}[S];return(0,i.jsxs)("svg",(0,f.A)((0,f.A)({},y),{},{"aria-hidden":!0,ref:t,width:A?l:l+C,height:l,viewBox:"0 0 "+l+" "+(c>l?c:l),style:(0,f.A)({position:"absolute",pointerEvents:"none",[I]:O,[T]:P,[S]:j||A?"100%":"calc(100% - "+C/2+"px)",transform:[M,g].filter(e=>!!e).join(" ")},v),children:[C>0&&(0,i.jsx)("path",{clipPath:"url(#"+b+")",fill:"none",stroke:p,strokeWidth:C+(m?0:1),d:R}),(0,i.jsx)("path",{stroke:C&&!m?y.fill:"none",d:R}),(0,i.jsx)("clipPath",{id:b,children:(0,i.jsx)("rect",{x:-E,y:E*(A?-1:1),width:l+C,height:l})})]}))});function Ns(){const e=new Map;return{emit(t,n){var r;null==(r=e.get(t))||r.forEach(e=>e(n))},on(t,n){e.has(t)||e.set(t,new Set),e.get(t).add(n)},off(t,n){var r;null==(r=e.get(t))||r.delete(n)}}}const js=r.createContext(null),ks=r.createContext(null),Cs=()=>{var e;return(null==(e=r.useContext(js))?void 0:e.id)||null},Es=()=>r.useContext(ks);function _s(e){const{open:t=!1,onOpenChange:n,elements:a}=e,s=ws(),o=r.useRef({}),[i]=r.useState(()=>Ns()),l=null!=Cs();const[c,d]=r.useState(a.reference),u=function(e){const t=r.useRef(()=>{});return Ir(()=>{t.current=e}),r.useCallback(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return null==t.current?void 0:t.current(...n)},[])}((e,t,r)=>{o.current.openEvent=e?t:void 0,i.emit("openchange",{open:e,event:t,reason:r,nested:l}),null==n||n(e,t,r)}),h=r.useMemo(()=>({setPositionReference:d}),[]),p=r.useMemo(()=>({reference:c||a.reference||null,floating:a.floating||null,domReference:a.reference}),[c,a.reference,a.floating]);return r.useMemo(()=>({dataRef:o,open:t,onOpenChange:u,elements:p,events:i,floatingId:s,refs:h}),[t,u,p,i,s,h])}function Ds(e){void 0===e&&(e={});const{nodeId:t}=e,n=_s((0,f.A)((0,f.A)({},e),{},{elements:(0,f.A)({reference:null,floating:null},e.elements)})),a=e.rootContext||n,s=a.elements,[o,i]=r.useState(null),[l,c]=r.useState(null),d=(null==s?void 0:s.domReference)||o,u=r.useRef(null),h=Es();Tr(()=>{d&&(u.current=d)},[d]);const p=function(e){void 0===e&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:a=[],platform:s,elements:{reference:o,floating:i}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[u,h]=r.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[p,m]=r.useState(a);rs(p,a)||m(a);const[g,v]=r.useState(null),[y,b]=r.useState(null),x=r.useCallback(e=>{e!==j.current&&(j.current=e,v(e))},[]),w=r.useCallback(e=>{e!==k.current&&(k.current=e,b(e))},[]),S=o||g,N=i||y,j=r.useRef(null),k=r.useRef(null),C=r.useRef(u),E=null!=c,_=os(c),D=os(s),A=os(d),T=r.useCallback(()=>{if(!j.current||!k.current)return;const e={placement:t,strategy:n,middleware:p};D.current&&(e.platform=D.current),ts(j.current,k.current,e).then(e=>{const t=(0,f.A)((0,f.A)({},e),{},{isPositioned:!1!==A.current});I.current&&!rs(C.current,t)&&(C.current=t,oa.flushSync(()=>{h(t)}))})},[p,t,n,D,A]);ns(()=>{!1===d&&C.current.isPositioned&&(C.current.isPositioned=!1,h(e=>(0,f.A)((0,f.A)({},e),{},{isPositioned:!1})))},[d]);const I=r.useRef(!1);ns(()=>(I.current=!0,()=>{I.current=!1}),[]),ns(()=>{if(S&&(j.current=S),N&&(k.current=N),S&&N){if(_.current)return _.current(S,N,T);T()}},[S,N,T,_,E]);const O=r.useMemo(()=>({reference:j,floating:k,setReference:x,setFloating:w}),[x,w]),P=r.useMemo(()=>({reference:S,floating:N}),[S,N]),R=r.useMemo(()=>{const e={position:n,left:0,top:0};if(!P.floating)return e;const t=ss(P.floating,u.x),r=ss(P.floating,u.y);return l?(0,f.A)((0,f.A)({},e),{},{transform:"translate("+t+"px, "+r+"px)"},as(P.floating)>=1.5&&{willChange:"transform"}):{position:n,left:t,top:r}},[n,l,P.floating,u.x,u.y]);return r.useMemo(()=>(0,f.A)((0,f.A)({},u),{},{update:T,refs:O,elements:P,floatingStyles:R}),[u,T,O,P,R])}((0,f.A)((0,f.A)({},e),{},{elements:(0,f.A)((0,f.A)({},s),l&&{reference:l})})),m=r.useCallback(e=>{const t=Fr(e)?{getBoundingClientRect:()=>e.getBoundingClientRect(),getClientRects:()=>e.getClientRects(),contextElement:e}:e;c(t),p.refs.setReference(t)},[p.refs]),g=r.useCallback(e=>{(Fr(e)||null===e)&&(u.current=e,i(e)),(Fr(p.refs.reference.current)||null===p.refs.reference.current||null!==e&&!Fr(e))&&p.refs.setReference(e)},[p.refs]),v=r.useMemo(()=>(0,f.A)((0,f.A)({},p.refs),{},{setReference:g,setPositionReference:m,domReference:u}),[p.refs,g,m]),y=r.useMemo(()=>(0,f.A)((0,f.A)({},p.elements),{},{domReference:d}),[p.elements,d]),b=r.useMemo(()=>(0,f.A)((0,f.A)((0,f.A)({},p),a),{},{refs:v,elements:y,nodeId:t}),[p,v,y,t,a]);return Tr(()=>{a.dataRef.current.floatingContext=b;const e=null==h?void 0:h.nodesRef.current.find(e=>e.id===t);e&&(e.context=b)}),r.useMemo(()=>(0,f.A)((0,f.A)({},p),{},{context:b,refs:v,elements:y}),[p,v,y,b])}var As=function(e,t){return As=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},As(e,t)};function Ts(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}As(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Is=function(){return Is=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Is.apply(this,arguments)};function Os(e,t,n){if(n||2===arguments.length)for(var r,a=0,s=t.length;a<s;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))}"function"===typeof SuppressedError&&SuppressedError;var Ps,Rs=function(e){var t=e.showTimeSelectOnly,n=void 0!==t&&t,a=e.showTime,s=void 0!==a&&a,o=e.className,i=e.children,l=n?"Choose Time":"Choose Date".concat(s?" and Time":"");return r.createElement("div",{className:o,role:"dialog","aria-label":l,"aria-modal":"true"},i)},Ms=function(e){var t=e.children,n=e.onClickOutside,a=e.className,s=e.containerRef,o=e.style,i=function(e,t){var n=(0,r.useRef)(null),a=(0,r.useRef)(e);a.current=e;var s=(0,r.useCallback)(function(e){var r,s=e.composed&&e.composedPath&&e.composedPath().find(function(e){return e instanceof Node})||e.target;n.current&&!n.current.contains(s)&&(t&&s instanceof HTMLElement&&s.classList.contains(t)||null===(r=a.current)||void 0===r||r.call(a,e))},[t]);return(0,r.useEffect)(function(){return document.addEventListener("mousedown",s),function(){document.removeEventListener("mousedown",s)}},[s]),n}(n,e.ignoreClass);return r.createElement("div",{className:a,style:o,ref:function(e){i.current=e,s&&(s.current=e)}},t)};function Ls(){return"undefined"!==typeof window?window:globalThis}!function(e){e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.PageUp="PageUp",e.PageDown="PageDown",e.Home="Home",e.End="End",e.Enter="Enter",e.Space=" ",e.Tab="Tab",e.Escape="Escape",e.Backspace="Backspace",e.X="x"}(Ps||(Ps={}));function Fs(e){if(null==e)return new Date;var t="string"===typeof e?be(e):ye(e);return Us(t)?t:new Date}function Bs(e,t,n,r,a){void 0===a&&(a=Fs());for(var s=so(n)||so(ao()),o=0,i=Array.isArray(t)?t:[t];o<i.length;o++){var l=i[o],c=sn(e,l,a,{locale:s,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});if(Us(c)&&(!r||e===zs(c,l,n)))return c}return null}function Us(e,t){return cn(e)&&!dn(e,new Date("1/1/1800"))}function zs(e,t,n){if("en"===n)return On(e,t,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var r=n?so(n):void 0;return n&&!r&&console.warn('A locale object was not found for the provided string ["'.concat(n,'"].')),On(e,t,{locale:r=r||so(ao()),useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function Hs(e,t){var n=t.dateFormat,r=t.locale,a=Array.isArray(n)&&n.length>0?n[0]:n;return e&&zs(e,a,r)||""}function qs(e,t){var n=t.hour,r=void 0===n?0:n,a=t.minute,s=void 0===a?0:a,o=t.second;return Rn(Mn(Ln(e,void 0===o?0:o),s),r)}function Ys(e){return hn(e)}function Ws(e,t,n){return Rt(e,{locale:so(t||ao()),weekStartsOn:n})}function Vs(e){return Fn(e)}function Ks(e){return mn(e)}function Gs(e){return Bn(e)}function Qs(){return hn(Fs())}function Js(e){return Un(e)}function $s(e){return Hn(e)}function Xs(e,t){return e&&t?qn(e,t):!e&&!t}function Zs(e,t){return e&&t?Yn(e,t):!e&&!t}function eo(e,t){return e&&t?Wn(e,t):!e&&!t}function to(e,t){return e&&t?Vn(e,t):!e&&!t}function no(e,t){return e&&t?Kn(e,t):!e&&!t}function ro(e,t,n){var r,a=hn(t),s=Un(n);try{r=Gn(e,{start:a,end:s})}catch(o){r=!1}return r}function ao(){return Ls().__localeId__}function so(e){if("string"===typeof e){var t=Ls();return t.__localeData__?t.__localeData__[e]:void 0}return e}function oo(e,t){return zs(Jn(Fs(),e),"LLLL",t)}function io(e,t){return zs(Jn(Fs(),e),"LLL",t)}function lo(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,s=n.excludeDates,o=n.excludeDateIntervals,i=n.includeDates,l=n.includeDateIntervals,c=n.filterDate;return yo(e,{minDate:r,maxDate:a})||s&&s.some(function(t){return t instanceof Date?to(e,t):to(e,t.date)})||o&&o.some(function(t){var n=t.start,r=t.end;return Gn(e,{start:n,end:r})})||i&&!i.some(function(t){return to(e,t)})||l&&!l.some(function(t){var n=t.start,r=t.end;return Gn(e,{start:n,end:r})})||c&&!c(Fs(e))||!1}function co(e,t){var n=void 0===t?{}:t,r=n.excludeDates,a=n.excludeDateIntervals;return a&&a.length>0?a.some(function(t){var n=t.start,r=t.end;return Gn(e,{start:n,end:r})}):r&&r.some(function(t){var n;return t instanceof Date?to(e,t):to(e,null!==(n=t.date)&&void 0!==n?n:new Date)})||!1}function uo(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,s=n.excludeDates,o=n.includeDates,i=n.filterDate;return yo(e,{minDate:r?Fn(r):void 0,maxDate:a?Hn(a):void 0})||(null===s||void 0===s?void 0:s.some(function(t){return Zs(e,t instanceof Date?t:t.date)}))||o&&!o.some(function(t){return Zs(e,t)})||i&&!i(Fs(e))||!1}function ho(e,t,n,r){var a=Xn(e),s=Zn(e),o=Xn(t),i=Zn(t),l=Xn(r);return a===o&&a===l?s<=n&&n<=i:a<o&&(l===a&&s<=n||l===o&&i>=n||l<o&&l>a)}function po(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,s=n.excludeDates,o=n.includeDates;return yo(e,{minDate:r,maxDate:a})||s&&s.some(function(t){return Zs(t instanceof Date?t:t.date,e)})||o&&!o.some(function(t){return Zs(t,e)})||!1}function mo(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,s=n.excludeDates,o=n.includeDates,i=n.filterDate;return yo(e,{minDate:r,maxDate:a})||(null===s||void 0===s?void 0:s.some(function(t){return eo(e,t instanceof Date?t:t.date)}))||o&&!o.some(function(t){return eo(e,t)})||i&&!i(Fs(e))||!1}function fo(e,t,n){if(!t||!n)return!1;if(!cn(t)||!cn(n))return!1;var r=Xn(t),a=Xn(n);return r<=e&&a>=e}function go(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.maxDate,s=n.excludeDates,o=n.includeDates,i=n.filterDate,l=new Date(e,0,1);return yo(l,{minDate:r?mn(r):void 0,maxDate:a?er(a):void 0})||(null===s||void 0===s?void 0:s.some(function(e){return Xs(l,e instanceof Date?e:e.date)}))||o&&!o.some(function(e){return Xs(l,e)})||i&&!i(Fs(l))||!1}function vo(e,t,n,r){var a=Xn(e),s=tr(e),o=Xn(t),i=tr(t),l=Xn(r);return a===o&&a===l?s<=n&&n<=i:a<o&&(l===a&&s<=n||l===o&&i>=n||l<o&&l>a)}function yo(e,t){var n,r=void 0===t?{}:t,a=r.minDate,s=r.maxDate;return null!==(n=a&&pn(e,a)<0||s&&pn(e,s)>0)&&void 0!==n&&n}function bo(e,t){return t.some(function(t){return nr(t)===nr(e)&&rr(t)===rr(e)&&ar(t)===ar(e)})}function xo(e,t){var n=void 0===t?{}:t,r=n.excludeTimes,a=n.includeTimes,s=n.filterTime;return r&&bo(e,r)||a&&!bo(e,a)||s&&!s(e)||!1}function wo(e,t){var n=t.minTime,r=t.maxTime;if(!n||!r)throw new Error("Both minTime and maxTime props required");var a=Fs();a=Ln(a=Mn(a=Rn(a,nr(e)),rr(e)),ar(e));var s=Fs();s=Ln(s=Mn(s=Rn(s,nr(n)),rr(n)),ar(n));var o,i=Fs();i=Ln(i=Mn(i=Rn(i,nr(r)),rr(r)),ar(r));try{o=!Gn(a,{start:s,end:i})}catch(l){o=!1}return o}function So(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.includeDates,s=or(e,1);return r&&ir(r,s)>0||a&&a.every(function(e){return ir(e,s)>0})||!1}function No(e,t){var n=void 0===t?{}:t,r=n.maxDate,a=n.includeDates,s=sr(e,1);return r&&ir(s,r)>0||a&&a.every(function(e){return ir(s,e)>0})||!1}function jo(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.includeDates,s=hr(e,1);return r&&pr(r,s)>0||a&&a.every(function(e){return pr(e,s)>0})||!1}function ko(e,t){var n=void 0===t?{}:t,r=n.maxDate,a=n.includeDates,s=ur(e,1);return r&&pr(s,r)>0||a&&a.every(function(e){return pr(s,e)>0})||!1}function Co(e){var t=e.minDate,n=e.includeDates;return n&&t?mr(n.filter(function(e){return pn(e,t)>=0})):n?mr(n):t}function Eo(e){var t=e.maxDate,n=e.includeDates;return n&&t?fr(n.filter(function(e){return pn(e,t)<=0})):n?fr(n):t}function _o(e,t){var n;void 0===e&&(e=[]),void 0===t&&(t="react-datepicker__day--highlighted");for(var r=new Map,a=0,s=e.length;a<s;a++){var o=e[a];if(ln(o)){var i=zs(o,"MM.dd.yyyy");(p=r.get(i)||[]).includes(t)||(p.push(t),r.set(i,p))}else if("object"===typeof o){var l=null!==(n=Object.keys(o)[0])&&void 0!==n?n:"",c=o[l];if("string"===typeof l&&Array.isArray(c))for(var d=0,u=c.length;d<u;d++){var h=c[d];if(h){var p;i=zs(h,"MM.dd.yyyy");(p=r.get(i)||[]).includes(l)||(p.push(l),r.set(i,p))}}}}return r}function Do(e,t){void 0===e&&(e=[]),void 0===t&&(t="react-datepicker__day--holidays");var n=new Map;return e.forEach(function(e){var r=e.date,a=e.holidayName;if(ln(r)){var s=zs(r,"MM.dd.yyyy"),o=n.get(s)||{className:"",holidayNames:[]};if(!("className"in o)||o.className!==t||(i=o.holidayNames,l=[a],i.length!==l.length||!i.every(function(e,t){return e===l[t]}))){var i,l;o.className=t;var c=o.holidayNames;o.holidayNames=c?Os(Os([],c,!0),[a],!1):[a],n.set(s,o)}}}),n}function Ao(e,t,n,r,a){for(var s=a.length,o=[],i=0;i<s;i++){var l=e,c=a[i];c&&(l=br(l=yr(l=vr(l,nr(c)),rr(c)),ar(c)));var d=yr(e,(n+1)*r);xr(l,t)&&dn(l,d)&&void 0!=c&&o.push(c)}return o}function To(e){return e<10?"0".concat(e):"".concat(e)}function Io(e,t){void 0===t&&(t=12);var n=Math.ceil(Xn(e)/t)*t;return{startPeriod:n-(t-1),endPeriod:n}}function Oo(e){var t=e.getSeconds(),n=e.getMilliseconds();return ye(e.getTime()-1e3*t-n)}function Po(e){if(!ln(e))throw new Error("Invalid date");var t=new Date(e);return t.setHours(0,0,0,0),t}function Ro(e,t){if(!ln(e)||!ln(t))throw new Error("Invalid date received");return dn(Po(e),Po(t))}function Mo(e){return e.key===Ps.Space}var Lo,Fo=function(e){function t(t){var n=e.call(this,t)||this;return n.inputRef=r.createRef(),n.onTimeChange=function(e){var t,r;n.setState({time:e});var a=n.props.date,s=a instanceof Date&&!isNaN(+a)?a:new Date;if(null===e||void 0===e?void 0:e.includes(":")){var o=e.split(":"),i=o[0],l=o[1];s.setHours(Number(i)),s.setMinutes(Number(l))}null===(r=(t=n.props).onChange)||void 0===r||r.call(t,s)},n.renderTimeInput=function(){var e=n.state.time,t=n.props,a=t.date,s=t.timeString,o=t.customTimeInput;return o?(0,r.cloneElement)(o,{date:a,value:e,onChange:n.onTimeChange}):r.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:n.inputRef,onClick:function(){var e;null===(e=n.inputRef.current)||void 0===e||e.focus()},required:!0,value:e,onChange:function(e){n.onTimeChange(e.target.value||s)}})},n.state={time:n.props.timeString},n}return Ts(t,e),t.getDerivedStateFromProps=function(e,t){return e.timeString!==t.time?{time:e.timeString}:null},t.prototype.render=function(){return r.createElement("div",{className:"react-datepicker__input-time-container"},r.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),r.createElement("div",{className:"react-datepicker-time__input-container"},r.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},t}(r.Component),Bo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dayEl=(0,r.createRef)(),t.handleClick=function(e){!t.isDisabled()&&t.props.onClick&&t.props.onClick(e)},t.handleMouseEnter=function(e){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(e)},t.handleOnKeyDown=function(e){var n,r;e.key===Ps.Space&&(e.preventDefault(),e.key=Ps.Enter),null===(r=(n=t.props).handleOnKeyDown)||void 0===r||r.call(n,e)},t.isSameDay=function(e){return to(t.props.day,e)},t.isKeyboardSelected=function(){var e;if(t.props.disabledKeyboardNavigation)return!1;var n=t.props.selectsMultiple?null===(e=t.props.selectedDates)||void 0===e?void 0:e.some(function(e){return t.isSameDayOrWeek(e)}):t.isSameDayOrWeek(t.props.selected),r=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!n&&t.isSameDayOrWeek(t.props.preSelection)&&!r},t.isDisabled=function(e){return void 0===e&&(e=t.props.day),lo(e,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return co(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return to(t.props.day,Ws(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(e){return t.props.showWeekPicker&&to(e,Ws(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(e){return t.isSameDay(e)||t.isSameWeek(e)},t.getHighLightedClass=function(){var e=t.props,n=e.day,r=e.highlightDates;if(!r)return!1;var a=zs(n,"MM.dd.yyyy");return r.get(a)},t.getHolidaysClass=function(){var e,n=t.props,r=n.day,a=n.holidays;if(!a)return[void 0];var s=zs(r,"MM.dd.yyyy");return a.has(s)?[null===(e=a.get(s))||void 0===e?void 0:e.className]:[void 0]},t.isInRange=function(){var e=t.props,n=e.day,r=e.startDate,a=e.endDate;return!(!r||!a)&&ro(n,r,a)},t.isInSelectingRange=function(){var e,n=t.props,r=n.day,a=n.selectsStart,s=n.selectsEnd,o=n.selectsRange,i=n.selectsDisabledDaysInRange,l=n.startDate,c=n.endDate,d=null!==(e=t.props.selectingDate)&&void 0!==e?e:t.props.preSelection;return!(!(a||s||o)||!d||!i&&t.isDisabled())&&(a&&c&&(dn(d,c)||no(d,c))?ro(r,d,c):(s&&l&&(xr(d,l)||no(d,l))||!(!o||!l||c||!xr(d,l)&&!no(d,l)))&&ro(r,l,d))},t.isSelectingRangeStart=function(){var e;if(!t.isInSelectingRange())return!1;var n=t.props,r=n.day,a=n.startDate,s=n.selectsStart,o=null!==(e=t.props.selectingDate)&&void 0!==e?e:t.props.preSelection;return to(r,s?o:a)},t.isSelectingRangeEnd=function(){var e;if(!t.isInSelectingRange())return!1;var n=t.props,r=n.day,a=n.endDate,s=n.selectsEnd,o=n.selectsRange,i=null!==(e=t.props.selectingDate)&&void 0!==e?e:t.props.preSelection;return to(r,s||o?i:a)},t.isRangeStart=function(){var e=t.props,n=e.day,r=e.startDate,a=e.endDate;return!(!r||!a)&&to(r,n)},t.isRangeEnd=function(){var e=t.props,n=e.day,r=e.startDate,a=e.endDate;return!(!r||!a)&&to(a,n)},t.isWeekend=function(){var e=wr(t.props.day);return 0===e||6===e},t.isAfterMonth=function(){return void 0!==t.props.month&&(t.props.month+1)%12===Zn(t.props.day)},t.isBeforeMonth=function(){return void 0!==t.props.month&&(Zn(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(Fs())},t.isSelected=function(){var e;return t.props.selectsMultiple?null===(e=t.props.selectedDates)||void 0===e?void 0:e.some(function(e){return t.isSameDayOrWeek(e)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(e){var n;return he("react-datepicker__day",t.props.dayClassName?t.props.dayClassName(e):void 0,"react-datepicker__day--"+zs(t.props.day,"ddd",n),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var e=t.props,n=e.day,r=e.ariaLabelPrefixWhenEnabled,a=void 0===r?"Choose":r,s=e.ariaLabelPrefixWhenDisabled,o=void 0===s?"Not available":s,i=t.isDisabled()||t.isExcluded()?o:a;return"".concat(i," ").concat(zs(n,"PPPP",t.props.locale))},t.getTitle=function(){var e=t.props,n=e.day,r=e.holidays,a=void 0===r?new Map:r,s=e.excludeDates,o=zs(n,"MM.dd.yyyy"),i=[];return a.has(o)&&i.push.apply(i,a.get(o).holidayNames),t.isExcluded()&&i.push(null===s||void 0===s?void 0:s.filter(function(e){return e instanceof Date?to(e,n):to(null===e||void 0===e?void 0:e.date,n)}).map(function(e){if(!(e instanceof Date))return null===e||void 0===e?void 0:e.message})),i.join(", ")},t.getTabIndex=function(){var e=t.props.selected,n=t.props.preSelection;return(!t.props.showWeekPicker||!t.props.showWeekNumber&&t.isStartOfWeek())&&(t.isKeyboardSelected()||t.isSameDay(e)&&to(n,e))?0:-1},t.handleFocusDay=function(){var e;t.shouldFocusDay()&&(null===(e=t.dayEl.current)||void 0===e||e.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(Sr(t.props.day),t.props.day):Sr(t.props.day)},t.render=function(){return r.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),""!==t.getTitle()&&r.createElement("span",{className:"overlay"},t.getTitle()))},t}return Ts(t,e),t.prototype.componentDidMount=function(){this.handleFocusDay()},t.prototype.componentDidUpdate=function(){this.handleFocusDay()},t.prototype.shouldFocusDay=function(){var e=!1;return 0===this.getTabIndex()&&this.isSameDay(this.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(e=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(e=!1),this.isDayActiveElement()&&(e=!0),this.isDuplicateDay()&&(e=!1)),e},t.prototype.isDayActiveElement=function(){var e,t,n;return(null===(t=null===(e=this.props.containerRef)||void 0===e?void 0:e.current)||void 0===t?void 0:t.contains(document.activeElement))&&(null===(n=document.activeElement)||void 0===n?void 0:n.classList.contains("react-datepicker__day"))},t.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},t}(r.Component),Uo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.weekNumberEl=(0,r.createRef)(),t.handleClick=function(e){t.props.onClick&&t.props.onClick(e)},t.handleOnKeyDown=function(e){var n,r;e.key===Ps.Space&&(e.preventDefault(),e.key=Ps.Enter),null===(r=(n=t.props).handleOnKeyDown)||void 0===r||r.call(n,e)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!to(t.props.date,t.props.selected)&&to(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||to(t.props.date,t.props.selected)&&to(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(e){var n=!1;0===t.getTabIndex()&&!(null===e||void 0===e?void 0:e.isInputFocused)&&to(t.props.date,t.props.preSelection)&&(document.activeElement&&document.activeElement!==document.body||(n=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(n=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(n=!0)),n&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Ts(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},t.prototype.componentDidUpdate=function(e){this.handleFocusWeekNumber(e)},t.prototype.render=function(){var e=this.props,n=e.weekNumber,a=e.isWeekDisabled,s=e.ariaLabelPrefix,o=void 0===s?t.defaultProps.ariaLabelPrefix:s,i=e.onClick,l={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!i&&!a,"react-datepicker__week-number--selected":!!i&&to(this.props.date,this.props.selected)};return r.createElement("div",{ref:this.weekNumberEl,className:he(l),"aria-label":"".concat(o," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},n)},t}(r.Component),zo=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.isDisabled=function(e){return lo(e,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,excludeDateIntervals:n.props.excludeDateIntervals,includeDateIntervals:n.props.includeDateIntervals,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.handleDayClick=function(e,t){n.props.onDayClick&&n.props.onDayClick(e,t)},n.handleDayMouseEnter=function(e){n.props.onDayMouseEnter&&n.props.onDayMouseEnter(e)},n.handleWeekClick=function(e,r,a){for(var s,o,i,l=new Date(e),c=0;c<7;c++){var d=new Date(e);if(d.setDate(d.getDate()+c),!n.isDisabled(d)){l=d;break}}"function"===typeof n.props.onWeekSelect&&n.props.onWeekSelect(l,r,a),n.props.showWeekPicker&&n.handleDayClick(l,a),(null!==(s=n.props.shouldCloseOnSelect)&&void 0!==s?s:t.defaultProps.shouldCloseOnSelect)&&(null===(i=(o=n.props).setOpen)||void 0===i||i.call(o,!1))},n.formatWeekNumber=function(e){return n.props.formatWeekNumber?n.props.formatWeekNumber(e):function(e){return qt(e)}(e)},n.isWeekDisabled=function(){for(var e=n.startOfWeek(),t=Kt(e,6),r=new Date(e);r<=t;){if(!n.isDisabled(r))return!1;r=Kt(r,1)}return!0},n.renderDays=function(){var e=n.startOfWeek(),a=[],s=n.formatWeekNumber(e);if(n.props.showWeekNumber){var o=n.props.onWeekSelect||n.props.showWeekPicker?n.handleWeekClick.bind(n,e,s):void 0;a.push(r.createElement(Uo,Is({key:"W"},t.defaultProps,n.props,{weekNumber:s,isWeekDisabled:n.isWeekDisabled(),date:e,onClick:o})))}return a.concat([0,1,2,3,4,5,6].map(function(a){var s=Kt(e,a);return r.createElement(Bo,Is({},t.defaultProps,n.props,{ariaLabelPrefixWhenEnabled:n.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:n.props.disabledDayAriaLabelPrefix,key:s.valueOf(),day:s,onClick:n.handleDayClick.bind(n,s),onMouseEnter:n.handleDayMouseEnter.bind(n,s)}))}))},n.startOfWeek=function(){return Ws(n.props.day,n.props.locale,n.props.calendarStartDay)},n.isKeyboardSelected=function(){return!n.props.disabledKeyboardNavigation&&!to(n.startOfWeek(),n.props.selected)&&to(n.startOfWeek(),n.props.preSelection)},n}return Ts(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e={"react-datepicker__week":!0,"react-datepicker__week--selected":to(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return r.createElement("div",{className:he(e)},this.renderDays())},t}(r.Component),Ho="two_columns",qo="three_columns",Yo="four_columns",Wo=((Lo={})[Ho]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},Lo[qo]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},Lo[Yo]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},Lo);function Vo(e,t){return e?Yo:t?Ho:qo}var Ko=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MONTH_REFS=Os([],Array(12),!0).map(function(){return(0,r.createRef)()}),t.QUARTER_REFS=Os([],Array(4),!0).map(function(){return(0,r.createRef)()}),t.isDisabled=function(e){return lo(e,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(e){return co(e,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(e,n){var r,a;null===(a=(r=t.props).onDayClick)||void 0===a||a.call(r,e,n,t.props.orderInDisplay)},t.handleDayMouseEnter=function(e){var n,r;null===(r=(n=t.props).onDayMouseEnter)||void 0===r||r.call(n,e)},t.handleMouseLeave=function(){var e,n;null===(n=(e=t.props).onMouseLeave)||void 0===n||n.call(e)},t.isRangeStartMonth=function(e){var n=t.props,r=n.day,a=n.startDate,s=n.endDate;return!(!a||!s)&&Zs(Jn(r,e),a)},t.isRangeStartQuarter=function(e){var n=t.props,r=n.day,a=n.startDate,s=n.endDate;return!(!a||!s)&&eo($n(r,e),a)},t.isRangeEndMonth=function(e){var n=t.props,r=n.day,a=n.startDate,s=n.endDate;return!(!a||!s)&&Zs(Jn(r,e),s)},t.isRangeEndQuarter=function(e){var n=t.props,r=n.day,a=n.startDate,s=n.endDate;return!(!a||!s)&&eo($n(r,e),s)},t.isInSelectingRangeMonth=function(e){var n,r=t.props,a=r.day,s=r.selectsStart,o=r.selectsEnd,i=r.selectsRange,l=r.startDate,c=r.endDate,d=null!==(n=t.props.selectingDate)&&void 0!==n?n:t.props.preSelection;return!(!(s||o||i)||!d)&&(s&&c?ho(d,c,e,a):(o&&l||!(!i||!l||c))&&ho(l,d,e,a))},t.isSelectingMonthRangeStart=function(e){var n;if(!t.isInSelectingRangeMonth(e))return!1;var r=t.props,a=r.day,s=r.startDate,o=r.selectsStart,i=Jn(a,e),l=null!==(n=t.props.selectingDate)&&void 0!==n?n:t.props.preSelection;return Zs(i,o?l:s)},t.isSelectingMonthRangeEnd=function(e){var n;if(!t.isInSelectingRangeMonth(e))return!1;var r=t.props,a=r.day,s=r.endDate,o=r.selectsEnd,i=r.selectsRange,l=Jn(a,e),c=null!==(n=t.props.selectingDate)&&void 0!==n?n:t.props.preSelection;return Zs(l,o||i?c:s)},t.isInSelectingRangeQuarter=function(e){var n,r=t.props,a=r.day,s=r.selectsStart,o=r.selectsEnd,i=r.selectsRange,l=r.startDate,c=r.endDate,d=null!==(n=t.props.selectingDate)&&void 0!==n?n:t.props.preSelection;return!(!(s||o||i)||!d)&&(s&&c?vo(d,c,e,a):(o&&l||!(!i||!l||c))&&vo(l,d,e,a))},t.isWeekInMonth=function(e){var n=t.props.day,r=Kt(e,6);return Zs(e,n)||Zs(r,n)},t.isCurrentMonth=function(e,t){return Xn(e)===Xn(Fs())&&t===Zn(Fs())},t.isCurrentQuarter=function(e,t){return Xn(e)===Xn(Fs())&&t===tr(Fs())},t.isSelectedMonth=function(e,t,n){return Zn(n)===t&&Xn(e)===Xn(n)},t.isSelectMonthInList=function(e,n,r){return r.some(function(r){return t.isSelectedMonth(e,n,r)})},t.isSelectedQuarter=function(e,t,n){return tr(e)===t&&Xn(e)===Xn(n)},t.isMonthSelected=function(){var e=t.props,n=e.day,r=e.selected,a=e.selectedDates,s=e.selectsMultiple,o=Zn(n);return s?null===a||void 0===a?void 0:a.some(function(e){return t.isSelectedMonth(n,o,e)}):!!r&&t.isSelectedMonth(n,o,r)},t.renderWeeks=function(){for(var e=[],n=t.props.fixedHeight,a=0,s=!1,o=Ws(Vs(t.props.day),t.props.locale,t.props.calendarStartDay),i=t.props.selected?function(e){return t.props.showWeekPicker?Ws(e,t.props.locale,t.props.calendarStartDay):t.props.selected}(t.props.selected):void 0,l=t.props.preSelection?function(e){return t.props.showWeekPicker?Ws(e,t.props.locale,t.props.calendarStartDay):t.props.preSelection}(t.props.preSelection):void 0;e.push(r.createElement(zo,Is({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:a,day:o,month:Zn(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:i,preSelection:l,showWeekNumber:t.props.showWeekNumbers}))),!s;){a++,o=Nr(o,1);var c=n&&a>=6,d=!n&&!t.isWeekInMonth(o);if(c||d){if(!t.props.peekNextMonth)break;s=!0}}return e},t.onMonthClick=function(e,n){var r=t.isMonthDisabledForLabelDate(n),a=r.isDisabled,s=r.labelDate;a||t.handleDayClick(Vs(s),e)},t.onMonthMouseEnter=function(e){var n=t.isMonthDisabledForLabelDate(e),r=n.isDisabled,a=n.labelDate;r||t.handleDayMouseEnter(Vs(a))},t.handleMonthNavigation=function(e,n){var r,a,s,o;null===(a=(r=t.props).setPreSelection)||void 0===a||a.call(r,n),null===(o=null===(s=t.MONTH_REFS[e])||void 0===s?void 0:s.current)||void 0===o||o.focus()},t.handleKeyboardNavigation=function(e,n,r){var a,s=t.props,o=s.selected,i=s.preSelection,l=s.setPreSelection,c=s.minDate,d=s.maxDate,u=s.showFourColumnMonthYearPicker,h=s.showTwoColumnMonthYearPicker;if(i){var p=Vo(u,h),m=t.getVerticalOffset(p),f=null===(a=Wo[p])||void 0===a?void 0:a.grid,g=function(e,t,n){var r,a,s=t,o=n;switch(e){case Ps.ArrowRight:s=sr(t,1),o=11===n?0:n+1;break;case Ps.ArrowLeft:s=or(t,1),o=0===n?11:n-1;break;case Ps.ArrowUp:s=or(t,m),o=(null===(r=null===f||void 0===f?void 0:f[0])||void 0===r?void 0:r.includes(n))?n+12-m:n-m;break;case Ps.ArrowDown:s=sr(t,m),o=(null===(a=null===f||void 0===f?void 0:f[f.length-1])||void 0===a?void 0:a.includes(n))?n-12+m:n+m}return{newCalculatedDate:s,newCalculatedMonth:o}};if(n!==Ps.Enter){var v=function(e,n,r){for(var a=e,s=!1,o=0,i=g(a,n,r),l=i.newCalculatedDate,u=i.newCalculatedMonth;!s;){if(o>=40){l=n,u=r;break}var h;if(c&&l<c)a=Ps.ArrowRight,l=(h=g(a,l,u)).newCalculatedDate,u=h.newCalculatedMonth;if(d&&l>d)a=Ps.ArrowLeft,l=(h=g(a,l,u)).newCalculatedDate,u=h.newCalculatedMonth;if(po(l,t.props))l=(h=g(a,l,u)).newCalculatedDate,u=h.newCalculatedMonth;else s=!0;o++}return{newCalculatedDate:l,newCalculatedMonth:u}}(n,i,r),y=v.newCalculatedDate,b=v.newCalculatedMonth;switch(n){case Ps.ArrowRight:case Ps.ArrowLeft:case Ps.ArrowUp:case Ps.ArrowDown:t.handleMonthNavigation(b,y)}}else t.isMonthDisabled(r)||(t.onMonthClick(e,r),null===l||void 0===l||l(o))}},t.getVerticalOffset=function(e){var t,n;return null!==(n=null===(t=Wo[e])||void 0===t?void 0:t.verticalNavigationOffset)&&void 0!==n?n:0},t.onMonthKeyDown=function(e,n){var r=t.props,a=r.disabledKeyboardNavigation,s=r.handleOnMonthKeyDown,o=e.key;o!==Ps.Tab&&e.preventDefault(),a||t.handleKeyboardNavigation(e,o,n),s&&s(e)},t.onQuarterClick=function(e,n){var r=$n(t.props.day,n);mo(r,t.props)||t.handleDayClick(Gs(r),e)},t.onQuarterMouseEnter=function(e){var n=$n(t.props.day,e);mo(n,t.props)||t.handleDayMouseEnter(Gs(n))},t.handleQuarterNavigation=function(e,n){var r,a,s,o;t.isDisabled(n)||t.isExcluded(n)||(null===(a=(r=t.props).setPreSelection)||void 0===a||a.call(r,n),null===(o=null===(s=t.QUARTER_REFS[e-1])||void 0===s?void 0:s.current)||void 0===o||o.focus())},t.onQuarterKeyDown=function(e,n){var r,a,s=e.key;if(!t.props.disabledKeyboardNavigation)switch(s){case Ps.Enter:t.onQuarterClick(e,n),null===(a=(r=t.props).setPreSelection)||void 0===a||a.call(r,t.props.selected);break;case Ps.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(4===n?1:n+1,lr(t.props.preSelection,1));break;case Ps.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(1===n?4:n-1,cr(t.props.preSelection,1))}},t.isMonthDisabledForLabelDate=function(e){var n,r=t.props,a=r.day,s=r.minDate,o=r.maxDate,i=r.excludeDates,l=r.includeDates,c=Jn(a,e);return{isDisabled:null!==(n=(s||o||i||l)&&uo(c,t.props))&&void 0!==n&&n,labelDate:c}},t.isMonthDisabled=function(e){return t.isMonthDisabledForLabelDate(e).isDisabled},t.getMonthClassNames=function(e){var n=t.props,r=n.day,a=n.startDate,s=n.endDate,o=n.preSelection,i=n.monthClassName,l=i?i(Jn(r,e)):void 0,c=t.getSelection();return he("react-datepicker__month-text","react-datepicker__month-".concat(e),l,{"react-datepicker__month-text--disabled":t.isMonthDisabled(e),"react-datepicker__month-text--selected":c?t.isSelectMonthInList(r,e,c):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&o&&t.isSelectedMonth(r,e,o)&&!t.isMonthSelected()&&!t.isMonthDisabled(e),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(e),"react-datepicker__month-text--in-range":a&&s?ho(a,s,e,r):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(e),"react-datepicker__month-text--range-end":t.isRangeEndMonth(e),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(e),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(e),"react-datepicker__month-text--today":t.isCurrentMonth(r,e)})},t.getTabIndex=function(e){if(null==t.props.preSelection)return"-1";var n=Zn(t.props.preSelection),r=t.isMonthDisabledForLabelDate(n).isDisabled;return e!==n||r||t.props.disabledKeyboardNavigation?"-1":"0"},t.getQuarterTabIndex=function(e){if(null==t.props.preSelection)return"-1";var n=tr(t.props.preSelection),r=mo(t.props.day,t.props);return e!==n||r||t.props.disabledKeyboardNavigation?"-1":"0"},t.getAriaLabel=function(e){var n=t.props,r=n.chooseDayAriaLabelPrefix,a=void 0===r?"Choose":r,s=n.disabledDayAriaLabelPrefix,o=void 0===s?"Not available":s,i=n.day,l=n.locale,c=Jn(i,e),d=t.isDisabled(c)||t.isExcluded(c)?o:a;return"".concat(d," ").concat(zs(c,"MMMM yyyy",l))},t.getQuarterClassNames=function(e){var n=t.props,r=n.day,a=n.startDate,s=n.endDate,o=n.selected,i=n.minDate,l=n.maxDate,c=n.excludeDates,d=n.includeDates,u=n.filterDate,h=n.preSelection,p=n.disabledKeyboardNavigation,m=(i||l||c||d||u)&&mo($n(r,e),t.props);return he("react-datepicker__quarter-text","react-datepicker__quarter-".concat(e),{"react-datepicker__quarter-text--disabled":m,"react-datepicker__quarter-text--selected":o?t.isSelectedQuarter(r,e,o):void 0,"react-datepicker__quarter-text--keyboard-selected":!p&&h&&t.isSelectedQuarter(r,e,h)&&!m,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(e),"react-datepicker__quarter-text--in-range":a&&s?vo(a,s,e,r):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(e),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(e),"react-datepicker__quarter-text--today":t.isCurrentQuarter(r,e)})},t.getMonthContent=function(e){var n=t.props,r=n.showFullMonthYearPicker,a=n.renderMonthContent,s=n.locale,o=n.day,i=io(e,s),l=oo(e,s);return a?a(e,i,l,o):r?l:i},t.getQuarterContent=function(e){var n,r=t.props,a=r.renderQuarterContent,s=function(e,t){return zs($n(Fs(),e),"QQQ",t)}(e,r.locale);return null!==(n=null===a||void 0===a?void 0:a(e,s))&&void 0!==n?n:s},t.renderMonths=function(){var e,n=t.props,a=n.showTwoColumnMonthYearPicker,s=n.showFourColumnMonthYearPicker,o=n.day,i=n.selected,l=null===(e=Wo[Vo(s,a)])||void 0===e?void 0:e.grid;return null===l||void 0===l?void 0:l.map(function(e,n){return r.createElement("div",{className:"react-datepicker__month-wrapper",key:n},e.map(function(e,n){return r.createElement("div",{ref:t.MONTH_REFS[e],key:n,onClick:function(n){t.onMonthClick(n,e)},onKeyDown:function(n){Mo(n)&&(n.preventDefault(),n.key=Ps.Enter),t.onMonthKeyDown(n,e)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(e)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(e)}:void 0,tabIndex:Number(t.getTabIndex(e)),className:t.getMonthClassNames(e),"aria-disabled":t.isMonthDisabled(e),role:"option","aria-label":t.getAriaLabel(e),"aria-current":t.isCurrentMonth(o,e)?"date":void 0,"aria-selected":i?t.isSelectedMonth(o,e,i):void 0},t.getMonthContent(e))}))})},t.renderQuarters=function(){var e=t.props,n=e.day,a=e.selected;return r.createElement("div",{className:"react-datepicker__quarter-wrapper"},[1,2,3,4].map(function(e,s){return r.createElement("div",{key:s,ref:t.QUARTER_REFS[s],role:"option",onClick:function(n){t.onQuarterClick(n,e)},onKeyDown:function(n){t.onQuarterKeyDown(n,e)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(e)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(e)}:void 0,className:t.getQuarterClassNames(e),"aria-selected":a?t.isSelectedQuarter(n,e,a):void 0,tabIndex:Number(t.getQuarterTabIndex(e)),"aria-current":t.isCurrentQuarter(n,e)?"date":void 0},t.getQuarterContent(e))}))},t.getClassNames=function(){var e=t.props,n=e.selectingDate,r=e.selectsStart,a=e.selectsEnd;return he("react-datepicker__month",{"react-datepicker__month--selecting-range":n&&(r||a)},{"react-datepicker__monthPicker":e.showMonthYearPicker},{"react-datepicker__quarterPicker":e.showQuarterYearPicker},{"react-datepicker__weekPicker":e.showWeekPicker})},t}return Ts(t,e),t.prototype.getSelection=function(){var e=this.props,t=e.selected,n=e.selectedDates;return e.selectsMultiple?n:t?[t]:void 0},t.prototype.render=function(){var e=this.props,t=e.showMonthYearPicker,n=e.showQuarterYearPicker,a=e.day,s=e.ariaLabelPrefix,o=void 0===s?"Month ":s,i=o?o.trim()+" ":"";return r.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(i).concat(zs(a,"MMMM, yyyy",this.props.locale)),role:"listbox"},t?this.renderMonths():n?this.renderQuarters():this.renderWeeks())},t}(r.Component),Go=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isSelectedMonth=function(e){return t.props.month===e},t.renderOptions=function(){return t.props.monthNames.map(function(e,n){return r.createElement("div",{className:t.isSelectedMonth(n)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:e,onClick:t.onChange.bind(t,n),"aria-selected":t.isSelectedMonth(n)?"true":void 0},t.isSelectedMonth(n)?r.createElement("span",{className:"react-datepicker__month-option--selected"},"\u2713"):"",e)})},t.onChange=function(e){return t.props.onChange(e)},t.handleClickOutside=function(){return t.props.onCancel()},t}return Ts(t,e),t.prototype.render=function(){return r.createElement(Ms,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},t}(r.Component),Qo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(e){return e.map(function(e,t){return r.createElement("option",{key:e,value:t},e)})},t.renderSelectMode=function(e){return r.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(e){return t.onChange(parseInt(e.target.value))}},t.renderSelectOptions(e))},t.renderReadView=function(e,n){return r.createElement("div",{key:"read",style:{visibility:e?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},r.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),r.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},n[t.props.month]))},t.renderDropdown=function(e){return r.createElement(Go,Is({key:"dropdown"},t.props,{monthNames:e,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(e){var n=t.state.dropdownVisible,r=[t.renderReadView(!n,e)];return n&&r.unshift(t.renderDropdown(e)),r},t.onChange=function(e){t.toggleDropdown(),e!==t.props.month&&t.props.onChange(e)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return Ts(t,e),t.prototype.render=function(){var e,t=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(e){return io(e,t.props.locale)}:function(e){return oo(e,t.props.locale)});switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode(n);break;case"select":e=this.renderSelectMode(n)}return r.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},e)},t}(r.Component);function Jo(e,t){for(var n=[],r=Vs(e),a=Vs(t);!xr(r,a);)n.push(Fs(r)),r=sr(r,1);return n}var $o=function(e){function t(t){var n=e.call(this,t)||this;return n.renderOptions=function(){return n.state.monthYearsList.map(function(e){var t=jr(e),a=Xs(n.props.date,e)&&Zs(n.props.date,e);return r.createElement("div",{className:a?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:t,onClick:n.onChange.bind(n,t),"aria-selected":a?"true":void 0},a?r.createElement("span",{className:"react-datepicker__month-year-option--selected"},"\u2713"):"",zs(e,n.props.dateFormat,n.props.locale))})},n.onChange=function(e){return n.props.onChange(e)},n.handleClickOutside=function(){n.props.onCancel()},n.state={monthYearsList:Jo(n.props.minDate,n.props.maxDate)},n}return Ts(t,e),t.prototype.render=function(){var e=he({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return r.createElement(Ms,{className:e,onClickOutside:this.handleClickOutside},this.renderOptions())},t}(r.Component),Xo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var e=Vs(t.props.minDate),n=Vs(t.props.maxDate),a=[];!xr(e,n);){var s=jr(e);a.push(r.createElement("option",{key:s,value:s},zs(e,t.props.dateFormat,t.props.locale))),e=sr(e,1)}return a},t.onSelectChange=function(e){t.onChange(parseInt(e.target.value))},t.renderSelectMode=function(){return r.createElement("select",{value:jr(Vs(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(e){var n=zs(t.props.date,t.props.dateFormat,t.props.locale);return r.createElement("div",{key:"read",style:{visibility:e?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},r.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),r.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},n))},t.renderDropdown=function(){return r.createElement($o,Is({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var e=t.state.dropdownVisible,n=[t.renderReadView(!e)];return e&&n.unshift(t.renderDropdown()),n},t.onChange=function(e){t.toggleDropdown();var n=Fs(e);Xs(t.props.date,n)&&Zs(t.props.date,n)||t.props.onChange(n)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return Ts(t,e),t.prototype.render=function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return r.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},e)},t}(r.Component),Zo=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.state={height:null},n.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var e,r,a;n.list&&(n.list.scrollTop=null!==(a=n.centerLi&&t.calcCenterPosition(n.props.monthRef?n.props.monthRef.clientHeight-(null!==(r=null===(e=n.header)||void 0===e?void 0:e.clientHeight)&&void 0!==r?r:0):n.list.clientHeight,n.centerLi))&&void 0!==a?a:0)})},n.handleClick=function(e){var t,r;(n.props.minTime||n.props.maxTime)&&wo(e,n.props)||(n.props.excludeTimes||n.props.includeTimes||n.props.filterTime)&&xo(e,n.props)||null===(r=(t=n.props).onChange)||void 0===r||r.call(t,e)},n.isSelectedTime=function(e){return n.props.selected&&(t=n.props.selected,r=e,Oo(t).getTime()===Oo(r).getTime());var t,r},n.isDisabledTime=function(e){return(n.props.minTime||n.props.maxTime)&&wo(e,n.props)||(n.props.excludeTimes||n.props.includeTimes||n.props.filterTime)&&xo(e,n.props)},n.liClasses=function(e){var r,a=["react-datepicker__time-list-item",n.props.timeClassName?n.props.timeClassName(e):void 0];return n.isSelectedTime(e)&&a.push("react-datepicker__time-list-item--selected"),n.isDisabledTime(e)&&a.push("react-datepicker__time-list-item--disabled"),n.props.injectTimes&&(3600*nr(e)+60*rr(e)+ar(e))%(60*(null!==(r=n.props.intervals)&&void 0!==r?r:t.defaultProps.intervals))!==0&&a.push("react-datepicker__time-list-item--injected"),a.join(" ")},n.handleOnKeyDown=function(e,t){var r,a;e.key===Ps.Space&&(e.preventDefault(),e.key=Ps.Enter),(e.key===Ps.ArrowUp||e.key===Ps.ArrowLeft)&&e.target instanceof HTMLElement&&e.target.previousSibling&&(e.preventDefault(),e.target.previousSibling instanceof HTMLElement&&e.target.previousSibling.focus()),(e.key===Ps.ArrowDown||e.key===Ps.ArrowRight)&&e.target instanceof HTMLElement&&e.target.nextSibling&&(e.preventDefault(),e.target.nextSibling instanceof HTMLElement&&e.target.nextSibling.focus()),e.key===Ps.Enter&&n.handleClick(t),null===(a=(r=n.props).handleOnKeyDown)||void 0===a||a.call(r,e)},n.renderTimes=function(){for(var e,a=[],s="string"===typeof n.props.format?n.props.format:"p",o=null!==(e=n.props.intervals)&&void 0!==e?e:t.defaultProps.intervals,i=n.props.selected||n.props.openToDate||Fs(),l=Ys(i),c=n.props.injectTimes&&n.props.injectTimes.sort(function(e,t){return e.getTime()-t.getTime()}),d=60*function(e){var t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),24);return Math.round((+n-+t)/36e5)}(i),u=d/o,h=0;h<u;h++){var p=yr(l,h*o);if(a.push(p),c){var m=Ao(l,p,h,o,c);a=a.concat(m)}}var f=a.reduce(function(e,t){return t.getTime()<=i.getTime()?t:e},a[0]);return a.map(function(e){return r.createElement("li",{key:e.valueOf(),onClick:n.handleClick.bind(n,e),className:n.liClasses(e),ref:function(t){e===f&&(n.centerLi=t)},onKeyDown:function(t){n.handleOnKeyDown(t,e)},tabIndex:e===f?0:-1,role:"option","aria-selected":n.isSelectedTime(e)?"true":void 0,"aria-disabled":n.isDisabledTime(e)?"true":void 0},zs(e,s,n.props.locale))})},n.renderTimeCaption=function(){return!1===n.props.showTimeCaption?r.createElement(r.Fragment,null):r.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(n.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(e){n.header=e}},r.createElement("div",{className:"react-datepicker-time__header"},n.props.timeCaption))},n}return Ts(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},t.prototype.componentWillUnmount=function(){var e;null===(e=this.resizeObserver)||void 0===e||e.disconnect()},t.prototype.observeDatePickerHeightChanges=function(){var e=this,t=this.props.monthRef;this.updateContainerHeight(),t&&(this.resizeObserver=new ResizeObserver(function(){e.updateContainerHeight()}),this.resizeObserver.observe(t))},t.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},t.prototype.render=function(){var e,n=this,a=this.state.height;return r.createElement("div",{className:"react-datepicker__time-container ".concat((null!==(e=this.props.todayButton)&&void 0!==e?e:t.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),r.createElement("div",{className:"react-datepicker__time"},r.createElement("div",{className:"react-datepicker__time-box"},r.createElement("ul",{className:"react-datepicker__time-list",ref:function(e){n.list=e},style:a?{height:a}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},t.calcCenterPosition=function(e,t){return t.offsetTop-(e/2-t.clientHeight/2)},t}(r.Component),ei=function(e){function t(t){var n=e.call(this,t)||this;return n.YEAR_REFS=Os([],Array(n.props.yearItemNumber),!0).map(function(){return(0,r.createRef)()}),n.isDisabled=function(e){return lo(e,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.isExcluded=function(e){return co(e,{excludeDates:n.props.excludeDates})},n.selectingDate=function(){var e;return null!==(e=n.props.selectingDate)&&void 0!==e?e:n.props.preSelection},n.updateFocusOnPaginate=function(e){window.requestAnimationFrame(function(){var t,r;null===(r=null===(t=n.YEAR_REFS[e])||void 0===t?void 0:t.current)||void 0===r||r.focus()})},n.handleYearClick=function(e,t){n.props.onDayClick&&n.props.onDayClick(e,t)},n.handleYearNavigation=function(e,t){var r,a,s,o,i=n.props,l=i.date,c=i.yearItemNumber;if(void 0!==l&&void 0!==c){var d=Io(l,c).startPeriod;n.isDisabled(t)||n.isExcluded(t)||(null===(a=(r=n.props).setPreSelection)||void 0===a||a.call(r,t),e-d<0?n.updateFocusOnPaginate(c-(d-e)):e-d>=c?n.updateFocusOnPaginate(Math.abs(c-(e-d))):null===(o=null===(s=n.YEAR_REFS[e-d])||void 0===s?void 0:s.current)||void 0===o||o.focus())}},n.isSameDay=function(e,t){return to(e,t)},n.isCurrentYear=function(e){return e===Xn(Fs())},n.isRangeStart=function(e){return n.props.startDate&&n.props.endDate&&Xs(kr(Fs(),e),n.props.startDate)},n.isRangeEnd=function(e){return n.props.startDate&&n.props.endDate&&Xs(kr(Fs(),e),n.props.endDate)},n.isInRange=function(e){return fo(e,n.props.startDate,n.props.endDate)},n.isInSelectingRange=function(e){var t=n.props,r=t.selectsStart,a=t.selectsEnd,s=t.selectsRange,o=t.startDate,i=t.endDate;return!(!(r||a||s)||!n.selectingDate())&&(r&&i?fo(e,n.selectingDate(),i):(a&&o||!(!s||!o||i))&&fo(e,o,n.selectingDate()))},n.isSelectingRangeStart=function(e){var t;if(!n.isInSelectingRange(e))return!1;var r=n.props,a=r.startDate,s=r.selectsStart,o=kr(Fs(),e);return Xs(o,s?null!==(t=n.selectingDate())&&void 0!==t?t:null:null!==a&&void 0!==a?a:null)},n.isSelectingRangeEnd=function(e){var t;if(!n.isInSelectingRange(e))return!1;var r=n.props,a=r.endDate,s=r.selectsEnd,o=r.selectsRange,i=kr(Fs(),e);return Xs(i,s||o?null!==(t=n.selectingDate())&&void 0!==t?t:null:null!==a&&void 0!==a?a:null)},n.isKeyboardSelected=function(e){if(void 0!==n.props.date&&null!=n.props.selected&&null!=n.props.preSelection){var t=n.props,r=t.minDate,a=t.maxDate,s=t.excludeDates,o=t.includeDates,i=t.filterDate,l=Ks(kr(n.props.date,e)),c=(r||a||s||o||i)&&go(e,n.props);return!n.props.disabledKeyboardNavigation&&!n.props.inline&&!to(l,Ks(n.props.selected))&&to(l,Ks(n.props.preSelection))&&!c}},n.isSelectedYear=function(e){var t=n.props,r=t.selectsMultiple,a=t.selected,s=t.selectedDates;return r?null===s||void 0===s?void 0:s.some(function(t){return e===Xn(t)}):!!a&&e===Xn(a)},n.onYearClick=function(e,t){var r=n.props.date;void 0!==r&&n.handleYearClick(Ks(kr(r,t)),e)},n.onYearKeyDown=function(e,t){var r,a,s=e.key,o=n.props,i=o.date,l=o.yearItemNumber,c=o.handleOnKeyDown;if(s!==Ps.Tab&&e.preventDefault(),!n.props.disabledKeyboardNavigation)switch(s){case Ps.Enter:if(null==n.props.selected)break;n.onYearClick(e,t),null===(a=(r=n.props).setPreSelection)||void 0===a||a.call(r,n.props.selected);break;case Ps.ArrowRight:if(null==n.props.preSelection)break;n.handleYearNavigation(t+1,ur(n.props.preSelection,1));break;case Ps.ArrowLeft:if(null==n.props.preSelection)break;n.handleYearNavigation(t-1,hr(n.props.preSelection,1));break;case Ps.ArrowUp:if(void 0===i||void 0===l||null==n.props.preSelection)break;var d=Io(i,l).startPeriod;if((p=t-(h=3))<d){var u=l%h;t>=d&&t<d+u?h=u:h+=u,p=t-h}n.handleYearNavigation(p,hr(n.props.preSelection,h));break;case Ps.ArrowDown:if(void 0===i||void 0===l||null==n.props.preSelection)break;var h,p,m=Io(i,l).endPeriod;if((p=t+(h=3))>m){u=l%h;t<=m&&t>m-u?h=u:h+=u,p=t+h}n.handleYearNavigation(p,ur(n.props.preSelection,h))}c&&c(e)},n.getYearClassNames=function(e){var t=n.props,r=t.date,a=t.minDate,s=t.maxDate,o=t.excludeDates,i=t.includeDates,l=t.filterDate,c=t.yearClassName;return he("react-datepicker__year-text","react-datepicker__year-".concat(e),r?null===c||void 0===c?void 0:c(kr(r,e)):void 0,{"react-datepicker__year-text--selected":n.isSelectedYear(e),"react-datepicker__year-text--disabled":(a||s||o||i||l)&&go(e,n.props),"react-datepicker__year-text--keyboard-selected":n.isKeyboardSelected(e),"react-datepicker__year-text--range-start":n.isRangeStart(e),"react-datepicker__year-text--range-end":n.isRangeEnd(e),"react-datepicker__year-text--in-range":n.isInRange(e),"react-datepicker__year-text--in-selecting-range":n.isInSelectingRange(e),"react-datepicker__year-text--selecting-range-start":n.isSelectingRangeStart(e),"react-datepicker__year-text--selecting-range-end":n.isSelectingRangeEnd(e),"react-datepicker__year-text--today":n.isCurrentYear(e)})},n.getYearTabIndex=function(e){if(n.props.disabledKeyboardNavigation||null==n.props.preSelection)return"-1";var t=Xn(n.props.preSelection),r=go(e,n.props);return e!==t||r?"-1":"0"},n.getYearContent=function(e){return n.props.renderYearContent?n.props.renderYearContent(e):e},n}return Ts(t,e),t.prototype.render=function(){var e=this,t=[],n=this.props,a=n.date,s=n.yearItemNumber,o=n.onYearMouseEnter,i=n.onYearMouseLeave;if(void 0===a)return null;for(var l=Io(a,s),c=l.startPeriod,d=l.endPeriod,u=function(n){t.push(r.createElement("div",{ref:h.YEAR_REFS[n-c],onClick:function(t){e.onYearClick(t,n)},onKeyDown:function(t){Mo(t)&&(t.preventDefault(),t.key=Ps.Enter),e.onYearKeyDown(t,n)},tabIndex:Number(h.getYearTabIndex(n)),className:h.getYearClassNames(n),onMouseEnter:h.props.usePointerEvent?void 0:function(e){return o(e,n)},onPointerEnter:h.props.usePointerEvent?function(e){return o(e,n)}:void 0,onMouseLeave:h.props.usePointerEvent?void 0:function(e){return i(e,n)},onPointerLeave:h.props.usePointerEvent?function(e){return i(e,n)}:void 0,key:n,"aria-current":h.isCurrentYear(n)?"date":void 0},h.getYearContent(n)))},h=this,p=c;p<=d;p++)u(p);return r.createElement("div",{className:"react-datepicker__year"},r.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},t))},t}(r.Component);function ti(e,t,n,r){for(var a=[],s=0;s<2*t+1;s++){var o=e+t-s,i=!0;n&&(i=Xn(n)<=o),r&&i&&(i=Xn(r)>=o),i&&a.push(o)}return a}var ni=function(e){function t(t){var n=e.call(this,t)||this;n.renderOptions=function(){var e=n.props.year,t=n.state.yearsList.map(function(t){return r.createElement("div",{className:e===t?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:t,onClick:n.onChange.bind(n,t),"aria-selected":e===t?"true":void 0},e===t?r.createElement("span",{className:"react-datepicker__year-option--selected"},"\u2713"):"",t)}),a=n.props.minDate?Xn(n.props.minDate):null,s=n.props.maxDate?Xn(n.props.maxDate):null;return s&&n.state.yearsList.find(function(e){return e===s})||t.unshift(r.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:n.incrementYears},r.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),a&&n.state.yearsList.find(function(e){return e===a})||t.push(r.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:n.decrementYears},r.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),t},n.onChange=function(e){n.props.onChange(e)},n.handleClickOutside=function(){n.props.onCancel()},n.shiftYears=function(e){var t=n.state.yearsList.map(function(t){return t+e});n.setState({yearsList:t})},n.incrementYears=function(){return n.shiftYears(1)},n.decrementYears=function(){return n.shiftYears(-1)};var a=t.yearDropdownItemNumber,s=t.scrollableYearDropdown,o=a||(s?10:5);return n.state={yearsList:ti(n.props.year,o,n.props.minDate,n.props.maxDate)},n.dropdownRef=(0,r.createRef)(),n}return Ts(t,e),t.prototype.componentDidMount=function(){var e=this.dropdownRef.current;if(e){var t=e.children?Array.from(e.children):null,n=t?t.find(function(e){return e.ariaSelected}):null;e.scrollTop=n&&n instanceof HTMLElement?n.offsetTop+(n.clientHeight-e.clientHeight)/2:(e.scrollHeight-e.clientHeight)/2}},t.prototype.render=function(){var e=he({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return r.createElement(Ms,{className:e,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},t}(r.Component),ri=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var e=t.props.minDate?Xn(t.props.minDate):1900,n=t.props.maxDate?Xn(t.props.maxDate):2100,a=[],s=e;s<=n;s++)a.push(r.createElement("option",{key:s,value:s},s));return a},t.onSelectChange=function(e){t.onChange(parseInt(e.target.value))},t.renderSelectMode=function(){return r.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(e){return r.createElement("div",{key:"read",style:{visibility:e?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(e){return t.toggleDropdown(e)}},r.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),r.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return r.createElement(ni,Is({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var e=t.state.dropdownVisible,n=[t.renderReadView(!e)];return e&&n.unshift(t.renderDropdown()),n},t.onChange=function(e){t.toggleDropdown(),e!==t.props.year&&t.props.onChange(e)},t.toggleDropdown=function(e){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,e)})},t.handleYearChange=function(e,n){var r;null===(r=t.onSelect)||void 0===r||r.call(t,e,n),t.setOpen()},t.onSelect=function(e,n){var r,a;null===(a=(r=t.props).onSelect)||void 0===a||a.call(r,e,n)},t.setOpen=function(){var e,n;null===(n=(e=t.props).setOpen)||void 0===n||n.call(e,!0)},t}return Ts(t,e),t.prototype.render=function(){var e;switch(this.props.dropdownMode){case"scroll":e=this.renderScrollMode();break;case"select":e=this.renderSelectMode()}return r.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},e)},t}(r.Component),ai=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],si=function(e){function t(n){var a=e.call(this,n)||this;return a.monthContainer=void 0,a.handleClickOutside=function(e){a.props.onClickOutside(e)},a.setClickOutsideRef=function(){return a.containerRef.current},a.handleDropdownFocus=function(e){var t,n;(function(e){var t=(e.className||"").split(/\s+/);return ai.some(function(e){return t.indexOf(e)>=0})})(e.target)&&(null===(n=(t=a.props).onDropdownFocus)||void 0===n||n.call(t,e))},a.getDateInView=function(){var e=a.props,t=e.preSelection,n=e.selected,r=e.openToDate,s=Co(a.props),o=Eo(a.props),i=Fs(),l=r||n||t;return l||(s&&dn(i,s)?s:o&&xr(i,o)?o:i)},a.increaseMonth=function(){a.setState(function(e){return{date:sr(e.date,1)}},function(){return a.handleMonthChange(a.state.date)})},a.decreaseMonth=function(){a.setState(function(e){return{date:or(e.date,1)}},function(){return a.handleMonthChange(a.state.date)})},a.handleDayClick=function(e,t,n){a.props.onSelect(e,t,n),a.props.setPreSelection&&a.props.setPreSelection(e)},a.handleDayMouseEnter=function(e){a.setState({selectingDate:e}),a.props.onDayMouseEnter&&a.props.onDayMouseEnter(e)},a.handleMonthMouseLeave=function(){a.setState({selectingDate:void 0}),a.props.onMonthMouseLeave&&a.props.onMonthMouseLeave()},a.handleYearMouseEnter=function(e,t){a.setState({selectingDate:kr(Fs(),t)}),a.props.onYearMouseEnter&&a.props.onYearMouseEnter(e,t)},a.handleYearMouseLeave=function(e,t){a.props.onYearMouseLeave&&a.props.onYearMouseLeave(e,t)},a.handleYearChange=function(e){var t,n,r,s;null===(n=(t=a.props).onYearChange)||void 0===n||n.call(t,e),a.setState({isRenderAriaLiveMessage:!0}),a.props.adjustDateOnChange&&(a.props.onSelect(e),null===(s=(r=a.props).setOpen)||void 0===s||s.call(r,!0)),a.props.setPreSelection&&a.props.setPreSelection(e)},a.getEnabledPreSelectionDateForMonth=function(e){if(!lo(e,a.props))return e;for(var t=Vs(e),n=Cr($s(e),t),r=null,s=0;s<=n;s++){var o=Kt(t,s);if(!lo(o,a.props)){r=o;break}}return r},a.handleMonthChange=function(e){var t,n,r,s=null!==(t=a.getEnabledPreSelectionDateForMonth(e))&&void 0!==t?t:e;a.handleCustomMonthChange(s),a.props.adjustDateOnChange&&(a.props.onSelect(s),null===(r=(n=a.props).setOpen)||void 0===r||r.call(n,!0)),a.props.setPreSelection&&a.props.setPreSelection(s)},a.handleCustomMonthChange=function(e){var t,n;null===(n=(t=a.props).onMonthChange)||void 0===n||n.call(t,e),a.setState({isRenderAriaLiveMessage:!0})},a.handleMonthYearChange=function(e){a.handleYearChange(e),a.handleMonthChange(e)},a.changeYear=function(e){a.setState(function(t){return{date:kr(t.date,Number(e))}},function(){return a.handleYearChange(a.state.date)})},a.changeMonth=function(e){a.setState(function(t){return{date:Jn(t.date,Number(e))}},function(){return a.handleMonthChange(a.state.date)})},a.changeMonthYear=function(e){a.setState(function(t){return{date:kr(Jn(t.date,Zn(e)),Xn(e))}},function(){return a.handleMonthYearChange(a.state.date)})},a.header=function(e){void 0===e&&(e=a.state.date);var t=Ws(e,a.props.locale,a.props.calendarStartDay),n=[];return a.props.showWeekNumbers&&n.push(r.createElement("div",{key:"W",className:"react-datepicker__day-name"},a.props.weekLabel||"#")),n.concat([0,1,2,3,4,5,6].map(function(e){var n=Kt(t,e),s=a.formatWeekday(n,a.props.locale),o=a.props.weekDayClassName?a.props.weekDayClassName(n):void 0;return r.createElement("div",{key:e,"aria-label":zs(n,"EEEE",a.props.locale),className:he("react-datepicker__day-name",o)},s)}))},a.formatWeekday=function(e,t){return a.props.formatWeekDay?function(e,t,n){return t(zs(e,"EEEE",n))}(e,a.props.formatWeekDay,t):a.props.useWeekdaysShort?function(e,t){return zs(e,"EEE",t)}(e,t):function(e,t){return zs(e,"EEEEEE",t)}(e,t)},a.decreaseYear=function(){a.setState(function(e){var n;return{date:hr(e.date,a.props.showYearPicker?null!==(n=a.props.yearItemNumber)&&void 0!==n?n:t.defaultProps.yearItemNumber:1)}},function(){return a.handleYearChange(a.state.date)})},a.clearSelectingDate=function(){a.setState({selectingDate:void 0})},a.renderPreviousButton=function(){var e,n,s;if(!a.props.renderCustomHeader){var o,i=null!==(e=a.props.monthsShown)&&void 0!==e?e:t.defaultProps.monthsShown,l=a.props.showPreviousMonths?i-1:0,c=null!==(n=a.props.monthSelectedIn)&&void 0!==n?n:l,d=or(a.state.date,c);switch(!0){case a.props.showMonthYearPicker:o=jo(a.state.date,a.props);break;case a.props.showYearPicker:o=function(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.yearItemNumber,s=void 0===a?12:a,o=Io(Ks(hr(e,s)),s).endPeriod,i=r&&Xn(r);return i&&i>o||!1}(a.state.date,a.props);break;case a.props.showQuarterYearPicker:o=function(e,t){var n=void 0===t?{}:t,r=n.minDate,a=n.includeDates,s=cr(mn(e),1);return r&&dr(r,s)>0||a&&a.every(function(e){return dr(e,s)>0})||!1}(a.state.date,a.props);break;default:o=So(d,a.props)}if(((null!==(s=a.props.forceShowMonthNavigation)&&void 0!==s?s:t.defaultProps.forceShowMonthNavigation)||a.props.showDisabledMonthNavigation||!o)&&!a.props.showTimeSelectOnly){var u=["react-datepicker__navigation","react-datepicker__navigation--previous"],h=a.decreaseMonth;(a.props.showMonthYearPicker||a.props.showQuarterYearPicker||a.props.showYearPicker)&&(h=a.decreaseYear),o&&a.props.showDisabledMonthNavigation&&(u.push("react-datepicker__navigation--previous--disabled"),h=void 0);var p=a.props.showMonthYearPicker||a.props.showQuarterYearPicker||a.props.showYearPicker,m=a.props,f=m.previousMonthButtonLabel,g=void 0===f?t.defaultProps.previousMonthButtonLabel:f,v=m.previousYearButtonLabel,y=void 0===v?t.defaultProps.previousYearButtonLabel:v,b=a.props,x=b.previousMonthAriaLabel,w=void 0===x?"string"===typeof g?g:"Previous Month":x,S=b.previousYearAriaLabel,N=void 0===S?"string"===typeof y?y:"Previous Year":S;return r.createElement("button",{type:"button",className:u.join(" "),onClick:h,onKeyDown:a.props.handleOnKeyDown,"aria-label":p?N:w},r.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"].join(" ")},p?y:g))}}},a.increaseYear=function(){a.setState(function(e){var n;return{date:ur(e.date,a.props.showYearPicker?null!==(n=a.props.yearItemNumber)&&void 0!==n?n:t.defaultProps.yearItemNumber:1)}},function(){return a.handleYearChange(a.state.date)})},a.renderNextButton=function(){var e;if(!a.props.renderCustomHeader){var n;switch(!0){case a.props.showMonthYearPicker:n=ko(a.state.date,a.props);break;case a.props.showYearPicker:n=function(e,t){var n=void 0===t?{}:t,r=n.maxDate,a=n.yearItemNumber,s=void 0===a?12:a,o=Io(ur(e,s),s).startPeriod,i=r&&Xn(r);return i&&i<o||!1}(a.state.date,a.props);break;case a.props.showQuarterYearPicker:n=function(e,t){var n=void 0===t?{}:t,r=n.maxDate,a=n.includeDates,s=lr(er(e),1);return r&&dr(s,r)>0||a&&a.every(function(e){return dr(s,e)>0})||!1}(a.state.date,a.props);break;default:n=No(a.state.date,a.props)}if(((null!==(e=a.props.forceShowMonthNavigation)&&void 0!==e?e:t.defaultProps.forceShowMonthNavigation)||a.props.showDisabledMonthNavigation||!n)&&!a.props.showTimeSelectOnly){var s=["react-datepicker__navigation","react-datepicker__navigation--next"];a.props.showTimeSelect&&s.push("react-datepicker__navigation--next--with-time"),a.props.todayButton&&s.push("react-datepicker__navigation--next--with-today-button");var o=a.increaseMonth;(a.props.showMonthYearPicker||a.props.showQuarterYearPicker||a.props.showYearPicker)&&(o=a.increaseYear),n&&a.props.showDisabledMonthNavigation&&(s.push("react-datepicker__navigation--next--disabled"),o=void 0);var i=a.props.showMonthYearPicker||a.props.showQuarterYearPicker||a.props.showYearPicker,l=a.props,c=l.nextMonthButtonLabel,d=void 0===c?t.defaultProps.nextMonthButtonLabel:c,u=l.nextYearButtonLabel,h=void 0===u?t.defaultProps.nextYearButtonLabel:u,p=a.props,m=p.nextMonthAriaLabel,f=void 0===m?"string"===typeof d?d:"Next Month":m,g=p.nextYearAriaLabel,v=void 0===g?"string"===typeof h?h:"Next Year":g;return r.createElement("button",{type:"button",className:s.join(" "),onClick:o,onKeyDown:a.props.handleOnKeyDown,"aria-label":i?v:f},r.createElement("span",{className:["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"].join(" ")},i?h:d))}}},a.renderCurrentMonth=function(e){void 0===e&&(e=a.state.date);var t=["react-datepicker__current-month"];return a.props.showYearDropdown&&t.push("react-datepicker__current-month--hasYearDropdown"),a.props.showMonthDropdown&&t.push("react-datepicker__current-month--hasMonthDropdown"),a.props.showMonthYearDropdown&&t.push("react-datepicker__current-month--hasMonthYearDropdown"),r.createElement("h2",{className:t.join(" ")},zs(e,a.props.dateFormat,a.props.locale))},a.renderYearDropdown=function(e){if(void 0===e&&(e=!1),a.props.showYearDropdown&&!e)return r.createElement(ri,Is({},t.defaultProps,a.props,{date:a.state.date,onChange:a.changeYear,year:Xn(a.state.date)}))},a.renderMonthDropdown=function(e){if(void 0===e&&(e=!1),a.props.showMonthDropdown&&!e)return r.createElement(Qo,Is({},t.defaultProps,a.props,{month:Zn(a.state.date),onChange:a.changeMonth}))},a.renderMonthYearDropdown=function(e){if(void 0===e&&(e=!1),a.props.showMonthYearDropdown&&!e)return r.createElement(Xo,Is({},t.defaultProps,a.props,{date:a.state.date,onChange:a.changeMonthYear}))},a.handleTodayButtonClick=function(e){a.props.onSelect(Qs(),e),a.props.setPreSelection&&a.props.setPreSelection(Qs())},a.renderTodayButton=function(){if(a.props.todayButton&&!a.props.showTimeSelectOnly)return r.createElement("div",{className:"react-datepicker__today-button",onClick:a.handleTodayButtonClick},a.props.todayButton)},a.renderDefaultHeader=function(e){var t=e.monthDate,n=e.i;return r.createElement("div",{className:"react-datepicker__header ".concat(a.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},a.renderCurrentMonth(t),r.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(a.props.dropdownMode),onFocus:a.handleDropdownFocus},a.renderMonthDropdown(0!==n),a.renderMonthYearDropdown(0!==n),a.renderYearDropdown(0!==n)),r.createElement("div",{className:"react-datepicker__day-names"},a.header(t)))},a.renderCustomHeader=function(e){var t,n,s=e.monthDate,o=e.i;if(a.props.showTimeSelect&&!a.state.monthContainer||a.props.showTimeSelectOnly)return null;var i=So(a.state.date,a.props),l=No(a.state.date,a.props),c=jo(a.state.date,a.props),d=ko(a.state.date,a.props),u=!a.props.showMonthYearPicker&&!a.props.showQuarterYearPicker&&!a.props.showYearPicker;return r.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:a.props.onDropdownFocus},null===(n=(t=a.props).renderCustomHeader)||void 0===n?void 0:n.call(t,Is(Is({},a.state),{customHeaderCount:o,monthDate:s,changeMonth:a.changeMonth,changeYear:a.changeYear,decreaseMonth:a.decreaseMonth,increaseMonth:a.increaseMonth,decreaseYear:a.decreaseYear,increaseYear:a.increaseYear,prevMonthButtonDisabled:i,nextMonthButtonDisabled:l,prevYearButtonDisabled:c,nextYearButtonDisabled:d})),u&&r.createElement("div",{className:"react-datepicker__day-names"},a.header(s)))},a.renderYearHeader=function(e){var n=e.monthDate,s=a.props,o=s.showYearPicker,i=s.yearItemNumber,l=Io(n,void 0===i?t.defaultProps.yearItemNumber:i),c=l.startPeriod,d=l.endPeriod;return r.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},o?"".concat(c," - ").concat(d):Xn(n))},a.renderHeader=function(e){var t=e.monthDate,n=e.i,r={monthDate:t,i:void 0===n?0:n};switch(!0){case void 0!==a.props.renderCustomHeader:return a.renderCustomHeader(r);case a.props.showMonthYearPicker||a.props.showQuarterYearPicker||a.props.showYearPicker:return a.renderYearHeader(r);default:return a.renderDefaultHeader(r)}},a.renderMonths=function(){var e,n;if(!a.props.showTimeSelectOnly&&!a.props.showYearPicker){for(var s=[],o=null!==(e=a.props.monthsShown)&&void 0!==e?e:t.defaultProps.monthsShown,i=a.props.showPreviousMonths?o-1:0,l=a.props.showMonthYearPicker||a.props.showQuarterYearPicker?ur(a.state.date,i):or(a.state.date,i),c=null!==(n=a.props.monthSelectedIn)&&void 0!==n?n:i,d=0;d<o;++d){var u=d-c+i,h=a.props.showMonthYearPicker||a.props.showQuarterYearPicker?ur(l,u):sr(l,u),p="month-".concat(d),m=d<o-1,f=d>0;s.push(r.createElement("div",{key:p,ref:function(e){a.monthContainer=null!==e&&void 0!==e?e:void 0},className:"react-datepicker__month-container"},a.renderHeader({monthDate:h,i:d}),r.createElement(Ko,Is({},t.defaultProps,a.props,{containerRef:a.containerRef,ariaLabelPrefix:a.props.monthAriaLabelPrefix,day:h,onDayClick:a.handleDayClick,handleOnKeyDown:a.props.handleOnDayKeyDown,handleOnMonthKeyDown:a.props.handleOnKeyDown,onDayMouseEnter:a.handleDayMouseEnter,onMouseLeave:a.handleMonthMouseLeave,orderInDisplay:d,selectingDate:a.state.selectingDate,monthShowsDuplicateDaysEnd:m,monthShowsDuplicateDaysStart:f}))))}return s}},a.renderYears=function(){if(!a.props.showTimeSelectOnly)return a.props.showYearPicker?r.createElement("div",{className:"react-datepicker__year--container"},a.renderHeader({monthDate:a.state.date}),r.createElement(ei,Is({},t.defaultProps,a.props,{selectingDate:a.state.selectingDate,date:a.state.date,onDayClick:a.handleDayClick,clearSelectingDate:a.clearSelectingDate,onYearMouseEnter:a.handleYearMouseEnter,onYearMouseLeave:a.handleYearMouseLeave}))):void 0},a.renderTimeSection=function(){if(a.props.showTimeSelect&&(a.state.monthContainer||a.props.showTimeSelectOnly))return r.createElement(Zo,Is({},t.defaultProps,a.props,{onChange:a.props.onTimeChange,format:a.props.timeFormat,intervals:a.props.timeIntervals,monthRef:a.state.monthContainer}))},a.renderInputTimeSection=function(){var e=a.props.selected?new Date(a.props.selected):void 0,n=e&&Us(e)&&Boolean(a.props.selected)?"".concat(To(e.getHours()),":").concat(To(e.getMinutes())):"";if(a.props.showTimeInput)return r.createElement(Fo,Is({},t.defaultProps,a.props,{date:e,timeString:n,onChange:a.props.onTimeChange}))},a.renderAriaLiveRegion=function(){var e,n,s=Io(a.state.date,null!==(e=a.props.yearItemNumber)&&void 0!==e?e:t.defaultProps.yearItemNumber),o=s.startPeriod,i=s.endPeriod;return n=a.props.showYearPicker?"".concat(o," - ").concat(i):a.props.showMonthYearPicker||a.props.showQuarterYearPicker?Xn(a.state.date):"".concat(oo(Zn(a.state.date),a.props.locale)," ").concat(Xn(a.state.date)),r.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},a.state.isRenderAriaLiveMessage&&n)},a.renderChildren=function(){if(a.props.children)return r.createElement("div",{className:"react-datepicker__children-container"},a.props.children)},a.containerRef=(0,r.createRef)(),a.state={date:a.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},a}return Ts(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:12}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){var e=this;this.props.showTimeSelect&&(this.assignMonthContainer=void e.setState({monthContainer:e.monthContainer}))},t.prototype.componentDidUpdate=function(e){var t=this;if(!this.props.preSelection||to(this.props.preSelection,e.preSelection)&&this.props.monthSelectedIn===e.monthSelectedIn)this.props.openToDate&&!to(this.props.openToDate,e.openToDate)&&this.setState({date:this.props.openToDate});else{var n=!Zs(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return n&&t.handleCustomMonthChange(t.state.date)})}},t.prototype.render=function(){var e=this.props.container||Rs;return r.createElement(Ms,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},r.createElement("div",{style:{display:"contents"},ref:this.containerRef},r.createElement(e,{className:he("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},t}(r.Component),oi=function(e){var t=e.icon,n=e.className,a=void 0===n?"":n,s=e.onClick,o="react-datepicker__calendar-icon";if("string"===typeof t)return r.createElement("i",{className:"".concat(o," ").concat(t," ").concat(a),"aria-hidden":"true",onClick:s});if(r.isValidElement(t)){var i=t;return r.cloneElement(i,{className:"".concat(i.props.className||""," ").concat(o," ").concat(a),onClick:function(e){"function"===typeof i.props.onClick&&i.props.onClick(e),"function"===typeof s&&s(e)}})}return r.createElement("svg",{className:"".concat(o," ").concat(a),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:s},r.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},ii=function(e){function t(t){var n=e.call(this,t)||this;return n.portalRoot=null,n.el=document.createElement("div"),n}return Ts(t,e),t.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},t.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},t.prototype.render=function(){return oa.createPortal(this.props.children,this.el)},t}(r.Component),li=function(e){return(e instanceof HTMLAnchorElement||!e.disabled)&&-1!==e.tabIndex},ci=function(e){function t(t){var n=e.call(this,t)||this;return n.getTabChildren=function(){var e;return Array.prototype.slice.call(null===(e=n.tabLoopRef.current)||void 0===e?void 0:e.querySelectorAll("[tabindex], a, button, input, select, textarea"),1,-1).filter(li)},n.handleFocusStart=function(){var e=n.getTabChildren();e&&e.length>1&&e[e.length-1].focus()},n.handleFocusEnd=function(){var e=n.getTabChildren();e&&e.length>1&&e[0].focus()},n.tabLoopRef=(0,r.createRef)(),n}return Ts(t,e),t.prototype.render=function(){var e;return(null!==(e=this.props.enableTabLoop)&&void 0!==e?e:t.defaultProps.enableTabLoop)?r.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},r.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,r.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},t.defaultProps={enableTabLoop:!0},t}(r.Component);var di,ui=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ts(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this.props,n=e.className,a=e.wrapperClassName,s=e.hidePopper,o=void 0===s?t.defaultProps.hidePopper:s,i=e.popperComponent,l=e.targetComponent,c=e.enableTabLoop,d=e.popperOnKeyDown,u=e.portalId,h=e.portalHost,p=e.popperProps,m=e.showArrow,f=void 0;if(!o){var g=he("react-datepicker-popper",n);f=r.createElement(ci,{enableTabLoop:c},r.createElement("div",{ref:p.refs.setFloating,style:p.floatingStyles,className:g,"data-placement":p.placement,onKeyDown:d},i,m&&r.createElement(Ss,{ref:p.arrowRef,context:p.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(f=(0,r.createElement)(this.props.popperContainer,{},f)),u&&!o&&(f=r.createElement(ii,{portalId:u,portalHost:h},f));var v=he("react-datepicker-wrapper",a);return r.createElement(r.Fragment,null,r.createElement("div",{ref:p.refs.setReference,className:v},l),f)},t}(r.Component),hi=(di=ui,function(e){var t,n,a,s="boolean"!==typeof e.hidePopper||e.hidePopper,o=(0,r.useRef)(null),i=Ds(Is({open:!s,whileElementsMounted:$a,placement:e.popperPlacement,middleware:Os([(n={padding:15},(0,f.A)((0,f.A)({},Za(n)),{},{options:[n,a]})),is(10),ls({element:o})],null!==(t=e.popperModifiers)&&void 0!==t?t:[],!0)},e.popperProps)),l=Is(Is({},e),{hidePopper:s,popperProps:Is(Is({},i),{arrowRef:o})});return r.createElement(di,Is({},l))}),pi="react-datepicker-ignore-onclickoutside";var mi="Date input not valid.",fi=function(e){function t(n){var a=e.call(this,n)||this;return a.calendar=null,a.input=null,a.getPreSelection=function(){return a.props.openToDate?a.props.openToDate:a.props.selectsEnd&&a.props.startDate?a.props.startDate:a.props.selectsStart&&a.props.endDate?a.props.endDate:Fs()},a.modifyHolidays=function(){var e;return null===(e=a.props.holidays)||void 0===e?void 0:e.reduce(function(e,t){var n=new Date(t.date);return Us(n)?Os(Os([],e,!0),[Is(Is({},t),{date:n})],!1):e},[])},a.calcInitialState=function(){var e,t=a.getPreSelection(),n=Co(a.props),r=Eo(a.props),s=n&&dn(t,Ys(n))?n:r&&xr(t,Js(r))?r:t;return{open:a.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:null!==(e=a.props.selectsRange?a.props.startDate:a.props.selected)&&void 0!==e?e:s,highlightDates:_o(a.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},a.resetHiddenStatus=function(){a.setState(Is(Is({},a.state),{wasHidden:!1}))},a.setHiddenStatus=function(){a.setState(Is(Is({},a.state),{wasHidden:!0}))},a.setHiddenStateOnVisibilityHidden=function(){"hidden"===document.visibilityState&&a.setHiddenStatus()},a.clearPreventFocusTimeout=function(){a.preventFocusTimeout&&clearTimeout(a.preventFocusTimeout)},a.setFocus=function(){var e,t;null===(t=null===(e=a.input)||void 0===e?void 0:e.focus)||void 0===t||t.call(e,{preventScroll:!0})},a.setBlur=function(){var e,t;null===(t=null===(e=a.input)||void 0===e?void 0:e.blur)||void 0===t||t.call(e),a.cancelFocusInput()},a.deferBlur=function(){requestAnimationFrame(function(){a.setBlur()})},a.setOpen=function(e,t){void 0===t&&(t=!1),a.setState({open:e,preSelection:e&&a.state.open?a.state.preSelection:a.calcInitialState().preSelection,lastPreSelectChange:vi},function(){e||a.setState(function(e){return{focused:!!t&&e.focused}},function(){!t&&a.deferBlur(),a.setState({inputValue:null})})})},a.inputOk=function(){return ln(a.state.preSelection)},a.isCalendarOpen=function(){return void 0===a.props.open?a.state.open&&!a.props.disabled&&!a.props.readOnly:a.props.open},a.handleFocus=function(e){var t,n,r=a.state.wasHidden,s=!r||a.state.open;r&&a.resetHiddenStatus(),a.state.preventFocus||(null===(n=(t=a.props).onFocus)||void 0===n||n.call(t,e),!s||a.props.preventOpenOnFocus||a.props.readOnly||a.setOpen(!0)),a.setState({focused:!0})},a.sendFocusBackToInput=function(){a.preventFocusTimeout&&a.clearPreventFocusTimeout(),a.setState({preventFocus:!0},function(){a.preventFocusTimeout=setTimeout(function(){a.setFocus(),a.setState({preventFocus:!1})})})},a.cancelFocusInput=function(){clearTimeout(a.inputFocusTimeout),a.inputFocusTimeout=void 0},a.deferFocusInput=function(){a.cancelFocusInput(),a.inputFocusTimeout=setTimeout(function(){return a.setFocus()},1)},a.handleDropdownFocus=function(){a.cancelFocusInput()},a.handleBlur=function(e){var t,n;(!a.state.open||a.props.withPortal||a.props.showTimeInput)&&(null===(n=(t=a.props).onBlur)||void 0===n||n.call(t,e)),a.state.open&&!1===a.props.open&&a.setOpen(!1),a.setState({focused:!1})},a.handleCalendarClickOutside=function(e){var t,n;a.props.inline||a.setOpen(!1),null===(n=(t=a.props).onClickOutside)||void 0===n||n.call(t,e),a.props.withPortal&&e.preventDefault()},a.handleChange=function(){for(var e,n,r,s,o,i=[],l=0;l<arguments.length;l++)i[l]=arguments[l];var c=i[0];if(!a.props.onChangeRaw||(a.props.onChangeRaw.apply(a,i),c&&"function"===typeof c.isDefaultPrevented&&!c.isDefaultPrevented())){a.setState({inputValue:(null===c||void 0===c?void 0:c.target)instanceof HTMLInputElement?c.target.value:null,lastPreSelectChange:gi});var d=a.props,u=d.selectsRange,h=d.startDate,p=d.endDate,m=null!==(e=a.props.dateFormat)&&void 0!==e?e:t.defaultProps.dateFormat,f=null!==(n=a.props.strictParsing)&&void 0!==n?n:t.defaultProps.strictParsing,g=(null===c||void 0===c?void 0:c.target)instanceof HTMLInputElement?c.target.value:"";if(u){var v=g.split(m.includes("-")?" - ":"-",2).map(function(e){return e.trim()}),y=v[0],b=v[1],x=Bs(null!==y&&void 0!==y?y:"",m,a.props.locale,f),w=Bs(null!==b&&void 0!==b?b:"",m,a.props.locale,f),S=(null===h||void 0===h?void 0:h.getTime())!==(null===x||void 0===x?void 0:x.getTime()),N=(null===p||void 0===p?void 0:p.getTime())!==(null===w||void 0===w?void 0:w.getTime());if(!S&&!N)return;if(x&&lo(x,a.props))return;if(w&&lo(w,a.props))return;null===(s=(r=a.props).onChange)||void 0===s||s.call(r,[x,w],c)}else{var j=Bs(g,m,a.props.locale,f,null!==(o=a.props.selected)&&void 0!==o?o:void 0);!j&&g||a.setSelected(j,c,!0)}}},a.handleSelect=function(e,t,n){if(!a.props.readOnly)if(a.props.shouldCloseOnSelect&&!a.props.showTimeSelect&&a.sendFocusBackToInput(),a.props.onChangeRaw&&a.props.onChangeRaw(t),a.setSelected(e,t,!1,n),a.props.showDateSelect&&a.setState({isRenderAriaLiveMessage:!0}),!a.props.shouldCloseOnSelect||a.props.showTimeSelect)a.setPreSelection(e);else if(!a.props.inline){a.props.selectsRange||a.setOpen(!1);var r=a.props,s=r.startDate,o=r.endDate;!s||o||!a.props.swapRange&&Ro(e,s)||a.setOpen(!1)}},a.setSelected=function(e,t,n,r){var s,o,i=e;if(a.props.showYearPicker){if(null!==i&&go(Xn(i),a.props))return}else if(a.props.showMonthYearPicker){if(null!==i&&uo(i,a.props))return}else if(null!==i&&lo(i,a.props))return;var l=a.props,c=l.onChange,d=l.selectsRange,u=l.startDate,h=l.endDate,p=l.selectsMultiple,m=l.selectedDates,f=l.minTime,g=l.swapRange;if(!no(a.props.selected,i)||a.props.allowSameDay||d||p)if(null!==i&&(!a.props.selected||n&&(a.props.showTimeSelect||a.props.showTimeSelectOnly||a.props.showTimeInput)||(i=qs(i,{hour:nr(a.props.selected),minute:rr(a.props.selected),second:ar(a.props.selected)})),n||!a.props.showTimeSelect&&!a.props.showTimeSelectOnly||f&&(i=qs(i,{hour:f.getHours(),minute:f.getMinutes(),second:f.getSeconds()})),a.props.inline||a.setState({preSelection:i}),a.props.focusSelectedMonth||a.setState({monthSelectedIn:r})),d){var v=u&&!h,y=u&&h;!u&&!h?null===c||void 0===c||c([i,null],t):v&&(null===i?null===c||void 0===c||c([null,null],t):Ro(i,u)?g?null===c||void 0===c||c([i,u],t):null===c||void 0===c||c([i,null],t):null===c||void 0===c||c([u,i],t)),y&&(null===c||void 0===c||c([i,null],t))}else if(p){if(null!==i)if(null===m||void 0===m?void 0:m.length)if(m.some(function(e){return to(e,i)})){var b=m.filter(function(e){return!to(e,i)});null===c||void 0===c||c(b,t)}else null===c||void 0===c||c(Os(Os([],m,!0),[i],!1),t);else null===c||void 0===c||c([i],t)}else null===c||void 0===c||c(i,t);n||(null===(o=(s=a.props).onSelect)||void 0===o||o.call(s,i,t),a.setState({inputValue:null}))},a.setPreSelection=function(e){if(!a.props.readOnly){var t=ln(a.props.minDate),n=ln(a.props.maxDate),r=!0;if(e){var s=Ys(e);if(t&&n)r=ro(e,a.props.minDate,a.props.maxDate);else if(t){var o=Ys(a.props.minDate);r=xr(e,o)||no(s,o)}else if(n){var i=Js(a.props.maxDate);r=dn(e,i)||no(s,i)}}r&&a.setState({preSelection:e})}},a.toggleCalendar=function(){a.setOpen(!a.state.open)},a.handleTimeChange=function(e){var t,n;if(!a.props.selectsRange&&!a.props.selectsMultiple){var r=a.props.selected?a.props.selected:a.getPreSelection(),s=a.props.selected?e:qs(r,{hour:nr(e),minute:rr(e)});a.setState({preSelection:s}),null===(n=(t=a.props).onChange)||void 0===n||n.call(t,s),a.props.shouldCloseOnSelect&&!a.props.showTimeInput&&(a.sendFocusBackToInput(),a.setOpen(!1)),a.props.showTimeInput&&a.setOpen(!0),(a.props.showTimeSelectOnly||a.props.showTimeSelect)&&a.setState({isRenderAriaLiveMessage:!0}),a.setState({inputValue:null})}},a.onInputClick=function(){var e,t;a.props.disabled||a.props.readOnly||a.setOpen(!0),null===(t=(e=a.props).onInputClick)||void 0===t||t.call(e)},a.onInputKeyDown=function(e){var t,n,r,s,o,i;null===(n=(t=a.props).onKeyDown)||void 0===n||n.call(t,e);var l=e.key;if(a.state.open||a.props.inline||a.props.preventOpenOnFocus){if(a.state.open){if(l===Ps.ArrowDown||l===Ps.ArrowUp){e.preventDefault();var c=a.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":a.props.showWeekPicker&&a.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':a.props.showFullMonthYearPicker||a.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',d=(null===(s=a.calendar)||void 0===s?void 0:s.containerRef.current)instanceof Element&&a.calendar.containerRef.current.querySelector(c);return void(d instanceof HTMLElement&&d.focus({preventScroll:!0}))}var u=Fs(a.state.preSelection);l===Ps.Enter?(e.preventDefault(),e.target.blur(),a.inputOk()&&a.state.lastPreSelectChange===vi?(a.handleSelect(u,e),!a.props.shouldCloseOnSelect&&a.setPreSelection(u)):a.setOpen(!1)):l===Ps.Escape?(e.preventDefault(),e.target.blur(),a.sendFocusBackToInput(),a.setOpen(!1)):l===Ps.Tab&&a.setOpen(!1),a.inputOk()||null===(i=(o=a.props).onInputError)||void 0===i||i.call(o,{code:1,msg:mi})}}else l!==Ps.ArrowDown&&l!==Ps.ArrowUp&&l!==Ps.Enter||null===(r=a.onInputClick)||void 0===r||r.call(a)},a.onPortalKeyDown=function(e){e.key===Ps.Escape&&(e.preventDefault(),a.setState({preventFocus:!0},function(){a.setOpen(!1),setTimeout(function(){a.setFocus(),a.setState({preventFocus:!1})})}))},a.onDayKeyDown=function(e){var t,n,r,s,o,i,l=a.props,c=l.minDate,d=l.maxDate,u=l.disabledKeyboardNavigation,h=l.showWeekPicker,p=l.shouldCloseOnSelect,m=l.locale,f=l.calendarStartDay,g=l.adjustDateOnChange,v=l.inline;if(null===(n=(t=a.props).onKeyDown)||void 0===n||n.call(t,e),!u){var y=e.key,b=e.shiftKey,x=Fs(a.state.preSelection),w=function(e,t){var n=t;switch(e){case Ps.ArrowRight:n=h?Nr(t,1):Kt(t,1);break;case Ps.ArrowLeft:n=h?_r(t,1):Dr(t,1);break;case Ps.ArrowUp:n=_r(t,1);break;case Ps.ArrowDown:n=Nr(t,1);break;case Ps.PageUp:n=b?hr(t,1):or(t,1);break;case Ps.PageDown:n=b?ur(t,1):sr(t,1);break;case Ps.Home:n=Ws(t,m,f);break;case Ps.End:n=function(e){return zn(e)}(t)}return n};if(y===Ps.Enter)return e.preventDefault(),a.handleSelect(x,e),void(!p&&a.setPreSelection(x));if(y===Ps.Escape)return e.preventDefault(),a.setOpen(!1),void(a.inputOk()||null===(s=(r=a.props).onInputError)||void 0===s||s.call(r,{code:1,msg:mi}));var S=null;switch(y){case Ps.ArrowLeft:case Ps.ArrowRight:case Ps.ArrowUp:case Ps.ArrowDown:case Ps.PageUp:case Ps.PageDown:case Ps.Home:case Ps.End:S=function(e,t){for(var n=e,r=!1,s=0,o=w(e,t);!r;){if(s>=40){o=t;break}c&&o<c&&(n=Ps.ArrowRight,o=lo(c,a.props)?w(n,o):c),d&&o>d&&(n=Ps.ArrowLeft,o=lo(d,a.props)?w(n,o):d),lo(o,a.props)?(n!==Ps.PageUp&&n!==Ps.Home||(n=Ps.ArrowRight),n!==Ps.PageDown&&n!==Ps.End||(n=Ps.ArrowLeft),o=w(n,o)):r=!0,s++}return o}(y,x)}if(S){if(e.preventDefault(),a.setState({lastPreSelectChange:vi}),g&&a.setSelected(S),a.setPreSelection(S),v){var N=Zn(x),j=Zn(S),k=Xn(x),C=Xn(S);N!==j||k!==C?a.setState({shouldFocusDayInline:!0}):a.setState({shouldFocusDayInline:!1})}}else null===(i=(o=a.props).onInputError)||void 0===i||i.call(o,{code:1,msg:mi})}},a.onPopperKeyDown=function(e){e.key===Ps.Escape&&(e.preventDefault(),a.sendFocusBackToInput(),a.setOpen(!1))},a.onClearClick=function(e){e&&e.preventDefault&&e.preventDefault(),a.sendFocusBackToInput();var t=a.props,n=t.selectsRange,r=t.onChange;n?null===r||void 0===r||r([null,null],e):null===r||void 0===r||r(null,e),a.setState({inputValue:null})},a.clear=function(){a.onClearClick()},a.onScroll=function(e){"boolean"===typeof a.props.closeOnScroll&&a.props.closeOnScroll?e.target!==document&&e.target!==document.documentElement&&e.target!==document.body||a.setOpen(!1):"function"===typeof a.props.closeOnScroll&&a.props.closeOnScroll(e)&&a.setOpen(!1)},a.renderCalendar=function(){var e,n;return a.props.inline||a.isCalendarOpen()?r.createElement(si,Is({showMonthYearDropdown:void 0,ref:function(e){a.calendar=e}},a.props,a.state,{setOpen:a.setOpen,dateFormat:null!==(e=a.props.dateFormatCalendar)&&void 0!==e?e:t.defaultProps.dateFormatCalendar,onSelect:a.handleSelect,onClickOutside:a.handleCalendarClickOutside,holidays:Do(a.modifyHolidays()),outsideClickIgnoreClass:pi,onDropdownFocus:a.handleDropdownFocus,onTimeChange:a.handleTimeChange,className:a.props.calendarClassName,container:a.props.calendarContainer,handleOnKeyDown:a.props.onKeyDown,handleOnDayKeyDown:a.onDayKeyDown,setPreSelection:a.setPreSelection,dropdownMode:null!==(n=a.props.dropdownMode)&&void 0!==n?n:t.defaultProps.dropdownMode}),a.props.children):null},a.renderAriaLiveRegion=function(){var e,n=a.props,s=n.dateFormat,o=void 0===s?t.defaultProps.dateFormat:s,i=n.locale,l=a.props.showTimeInput||a.props.showTimeSelect?"PPPPp":"PPPP";return e=a.props.selectsRange?"Selected start date: ".concat(Hs(a.props.startDate,{dateFormat:l,locale:i}),". ").concat(a.props.endDate?"End date: "+Hs(a.props.endDate,{dateFormat:l,locale:i}):""):a.props.showTimeSelectOnly?"Selected time: ".concat(Hs(a.props.selected,{dateFormat:o,locale:i})):a.props.showYearPicker?"Selected year: ".concat(Hs(a.props.selected,{dateFormat:"yyyy",locale:i})):a.props.showMonthYearPicker?"Selected month: ".concat(Hs(a.props.selected,{dateFormat:"MMMM yyyy",locale:i})):a.props.showQuarterYearPicker?"Selected quarter: ".concat(Hs(a.props.selected,{dateFormat:"yyyy, QQQ",locale:i})):"Selected date: ".concat(Hs(a.props.selected,{dateFormat:l,locale:i})),r.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},e)},a.renderDateInput=function(){var e,n,s,o=he(a.props.className,((e={})[pi]=a.state.open,e)),i=a.props.customInput||r.createElement("input",{type:"text"}),l=a.props.customInputRef||"ref",c=a.props,d=c.dateFormat,u=void 0===d?t.defaultProps.dateFormat:d,h=c.locale,p="string"===typeof a.props.value?a.props.value:"string"===typeof a.state.inputValue?a.state.inputValue:a.props.selectsRange?function(e,t,n){if(!e)return"";var r=Hs(e,n),a=t?Hs(t,n):"";return"".concat(r).concat(" - ").concat(a)}(a.props.startDate,a.props.endDate,{dateFormat:u,locale:h}):a.props.selectsMultiple?function(e,t){if(!(null===e||void 0===e?void 0:e.length))return"";var n=e[0]?Hs(e[0],t):"";if(1===e.length)return n;if(2===e.length&&e[1]){var r=Hs(e[1],t);return"".concat(n,", ").concat(r)}var a=e.length-1;return"".concat(n," (+").concat(a,")")}(null!==(s=a.props.selectedDates)&&void 0!==s?s:[],{dateFormat:u,locale:h}):Hs(a.props.selected,{dateFormat:u,locale:h});return(0,r.cloneElement)(i,((n={})[l]=function(e){a.input=e},n.value=p,n.onBlur=a.handleBlur,n.onChange=a.handleChange,n.onClick=a.onInputClick,n.onFocus=a.handleFocus,n.onKeyDown=a.onInputKeyDown,n.id=a.props.id,n.name=a.props.name,n.form=a.props.form,n.autoFocus=a.props.autoFocus,n.placeholder=a.props.placeholderText,n.disabled=a.props.disabled,n.autoComplete=a.props.autoComplete,n.className=he(i.props.className,o),n.title=a.props.title,n.readOnly=a.props.readOnly,n.required=a.props.required,n.tabIndex=a.props.tabIndex,n["aria-describedby"]=a.props.ariaDescribedBy,n["aria-invalid"]=a.props.ariaInvalid,n["aria-labelledby"]=a.props.ariaLabelledBy,n["aria-required"]=a.props.ariaRequired,n))},a.renderClearButton=function(){var e=a.props,t=e.isClearable,n=e.disabled,s=e.selected,o=e.startDate,i=e.endDate,l=e.clearButtonTitle,c=e.clearButtonClassName,d=void 0===c?"":c,u=e.ariaLabelClose,h=void 0===u?"Close":u,p=e.selectedDates,m=e.readOnly;return!t||m||null==s&&null==o&&null==i&&!(null===p||void 0===p?void 0:p.length)?null:r.createElement("button",{type:"button",className:he("react-datepicker__close-icon",d,{"react-datepicker__close-icon--disabled":n}),disabled:n,"aria-label":h,onClick:a.onClearClick,title:l,tabIndex:-1})},a.state=a.calcInitialState(),a.preventFocusTimeout=void 0,a}return Ts(t,e),Object.defineProperty(t,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:12,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},t.prototype.componentDidUpdate=function(e,t){var n,r,a,s,o,i;e.inline&&(o=e.selected,i=this.props.selected,o&&i?Zn(o)!==Zn(i)||Xn(o)!==Xn(i):o!==i)&&this.setPreSelection(this.props.selected),void 0!==this.state.monthSelectedIn&&e.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),e.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:_o(this.props.highlightDates)}),t.focused||no(e.selected,this.props.selected)||this.setState({inputValue:null}),t.open!==this.state.open&&(!1===t.open&&!0===this.state.open&&(null===(r=(n=this.props).onCalendarOpen)||void 0===r||r.call(n)),!0===t.open&&!1===this.state.open&&(null===(s=(a=this.props).onCalendarClose)||void 0===s||s.call(a)))},t.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},t.prototype.renderInputContainer=function(){var e=this.props,t=e.showIcon,n=e.icon,a=e.calendarIconClassname,s=e.calendarIconClassName,o=e.toggleCalendarOnIconClick,i=this.state.open;return a&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),r.createElement("div",{className:"react-datepicker__input-container".concat(t?" react-datepicker__view-calendar-icon":"")},t&&r.createElement(oi,Is({icon:n,className:he(s,!s&&a,i&&"react-datepicker-ignore-onclickoutside")},o?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},t.prototype.render=function(){var e=this.renderCalendar();if(this.props.inline)return e;if(this.props.withPortal){var t=this.state.open?r.createElement(ci,{enableTabLoop:this.props.enableTabLoop},r.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},e)):null;return this.state.open&&this.props.portalId&&(t=r.createElement(ii,Is({portalId:this.props.portalId},this.props),t)),r.createElement("div",null,this.renderInputContainer(),t)}return r.createElement(hi,Is({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:e,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},t}(r.Component),gi="input",vi="navigate";const yi=(0,r.forwardRef)((e,t)=>{let{value:n,onClick:r,placeholder:a,disabled:s}=e;return(0,i.jsx)("input",{ref:t,value:n,onClick:r,placeholder:a,readOnly:!0,disabled:s,className:"filter-datepicker-input"})});yi.displayName="FilterInput";const bi=e=>{let{value:t,onChange:n,placeholder:r="Select date",min:a,max:s,disabled:o=!1,className:l=""}=e;const c=t?new Date(t):null,d=a?new Date(a):void 0,u=s?new Date(s):void 0;return(0,i.jsx)(fi,{selected:c,onChange:e=>{if(e){const t=e.toISOString().split("T")[0];n(t)}else n("")},customInput:(0,i.jsx)(yi,{disabled:o}),dateFormat:"eee, dd/MM/yyyy",minDate:d,maxDate:u,disabled:o,placeholderText:r,className:"filter-datepicker ".concat(l),calendarClassName:"filter-calendar",popperClassName:"filter-popper",showPopperArrow:!1,fixedHeight:!0,showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",isClearable:!0,todayButton:"Today",withPortal:window.innerWidth<=768,enableTabLoop:!1})},xi=e=>{const t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";const n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()],r=t.getDate().toString().padStart(2,"0"),a=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getFullYear();return"".concat(n,", ").concat(r,"/").concat(a,"/").concat(s)},wi=e=>{const t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";const n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()],r=t.getDate().toString().padStart(2,"0"),a=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getFullYear(),o=t.getHours().toString().padStart(2,"0"),i=t.getMinutes().toString().padStart(2,"0");return"".concat(n,", ").concat(r,"/").concat(a,"/").concat(s," ").concat(o,":").concat(i)},Si=e=>{const t=new Date(e);return isNaN(t.getTime())?"":t.toISOString().split("T")[0]},Ni=()=>Si(new Date),ji=e=>{let{onCaseSubmitted:t}=e;const{modal:n,closeModal:a,showConfirm:s,showSuccess:c,showError:d}=de(),u=(0,r.useCallback)(d,[d]),h=()=>((e,t)=>{const n=t||new Date,r=new Date(n);return r.setDate(n.getDate()+e),Si(r)})(3),[p,m]=(0,r.useState)({hospital:"",department:"",dateOfSurgery:h(),procedureType:"",procedureName:"",doctorName:"",timeOfProcedure:"",surgerySetSelection:[],implantBox:[],specialInstruction:""}),[g,v]=(0,r.useState)({}),[y,x]=(0,r.useState)([]),[w,S]=(0,r.useState)([]),[N,j]=(0,r.useState)(!0),[k,A]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{j(!0),A(null);try{const e=b(),t=(null===e||void 0===e?void 0:e.selectedCountry)||"Singapore";console.log("\ud83c\udfe5 CaseBookingForm - Current User:",e),console.log("\ud83c\udf0d CaseBookingForm - User Country:",t);const n=await z(t);x(n.sort());const r=await V(t);console.log("\ud83c\udfe5 CaseBookingForm - Hospitals for",t,":",r),S(r.sort())}catch(e){console.error("Error loading form data:",e),e instanceof E.a$?(A(e.message),u("Form Setup Error",e.message)):(A("Unable to load form data. Please check your connection."),u("Connection Error","Unable to load form data. Please check your connection and try again."))}finally{j(!1)}})()},[u]);const[I,O]=(0,r.useState)([]),[R,M]=(0,r.useState)([]),[L,F]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{if(!p.procedureType)return O([...o.cD].sort()),void M([...o.Me].sort());const e=b(),t=(null===e||void 0===e?void 0:e.selectedCountry)||"Singapore";try{var n,r,a,s;const e=await P(t);if((null===(n=e[p.procedureType])||void 0===n||null===(r=n.surgerySets)||void 0===r?void 0:r.length)>0)O(e[p.procedureType].surgerySets.sort());else{const e=o.DU[p.procedureType];O(e?[...e.surgerySets].sort():[...o.cD].sort())}if((null===(a=e[p.procedureType])||void 0===a||null===(s=a.implantBoxes)||void 0===s?void 0:s.length)>0)M(e[p.procedureType].implantBoxes.sort());else{const e=o.DU[p.procedureType];M(e?[...e.implantBoxes].sort():[...o.Me].sort())}}catch(i){console.error("Error loading categorized sets:",i);const e=o.DU[p.procedureType];O(e?[...e.surgerySets].sort():[...o.cD].sort()),M(e?[...e.implantBoxes].sort():[...o.Me].sort())}})()},[p.procedureType]),(0,r.useEffect)(()=>{(async()=>{var e;const t=b();if(!t){try{const e=await K();F(e.sort())}catch(r){console.error("Error loading departments:",r),F([])}return}const n=t.selectedCountry||(null===(e=t.countries)||void 0===e?void 0:e[0]);if(n)try{const e=await K(void 0,n);if("admin"===t.role||"it"===t.role)F(e.sort());else{const r=t.departments||[],a=await ee(r,[n]);F(e.filter(e=>a.includes(e)).sort())}}catch(r){console.error("Error loading departments:",r),r instanceof E.a$&&u("Department Loading Error",r.message),F([])}else try{const e=await K();F(e.sort())}catch(r){console.error("Error loading departments:",r),F([])}})()},[u]);return N?(0,i.jsxs)("div",{className:"case-booking-form",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h2",{className:"card-title",children:"New Case Booking"}),(0,i.jsx)("p",{className:"card-subtitle",children:"Loading form data..."})]}),(0,i.jsx)("div",{className:"card-content",children:(0,i.jsxs)("div",{className:"loading-spinner",children:[(0,i.jsx)("div",{className:"spinner"}),(0,i.jsx)("p",{children:"Loading hospitals, departments, and procedure types..."})]})})]}):k?(0,i.jsxs)("div",{className:"case-booking-form",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h2",{className:"card-title",children:"New Case Booking"}),(0,i.jsx)("p",{className:"card-subtitle",children:"Unable to load form"})]}),(0,i.jsx)("div",{className:"card-content",children:(0,i.jsxs)("div",{className:"error-state",children:[(0,i.jsx)("div",{className:"error-icon",children:"\u26a0\ufe0f"}),(0,i.jsx)("h3",{children:"Connection Error"}),(0,i.jsx)("p",{children:k}),(0,i.jsx)("button",{type:"button",className:"btn btn-primary",onClick:()=>window.location.reload(),children:"Try Again"})]})})]}):(0,i.jsxs)("div",{className:"case-booking-form",children:[(0,i.jsxs)("div",{className:"card-header",children:[(0,i.jsx)("h2",{className:"card-title",children:"New Case Booking"}),(0,i.jsx)("p",{className:"card-subtitle",children:"Fill out the details for your medical case booking"})]}),(0,i.jsx)("div",{className:"card-content",children:(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!(()=>{const e={};return p.hospital.trim()||(e.hospital="Hospital is required"),p.department.trim()||(e.department="Department is required"),p.dateOfSurgery||(e.dateOfSurgery="Date of Surgery is required"),p.procedureType.trim()||(e.procedureType="Procedure Type is required"),p.procedureName.trim()||(e.procedureName="Procedure Name is required"),0===p.surgerySetSelection.length&&(e.surgerySetSelection="Surgery Set Selection is required"),0===p.implantBox.length&&(e.implantBox="Implant Box selection is required"),v(e),0===Object.keys(e).length})())return;const n=b();if(!n)return void d("You must be logged in to submit a case");const r=(()=>{const e=localStorage.getItem(D),t=e?parseInt(e)+1:1,n=t.toString().padStart(6,"0"),r="TMC".concat(n);return localStorage.setItem(D,t.toString()),r})(),a=(0,f.A)((0,f.A)({id:Date.now().toString(),caseReferenceNumber:r},p),{},{status:"Case Booked",submittedBy:n.name,submittedAt:(new Date).toISOString(),country:n.selectedCountry||"Singapore"});(e=>{const t=T(),n=t.findIndex(t=>t.id===e.id);n>=0?(t.splice(n,1),t.unshift(e)):t.unshift(e),localStorage.setItem(_,JSON.stringify(t))})(a),console.log("\u2705 Case saved to localStorage:",a.caseReferenceNumber);try{await H.caseService.saveCase(a),console.log("\u2705 Case also saved to Supabase:",a.caseReferenceNumber)}catch(s){console.error("\u26a0\ufe0f Failed to save case to Supabase (saved to localStorage only):",s),d("Case saved locally but failed to sync online. It will be synced automatically later.")}(async e=>C(e,"Case Booked",{eventType:"New Case Created"}))(a).then(e=>{e?console.log("\u2705 Email notification sent for new case:",a.caseReferenceNumber):console.warn("\u26a0\ufe0f Failed to send email notification for new case:",a.caseReferenceNumber)}).catch(e=>{console.error("\ud83d\udca5 Error sending email notification:",e)}),m({hospital:"",department:"",dateOfSurgery:h(),procedureType:"",procedureName:"",doctorName:"",timeOfProcedure:"",surgerySetSelection:[],implantBox:[],specialInstruction:""}),t()},children:[(0,i.jsxs)("div",{className:"form-row",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"hospital",className:"required",children:"Hospital"}),(0,i.jsx)(l,{id:"hospital",value:p.hospital,onChange:e=>m(t=>(0,f.A)((0,f.A)({},t),{},{hospital:e})),options:w,placeholder:"Search and select hospital",className:g.hospital?"error":"",required:!0}),g.hospital&&(0,i.jsx)("span",{className:"error-text",children:g.hospital})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"department",className:"required",children:"Department"}),(0,i.jsx)(l,{id:"department",value:p.department,onChange:e=>m(t=>(0,f.A)((0,f.A)({},t),{},{department:e})),options:L,placeholder:"Search and select department",className:g.department?"error":"",required:!0}),g.department&&(0,i.jsx)("span",{className:"error-text",children:g.department})]})]}),(0,i.jsxs)("div",{className:"form-row",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"dateOfSurgery",className:"required",children:"Date of Surgery"}),(0,i.jsx)(bi,{value:p.dateOfSurgery,onChange:e=>m(t=>(0,f.A)((0,f.A)({},t),{},{dateOfSurgery:e})),placeholder:"Select surgery date",min:Ni(),className:g.dateOfSurgery?"error":""}),g.dateOfSurgery&&(0,i.jsx)("span",{className:"error-text",children:g.dateOfSurgery})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"timeOfProcedure",children:"Time of Procedure"}),(0,i.jsx)(ie,{id:"timeOfProcedure",value:p.timeOfProcedure,onChange:e=>m(t=>(0,f.A)((0,f.A)({},t),{},{timeOfProcedure:e})),placeholder:"Select procedure time",step:15})]})]}),(0,i.jsx)("div",{className:"form-row",children:(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"procedureType",className:"required",children:"Procedure Type"}),(0,i.jsx)(l,{id:"procedureType",value:p.procedureType,onChange:e=>m(t=>(0,f.A)((0,f.A)({},t),{},{procedureType:e,surgerySetSelection:[],implantBox:[]})),options:y,placeholder:"Search and select procedure type",className:g.procedureType?"error":"",required:!0}),g.procedureType&&(0,i.jsx)("span",{className:"error-text",children:g.procedureType})]})}),(0,i.jsxs)("div",{className:"form-row",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"procedureName",className:"required",children:"Procedure Name"}),(0,i.jsx)("input",{type:"text",id:"procedureName",value:p.procedureName,onChange:e=>m(t=>(0,f.A)((0,f.A)({},t),{},{procedureName:e.target.value})),className:g.procedureName?"error":""}),g.procedureName&&(0,i.jsx)("span",{className:"error-text",children:g.procedureName})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"doctorName",children:"Doctor Name"}),(0,i.jsx)("input",{type:"text",id:"doctorName",value:p.doctorName,onChange:e=>m(t=>(0,f.A)((0,f.A)({},t),{},{doctorName:e.target.value}))})]})]}),(0,i.jsxs)("div",{className:"form-section-surgery-sets",children:[(0,i.jsx)(oe,{id:"surgerySetSelection",label:"Surgery Set",options:I,value:p.surgerySetSelection,onChange:e=>m(t=>(0,f.A)((0,f.A)({},t),{},{surgerySetSelection:e})),placeholder:"Select surgery sets...",required:!0}),p.surgerySetSelection.length>0&&(0,i.jsxs)("div",{className:"selection-indicator",children:[(0,i.jsxs)("span",{className:"indicator-label",children:["Selected (",p.surgerySetSelection.length,"): "]}),(0,i.jsx)("div",{className:"selected-items-container",children:p.surgerySetSelection.map((e,t)=>(0,i.jsx)("span",{className:"selected-item-badge",children:e},e))})]}),g.surgerySetSelection&&(0,i.jsx)("span",{className:"error-text",children:g.surgerySetSelection})]}),(0,i.jsxs)("div",{className:"form-section-implant-boxes",children:[(0,i.jsx)(oe,{id:"implantBox",label:"Implant Box",options:R,value:p.implantBox,onChange:e=>m(t=>(0,f.A)((0,f.A)({},t),{},{implantBox:e})),placeholder:"Select implant boxes...",required:!0}),p.implantBox.length>0&&(0,i.jsxs)("div",{className:"selection-indicator",children:[(0,i.jsxs)("span",{className:"indicator-label",children:["Selected (",p.implantBox.length,"): "]}),(0,i.jsx)("div",{className:"selected-items-container",children:p.implantBox.map((e,t)=>(0,i.jsx)("span",{className:"selected-item-badge",children:e},e))})]}),g.implantBox&&(0,i.jsx)("span",{className:"error-text",children:g.implantBox})]}),(0,i.jsxs)("div",{className:"form-group form-section-special-instructions",children:[(0,i.jsx)("label",{htmlFor:"specialInstruction",children:"Special Instructions"}),(0,i.jsx)("textarea",{id:"specialInstruction",value:p.specialInstruction,onChange:e=>m(t=>(0,f.A)((0,f.A)({},t),{},{specialInstruction:e.target.value})),rows:4,placeholder:"Enter any additional notes or special instructions..."})]}),(0,i.jsxs)("div",{className:"form-actions",children:[(0,i.jsx)("button",{type:"button",onClick:()=>{s("Clear Form","Are you sure you want to clear all inputs? This action cannot be undone.",()=>{m({hospital:"",department:"",dateOfSurgery:h(),procedureType:"",procedureName:"",doctorName:"",timeOfProcedure:"",surgerySetSelection:[],implantBox:[],specialInstruction:""}),v({}),c("All inputs have been successfully cleared!")})},className:"btn btn-outline-secondary btn-lg clear-button",children:"\ud83d\uddd1\ufe0f Clear Inputs"}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg submit-button",children:"Submit Case Booking"})]})]})}),(0,i.jsx)(le,{isOpen:n.isOpen,onClose:a,title:n.title,message:n.message,type:n.type,actions:"confirm"===n.type?[{label:"Cancel",onClick:a,style:"secondary"},{label:"Confirm",onClick:n.onConfirm||a,style:"danger"}]:void 0,autoClose:n.autoClose,autoCloseDelay:n.autoCloseDelay})]})},ki=[{id:"admin",name:"admin",displayName:"Admin",description:"Full system access",color:"#e74c3c"},{id:"operations",name:"operations",displayName:"Operations",description:"Order processing",color:"#3498db"},{id:"operations-manager",name:"operations-manager",displayName:"Operations Manager",description:"Operations oversight",color:"#2980b9"},{id:"sales",name:"sales",displayName:"Sales",description:"Case completion",color:"#27ae60"},{id:"sales-manager",name:"sales-manager",displayName:"Sales Manager",description:"Sales oversight",color:"#229954"},{id:"driver",name:"driver",displayName:"Driver",description:"Delivery operations",color:"#f39c12"},{id:"it",name:"it",displayName:"IT",description:"Technical support",color:"#9b59b6"}],Ci=[{id:"create-case",name:"Create Case",description:"Create new medical case bookings with complete details including hospital, department, surgery date, procedure type, and special instructions. Essential for case submission workflow.",category:"Case Management"},{id:"view-cases",name:"View Cases",description:"Access case listings, view detailed case information, status history, and case progress. Includes filtering by department, country, and date ranges within user permissions.",category:"Case Management"},{id:"amend-case",name:"Amend Case",description:"Modify existing case booking details including procedures, dates, special instructions, and requirements. Changes are tracked with user attribution and audit trail.",category:"Case Management"},{id:"delete-case",name:"Delete Case",description:"Permanently remove case bookings from the system. High-privilege action with full audit logging. Typically restricted to administrative roles only.",category:"Case Management"},{id:"edit-sets",name:"Edit Sets",description:"Manage surgery sets and implant boxes for procedure types. Configure available surgical instruments and implant options for specific medical procedures and specialties.",category:"Case Management"},{id:"process-order",name:"Process Order",description:"Case Booked \u2192 Order Preparation",category:"Status Transitions"},{id:"order-processed",name:"Order Processed",description:"Order Preparation \u2192 Order Prepared",category:"Status Transitions"},{id:"pending-delivery-hospital",name:"Pending Delivery (Hospital)",description:"Order Prepared \u2192 Pending Delivery (Hospital)",category:"Status Transitions"},{id:"delivered-hospital",name:"Delivered (Hospital)",description:"Pending Delivery \u2192 Delivered (Hospital)",category:"Status Transitions"},{id:"case-completed",name:"Case Completed",description:"Delivered (Hospital) \u2192 Case Completed",category:"Status Transitions"},{id:"pending-delivery-office",name:"Pending Delivery (Office)",description:"Case Completed \u2192 Pending Delivery (Office)",category:"Status Transitions"},{id:"delivered-office",name:"Delivered (Office)",description:"Pending Delivery (Office) \u2192 Delivered (Office)",category:"Status Transitions"},{id:"to-be-billed",name:"To be Billed",description:"Delivered (Office) \u2192 To be Billed",category:"Status Transitions"},{id:"case-closed",name:"Case Closed",description:"To be Billed \u2192 Case Closed",category:"Status Transitions"},{id:"cancel-case",name:"Cancel Case",description:"Cancel cases in Process Order, Order Processed, Pending Delivery, or Delivered status",category:"Case Management"},{id:"export-data",name:"Export Data",description:"Export case data to external formats",category:"Data Operations"},{id:"import-data",name:"Import Data",description:"Import case data from external sources",category:"Data Operations"},{id:"view-reports",name:"View Reports",description:"Access reporting and analytics",category:"Data Operations"},{id:"create-user",name:"Create User",description:"Add new users to the system",category:"User Management"},{id:"edit-user",name:"Edit User",description:"Modify user details and permissions",category:"User Management"},{id:"edit-countries",name:"Edit Countries",description:"Assign and modify user country access permissions. Control which countries and regions users can access for case management and data viewing. Essential for multi-regional access control.",category:"User Management"},{id:"delete-user",name:"Delete User",description:"Remove users from the system",category:"User Management"},{id:"view-users",name:"View Users",description:"View user listings and details",category:"User Management"},{id:"enable-disable-user",name:"Enable/Disable User",description:"Enable or disable user login access",category:"User Management"},{id:"system-settings",name:"System Settings",description:"Configure system-wide settings",category:"System Settings"},{id:"email-config",name:"Email Configuration",description:"Configure SMTP settings and email notifications by country",category:"System Settings"},{id:"code-table-setup",name:"Code Table Setup",description:"Access and manage system code tables including hospitals, departments, and reference data. Configure country-specific and global lookup tables used throughout the application.",category:"Code Table Management"},{id:"global-tables",name:"Global Tables",description:"Manage global code tables that apply across all countries such as countries list, procedure types, and system-wide reference data. Requires additional confirmation for modifications.",category:"Code Table Management"},{id:"booking-calendar",name:"Booking Calendar",description:"View and manage booking calendar",category:"Case Management"},{id:"backup-restore",name:"Backup & Restore",description:"Manage system backups and restoration",category:"System Settings"},{id:"audit-logs",name:"Audit Logs",description:"View system audit trail and logs",category:"System Settings"},{id:"upload-files",name:"Upload Files",description:"Upload images and documents",category:"File Operations"},{id:"download-files",name:"Download Files",description:"Download attached files and documents",category:"File Operations"},{id:"delete-files",name:"Delete Files",description:"Remove uploaded files and attachments",category:"File Operations"}],Ei=[{actionId:"create-case",roleId:"admin",allowed:!0},{actionId:"view-cases",roleId:"admin",allowed:!0},{actionId:"amend-case",roleId:"admin",allowed:!0},{actionId:"delete-case",roleId:"admin",allowed:!0},{actionId:"edit-sets",roleId:"admin",allowed:!0},{actionId:"booking-calendar",roleId:"admin",allowed:!0},{actionId:"process-order",roleId:"admin",allowed:!0},{actionId:"order-processed",roleId:"admin",allowed:!0},{actionId:"pending-delivery-hospital",roleId:"admin",allowed:!0},{actionId:"delivered-hospital",roleId:"admin",allowed:!0},{actionId:"case-completed",roleId:"admin",allowed:!0},{actionId:"pending-delivery-office",roleId:"admin",allowed:!0},{actionId:"delivered-office",roleId:"admin",allowed:!0},{actionId:"to-be-billed",roleId:"admin",allowed:!0},{actionId:"case-closed",roleId:"admin",allowed:!0},{actionId:"export-data",roleId:"admin",allowed:!0},{actionId:"import-data",roleId:"admin",allowed:!0},{actionId:"view-reports",roleId:"admin",allowed:!0},{actionId:"create-user",roleId:"admin",allowed:!0},{actionId:"edit-user",roleId:"admin",allowed:!0},{actionId:"edit-countries",roleId:"admin",allowed:!0},{actionId:"delete-user",roleId:"admin",allowed:!0},{actionId:"view-users",roleId:"admin",allowed:!0},{actionId:"enable-disable-user",roleId:"admin",allowed:!0},{actionId:"system-settings",roleId:"admin",allowed:!0},{actionId:"email-config",roleId:"admin",allowed:!0},{actionId:"code-table-setup",roleId:"admin",allowed:!0},{actionId:"global-tables",roleId:"admin",allowed:!0},{actionId:"backup-restore",roleId:"admin",allowed:!0},{actionId:"audit-logs",roleId:"admin",allowed:!0},{actionId:"upload-files",roleId:"admin",allowed:!0},{actionId:"download-files",roleId:"admin",allowed:!0},{actionId:"delete-files",roleId:"admin",allowed:!0},{actionId:"cancel-case",roleId:"admin",allowed:!0},{actionId:"create-case",roleId:"operations",allowed:!0},{actionId:"view-cases",roleId:"operations",allowed:!0},{actionId:"amend-case",roleId:"operations",allowed:!0},{actionId:"process-order",roleId:"operations",allowed:!0},{actionId:"order-processed",roleId:"operations",allowed:!0},{actionId:"pending-delivery-hospital",roleId:"operations",allowed:!0},{actionId:"upload-files",roleId:"operations",allowed:!0},{actionId:"download-files",roleId:"operations",allowed:!0},{actionId:"view-reports",roleId:"operations",allowed:!0},{actionId:"create-case",roleId:"operations-manager",allowed:!0},{actionId:"view-cases",roleId:"operations-manager",allowed:!0},{actionId:"amend-case",roleId:"operations-manager",allowed:!0},{actionId:"delete-case",roleId:"operations-manager",allowed:!0},{actionId:"edit-sets",roleId:"operations-manager",allowed:!0},{actionId:"booking-calendar",roleId:"operations-manager",allowed:!0},{actionId:"process-order",roleId:"operations-manager",allowed:!0},{actionId:"order-processed",roleId:"operations-manager",allowed:!0},{actionId:"pending-delivery-hospital",roleId:"operations-manager",allowed:!0},{actionId:"upload-files",roleId:"operations-manager",allowed:!0},{actionId:"download-files",roleId:"operations-manager",allowed:!0},{actionId:"view-reports",roleId:"operations-manager",allowed:!0},{actionId:"export-data",roleId:"operations-manager",allowed:!0},{actionId:"cancel-case",roleId:"operations-manager",allowed:!0},{actionId:"create-case",roleId:"sales",allowed:!0},{actionId:"view-cases",roleId:"sales",allowed:!0},{actionId:"amend-case",roleId:"sales",allowed:!0},{actionId:"booking-calendar",roleId:"sales",allowed:!0},{actionId:"case-completed",roleId:"sales",allowed:!0},{actionId:"pending-delivery-office",roleId:"sales",allowed:!0},{actionId:"delivered-office",roleId:"sales",allowed:!0},{actionId:"to-be-billed",roleId:"sales",allowed:!0},{actionId:"case-closed",roleId:"sales",allowed:!0},{actionId:"upload-files",roleId:"sales",allowed:!0},{actionId:"download-files",roleId:"sales",allowed:!0},{actionId:"view-reports",roleId:"sales",allowed:!0},{actionId:"create-case",roleId:"sales-manager",allowed:!0},{actionId:"view-cases",roleId:"sales-manager",allowed:!0},{actionId:"amend-case",roleId:"sales-manager",allowed:!0},{actionId:"booking-calendar",roleId:"sales-manager",allowed:!0},{actionId:"case-completed",roleId:"sales-manager",allowed:!0},{actionId:"pending-delivery-office",roleId:"sales-manager",allowed:!0},{actionId:"delivered-office",roleId:"sales-manager",allowed:!0},{actionId:"to-be-billed",roleId:"sales-manager",allowed:!0},{actionId:"case-closed",roleId:"sales-manager",allowed:!0},{actionId:"upload-files",roleId:"sales-manager",allowed:!0},{actionId:"download-files",roleId:"sales-manager",allowed:!0},{actionId:"view-reports",roleId:"sales-manager",allowed:!0},{actionId:"export-data",roleId:"sales-manager",allowed:!0},{actionId:"view-cases",roleId:"driver",allowed:!0},{actionId:"pending-delivery-hospital",roleId:"driver",allowed:!0},{actionId:"delivered-hospital",roleId:"driver",allowed:!0},{actionId:"pending-delivery-office",roleId:"driver",allowed:!0},{actionId:"delivered-office",roleId:"driver",allowed:!0},{actionId:"to-be-billed",roleId:"driver",allowed:!0},{actionId:"case-closed",roleId:"driver",allowed:!0},{actionId:"upload-files",roleId:"driver",allowed:!0},{actionId:"download-files",roleId:"driver",allowed:!0},{actionId:"view-cases",roleId:"it",allowed:!0},{actionId:"edit-sets",roleId:"it",allowed:!0},{actionId:"view-users",roleId:"it",allowed:!0},{actionId:"create-user",roleId:"it",allowed:!0},{actionId:"edit-user",roleId:"it",allowed:!0},{actionId:"edit-countries",roleId:"it",allowed:!0},{actionId:"delete-user",roleId:"it",allowed:!0},{actionId:"enable-disable-user",roleId:"it",allowed:!0},{actionId:"system-settings",roleId:"it",allowed:!0},{actionId:"email-config",roleId:"it",allowed:!0},{actionId:"code-table-setup",roleId:"it",allowed:!0},{actionId:"global-tables",roleId:"it",allowed:!0},{actionId:"backup-restore",roleId:"it",allowed:!0},{actionId:"audit-logs",roleId:"it",allowed:!0},{actionId:"import-data",roleId:"it",allowed:!0},{actionId:"export-data",roleId:"it",allowed:!0},{actionId:"upload-files",roleId:"it",allowed:!0},{actionId:"download-files",roleId:"it",allowed:!0},{actionId:"delete-files",roleId:"it",allowed:!0},{actionId:"view-reports",roleId:"it",allowed:!0}],_i=()=>{try{const e=localStorage.getItem("case-booking-custom-roles");if(e){const t=JSON.parse(e);return[...ki,...t]}}catch(e){console.error("Error loading custom roles:",e)}return ki},Di=()=>{try{const e=localStorage.getItem("case-booking-custom-permissions");if(e){const t=JSON.parse(e);return[...Ei,...t]}}catch(e){console.error("Error loading custom permissions:",e)}return Ei},Ai=(e,t)=>{const n=Di().find(n=>n.roleId===e&&n.actionId===t);return(null===n||void 0===n?void 0:n.allowed)||!1},Ti="app_runtime_permissions",Ii=()=>{try{const e=localStorage.getItem(Ti);if(e){const t=JSON.parse(e),n=t.filter(e=>"admin"===e.roleId&&e.allowed),r=Ei.filter(e=>"admin"===e.roleId&&e.allowed).length;if(n.length<r){console.log("Admin permissions incomplete, resetting to defaults...");const e=Ei;return Oi(e),e}return t}}catch(e){console.error("Error loading runtime permissions:",e)}return Ei},Oi=e=>{try{localStorage.setItem(Ti,JSON.stringify(e))}catch(t){console.error("Error saving runtime permissions:",t)}},Pi=(e,t)=>{const n=Ii().find(n=>n.roleId===e&&n.actionId===t);return(null===n||void 0===n?void 0:n.allowed)||!1},Ri=(e,t,n)=>{const r=Ii(),a=r.findIndex(n=>n.roleId===e&&n.actionId===t);a>=0?r[a]=(0,f.A)((0,f.A)({},r[a]),{},{allowed:n}):r.push({roleId:e,actionId:t,allowed:n}),Oi(r)},Mi="create-case",Li="amend-case",Fi="delete-case",Bi="cancel-case",Ui="edit-sets",zi="process-order",Hi="order-processed",qi="pending-delivery-hospital",Yi="delivered-hospital",Wi="case-completed",Vi="pending-delivery-office",Ki="delivered-office",Gi="to-be-billed",Qi="case-closed",Ji="create-user",$i="edit-user",Xi="delete-user",Zi="view-users",el="enable-disable-user",tl="email-config",nl="audit-logs",rl="view-reports",al=(0,r.createContext)(void 0),sl=e=>{let{children:t}=e;const[n,a]=(0,r.useState)([]),[s,o]=(0,r.useState)([]);(0,r.useEffect)(()=>{const e=localStorage.getItem("case-booking-notifications");if(e)try{const t=JSON.parse(e),n=b(),r=t.map(e=>!e.userId&&n?(0,f.A)((0,f.A)({},e),{},{userId:n.id}):e).filter(e=>e.userId);a(r)}catch(t){console.error("Failed to load notifications:",t)}},[]),(0,r.useEffect)(()=>{const e=b();if(e){const t=n.filter(t=>t.userId===e.id).slice(0,10);o(t)}else o([])},[n]),(0,r.useEffect)(()=>{localStorage.setItem("case-booking-notifications",JSON.stringify(n))},[n]);const l=s.filter(e=>!e.read).length,c={notifications:s,unreadCount:l,addNotification:(e,t)=>{const n=b();if(!n)return;const r=(e=>{const t=localStorage.getItem("notificationPreferences_".concat(e));if(t)try{return JSON.parse(t)}catch(n){console.error("Error parsing notification preferences:",n)}return{statusUpdates:!0,caseCreated:!0,caseAmended:!0,orderProcessed:!0,orderDelivered:!0,orderReceived:!0,caseCompleted:!0,toBeBilled:!0,systemAlerts:!0,reminderNotifications:!0,sound:!0,desktop:!1}})(n.id);if(t&&!((e,t)=>{const n={"status-update":"statusUpdates","case-created":"caseCreated","case-amended":"caseAmended","order-processed":"orderProcessed","order-delivered":"orderDelivered","order-received":"orderReceived","case-completed":"caseCompleted","to-be-billed":"toBeBilled","system-alert":"systemAlerts",reminder:"reminderNotifications"}[e];return!n||t[n]})(t,r))return;const s=(0,f.A)((0,f.A)({},e),{},{id:Date.now().toString()+Math.random().toString(36).substr(2,9),timestamp:(new Date).toISOString(),read:!1,userId:n.id});a(e=>{const t=[s,...e],r=t.filter(e=>e.userId===n.id),a=t.filter(e=>e.userId!==n.id);return[...r.slice(0,10),...a]})},markAsRead:e=>{a(t=>t.map(t=>t.id===e?(0,f.A)((0,f.A)({},t),{},{read:!0}):t))},markAllAsRead:()=>{const e=b();e&&a(t=>t.map(t=>t.userId===e.id?(0,f.A)((0,f.A)({},t),{},{read:!0}):t))},clearNotification:e=>{a(t=>t.filter(t=>t.id!==e))},clearAllNotifications:()=>{const e=b();e&&a(t=>t.filter(t=>t.userId!==e.id))}};return(0,i.jsx)(al.Provider,{value:c,children:t})},ol=()=>{const e=(0,r.useContext)(al);if(void 0===e)throw new Error("useNotifications must be used within a NotificationProvider");return e};var il=n(739);const ll="admin",cl="operations",dl="operations-manager",ul="sales",hl="sales-manager",pl="driver",ml="it",fl={VIEW_ALL_CASES:"view_all_cases",CREATE_CASE:"create_case",EDIT_CASE:"edit_case",DELETE_CASE:"delete_case",AMEND_CASE:"amend_case",PROCESS_ORDER:"process_order",MARK_DELIVERED:"mark_delivered_hospital",RECEIVE_ORDER:"receive_order_hospital",COMPLETE_CASE:"complete_case",DELIVER_TO_OFFICE:"deliver_to_office",MARK_TO_BILLED:"mark_to_billed",MANAGE_USERS:"manage_users",MANAGE_PERMISSIONS:"manage_permissions",VIEW_SETTINGS:"view_settings",MANAGE_CODE_TABLES:"manage_code_tables",AUDIT_LOGS:"view_audit_logs",BACKUP_RESTORE:"backup_restore",SYSTEM_CONFIG:"system_configuration"},gl=(Object.values(fl),[il.sf.CASE_BOOKED,il.sf.ORDER_PREPARATION,il.sf.ORDER_PREPARED,il.sf.PENDING_DELIVERY_HOSPITAL,il.sf.DELIVERED_HOSPITAL,il.sf.CASE_COMPLETED,il.sf.PENDING_DELIVERY_OFFICE,il.sf.DELIVERED_OFFICE,il.sf.TO_BE_BILLED,il.sf.CASE_CLOSED,il.sf.CASE_CANCELLED]),vl=e=>{switch(e){case il.sf.CASE_BOOKED:return"".concat(cl," / ").concat(dl);case il.sf.ORDER_PREPARATION:return"Operations Team";case il.sf.ORDER_PREPARED:case il.sf.PENDING_DELIVERY_HOSPITAL:return pl;case il.sf.DELIVERED_HOSPITAL:return"Sales Team";case il.sf.CASE_COMPLETED:return"".concat(ul," / ").concat(pl);case il.sf.PENDING_DELIVERY_OFFICE:return"".concat(pl," / ").concat(ul);case il.sf.DELIVERED_OFFICE:case il.sf.TO_BE_BILLED:return"".concat(ll," / System");default:return null}},yl=e=>wi(e),bl=e=>{switch(e){case il.sf.CASE_BOOKED:return"#ff9800";case il.sf.ORDER_PREPARATION:return"#e91e63";case il.sf.ORDER_PREPARED:return"#9c27b0";case il.sf.PENDING_DELIVERY_HOSPITAL:return"#4caf50";case il.sf.DELIVERED_HOSPITAL:return"#00bcd4";case il.sf.CASE_COMPLETED:return"#8bc34a";case il.sf.PENDING_DELIVERY_OFFICE:return"#03a9f4";case il.sf.DELIVERED_OFFICE:return"#607d8b";case il.sf.TO_BE_BILLED:return"#795548";case il.sf.CASE_CLOSED:return"#4caf50";case il.sf.CASE_CANCELLED:return"#f44336";default:return"#757575"}},xl=e=>{let{filters:t,tempFilters:n,showFilters:a,availableSubmitters:s,availableHospitals:c,filteredCasesCount:d,totalCasesCount:u,onFilterChange:h,onApplyFilters:p,onClearFilters:m,onToggleFilters:f,onQuickFilter:g}=e;const v=b(),[y,x]=(0,r.useState)([]);return(0,r.useEffect)(()=>{(async()=>{try{const e=await G(),t=e.length>0?e:[...o.FS];x(t)}catch(e){console.error("Error loading countries:",e),x([...o.FS])}})()},[]),(0,i.jsxs)("div",{className:"modern-filters-section",children:[(0,i.jsxs)("div",{className:"filters-header",onClick:f,children:[(0,i.jsxs)("div",{className:"filters-title",children:[(0,i.jsx)("h3",{children:"\ud83d\udd0d Advanced Filters"}),(0,i.jsx)("span",{className:"active-filters-count",children:Object.keys(t).length>0&&"(".concat(Object.keys(t).length," active)")})]}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm filters-toggle ".concat(a?"expanded":""),children:a?"\u25b2":"\u25bc"})]}),a&&(0,i.jsxs)("div",{className:"filters-content",children:[(0,i.jsxs)("div",{className:"filters-grid",children:[(0,i.jsxs)("div",{className:"filter-category",children:[(0,i.jsx)("h4",{children:"\ud83d\udd0e Search"}),(0,i.jsxs)("div",{className:"filter-row",children:[(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Submitter"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(l,{options:[{value:"",label:"All Submitters"},...s.map(e=>({value:e,label:e}))],value:n.submitter||"",onChange:e=>h("submitter",e),placeholder:"All Submitters"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udc64  "})]})]}),(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Hospital"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(l,{options:[{value:"",label:"All Hospitals"},...c.map(e=>({value:e,label:e}))],value:n.hospital||"",onChange:e=>h("hospital",e),placeholder:"All Hospitals"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83c\udfe5"})]})]}),"admin"===(null===v||void 0===v?void 0:v.role)&&(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Country"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(l,{options:[{value:"",label:"All Countries"},...y.map(e=>({value:e,label:e}))],value:n.country||"",onChange:e=>h("country",e),placeholder:"All Countries"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83c\udf0d"})]})]})]})]}),(0,i.jsxs)("div",{className:"filter-category",children:[(0,i.jsx)("h4",{children:"\ud83d\udcca Status"}),(0,i.jsx)("div",{className:"filter-row",children:(0,i.jsxs)("div",{className:"modern-filter-group full-width",children:[(0,i.jsx)("label",{children:"Case Status"}),(0,i.jsx)("div",{className:"status-filter-wrapper",children:(0,i.jsx)(l,{options:[{value:"",label:"All Statuses"},...gl.map(e=>({value:e,label:e}))],value:n.status||"",onChange:e=>h("status",e),placeholder:"All Statuses"})})]})})]}),(0,i.jsxs)("div",{className:"filter-category",children:[(0,i.jsx)("h4",{children:"\ud83d\udcc5 Date Range"}),(0,i.jsxs)("div",{className:"filter-row",children:[(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Start Date"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(bi,{value:n.dateFrom||"",onChange:e=>h("dateFrom",e),placeholder:"Select start date"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udcc5"})]})]}),(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"End Date"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(bi,{value:n.dateTo||"",onChange:e=>h("dateTo",e),placeholder:"Select end date",min:n.dateFrom||void 0}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udcc5"})]})]})]})]})]}),(0,i.jsxs)("div",{className:"modern-filter-actions",children:[(0,i.jsxs)("div",{className:"filter-stats",children:["Showing ",d," of ",u," cases"]}),(0,i.jsxs)("div",{className:"filter-buttons",children:[(0,i.jsx)("button",{onClick:m,className:"btn btn-outline-secondary btn-md modern-clear-button",disabled:0===Object.keys(n).length,children:"\ud83d\uddd1\ufe0f Clear All"}),(0,i.jsx)("button",{onClick:p,className:"btn btn-primary btn-md modern-apply-button",children:"\u2728 Apply Filters"})]})]}),(0,i.jsxs)("div",{className:"quick-filters",children:[(0,i.jsx)("span",{className:"quick-filters-label",children:"Quick Filters:"}),(0,i.jsx)("button",{onClick:()=>g("status","Case Booked"),className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\ud83d\udccb New Cases"}),(0,i.jsx)("button",{onClick:()=>g("status","Order Preparation"),className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\u23f3 Pending"}),(0,i.jsx)("button",{onClick:()=>g("status","Case Completed"),className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\u2705 Completed"}),(0,i.jsx)("button",{onClick:()=>{const e=(new Date).toISOString().split("T")[0];g("dateFrom",e),g("dateTo",e)},className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\ud83d\udcc5 Today"})]})]})]})},wl=e=>{let{content:t,children:n,disabled:a=!1}=e;const[s,o]=(0,r.useState)(!1);return a?(0,i.jsxs)("div",{className:"tooltip-wrapper",onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),style:{position:"relative",display:"inline-block"},children:[n,s&&(0,i.jsx)("div",{className:"tooltip-content",children:t})]}):(0,i.jsx)(i.Fragment,{children:n})},Sl=e=>{let{caseItem:t,currentUser:n,onStatusChange:r,onAmendCase:a,onDeleteCase:s,onOrderProcessed:o,onOrderDelivered:l,onOrderReceived:c,onCaseCompleted:d,onPendingDeliveryOffice:u,onOfficeDelivery:h,onOrderDeliveredOffice:p,onToBeBilled:m,onCancelCase:f,canAmendCase:g}=e;return(0,i.jsxs)("div",{className:"case-actions",children:["Case Cancelled"!==t.status&&(0,i.jsxs)("div",{className:"case-buttons",children:["Case Booked"===t.status&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",zi)?"Process Order":"You do not have permission to process orders",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",zi),children:(0,i.jsx)("button",{onClick:()=>r(t.id,"Order Preparation"),className:"case-action-button process-order-button ".concat(Pi((null===n||void 0===n?void 0:n.role)||"",zi)?"":"disabled"),disabled:!Pi((null===n||void 0===n?void 0:n.role)||"",zi),children:"Process Order"})}),"Order Preparation"===t.status&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",Hi)?"Mark as Order Processed":"You do not have permission to mark orders as processed",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",Hi),children:(0,i.jsx)("button",{onClick:()=>o(t.id),className:"case-action-button process-button ".concat(Pi((null===n||void 0===n?void 0:n.role)||"",Hi)?"":"disabled"),disabled:!Pi((null===n||void 0===n?void 0:n.role)||"",Hi),children:"Order Processed"})}),"Order Prepared"===t.status&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",qi)?"Mark as Pending Delivery to Hospital":"You do not have permission to mark pending delivery to hospital",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",qi),children:(0,i.jsx)("button",{onClick:()=>l(t.id),className:"case-action-button deliver-button ".concat(Pi((null===n||void 0===n?void 0:n.role)||"",qi)?"":"disabled"),disabled:!Pi((null===n||void 0===n?void 0:n.role)||"",qi),children:"Pending Delivery (Hospital)"})}),"Pending Delivery (Hospital)"===t.status&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",Yi)?"Mark as Delivered to Hospital":"You do not have permission to mark as delivered to hospital",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",Yi),children:(0,i.jsx)("button",{onClick:()=>c(t.id),className:"case-action-button received-button ".concat(Pi((null===n||void 0===n?void 0:n.role)||"",Yi)?"":"disabled"),disabled:!Pi((null===n||void 0===n?void 0:n.role)||"",Yi),children:"Delivered (Hospital)"})}),"Delivered (Hospital)"===t.status&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",Wi)?"Mark as Case Completed":"You do not have permission to mark cases as completed",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",Wi),children:(0,i.jsx)("button",{onClick:()=>d(t.id),className:"case-action-button complete-button ".concat(Pi((null===n||void 0===n?void 0:n.role)||"",Wi)?"":"disabled"),disabled:!Pi((null===n||void 0===n?void 0:n.role)||"",Wi),children:"Mark as Case Completed"})}),"Case Completed"===t.status&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",Vi)?"Mark as Pending Delivery to Office":"You do not have permission to mark as pending delivery to office",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",Vi),children:(0,i.jsx)("button",{onClick:()=>u(t.id),className:"case-action-button pending-office-button ".concat(Pi((null===n||void 0===n?void 0:n.role)||"",Vi)?"":"disabled"),disabled:!Pi((null===n||void 0===n?void 0:n.role)||"",Vi),children:"Pending Delivery (Office)"})}),"Pending Delivery (Office)"===t.status&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",Ki)?"Mark as Delivered to Office":"You do not have permission to mark as delivered to office",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",Ki),children:(0,i.jsx)("button",{onClick:()=>h(t.id),className:"case-action-button office-deliver-button ".concat(Pi((null===n||void 0===n?void 0:n.role)||"",Ki)?"":"disabled"),disabled:!Pi((null===n||void 0===n?void 0:n.role)||"",Ki),children:"Delivered (Office)"})}),"Delivered (Office)"===t.status&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",Gi)?"Mark as To be Billed":"You do not have permission to mark as to be billed",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",Gi),children:(0,i.jsx)("button",{onClick:()=>m(t.id),className:"case-action-button billing-button ".concat(Pi((null===n||void 0===n?void 0:n.role)||"",Gi)?"":"disabled"),disabled:!Pi((null===n||void 0===n?void 0:n.role)||"",Gi),children:"Mark as To be Billed"})}),"To be billed"===t.status&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",Qi)?"Mark as Case Closed":"You do not have permission to mark as case closed",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",Qi),children:(0,i.jsx)("button",{onClick:()=>r(t.id,"Case Closed"),className:"case-action-button case-closed-button ".concat(Pi((null===n||void 0===n?void 0:n.role)||"",Qi)?"":"disabled"),disabled:!Pi((null===n||void 0===n?void 0:n.role)||"",Qi),children:"Mark as Case Closed"})})]}),g(t)&&Pi((null===n||void 0===n?void 0:n.role)||"",Li)&&"Case Cancelled"!==t.status&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",Li)?"Amend Case":"You do not have permission to amend cases",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",Li),children:(0,i.jsx)("button",{onClick:()=>a(t),className:"case-action-button amend-button",children:"Amend Case"})}),Pi((null===n||void 0===n?void 0:n.role)||"",Fi)&&"Case Cancelled"!==t.status&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",Fi)?"Delete Case":"You do not have permission to delete cases",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",Fi),children:(0,i.jsx)("button",{onClick:()=>s(t.id,t),className:"case-action-button delete-button",children:"\ud83d\uddd1\ufe0f Delete Case"})}),["Order Preparation","Order Prepared","Pending Delivery (Hospital)","Delivered (Hospital)","Pending Delivery (Office)"].includes(t.status)&&Pi((null===n||void 0===n?void 0:n.role)||"",Bi)&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",Bi)?"Cancel this case - will mark as cancelled (case data preserved)":"You do not have permission to cancel cases",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",Bi),children:(0,i.jsx)("button",{onClick:()=>f(t.id),className:"case-action-button cancel-button warning-action ".concat(Pi((null===n||void 0===n?void 0:n.role)||"",Bi)?"":"disabled"),disabled:!Pi((null===n||void 0===n?void 0:n.role)||"",Bi),children:"\u26a0\ufe0f Cancel Case"})}),"Case Cancelled"===t.status&&(0,i.jsx)(wl,{content:Pi((null===n||void 0===n?void 0:n.role)||"",Fi)?"Permanently delete this cancelled case - this action cannot be undone":"Only Admin and IT users can delete cancelled cases",disabled:Pi((null===n||void 0===n?void 0:n.role)||"",Fi),children:(0,i.jsx)("button",{onClick:()=>s(t.id,t),className:"case-action-button delete-button ".concat(Pi((null===n||void 0===n?void 0:n.role)||"",Fi)?"":"disabled"),disabled:!Pi((null===n||void 0===n?void 0:n.role)||"",Fi),children:"\ud83d\uddd1\ufe0f Delete Case"})})]})},Nl=e=>{var t,n,a,s,o,l,c;let{caseItem:d,currentUser:u,expandedCases:h,expandedStatusHistory:p,expandedAmendmentHistory:m,amendingCase:g,amendmentData:v,processingCase:y,processDetails:x,processAttachments:w,processComments:S,hospitalDeliveryCase:N,hospitalDeliveryAttachments:j,hospitalDeliveryComments:k,receivedCase:C,receivedDetails:E,receivedImage:_,completedCase:D,attachments:A,orderSummary:T,doNumber:I,pendingOfficeCase:O,pendingOfficeAttachments:P,pendingOfficeComments:R,officeDeliveryCase:M,officeDeliveryAttachments:L,officeDeliveryComments:F,onToggleExpansion:B,onToggleStatusHistory:U,onToggleAmendmentHistory:H,onStatusChange:q,onAmendCase:Y,onSaveAmendment:W,onCancelAmendment:V,onOrderProcessed:G,onSaveProcessDetails:Q,onCancelProcessing:J,onOrderDelivered:$,onOrderReceived:X,onSaveOrderReceived:Z,onCancelReceived:ee,onCaseCompleted:te,onSaveCaseCompleted:re,onCancelCompleted:ae,onPendingDeliveryOffice:se,onSavePendingOffice:oe,onCancelPendingOffice:le,onOfficeDelivery:ce,onSaveOfficeDelivery:de,onCancelOfficeDelivery:ue,onOrderDeliveredOffice:he,onToBeBilled:pe,onDeleteCase:me,onCancelCase:fe,onAttachmentUpload:ge,onRemoveAttachment:ve,onAmendmentDataChange:ye,onProcessDetailsChange:be,onProcessAttachmentsChange:xe,onProcessCommentsChange:we,onSaveHospitalDelivery:Se,onCancelHospitalDelivery:Ne,onHospitalDeliveryAttachmentsChange:je,onHospitalDeliveryCommentsChange:ke,onReceivedDetailsChange:Ce,onReceivedImageChange:Ee,onOrderSummaryChange:_e,onDoNumberChange:De,onPendingOfficeAttachmentsChange:Ae,onPendingOfficeCommentsChange:Te,onOfficeDeliveryAttachmentsChange:Ie,onOfficeDeliveryCommentsChange:Oe,onNavigateToPermissions:Pe}=e;const[Re,Me]=(0,r.useState)([]),[Le,Fe]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{var e;ne();const t=b(),n=(null===t||void 0===t?void 0:t.selectedCountry)||(null===t||void 0===t||null===(e=t.countries)||void 0===e?void 0:e[0]),r=await z(n);Me(r);const a=await K();Fe(a)})()},[]);const Be=(e,t,n)=>d.originalValues&&n&&t&&t.trim()!==n.trim()?(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("span",{className:"detail-label",children:"Original Value: "}),(0,i.jsx)("span",{className:"detail-value",children:n})]}):null;return(0,i.jsxs)("div",{id:"case-".concat(d.id),className:"case-card",style:{"--status-color":bl(d.status)},children:[(0,i.jsxs)("div",{className:"case-summary",onClick:()=>B(d.id),children:[(0,i.jsxs)("div",{className:"case-main-info",children:[(0,i.jsxs)("div",{className:"case-title",children:[(0,i.jsx)("span",{className:"case-title-label",children:"Submitted by:"}),(0,i.jsx)("strong",{children:d.submittedBy}),(0,i.jsxs)("span",{className:"case-reference",children:["#",d.caseReferenceNumber]})]}),(0,i.jsxs)("div",{className:"case-meta",children:[(0,i.jsxs)("span",{children:["Case Title: ",d.procedureType]}),(0,i.jsxs)("span",{children:["Surgery Date: ",xi(d.dateOfSurgery)]}),(0,i.jsxs)("span",{children:["Hospital: ",d.hospital]}),(0,i.jsxs)("span",{children:["Department: ",d.department]}),"admin"===(null===u||void 0===u?void 0:u.role)&&(0,i.jsxs)("span",{children:["Country: ",d.country]})]})]}),(0,i.jsxs)("div",{className:"case-status",children:[(0,i.jsx)("div",{className:"status-text",children:d.status}),vl(d.status)&&(0,i.jsxs)("div",{className:"pending-indicator",children:[(0,i.jsx)("span",{className:"pending-icon",children:"\u23f3"}),(0,i.jsxs)("span",{className:"pending-text",title:"Click to view Role-Based Permission Matrix",children:["Awaiting: ",vl(d.status)]})]})]}),(0,i.jsx)("div",{className:"expand-icon",children:h.has(d.id)?"\u25bc":"\u25b6"})]}),h.has(d.id)&&(0,i.jsxs)("div",{className:"case-details",children:[(0,i.jsxs)("div",{className:"details-grid",children:[(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("span",{className:"detail-label",children:"Submission Date: "}),(0,i.jsx)("span",{className:"detail-value",children:xi(d.submittedAt)})]}),(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("span",{className:"detail-label",children:"Surgery Date: "}),(0,i.jsx)("span",{className:"detail-value",children:xi(d.dateOfSurgery)})]}),(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("span",{className:"detail-label",children:"Time of Procedure: "}),(0,i.jsx)("span",{className:"detail-value",children:d.timeOfProcedure||"Not specified"})]}),d.doctorName&&(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("span",{className:"detail-label",children:"Doctor Name: "}),(0,i.jsx)("span",{className:"detail-value",children:d.doctorName})]}),(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("span",{className:"detail-label",children:"Surgery Set Selection: "}),(0,i.jsx)("ul",{className:"detail-value",children:d.surgerySetSelection.map(e=>(0,i.jsx)("li",{children:e},e))})]}),(0,i.jsxs)("div",{className:"detail-item",children:[(0,i.jsx)("span",{className:"detail-label",children:"Implant Box: "}),(0,i.jsx)("ul",{className:"detail-value",children:d.implantBox.map(e=>(0,i.jsx)("li",{children:e},e))})]}),d.specialInstruction&&(0,i.jsxs)("div",{className:"detail-item full-width",children:[(0,i.jsx)("span",{className:"detail-label",children:"Special Instructions: "}),(0,i.jsx)("p",{className:"detail-value",children:d.specialInstruction})]}),d.isAmended&&d.originalValues&&(0,i.jsxs)("div",{className:"detail-item full-width amendment-history",children:[(0,i.jsxs)("div",{className:"amendment-header-container",children:[(0,i.jsx)("span",{className:"amendment-badge",children:"AMENDED"}),(0,i.jsx)("button",{onClick:()=>H(d.id),className:"btn btn-outline-secondary btn-sm expand-amendment-button",children:m.has(d.id)?"Hide Amendment History":"View Amendment History"})]}),m.has(d.id)&&(0,i.jsxs)("div",{className:"amendment-content",children:[(0,i.jsx)("div",{style:{marginBottom:"12px"},children:(0,i.jsx)("strong",{children:"Original Values (Before Amendment):"})}),(0,i.jsxs)("div",{className:"original-values-grid",children:[d.originalValues.hospital&&(0,i.jsxs)("div",{className:"original-value-item",children:[(0,i.jsx)("span",{className:"original-label",children:"Hospital:"})," ",d.originalValues.hospital]}),d.originalValues.department&&(0,i.jsxs)("div",{className:"original-value-item",children:[(0,i.jsx)("span",{className:"original-label",children:"Department:"})," ",d.originalValues.department]}),d.originalValues.dateOfSurgery&&(0,i.jsxs)("div",{className:"original-value-item",children:[(0,i.jsx)("span",{className:"original-label",children:"Surgery Date:"})," ",xi(d.originalValues.dateOfSurgery)]}),d.originalValues.procedureType&&(0,i.jsxs)("div",{className:"original-value-item",children:[(0,i.jsx)("span",{className:"original-label",children:"Procedure Type:"})," ",d.originalValues.procedureType]}),d.originalValues.doctorName&&(0,i.jsxs)("div",{className:"original-value-item",children:[(0,i.jsx)("span",{className:"original-label",children:"Doctor Name:"})," ",d.originalValues.doctorName]}),d.originalValues.timeOfProcedure&&(0,i.jsxs)("div",{className:"original-value-item",children:[(0,i.jsx)("span",{className:"original-label",children:"Time of Procedure:"})," ",d.originalValues.timeOfProcedure]}),d.originalValues.specialInstruction&&(0,i.jsxs)("div",{className:"original-value-item",children:[(0,i.jsx)("span",{className:"original-label",children:"Special Instructions:"})," ",d.originalValues.specialInstruction]})]}),(0,i.jsxs)("div",{style:{fontSize:"12px",color:"#666",textAlign:"right",marginTop:"15px",border:"none",background:"none"},children:[(0,i.jsxs)("div",{children:["Amended by: ",d.amendedBy||"Unknown"]}),(0,i.jsxs)("div",{children:["Amended at: ",d.amendedAt?yl(d.amendedAt):"N/A"]})]})]})]}),d.processedBy&&(0,i.jsxs)("div",{className:"detail-item prepared-by",children:[(0,i.jsx)("strong",{children:"Prepared by:"})," ",d.processedBy]}),d.processedAt&&(0,i.jsxs)("div",{className:"detail-item prepared-at",children:[(0,i.jsx)("strong",{children:"Prepared at:"})," ",yl(d.processedAt)]}),d.statusHistory&&d.statusHistory.length>0&&(0,i.jsxs)("div",{className:"detail-item full-width",children:[(0,i.jsxs)("div",{className:"status-history-header-container",children:[(0,i.jsx)("strong",{children:"Status Updates:"}),d.statusHistory.length>1&&(0,i.jsx)("button",{onClick:()=>U(d.id),className:"btn btn-outline-secondary btn-sm expand-history-button",children:p.has(d.id)?"Hide History (".concat(d.statusHistory.length-1," previous)"):"View History (".concat(d.statusHistory.length-1," previous)")})]}),(0,i.jsx)("div",{className:"status-history",children:p.has(d.id)?d.statusHistory.map((e,t)=>(0,i.jsxs)("div",{className:"status-history-item",style:{borderLeftColor:bl(e.status)},children:[(0,i.jsxs)("div",{className:"status-history-header",children:[(0,i.jsx)("span",{className:"history-status",style:{backgroundColor:bl(e.status)},children:e.status}),(0,i.jsx)("span",{className:"history-timestamp",children:yl(e.timestamp)})]}),(0,i.jsxs)("div",{className:"history-details",children:[(0,i.jsxs)("span",{className:"history-processor",children:["By: ",e.processedBy]}),e.details&&(0,i.jsx)("div",{className:"history-notes",children:(()=>{try{const t=JSON.parse(e.details);if(t.deliveryDetails||t.comments&&!t.orderSummary&&!t.processDetails){const e=t.deliveryDetails,n=e?t.deliveryDetails:t.comments,r=e?t.deliveryImage?[JSON.stringify({name:"delivery-image.png",type:"image/png",data:t.deliveryImage})]:[]:t.attachments||[];return(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Delivery Details:"})," ",n,r&&r.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:["Attachments (",r.length,"):"]}),(0,i.jsx)("div",{className:"attachment-preview-grid",children:r.map((e,t)=>{try{const n=JSON.parse(e),r=n.type.startsWith("image/");return(0,i.jsx)("div",{className:"attachment-preview-item",children:r?(0,i.jsxs)("div",{className:"image-attachment",children:[(0,i.jsx)("img",{src:n.data,alt:n.name,className:"attachment-thumbnail clickable-image",style:{maxWidth:"100px",maxHeight:"75px",borderRadius:"4px",border:"1px solid #ddd",cursor:"pointer"},onClick:()=>{const e=document.createElement("div");e.className="image-modal",e.innerHTML='\n                                                                  <div class="image-modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center; cursor: pointer;">\n                                                                    <div style="position: relative; max-width: 90%; max-height: 90%;">\n                                                                      <img src="'.concat(n.data,'" alt="').concat(n.name,'" style="max-width: 100%; max-height: 100%; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5);" />\n                                                                      <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 10px;">\n                                                                        <button onclick="event.stopPropagation(); const link = document.createElement(\'a\'); link.href = \'').concat(n.data,"'; link.download = '").concat(n.name,'\'; link.click();" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\ud83d\udce5 Download</button>\n                                                                        <button onclick="document.body.removeChild(this.closest(\'.image-modal\'));" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\u2715 Close</button>\n                                                                      </div>\n                                                                    </div>\n                                                                  </div>\n                                                                '),document.body.appendChild(e),e.addEventListener("click",t=>{t.target===e.querySelector(".image-modal-backdrop")&&document.body.removeChild(e)})}}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]})]}):(0,i.jsxs)("div",{className:"file-attachment",children:[(0,i.jsx)("div",{className:"file-icon",children:"\ud83d\udcc4"}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]}),(0,i.jsx)("button",{onClick:()=>{const e=document.createElement("a");e.href=n.data,e.download=n.name,e.click()},className:"download-button",title:"Download file",children:"\ud83d\udce5"})]})},t)}catch(n){return(0,i.jsx)("div",{className:"attachment-preview-item",children:(0,i.jsxs)("div",{className:"file-attachment error",children:[(0,i.jsx)("div",{className:"file-icon",children:"\u274c"}),(0,i.jsx)("div",{className:"attachment-info",children:(0,i.jsx)("div",{className:"file-name",children:"Invalid file data"})})]})},t)}})})]})]})}return t.orderSummary||t.doNumber?(0,i.jsxs)("div",{children:[t.orderSummary&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Order Summary:"})," ",t.orderSummary]}),t.doNumber&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"DO Number:"})," ",t.doNumber]}),t.attachments&&t.attachments.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:["Attachments (",t.attachments.length,"):"]}),(0,i.jsx)("div",{className:"attachment-preview-grid",children:t.attachments.map((e,t)=>{try{const n=JSON.parse(e),r=n.type.startsWith("image/");return(0,i.jsx)("div",{className:"attachment-preview-item",children:r?(0,i.jsxs)("div",{className:"image-attachment",children:[(0,i.jsx)("img",{src:n.data,alt:n.name,className:"attachment-thumbnail clickable-image",style:{maxWidth:"100px",maxHeight:"75px",borderRadius:"4px",border:"1px solid #ddd",cursor:"pointer"},onClick:()=>{const e=document.createElement("div");e.className="image-modal",e.innerHTML='\n                                                                  <div class="image-modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center; cursor: pointer;">\n                                                                    <div style="position: relative; max-width: 90%; max-height: 90%;">\n                                                                      <img src="'.concat(n.data,'" alt="').concat(n.name,'" style="max-width: 100%; max-height: 100%; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5);" />\n                                                                      <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 10px;">\n                                                                        <button onclick="event.stopPropagation(); const link = document.createElement(\'a\'); link.href = \'').concat(n.data,"'; link.download = '").concat(n.name,'\'; link.click();" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\ud83d\udce5 Download</button>\n                                                                        <button onclick="document.body.removeChild(this.closest(\'.image-modal\'));" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\u2715 Close</button>\n                                                                      </div>\n                                                                    </div>\n                                                                  </div>\n                                                                '),document.body.appendChild(e),e.addEventListener("click",t=>{t.target===e.querySelector(".image-modal-backdrop")&&document.body.removeChild(e)})}}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]})]}):(0,i.jsxs)("div",{className:"file-attachment",children:[(0,i.jsx)("div",{className:"file-icon",children:"\ud83d\udcc4"}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]}),(0,i.jsx)("button",{onClick:()=>{const e=document.createElement("a");e.href=n.data,e.download=n.name,e.click()},className:"download-button",title:"Download file",children:"\ud83d\udce5"})]})},t)}catch(n){return(0,i.jsx)("div",{className:"attachment-preview-item",children:(0,i.jsxs)("div",{className:"file-attachment error",children:[(0,i.jsx)("div",{className:"file-icon",children:"\u274c"}),(0,i.jsx)("div",{className:"attachment-info",children:(0,i.jsx)("div",{className:"file-name",children:"Invalid file data"})})]})},t)}})})]})]}):t.processDetails?(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Process Details:"})," ",t.processDetails,t.attachments&&t.attachments.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:["Attachments (",t.attachments.length,"):"]}),(0,i.jsx)("div",{className:"attachment-preview-grid",children:t.attachments.map((e,t)=>{try{const n=JSON.parse(e),r=n.type.startsWith("image/");return(0,i.jsx)("div",{className:"attachment-preview-item",children:r?(0,i.jsxs)("div",{className:"image-attachment",children:[(0,i.jsx)("img",{src:n.data,alt:n.name,className:"attachment-thumbnail clickable-image",style:{maxWidth:"100px",maxHeight:"75px",borderRadius:"4px",border:"1px solid #ddd",cursor:"pointer"},onClick:()=>{const e=document.createElement("div");e.className="image-modal",e.innerHTML='\n                                                                  <div class="image-modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center; cursor: pointer;">\n                                                                    <div style="position: relative; max-width: 90%; max-height: 90%;">\n                                                                      <img src="'.concat(n.data,'" alt="').concat(n.name,'" style="max-width: 100%; max-height: 100%; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5);" />\n                                                                      <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 10px;">\n                                                                        <button onclick="event.stopPropagation(); const link = document.createElement(\'a\'); link.href = \'').concat(n.data,"'; link.download = '").concat(n.name,'\'; link.click();" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\ud83d\udce5 Download</button>\n                                                                        <button onclick="document.body.removeChild(this.closest(\'.image-modal\'));" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\u2715 Close</button>\n                                                                      </div>\n                                                                    </div>\n                                                                  </div>\n                                                                '),document.body.appendChild(e),e.addEventListener("click",t=>{t.target===e.querySelector(".image-modal-backdrop")&&document.body.removeChild(e)})}}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]})]}):(0,i.jsxs)("div",{className:"file-attachment",children:[(0,i.jsx)("div",{className:"file-icon",children:"\ud83d\udcc4"}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]}),(0,i.jsx)("button",{onClick:()=>{const e=document.createElement("a");e.href=n.data,e.download=n.name,e.click()},className:"download-button",title:"Download file",children:"\ud83d\udce5"})]})},t)}catch(n){return(0,i.jsx)("div",{className:"attachment-preview-item",children:(0,i.jsxs)("div",{className:"file-attachment error",children:[(0,i.jsx)("div",{className:"file-icon",children:"\u274c"}),(0,i.jsx)("div",{className:"attachment-info",children:(0,i.jsx)("div",{className:"file-name",children:"Invalid file data"})})]})},t)}})})]}),t.comments&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Comments:"})," ",t.comments]})]}):t.attachments||t.comments?(0,i.jsxs)("div",{children:[t.comments&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Comments:"})," ",t.comments]}),t.attachments&&t.attachments.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:["Attachments (",t.attachments.length,"):"]}),(0,i.jsx)("div",{className:"attachment-preview-grid",children:t.attachments.map((e,t)=>{try{const n=JSON.parse(e),r=n.type.startsWith("image/");return(0,i.jsx)("div",{className:"attachment-preview-item",children:r?(0,i.jsxs)("div",{className:"image-attachment",children:[(0,i.jsx)("img",{src:n.data,alt:n.name,className:"attachment-thumbnail clickable-image",style:{maxWidth:"100px",maxHeight:"75px",borderRadius:"4px",border:"1px solid #ddd",cursor:"pointer"},onClick:()=>{const e=document.createElement("div");e.className="image-modal",e.innerHTML='\n                                                                  <div class="image-modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center; cursor: pointer;">\n                                                                    <div style="position: relative; max-width: 90%; max-height: 90%;">\n                                                                      <img src="'.concat(n.data,'" alt="').concat(n.name,'" style="max-width: 100%; max-height: 100%; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5);" />\n                                                                      <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 10px;">\n                                                                        <button onclick="event.stopPropagation(); const link = document.createElement(\'a\'); link.href = \'').concat(n.data,"'; link.download = '").concat(n.name,'\'; link.click();" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\ud83d\udce5 Download</button>\n                                                                        <button onclick="document.body.removeChild(this.closest(\'.image-modal\'));" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\u2715 Close</button>\n                                                                      </div>\n                                                                    </div>\n                                                                  </div>\n                                                                '),document.body.appendChild(e),e.addEventListener("click",t=>{t.target===e.querySelector(".image-modal-backdrop")&&document.body.removeChild(e)})}}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]})]}):(0,i.jsxs)("div",{className:"file-attachment",children:[(0,i.jsx)("div",{className:"file-icon",children:"\ud83d\udcc4"}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]}),(0,i.jsx)("button",{onClick:()=>{const e=document.createElement("a");e.href=n.data,e.download=n.name,e.click()},className:"download-button",title:"Download file",children:"\ud83d\udce5"})]})},t)}catch(n){return(0,i.jsx)("div",{className:"attachment-preview-item",children:(0,i.jsxs)("div",{className:"file-attachment error",children:[(0,i.jsx)("div",{className:"file-icon",children:"\u274c"}),(0,i.jsx)("div",{className:"attachment-info",children:(0,i.jsx)("div",{className:"file-name",children:"Invalid file data"})})]})},t)}})})]})]}):(0,i.jsx)("div",{children:Object.entries(t).map(e=>{let[t,n]=e;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:[t.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()),":"]}),"attachments"===t&&Array.isArray(n)&&n.length>0?(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:[" (",n.length,"):"]}),(0,i.jsx)("div",{className:"attachment-preview-grid",children:n.map((e,t)=>{try{const n=JSON.parse(e),r=n.type.startsWith("image/");return(0,i.jsx)("div",{className:"attachment-preview-item",children:r?(0,i.jsxs)("div",{className:"image-attachment",children:[(0,i.jsx)("img",{src:n.data,alt:n.name,className:"attachment-thumbnail clickable-image",style:{maxWidth:"100px",maxHeight:"75px",borderRadius:"4px",border:"1px solid #ddd",cursor:"pointer"},onClick:()=>{const e=document.createElement("div");e.className="image-modal",e.innerHTML='\n                                                                      <div class="image-modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center; cursor: pointer;">\n                                                                        <div style="position: relative; max-width: 90%; max-height: 90%;">\n                                                                          <img src="'.concat(n.data,'" alt="').concat(n.name,'" style="max-width: 100%; max-height: 100%; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5);" />\n                                                                          <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 10px;">\n                                                                            <button onclick="event.stopPropagation(); const link = document.createElement(\'a\'); link.href = \'').concat(n.data,"'; link.download = '").concat(n.name,'\'; link.click();" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\ud83d\udce5 Download</button>\n                                                                            <button onclick="document.body.removeChild(this.closest(\'.image-modal\'));" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\u2715 Close</button>\n                                                                          </div>\n                                                                        </div>\n                                                                      </div>\n                                                                    '),document.body.appendChild(e),e.addEventListener("click",t=>{t.target===e.querySelector(".image-modal-backdrop")&&document.body.removeChild(e)})}}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]})]}):(0,i.jsxs)("div",{className:"file-attachment",children:[(0,i.jsx)("div",{className:"file-icon",children:"\ud83d\udcc4"}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]}),(0,i.jsx)("button",{onClick:()=>{const e=document.createElement("a");e.href=n.data,e.download=n.name,e.click()},className:"download-button",title:"Download file",children:"\ud83d\udce5"})]})},t)}catch(n){return(0,i.jsx)("div",{className:"attachment-preview-item",children:(0,i.jsxs)("div",{className:"file-attachment error",children:[(0,i.jsx)("div",{className:"file-icon",children:"\u274c"}),(0,i.jsx)("div",{className:"attachment-info",children:(0,i.jsx)("div",{className:"file-name",children:"Invalid file data"})})]})},t)}})})]}):(0,i.jsxs)("span",{children:[" ","object"===typeof n?Array.isArray(n)?"".concat(n.length," item(s)"):JSON.stringify(n):String(n)]})]},t)})})}catch(t){return(0,i.jsx)("div",{children:e.details})}})()})]})]},t)):d.statusHistory.slice(-1).map((e,t)=>(0,i.jsxs)("div",{className:"status-history-item current-status",style:{borderLeftColor:bl(e.status)},children:[(0,i.jsxs)("div",{className:"status-history-header",children:[(0,i.jsxs)("span",{className:"history-status current",style:{backgroundColor:bl(e.status)},children:[e.status," (Current)"]}),(0,i.jsx)("span",{className:"history-timestamp",children:yl(e.timestamp)})]}),(0,i.jsxs)("div",{className:"history-details",children:[(0,i.jsxs)("span",{className:"history-processor",children:["By: ",e.processedBy]}),e.details&&(0,i.jsx)("div",{className:"history-notes",children:(()=>{try{const t=JSON.parse(e.details);if(t.deliveryDetails||t.comments&&!t.orderSummary&&!t.processDetails){const e=t.deliveryDetails,n=e?t.deliveryDetails:t.comments,r=e?t.deliveryImage?[JSON.stringify({name:"delivery-image.png",type:"image/png",data:t.deliveryImage})]:[]:t.attachments||[];return(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Delivery Details:"})," ",n,r&&r.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:["Attachments (",r.length,"):"]}),(0,i.jsx)("div",{className:"attachment-preview-grid",children:r.map((e,t)=>{try{const n=JSON.parse(e),r=n.type.startsWith("image/");return(0,i.jsx)("div",{className:"attachment-preview-item",children:r?(0,i.jsxs)("div",{className:"image-attachment",children:[(0,i.jsx)("img",{src:n.data,alt:n.name,className:"attachment-thumbnail clickable-image",style:{maxWidth:"100px",maxHeight:"75px",borderRadius:"4px",border:"1px solid #ddd",cursor:"pointer"},onClick:()=>{const e=document.createElement("div");e.className="image-modal",e.innerHTML='\n                                                                  <div class="image-modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center; cursor: pointer;">\n                                                                    <div style="position: relative; max-width: 90%; max-height: 90%;">\n                                                                      <img src="'.concat(n.data,'" alt="').concat(n.name,'" style="max-width: 100%; max-height: 100%; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5);" />\n                                                                      <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 10px;">\n                                                                        <button onclick="event.stopPropagation(); const link = document.createElement(\'a\'); link.href = \'').concat(n.data,"'; link.download = '").concat(n.name,'\'; link.click();" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\ud83d\udce5 Download</button>\n                                                                        <button onclick="document.body.removeChild(this.closest(\'.image-modal\'));" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\u2715 Close</button>\n                                                                      </div>\n                                                                    </div>\n                                                                  </div>\n                                                                '),document.body.appendChild(e),e.addEventListener("click",t=>{t.target===e.querySelector(".image-modal-backdrop")&&document.body.removeChild(e)})}}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]})]}):(0,i.jsxs)("div",{className:"file-attachment",children:[(0,i.jsx)("div",{className:"file-icon",children:"\ud83d\udcc4"}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]}),(0,i.jsx)("button",{onClick:()=>{const e=document.createElement("a");e.href=n.data,e.download=n.name,e.click()},className:"download-button",title:"Download file",children:"\ud83d\udce5"})]})},t)}catch(n){return(0,i.jsx)("div",{className:"attachment-preview-item",children:(0,i.jsxs)("div",{className:"file-attachment error",children:[(0,i.jsx)("div",{className:"file-icon",children:"\u274c"}),(0,i.jsx)("div",{className:"attachment-info",children:(0,i.jsx)("div",{className:"file-name",children:"Invalid file data"})})]})},t)}})})]})]})}return t.orderSummary||t.doNumber?(0,i.jsxs)("div",{children:[t.orderSummary&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Order Summary:"})," ",t.orderSummary]}),t.doNumber&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"DO Number:"})," ",t.doNumber]}),t.attachments&&t.attachments.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:["Attachments (",t.attachments.length,"):"]}),(0,i.jsx)("div",{className:"attachment-preview-grid",children:t.attachments.map((e,t)=>{try{const n=JSON.parse(e),r=n.type.startsWith("image/");return(0,i.jsx)("div",{className:"attachment-preview-item",children:r?(0,i.jsxs)("div",{className:"image-attachment",children:[(0,i.jsx)("img",{src:n.data,alt:n.name,className:"attachment-thumbnail clickable-image",style:{maxWidth:"100px",maxHeight:"75px",borderRadius:"4px",border:"1px solid #ddd",cursor:"pointer"},onClick:()=>{const e=document.createElement("div");e.className="image-modal",e.innerHTML='\n                                                                  <div class="image-modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center; cursor: pointer;">\n                                                                    <div style="position: relative; max-width: 90%; max-height: 90%;">\n                                                                      <img src="'.concat(n.data,'" alt="').concat(n.name,'" style="max-width: 100%; max-height: 100%; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5);" />\n                                                                      <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 10px;">\n                                                                        <button onclick="event.stopPropagation(); const link = document.createElement(\'a\'); link.href = \'').concat(n.data,"'; link.download = '").concat(n.name,'\'; link.click();" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\ud83d\udce5 Download</button>\n                                                                        <button onclick="document.body.removeChild(this.closest(\'.image-modal\'));" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\u2715 Close</button>\n                                                                      </div>\n                                                                    </div>\n                                                                  </div>\n                                                                '),document.body.appendChild(e),e.addEventListener("click",t=>{t.target===e.querySelector(".image-modal-backdrop")&&document.body.removeChild(e)})}}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]})]}):(0,i.jsxs)("div",{className:"file-attachment",children:[(0,i.jsx)("div",{className:"file-icon",children:"\ud83d\udcc4"}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]}),(0,i.jsx)("button",{onClick:()=>{const e=document.createElement("a");e.href=n.data,e.download=n.name,e.click()},className:"download-button",title:"Download file",children:"\ud83d\udce5"})]})},t)}catch(n){return(0,i.jsx)("div",{className:"attachment-preview-item",children:(0,i.jsxs)("div",{className:"file-attachment error",children:[(0,i.jsx)("div",{className:"file-icon",children:"\u274c"}),(0,i.jsx)("div",{className:"attachment-info",children:(0,i.jsx)("div",{className:"file-name",children:"Invalid file data"})})]})},t)}})})]})]}):t.processDetails?(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Process Details:"})," ",t.processDetails,t.attachments&&t.attachments.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:["Attachments (",t.attachments.length,"):"]}),(0,i.jsx)("div",{className:"attachment-preview-grid",children:t.attachments.map((e,t)=>{try{const n=JSON.parse(e),r=n.type.startsWith("image/");return(0,i.jsx)("div",{className:"attachment-preview-item",children:r?(0,i.jsxs)("div",{className:"image-attachment",children:[(0,i.jsx)("img",{src:n.data,alt:n.name,className:"attachment-thumbnail clickable-image",style:{maxWidth:"100px",maxHeight:"75px",borderRadius:"4px",border:"1px solid #ddd",cursor:"pointer"},onClick:()=>{const e=document.createElement("div");e.className="image-modal",e.innerHTML='\n                                                                  <div class="image-modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center; cursor: pointer;">\n                                                                    <div style="position: relative; max-width: 90%; max-height: 90%;">\n                                                                      <img src="'.concat(n.data,'" alt="').concat(n.name,'" style="max-width: 100%; max-height: 100%; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5);" />\n                                                                      <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 10px;">\n                                                                        <button onclick="event.stopPropagation(); const link = document.createElement(\'a\'); link.href = \'').concat(n.data,"'; link.download = '").concat(n.name,'\'; link.click();" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\ud83d\udce5 Download</button>\n                                                                        <button onclick="document.body.removeChild(this.closest(\'.image-modal\'));" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\u2715 Close</button>\n                                                                      </div>\n                                                                    </div>\n                                                                  </div>\n                                                                '),document.body.appendChild(e),e.addEventListener("click",t=>{t.target===e.querySelector(".image-modal-backdrop")&&document.body.removeChild(e)})}}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]})]}):(0,i.jsxs)("div",{className:"file-attachment",children:[(0,i.jsx)("div",{className:"file-icon",children:"\ud83d\udcc4"}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]}),(0,i.jsx)("button",{onClick:()=>{const e=document.createElement("a");e.href=n.data,e.download=n.name,e.click()},className:"download-button",title:"Download file",children:"\ud83d\udce5"})]})},t)}catch(n){return(0,i.jsx)("div",{className:"attachment-preview-item",children:(0,i.jsxs)("div",{className:"file-attachment error",children:[(0,i.jsx)("div",{className:"file-icon",children:"\u274c"}),(0,i.jsx)("div",{className:"attachment-info",children:(0,i.jsx)("div",{className:"file-name",children:"Invalid file data"})})]})},t)}})})]}),t.comments&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Comments:"})," ",t.comments]})]}):t.attachments||t.comments?(0,i.jsxs)("div",{children:[t.comments&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Comments:"})," ",t.comments]}),t.attachments&&t.attachments.length>0&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:["Attachments (",t.attachments.length,"):"]}),(0,i.jsx)("div",{className:"attachment-preview-grid",children:t.attachments.map((e,t)=>{try{const n=JSON.parse(e),r=n.type.startsWith("image/");return(0,i.jsx)("div",{className:"attachment-preview-item",children:r?(0,i.jsxs)("div",{className:"image-attachment",children:[(0,i.jsx)("img",{src:n.data,alt:n.name,className:"attachment-thumbnail clickable-image",style:{maxWidth:"100px",maxHeight:"75px",borderRadius:"4px",border:"1px solid #ddd",cursor:"pointer"},onClick:()=>{const e=document.createElement("div");e.className="image-modal",e.innerHTML='\n                                                                  <div class="image-modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center; cursor: pointer;">\n                                                                    <div style="position: relative; max-width: 90%; max-height: 90%;">\n                                                                      <img src="'.concat(n.data,'" alt="').concat(n.name,'" style="max-width: 100%; max-height: 100%; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5);" />\n                                                                      <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 10px;">\n                                                                        <button onclick="event.stopPropagation(); const link = document.createElement(\'a\'); link.href = \'').concat(n.data,"'; link.download = '").concat(n.name,'\'; link.click();" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\ud83d\udce5 Download</button>\n                                                                        <button onclick="document.body.removeChild(this.closest(\'.image-modal\'));" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\u2715 Close</button>\n                                                                      </div>\n                                                                    </div>\n                                                                  </div>\n                                                                '),document.body.appendChild(e),e.addEventListener("click",t=>{t.target===e.querySelector(".image-modal-backdrop")&&document.body.removeChild(e)})}}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]})]}):(0,i.jsxs)("div",{className:"file-attachment",children:[(0,i.jsx)("div",{className:"file-icon",children:"\ud83d\udcc4"}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]}),(0,i.jsx)("button",{onClick:()=>{const e=document.createElement("a");e.href=n.data,e.download=n.name,e.click()},className:"download-button",title:"Download file",children:"\ud83d\udce5"})]})},t)}catch(n){return(0,i.jsx)("div",{className:"attachment-preview-item",children:(0,i.jsxs)("div",{className:"file-attachment error",children:[(0,i.jsx)("div",{className:"file-icon",children:"\u274c"}),(0,i.jsx)("div",{className:"attachment-info",children:(0,i.jsx)("div",{className:"file-name",children:"Invalid file data"})})]})},t)}})})]})]}):(0,i.jsx)("div",{children:Object.entries(t).map(e=>{let[t,n]=e;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:[t.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()),":"]}),"attachments"===t&&Array.isArray(n)&&n.length>0?(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:[" (",n.length,"):"]}),(0,i.jsx)("div",{className:"attachment-preview-grid",children:n.map((e,t)=>{try{const n=JSON.parse(e),r=n.type.startsWith("image/");return(0,i.jsx)("div",{className:"attachment-preview-item",children:r?(0,i.jsxs)("div",{className:"image-attachment",children:[(0,i.jsx)("img",{src:n.data,alt:n.name,className:"attachment-thumbnail clickable-image",style:{maxWidth:"100px",maxHeight:"75px",borderRadius:"4px",border:"1px solid #ddd",cursor:"pointer"},onClick:()=>{const e=document.createElement("div");e.className="image-modal",e.innerHTML='\n                                                                      <div class="image-modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; align-items: center; justify-content: center; cursor: pointer;">\n                                                                        <div style="position: relative; max-width: 90%; max-height: 90%;">\n                                                                          <img src="'.concat(n.data,'" alt="').concat(n.name,'" style="max-width: 100%; max-height: 100%; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5);" />\n                                                                          <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 10px;">\n                                                                            <button onclick="event.stopPropagation(); const link = document.createElement(\'a\'); link.href = \'').concat(n.data,"'; link.download = '").concat(n.name,'\'; link.click();" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\ud83d\udce5 Download</button>\n                                                                            <button onclick="document.body.removeChild(this.closest(\'.image-modal\'));" style="background: rgba(255,255,255,0.9); border: none; padding: 8px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">\u2715 Close</button>\n                                                                          </div>\n                                                                        </div>\n                                                                      </div>\n                                                                    '),document.body.appendChild(e),e.addEventListener("click",t=>{t.target===e.querySelector(".image-modal-backdrop")&&document.body.removeChild(e)})}}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]})]}):(0,i.jsxs)("div",{className:"file-attachment",children:[(0,i.jsx)("div",{className:"file-icon",children:"\ud83d\udcc4"}),(0,i.jsxs)("div",{className:"attachment-info",children:[(0,i.jsx)("div",{className:"file-name",title:n.name,children:n.name.length>15?n.name.substring(0,15)+"...":n.name}),(0,i.jsxs)("div",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]})]}),(0,i.jsx)("button",{onClick:()=>{const e=document.createElement("a");e.href=n.data,e.download=n.name,e.click()},className:"download-button",title:"Download file",children:"\ud83d\udce5"})]})},t)}catch(n){return(0,i.jsx)("div",{className:"attachment-preview-item",children:(0,i.jsxs)("div",{className:"file-attachment error",children:[(0,i.jsx)("div",{className:"file-icon",children:"\u274c"}),(0,i.jsx)("div",{className:"attachment-info",children:(0,i.jsx)("div",{className:"file-name",children:"Invalid file data"})})]})},t)}})})]}):(0,i.jsxs)("span",{children:[" ","object"===typeof n?Array.isArray(n)?"".concat(n.length," item(s)"):JSON.stringify(n):String(n)]})]},t)})})}catch(t){return(0,i.jsx)("div",{children:e.details})}})()})]})]},t))})]})]}),g===d.id&&(0,i.jsxs)("div",{className:"amendment-form",children:[(0,i.jsx)("h4",{children:"Amend Case Details"}),(0,i.jsxs)("div",{className:"form-grid",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Hospital:"}),(0,i.jsx)("input",{type:"text",value:v.hospital||"",onChange:e=>ye((0,f.A)((0,f.A)({},v),{},{hospital:e.target.value}))}),Be(0,v.hospital,null===(t=d.originalValues)||void 0===t?void 0:t.hospital)]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Department:"}),(0,i.jsxs)("select",{value:v.department||"",onChange:e=>ye((0,f.A)((0,f.A)({},v),{},{department:e.target.value})),children:[(0,i.jsx)("option",{value:"",children:"Select Department"}),Le.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]}),Be(0,v.department,null===(n=d.originalValues)||void 0===n?void 0:n.department)]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Date of Surgery:"}),(0,i.jsx)("input",{type:"date",value:v.dateOfSurgery||"",onChange:e=>ye((0,f.A)((0,f.A)({},v),{},{dateOfSurgery:e.target.value})),min:Ni(),required:!0}),Be(0,v.dateOfSurgery,null===(a=d.originalValues)||void 0===a?void 0:a.dateOfSurgery)]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Procedure Type:"}),(0,i.jsxs)("select",{value:v.procedureType||"",onChange:e=>ye((0,f.A)((0,f.A)({},v),{},{procedureType:e.target.value})),children:[(0,i.jsx)("option",{value:"",children:"Select Procedure Type"}),Re.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]}),Be(0,v.procedureType,null===(s=d.originalValues)||void 0===s?void 0:s.procedureType)]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Doctor Name:"}),(0,i.jsx)("input",{type:"text",value:v.doctorName||"",onChange:e=>ye((0,f.A)((0,f.A)({},v),{},{doctorName:e.target.value}))}),Be(0,v.doctorName,null===(o=d.originalValues)||void 0===o?void 0:o.doctorName)]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Time of Procedure:"}),(0,i.jsx)(ie,{value:v.timeOfProcedure||"",onChange:e=>ye((0,f.A)((0,f.A)({},v),{},{timeOfProcedure:e})),placeholder:"Select procedure time",step:15}),Be(0,v.timeOfProcedure,null===(l=d.originalValues)||void 0===l?void 0:l.timeOfProcedure)]}),(0,i.jsxs)("div",{className:"form-group full-width",children:[(0,i.jsx)("label",{children:"Special Instructions:"}),(0,i.jsx)("textarea",{value:v.specialInstruction||"",onChange:e=>ye((0,f.A)((0,f.A)({},v),{},{specialInstruction:e.target.value})),rows:3}),Be(0,v.specialInstruction,null===(c=d.originalValues)||void 0===c?void 0:c.specialInstruction)]})]}),(0,i.jsxs)("div",{className:"amendment-actions",children:[(0,i.jsx)("button",{onClick:()=>W(d.id),className:"btn btn-primary btn-md save-amendment-button",children:"Save Amendment"}),(0,i.jsx)("button",{onClick:V,className:"btn btn-outline-secondary btn-md cancel-amendment-button",children:"Cancel"})]})]}),y===d.id&&(0,i.jsxs)("div",{className:"processing-form",children:[(0,i.jsx)("h4",{children:"Order Processing Details"}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Enter processing details:"}),(0,i.jsx)("textarea",{value:x,onChange:e=>be(e.target.value),placeholder:"Enter order processing details, preparation notes, and any additional requirements...",rows:4,className:"process-details-input"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Attachments (Optional):"}),(0,i.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg,.txt",onChange:e=>{const t=e.target.files;if(t){const e=[];Array.from(t).forEach(n=>{const r=new FileReader;r.onload=()=>{const a={name:n.name,type:n.type,size:n.size,data:r.result};e.push(JSON.stringify(a)),e.length===t.length&&xe([...w,...e])},r.readAsDataURL(n)})}},className:"file-upload-input"}),w.length>0&&(0,i.jsxs)("div",{className:"attachment-list",children:[(0,i.jsxs)("p",{children:["Uploaded files (",w.length,"):"]}),w.map((e,t)=>{try{const n=JSON.parse(e);return(0,i.jsxs)("div",{className:"attachment-item",children:[(0,i.jsx)("span",{className:"file-name",children:n.name}),(0,i.jsxs)("span",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]}),(0,i.jsx)("button",{onClick:()=>xe(w.filter((e,n)=>n!==t)),className:"remove-attachment",type:"button",children:"\u2715"})]},t)}catch(n){return(0,i.jsxs)("div",{className:"attachment-item",children:[(0,i.jsx)("span",{className:"file-name",children:"Invalid file data"}),(0,i.jsx)("button",{onClick:()=>xe(w.filter((e,n)=>n!==t)),className:"remove-attachment",type:"button",children:"\u2715"})]},t)}})]})]}),(0,i.jsxs)("div",{className:"processing-actions",children:[(0,i.jsx)("button",{onClick:()=>Q(d.id),className:"btn btn-primary btn-md save-process-button",disabled:!x.trim(),children:"Complete Processing"}),(0,i.jsx)("button",{onClick:J,className:"btn btn-outline-secondary btn-md cancel-process-button",children:"Cancel"})]})]}),N===d.id&&(0,i.jsxs)("div",{className:"hospital-delivery-form",children:[(0,i.jsx)("h4",{children:"Pending Delivery to Hospital"}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Attachments (Optional):"}),(0,i.jsx)("input",{type:"file",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.txt",onChange:e=>{const t=e.target.files;t&&Array.from(t).forEach(e=>{const t=new FileReader;t.onload=()=>{const n={name:e.name,type:e.type,size:e.size,data:t.result};je([...j,JSON.stringify(n)])},t.readAsDataURL(e)})},className:"file-upload-input"}),j.length>0&&(0,i.jsxs)("div",{className:"attachment-list",children:[(0,i.jsxs)("p",{children:["Uploaded files (",j.length,"):"]}),j.map((e,t)=>{try{const n=JSON.parse(e);return(0,i.jsxs)("div",{className:"attachment-item",children:[(0,i.jsx)("span",{className:"file-name",children:n.name}),(0,i.jsxs)("span",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]}),(0,i.jsx)("button",{onClick:()=>je(j.filter((e,n)=>n!==t)),className:"remove-attachment",type:"button",children:"\u2715"})]},t)}catch(n){return(0,i.jsxs)("div",{className:"attachment-item",children:[(0,i.jsx)("span",{className:"file-name",children:"Invalid file data"}),(0,i.jsx)("button",{onClick:()=>je(j.filter((e,n)=>n!==t)),className:"remove-attachment",type:"button",children:"\u2715"})]},t)}})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Comments (Optional):"}),(0,i.jsx)("textarea",{value:k,onChange:e=>ke(e.target.value),placeholder:"Add any delivery notes or special instructions...",rows:3,className:"form-control"})]}),(0,i.jsxs)("div",{className:"hospital-delivery-actions",children:[(0,i.jsx)("button",{onClick:()=>Se(d.id),className:"btn btn-primary btn-md save-hospital-delivery-button",children:"Mark as Pending Delivery"}),(0,i.jsx)("button",{onClick:Ne,className:"btn btn-outline-secondary btn-md cancel-hospital-delivery-button",children:"Cancel"})]})]}),C===d.id&&(0,i.jsxs)("div",{className:"received-form",children:[(0,i.jsx)("h4",{children:"Order Received at Hospital"}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Delivery Details:"}),(0,i.jsx)("textarea",{value:E,onChange:e=>Ce(e.target.value),placeholder:"Enter delivery details, condition of items, any issues encountered...",rows:4,className:"received-details-input"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Delivery Image (Optional):"}),(0,i.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;const n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){const e=new FileReader;e.onload=()=>Ee(e.result),e.readAsDataURL(n)}},className:"image-upload"}),_&&(0,i.jsx)("div",{className:"image-preview",children:(0,i.jsx)("img",{src:_,alt:"Delivery",style:{maxWidth:"200px",maxHeight:"200px"}})})]}),(0,i.jsxs)("div",{className:"received-actions",children:[(0,i.jsx)("button",{onClick:()=>Z(d.id),className:"btn btn-primary btn-md save-received-button",disabled:!E.trim(),children:"Confirm Received"}),(0,i.jsx)("button",{onClick:ee,className:"btn btn-outline-secondary btn-md cancel-received-button",children:"Cancel"})]})]}),D===d.id&&(0,i.jsxs)("div",{className:"completed-form",children:[(0,i.jsx)("h4",{children:"Case Completion"}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Attachments (Optional):"}),(0,i.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg,.txt",onChange:ge,className:"file-upload-input"}),A.length>0&&(0,i.jsxs)("div",{className:"attachment-list",children:[(0,i.jsxs)("p",{children:["Uploaded files (",A.length,"):"]}),A.map((e,t)=>{try{const n=JSON.parse(e);return(0,i.jsxs)("div",{className:"attachment-item",children:[(0,i.jsx)("span",{className:"file-name",children:n.name}),(0,i.jsxs)("span",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]}),(0,i.jsx)("button",{onClick:()=>ve(t),className:"remove-attachment",type:"button",children:"\u2715"})]},t)}catch(n){return(0,i.jsxs)("div",{className:"attachment-item",children:[(0,i.jsx)("span",{className:"file-name",children:"Invalid file data"}),(0,i.jsx)("button",{onClick:()=>ve(t),className:"remove-attachment",type:"button",children:"\u2715"})]},t)}})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Order Summary:"}),(0,i.jsx)("textarea",{value:T,onChange:e=>_e(e.target.value),placeholder:"Provide a comprehensive summary of the completed order...",rows:4,className:"summary-input"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"DO Number:"}),(0,i.jsx)("input",{type:"text",value:I,onChange:e=>De(e.target.value),placeholder:"Enter delivery order number",className:"do-number-input"})]}),(0,i.jsxs)("div",{className:"completed-actions",children:[(0,i.jsx)("button",{onClick:()=>re(d.id),className:"btn btn-primary btn-md save-completed-button",disabled:!T.trim()||!I.trim(),children:"Complete Case"}),(0,i.jsx)("button",{onClick:ae,className:"btn btn-outline-secondary btn-md cancel-completed-button",children:"Cancel"})]})]}),O===d.id&&(0,i.jsxs)("div",{className:"pending-office-form",children:[(0,i.jsx)("h4",{children:"Pending Delivery to Office"}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Attachments (Optional):"}),(0,i.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg,.txt",onChange:e=>{const t=e.target.files;if(t){const e=[];Array.from(t).forEach(n=>{const r=new FileReader;r.onload=()=>{const a={name:n.name,type:n.type,size:n.size,data:r.result};e.push(JSON.stringify(a)),e.length===t.length&&Ae([...P,...e])},r.readAsDataURL(n)})}},className:"file-upload-input"}),P.length>0&&(0,i.jsxs)("div",{className:"attachment-list",children:[(0,i.jsxs)("p",{children:["Uploaded files (",P.length,"):"]}),P.map((e,t)=>{try{const n=JSON.parse(e);return(0,i.jsxs)("div",{className:"attachment-item",children:[(0,i.jsx)("span",{className:"file-name",children:n.name}),(0,i.jsxs)("span",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]}),(0,i.jsx)("button",{onClick:()=>Ae(P.filter((e,n)=>n!==t)),className:"remove-attachment",type:"button",children:"\u2715"})]},t)}catch(n){return(0,i.jsxs)("div",{className:"attachment-item",children:[(0,i.jsx)("span",{className:"file-name",children:"Invalid file data"}),(0,i.jsx)("button",{onClick:()=>Ae(P.filter((e,n)=>n!==t)),className:"remove-attachment",type:"button",children:"\u2715"})]},t)}})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Comments (Optional):"}),(0,i.jsx)("textarea",{value:R,onChange:e=>Te(e.target.value),placeholder:"Add any additional comments or notes...",rows:3,className:"comments-input"})]}),(0,i.jsxs)("div",{className:"pending-office-actions",children:[(0,i.jsx)("button",{onClick:()=>oe(d.id),className:"btn btn-primary btn-md save-pending-office-button",children:"Mark as Pending Delivery (Office)"}),(0,i.jsx)("button",{onClick:le,className:"btn btn-outline-secondary btn-md cancel-pending-office-button",children:"Cancel"})]})]}),M===d.id&&(0,i.jsxs)("div",{className:"office-delivery-form",children:[(0,i.jsx)("h4",{children:"Delivery to Office"}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Attachments (Optional):"}),(0,i.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg,.txt",onChange:e=>{const t=e.target.files;if(t){const e=[];Array.from(t).forEach(n=>{const r=new FileReader;r.onload=()=>{const a={name:n.name,type:n.type,size:n.size,data:r.result};e.push(JSON.stringify(a)),e.length===t.length&&Ie([...L,...e])},r.readAsDataURL(n)})}},className:"file-upload-input"}),L.length>0&&(0,i.jsxs)("div",{className:"attachment-list",children:[(0,i.jsxs)("p",{children:["Uploaded files (",L.length,"):"]}),L.map((e,t)=>{try{const n=JSON.parse(e);return(0,i.jsxs)("div",{className:"attachment-item",children:[(0,i.jsx)("span",{className:"file-name",children:n.name}),(0,i.jsxs)("span",{className:"file-size",children:["(",(n.size/1024).toFixed(1)," KB)"]}),(0,i.jsx)("button",{onClick:()=>Ie(L.filter((e,n)=>n!==t)),className:"remove-attachment",type:"button",children:"\u2715"})]},t)}catch(n){return(0,i.jsxs)("div",{className:"attachment-item",children:[(0,i.jsx)("span",{className:"file-name",children:"Invalid file data"}),(0,i.jsx)("button",{onClick:()=>Ie(L.filter((e,n)=>n!==t)),className:"remove-attachment",type:"button",children:"\u2715"})]},t)}})]})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"Comments (Optional):"}),(0,i.jsx)("textarea",{value:F,onChange:e=>Oe(e.target.value),placeholder:"Add any delivery notes or special instructions...",rows:3,className:"comments-input"})]}),(0,i.jsxs)("div",{className:"office-delivery-actions",children:[(0,i.jsx)("button",{onClick:()=>de(d.id),className:"btn btn-primary btn-md save-office-delivery-button",children:"Mark as Delivered (Office)"}),(0,i.jsx)("button",{onClick:ue,className:"btn btn-outline-secondary btn-md cancel-office-delivery-button",children:"Cancel"})]})]}),(0,i.jsx)(Sl,{caseItem:d,currentUser:u,onStatusChange:q,onAmendCase:Y,onDeleteCase:me,onOrderProcessed:G,onOrderDelivered:$,onOrderReceived:X,onCaseCompleted:te,onPendingDeliveryOffice:se,onOfficeDelivery:ce,onOrderDeliveredOffice:he,onToBeBilled:pe,onCancelCase:fe,canAmendCase:e=>{const t=b();if(!t)return!1;if("admin"===t.role)return!0;const n=["sales","sales-manager","operations","operations-manager"].includes(t.role),r=!e.isAmended;return n&&r}})]})]})},jl=e=>{let{message:t,isVisible:n,onClose:a}=e;return(0,r.useEffect)(()=>{if(n){const e=setTimeout(()=>{a()},3e3);return()=>clearTimeout(e)}},[n,a]),(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&n&&a()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n,a]),n?(0,i.jsx)("div",{className:"status-success-overlay",onClick:a,children:(0,i.jsxs)("div",{className:"status-success-popup",onClick:e=>e.stopPropagation(),children:[(0,i.jsx)("div",{className:"success-icon",children:(0,i.jsx)("div",{className:"success-checkmark",children:(0,i.jsxs)("svg",{className:"checkmark-svg",viewBox:"0 0 52 52",width:"80",height:"80",children:[(0,i.jsx)("circle",{className:"checkmark-circle",cx:"26",cy:"26",r:"25",fill:"none"}),(0,i.jsx)("path",{className:"checkmark-check",fill:"none",d:"m14.1 27.2l7.1 7.2 16.7-16.8"})]})})}),(0,i.jsxs)("div",{className:"success-content",children:[(0,i.jsx)("h3",{children:"Success!"}),(0,i.jsx)("p",{children:t})]}),(0,i.jsx)("button",{className:"close-button",onClick:a,children:"\xd7"}),(0,i.jsx)("div",{className:"auto-close-indicator",children:(0,i.jsx)("div",{className:"auto-close-bar"})})]})}):null},kl=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{autoRefresh:t=!1,refreshInterval:n=3e4}=e,[a,s]=(0,r.useState)([]),[o,i]=(0,r.useState)(!0),[l,c]=(0,r.useState)(null),d=(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];console.log("\ud83d\udccb useCases.loadCases called with forceRefresh:",e);try{i(!0),c(null),await A();const t=await H.caseService.getAllCases(e);console.log("\ud83d\udccb useCases loaded",t.length,"cases from Supabase");const n=T();console.log("\ud83d\udccb useCases found",n.length,"cases still in localStorage");const r=new Set(t.map(e=>e.caseReferenceNumber)),a=n.filter(e=>!r.has(e.caseReferenceNumber)),o=[...t,...a];console.log("\ud83d\udccb useCases total combined cases:",o.length),s(o)}catch(t){c(t instanceof Error?t.message:"Failed to load cases"),console.error("\ud83d\udccb Error loading cases in useCases:",t)}finally{i(!1)}},[]),u=(0,r.useCallback)(()=>{d(!0)},[d]),h=(0,r.useCallback)(async(e,t,n,r)=>{const a=await H.caseService.updateCaseStatus(e,t,n,r);return a&&u(),a},[u]),p=(0,r.useCallback)(async e=>{const t=await H.caseService.saveCase(e);return t&&u(),t},[u]),m=(0,r.useCallback)(async e=>{const t=await H.caseService.deleteCase(e);return t&&u(),t},[u]),f=(0,r.useCallback)(async function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const a=await H.caseService.amendCase(e,t,n,r);return a&&u(),a},[u]);return(0,r.useEffect)(()=>{if(t&&n>0){const e=setInterval(u,n);return()=>clearInterval(e)}},[t,n,u]),(0,r.useEffect)(()=>{d()},[d]),{cases:a,loading:o,error:l,refreshCases:u,updateCaseStatus:h,saveCase:p,deleteCase:m,amendCase:f,generateCaseReferenceNumber:()=>H.caseService.generateCaseReferenceNumber()}},Cl=e=>{let{onProcessCase:t,currentUser:n,highlightedCaseId:a,onClearHighlight:s,onNavigateToPermissions:o}=e;const{addNotification:l}=ol(),{modal:c,closeModal:d,showConfirm:u}=de(),{cases:h,refreshCases:p,updateCaseStatus:m,amendCase:g,deleteCase:v}=kl(),[y,x]=(0,r.useState)([]),[S,N]=(0,r.useState)([]),[j,k]=(0,r.useState)([]),[C,E]=(0,r.useState)({}),[_,D]=(0,r.useState)({}),[A,T]=(0,r.useState)(new Set),[I,O]=(0,r.useState)(new Set),[P,R]=(0,r.useState)(new Set),[M,L]=(0,r.useState)(!1),[F,B]=(0,r.useState)(!0),[U,z]=(0,r.useState)(null),[H,q]=(0,r.useState)({}),[Y,W]=(0,r.useState)(null),[K,G]=(0,r.useState)(""),[Q]=(0,r.useState)(null),[J]=(0,r.useState)(""),[$,X]=(0,r.useState)(null),[Z,ee]=(0,r.useState)(""),[te,ne]=(0,r.useState)(""),[re,ae]=(0,r.useState)(null),[se,oe]=(0,r.useState)([]),[ie,ce]=(0,r.useState)(""),[ue,he]=(0,r.useState)(""),[pe,me]=(0,r.useState)([]),[fe,ge]=(0,r.useState)(""),[ve,ye]=(0,r.useState)([]),[be,xe]=(0,r.useState)(""),[we,Se]=(0,r.useState)(null),[Ne,je]=(0,r.useState)(null),[ke,Ce]=(0,r.useState)([]),[Ee,_e]=(0,r.useState)(""),[De,Ae]=(0,r.useState)(null),[Te,Ie]=(0,r.useState)([]),[Oe,Pe]=(0,r.useState)(""),[Re,Me]=(0,r.useState)(1),[Le]=(0,r.useState)(5),[Fe,Be]=(0,r.useState)(!1),[Ue,ze]=(0,r.useState)(""),He=async e=>{const t=e.target.files;t&&Array.from(t).forEach(e=>{const t=new FileReader;t.onload=()=>{const n={name:e.name,type:e.type,size:e.size,data:t.result};oe(e=>[...e,JSON.stringify(n)])},t.readAsDataURL(e)})},qe=e=>{oe(t=>t.filter((t,n)=>n!==e))},Ye=(0,r.useMemo)(()=>{const e=b();let t=h.filter(e=>{if(C.search){var t;const n=C.search.toLowerCase();if(!(e.caseReferenceNumber.toLowerCase().includes(n)||e.hospital.toLowerCase().includes(n)||(null===(t=e.doctorName)||void 0===t?void 0:t.toLowerCase().includes(n))||e.procedureType.toLowerCase().includes(n)||e.procedureName.toLowerCase().includes(n)||e.submittedBy.toLowerCase().includes(n)))return!1}return(!C.status||e.status===C.status)&&((!C.submitter||e.submittedBy===C.submitter)&&((!C.hospital||e.hospital===C.hospital)&&((!C.country||e.country===C.country)&&(!(C.dateFrom&&e.dateOfSurgery<C.dateFrom)&&!(C.dateTo&&e.dateOfSurgery>C.dateTo)))))});return(null===e||void 0===e?void 0:e.role)!==cl&&(null===e||void 0===e?void 0:e.role)!==dl||!e.selectedCountry||(t=t.filter(t=>t.country===e.selectedCountry)),null!==e&&void 0!==e&&e.departments&&e.departments.length>0&&e.role!==ll&&e.role!==dl&&e.role!==ml&&(t=t.filter(t=>w(e.departments,t.department))),t},[h,C]);(0,r.useEffect)(()=>{x(Ye)},[Ye]),(0,r.useEffect)(()=>{if(a){const e=y.findIndex(e=>e.id===a);if(-1!==e){const t=Math.ceil((e+1)/Le);Me(t)}T(e=>new Set([...Array.from(e),a])),setTimeout(()=>{const e=document.getElementById("case-".concat(a));e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("highlighted-case"),setTimeout(()=>{e.classList.remove("highlighted-case"),null===s||void 0===s||s()},3e3))},100)}},[a,s,y,Le]),(0,r.useEffect)(()=>{(async()=>{const e=Array.from(new Set(h.map(e=>e.submittedBy))).filter(e=>e&&e.trim()).sort();N(e);const t=b(),n=(null===t||void 0===t?void 0:t.selectedCountry)||"Singapore";if(console.log("\ud83c\udfe5 CasesList - Loading hospitals for country:",n),n){const e=await V(n);console.log("\ud83c\udfe5 CasesList - Country-specific hospitals:",e),k(e.sort())}else{const e=(console.warn("\u26a0\ufe0f getHospitals is deprecated. Use async getHospitalsForCountry() instead."),[]);console.log("\ud83c\udfe5 CasesList - Global hospitals fallback:",e),k(e.sort())}})()},[h]);const We=e=>{T(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},Ve=e=>{O(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},Ke=e=>{R(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},Ge=async(e,t)=>{if(!b())return;const n=h.find(t=>t.id===e);await m(e,t),Me(1),T(t=>new Set([...Array.from(t),e])),ze('Case status successfully updated to "'.concat(t,'"')),Be(!0),l({title:"Case Status Updated",message:"Case ".concat((null===n||void 0===n?void 0:n.caseReferenceNumber)||e," status changed to ").concat(t),type:"success"})},Qe=async e=>{z(e.id),q({hospital:e.hospital,department:e.department,dateOfSurgery:e.dateOfSurgery,procedureType:e.procedureType,doctorName:e.doctorName,timeOfProcedure:e.timeOfProcedure,specialInstruction:e.specialInstruction})},Je=async e=>{const t=b();if(t)try{const n="admin"===t.role;await g(e,H,t.name,n),z(null),q({}),Me(1),T(t=>new Set([...Array.from(t),e])),ze("Case amended successfully!"),Be(!0)}catch(n){console.error("Failed to amend case:",n)}},$e=async()=>{z(null),q({})},Xe=async e=>{W(e),G(""),me([])},Ze=async e=>{if(!K.trim())return;const t=b();if(t)try{const n=h.find(t=>t.id===e),r={processDetails:K,attachments:pe};await m(e,"Order Prepared",JSON.stringify(r)),W(null),G(""),me([]),Me(1),T(t=>new Set([...Array.from(t),e])),ze("Order successfully marked as prepared"),Be(!0),l({title:"Order Processed",message:"Case ".concat((null===n||void 0===n?void 0:n.caseReferenceNumber)||e," has been processed and is now ready for delivery by ").concat(t.name),type:"success"})}catch(n){console.error("Failed to update case status:",n)}},et=async()=>{W(null),G(""),me([])},tt=async e=>{Se(e)},nt=async()=>{Se(null),ye([]),xe("")},rt=async e=>{const t=b();if(t&&Pi(t.role,qi))try{const n=h.find(t=>t.id===e),r={attachments:ve,comments:be};await m(e,"Pending Delivery (Hospital)",JSON.stringify(r)),Se(null),ye([]),xe(""),Me(1),T(t=>new Set([...Array.from(t),e])),ze("Order marked as pending delivery to hospital"),Be(!0),l({title:"Pending Delivery to Hospital",message:"Case ".concat((null===n||void 0===n?void 0:n.caseReferenceNumber)||e," has been delivered to hospital by ").concat(t.name),type:"success"})}catch(n){console.error("Failed to update case status:",n)}},at=async e=>{X(e),ee(""),ne("")},st=async e=>{const t=b();if(t&&Pi(t.role,Yi)&&Z.trim())try{const n=h.find(t=>t.id===e),r=[];if(te){const t={name:"delivery-image-".concat(e,"-").concat(Date.now(),".png"),type:"image/png",size:Math.round(.75*te.length),data:te};r.push(JSON.stringify(t))}const a={comments:Z,attachments:r};await m(e,"Delivered (Hospital)",JSON.stringify(a)),X(null),ee(""),ne(""),Me(1),T(t=>new Set([...Array.from(t),e])),ze("Order successfully marked as delivered to hospital"),Be(!0),l({title:"Delivered at Hospital",message:"Case ".concat((null===n||void 0===n?void 0:n.caseReferenceNumber)||e," has been received at hospital by ").concat(t.name),type:"success"})}catch(n){console.error("Failed to update case status:",n)}},ot=async e=>{ae(e),oe([]),ce(""),he("")},it=async e=>{const t=b();if(t&&Pi(t.role,Wi)&&ie.trim()&&ue.trim())try{const n=h.find(t=>t.id===e),r={attachments:se,orderSummary:ie,doNumber:ue};await m(e,"Case Completed",JSON.stringify(r)),ae(null),oe([]),ce(""),he(""),Me(1),T(t=>new Set([...Array.from(t),e])),ze("Case successfully marked as completed"),Be(!0),l({title:"Case Completed",message:"Case ".concat((null===n||void 0===n?void 0:n.caseReferenceNumber)||e," has been completed by ").concat(t.name," with DO#: ").concat(ue),type:"success"})}catch(n){console.error("Failed to update case status:",n)}},lt=async e=>{const t=b();if(t&&Pi(t.role,Ki))try{const n=h.find(t=>t.id===e);await m(e,"Delivered (Office)"),Me(1),T(t=>new Set([...Array.from(t),e])),ze("Order successfully delivered to office"),Be(!0),l({title:"Delivered to Office",message:"Case ".concat((null===n||void 0===n?void 0:n.caseReferenceNumber)||e," has been delivered to office by ").concat(t.name),type:"success"})}catch(n){console.error("Failed to update case status:",n)}},ct=async e=>{const t=b();if(t)try{const n=h.find(t=>t.id===e);await m(e,"To be billed"),Me(1),T(t=>new Set([...Array.from(t),e])),ze('Case successfully marked as "To be billed"'),Be(!0),l({title:"Case Ready for Billing",message:"Case ".concat((null===n||void 0===n?void 0:n.caseReferenceNumber)||e," is now ready to be billed - updated by ").concat(t.name),type:"success"})}catch(n){console.error("Failed to update case status:",n)}},dt=async e=>{Ae(e),Ie([]),Pe("")},ut=async e=>{const t=b();if(t&&Pi(t.role,Vi))try{const n=h.find(t=>t.id===e),r={attachments:Te,comments:Oe};await m(e,"Pending Delivery (Office)",JSON.stringify(r)),Ae(null),Ie([]),Pe(""),Me(1),T(t=>new Set([...Array.from(t),e])),ze("Case marked as pending delivery to office"),Be(!0),l({title:"Pending Delivery to Office",message:"Case ".concat((null===n||void 0===n?void 0:n.caseReferenceNumber)||e," is now pending delivery to office - updated by ").concat(t.name),type:"success"})}catch(n){console.error("Failed to update case status:",n)}},ht=async()=>{Ae(null),Ie([]),Pe("")},pt=async e=>{je(e),Ce([]),_e("")},mt=async e=>{const t=b();if(t&&Pi(t.role,Ki))try{const n=h.find(t=>t.id===e),r={attachments:ke,comments:Ee};await m(e,"Delivered (Office)",JSON.stringify(r)),je(null),Ce([]),_e(""),Me(1),T(t=>new Set([...Array.from(t),e])),ze("Order successfully delivered to office"),Be(!0),l({title:"Delivered to Office",message:"Case ".concat((null===n||void 0===n?void 0:n.caseReferenceNumber)||e," has been delivered to office by ").concat(t.name),type:"success"})}catch(n){console.error("Failed to update case status:",n)}},ft=async()=>{je(null),Ce([]),_e("")},gt=async e=>{const t=b();if(!t)return;const n=h.find(t=>t.id===e),r='Are you sure you want to cancel case "'.concat(null===n||void 0===n?void 0:n.caseReferenceNumber,'"?\n\nThis action will mark the case as cancelled and cannot be undone.');u("Cancel Case",r,async()=>{try{await m(e,"Case Cancelled","Case cancelled by user request"),Me(1),T(t=>new Set([...Array.from(t),e])),ze("Case successfully cancelled"),Be(!0),l({title:"Case Cancelled",message:"Case ".concat((null===n||void 0===n?void 0:n.caseReferenceNumber)||e," has been cancelled by ").concat(t.name),type:"warning"})}catch(r){console.error("Failed to cancel case:",r)}})},vt=async()=>{X(null),ee(""),ne("")},yt=async()=>{ae(null),oe([]),ce(""),he("")},bt=async(e,t)=>{const n=b();if(!n||!Pi(n.role,Fi))return;const r='Are you sure you want to delete case "'.concat(t.caseReferenceNumber,'"?\n\nCase Details:\n- Hospital: ').concat(t.hospital,"\n- Procedure: ").concat(t.procedureType,"\n- Status: ").concat(t.status,"\n\nThis action cannot be undone.");u("Delete Case",r,async()=>{try{await v(e),Me(1),ze("Case ".concat(t.caseReferenceNumber," has been successfully deleted")),Be(!0)}catch(n){console.error("Delete failed:",n)}})},xt=Math.ceil(y.length/Le),wt=async e=>{Me(e)};return(0,i.jsxs)("div",{className:"cases-list",children:[(0,i.jsxs)("div",{className:"cases-header",children:[(0,i.jsx)("h2",{children:"All Submitted Cases"}),(0,i.jsx)("button",{onClick:p,className:"btn btn-outline-secondary btn-md refresh-button",children:"Refresh"})]}),(0,i.jsx)(xl,{filters:C,tempFilters:_,showFilters:M,availableSubmitters:S,availableHospitals:j,filteredCasesCount:y.length,totalCasesCount:h.length,onFilterChange:async(e,t)=>{D(n=>(0,f.A)((0,f.A)({},n),{},{[e]:t||void 0}))},onApplyFilters:()=>{E(_)},onClearFilters:()=>{E({}),D({})},onToggleFilters:()=>L(!M),onQuickFilter:async(e,t)=>{const n={[e]:t};D(n),E(n)}}),(0,i.jsxs)("div",{className:"collapsible-section",children:[(0,i.jsxs)("div",{className:"section-header",onClick:()=>B(!F),children:[(0,i.jsx)("h3",{children:"All Cases"}),(0,i.jsx)("span",{className:"expand-icon",children:F?"\u25bc":"\u25b6"})]}),F&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"cases-count",children:["Showing ",(Re-1)*Le+1," to ",Math.min(Re*Le,y.length)," of ",y.length," cases (Total: ",h.length,")"]}),(0,i.jsx)("div",{className:"cases-container",children:0===y.length?(0,i.jsx)("div",{className:"no-cases",children:"No cases found matching the current filters."}):(()=>{const e=Re*Le,t=e-Le;return y.slice(t,e)})().map(e=>(0,i.jsx)(Nl,{caseItem:e,currentUser:n,expandedCases:A,expandedStatusHistory:I,expandedAmendmentHistory:P,amendingCase:U,amendmentData:H,processingCase:Y,processDetails:K,processAttachments:pe,processComments:fe,deliveryCase:Q,deliveryDetails:J,hospitalDeliveryCase:we,hospitalDeliveryAttachments:ve,hospitalDeliveryComments:be,receivedCase:$,receivedDetails:Z,receivedImage:te,completedCase:re,attachments:se,orderSummary:ie,doNumber:ue,pendingOfficeCase:De,pendingOfficeAttachments:Te,pendingOfficeComments:Oe,officeDeliveryCase:Ne,officeDeliveryAttachments:ke,officeDeliveryComments:Ee,onToggleExpansion:We,onToggleStatusHistory:Ve,onToggleAmendmentHistory:Ke,onStatusChange:Ge,onAmendCase:Qe,onSaveAmendment:Je,onCancelAmendment:$e,onOrderProcessed:Xe,onSaveProcessDetails:Ze,onCancelProcessing:et,onOrderDelivered:tt,onOrderReceived:at,onSaveOrderReceived:st,onCancelReceived:vt,onCaseCompleted:ot,onSaveCaseCompleted:it,onCancelCompleted:yt,onPendingDeliveryOffice:dt,onSavePendingOffice:ut,onCancelPendingOffice:ht,onOfficeDelivery:pt,onSaveOfficeDelivery:mt,onCancelOfficeDelivery:ft,onOrderDeliveredOffice:lt,onToBeBilled:ct,onDeleteCase:bt,onCancelCase:gt,onAttachmentUpload:He,onRemoveAttachment:qe,onAmendmentDataChange:q,onProcessDetailsChange:G,onProcessAttachmentsChange:me,onProcessCommentsChange:ge,onSaveHospitalDelivery:rt,onCancelHospitalDelivery:nt,onHospitalDeliveryAttachmentsChange:ye,onHospitalDeliveryCommentsChange:xe,onReceivedDetailsChange:ee,onReceivedImageChange:ne,onOrderSummaryChange:ce,onDoNumberChange:he,onPendingOfficeAttachmentsChange:Ie,onPendingOfficeCommentsChange:Pe,onOfficeDeliveryAttachmentsChange:Ce,onOfficeDeliveryCommentsChange:_e,onNavigateToPermissions:o},e.id))}),xt>1&&(0,i.jsxs)("div",{className:"pagination-container",children:[(0,i.jsxs)("div",{className:"pagination-info",children:["Page ",Re," of ",xt]}),(0,i.jsxs)("div",{className:"pagination-controls",children:[(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>wt(1),disabled:1===Re,children:"First"}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>wt(Re-1),disabled:1===Re,children:"Previous"}),[...Array(xt)].map((e,t)=>{const n=t+1;return 1===n||n===xt||n>=Re-2&&n<=Re+2?(0,i.jsx)("button",{className:"btn btn-sm ".concat(n===Re?"btn-primary":"btn-outline-secondary"),onClick:()=>wt(n),children:n},n):n===Re-3||n===Re+3?(0,i.jsx)("span",{className:"pagination-ellipsis",children:"..."},n):null}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>wt(Re+1),disabled:Re===xt,children:"Next"}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>wt(xt),disabled:Re===xt,children:"Last"})]})]})]})]}),(0,i.jsx)(jl,{message:Ue,isVisible:Fe,onClose:()=>Be(!1)}),(0,i.jsx)(le,{isOpen:c.isOpen,onClose:d,title:c.title,message:c.message,type:c.type,actions:"confirm"===c.type?[{label:"Cancel",onClick:d,style:"secondary"},{label:"Delete",onClick:c.onConfirm||d,style:"danger"}]:void 0})]})},El=e=>{let{caseData:t,onProcessComplete:n,onBack:a}=e;const[s,o]=(0,r.useState)(t.processOrderDetails||""),[l,c]=(0,r.useState)(!1);return(0,i.jsxs)("div",{className:"process-order-page",children:[(0,i.jsxs)("div",{className:"page-header",children:[(0,i.jsx)("button",{onClick:a,className:"btn btn-outline-secondary btn-md back-button",children:"\u2190 Back to Cases"}),(0,i.jsx)("h2",{children:"Prepared Order Details"})]}),(0,i.jsxs)("div",{className:"case-summary-card",children:[(0,i.jsx)("h3",{children:"Case Information"}),(0,i.jsxs)("div",{className:"summary-grid",children:[(0,i.jsxs)("div",{className:"summary-item",children:[(0,i.jsx)("strong",{children:"Hospital:"})," ",t.hospital]}),(0,i.jsxs)("div",{className:"summary-item",children:[(0,i.jsx)("strong",{children:"Department:"})," ",t.department]}),(0,i.jsxs)("div",{className:"summary-item",children:[(0,i.jsx)("strong",{children:"Procedure:"})," ",t.procedureType]}),(0,i.jsxs)("div",{className:"summary-item",children:[(0,i.jsx)("strong",{children:"Surgery Date:"})," ",t.dateOfSurgery]}),(0,i.jsxs)("div",{className:"summary-item",children:[(0,i.jsx)("strong",{children:"Surgery Time:"})," ",t.timeOfProcedure||"Not specified"]}),(0,i.jsxs)("div",{className:"summary-item",children:[(0,i.jsx)("strong",{children:"Submitted by:"})," ",t.submittedBy]}),(0,i.jsxs)("div",{className:"summary-item",children:[(0,i.jsx)("strong",{children:"Submitted at:"})," ",wi(t.submittedAt)]}),(0,i.jsxs)("div",{className:"summary-item",children:[(0,i.jsx)("strong",{children:"Current Status:"}),(0,i.jsx)("span",{className:"status-badge",children:t.status})]})]}),(0,i.jsxs)("div",{className:"equipment-section",children:[(0,i.jsxs)("div",{className:"equipment-item",children:[(0,i.jsx)("strong",{children:"Surgery Set Selection:"}),(0,i.jsx)("ul",{children:t.surgerySetSelection.map(e=>(0,i.jsx)("li",{children:e},e))})]}),(0,i.jsxs)("div",{className:"equipment-item",children:[(0,i.jsx)("strong",{children:"Implant Box:"}),(0,i.jsx)("ul",{children:t.implantBox.map(e=>(0,i.jsx)("li",{children:e},e))})]})]}),t.specialInstruction&&(0,i.jsxs)("div",{className:"special-instructions",children:[(0,i.jsx)("strong",{children:"Special Instructions:"}),(0,i.jsx)("p",{children:t.specialInstruction})]})]}),(0,i.jsxs)("div",{className:"process-order-form",children:[(0,i.jsx)("h3",{children:"Prepared Order Details"}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"processOrderDetails",children:"Enter detailed processing information, preparation notes, and any additional requirements:"}),(0,i.jsx)("textarea",{id:"processOrderDetails",value:s,onChange:e=>o(e.target.value),rows:8,placeholder:"Enter process order details here... Examples:\n- Equipment preparation status\n- Special handling requirements\n- Quality check notes\n- Delivery instructions\n- Any issues or concerns",className:"process-details-textarea"})]}),(0,i.jsx)("div",{className:"process-actions",children:(0,i.jsx)("button",{onClick:async()=>{if(!s.trim())return void alert("Please enter process order details before processing.");const e=b();if(e){c(!0);try{I(t.id,"Order Prepared",e.name,s),setTimeout(()=>{c(!1),n()},1e3)}catch(r){c(!1),alert("An error occurred while processing the order. Please try again.")}}else alert("You must be logged in to process orders.")},disabled:l||!s.trim(),className:"process-order-button",children:l?"Processing...":"Process Order"})}),l&&(0,i.jsxs)("div",{className:"processing-indicator",children:[(0,i.jsx)("div",{className:"spinner"}),(0,i.jsx)("p",{children:"Processing order and updating status..."})]})]}),(0,i.jsxs)("div",{className:"process-info",children:[(0,i.jsx)("h4",{children:"What happens next?"}),(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:'Order status will change to "Order Prepared"'}),(0,i.jsx)("li",{children:"Your name will be recorded as the processor"}),(0,i.jsx)("li",{children:"Process timestamp will be logged"}),(0,i.jsx)("li",{children:"Case will be ready for delivery to hospital"})]})]})]})};const _l=new class{constructor(){this.config=void 0,this.audioContext=null,this.config=this.loadConfig(),this.initAudioContext()}loadConfig(){const e=localStorage.getItem("case-booking-sound-config");return e?JSON.parse(e):{volume:.5,enabled:!0}}saveConfig(){localStorage.setItem("case-booking-sound-config",JSON.stringify(this.config))}initAudioContext(){"undefined"!==typeof window&&window.AudioContext&&(this.audioContext=new AudioContext)}generateTone(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sine";if(!this.config.enabled||!this.audioContext)return;const r=this.audioContext.createOscillator(),a=this.audioContext.createGain();r.connect(a),a.connect(this.audioContext.destination),r.frequency.setValueAtTime(e,this.audioContext.currentTime),r.type=n,a.gain.setValueAtTime(0,this.audioContext.currentTime),a.gain.linearRampToValueAtTime(.1*this.config.volume,this.audioContext.currentTime+.01),a.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+t),r.start(this.audioContext.currentTime),r.stop(this.audioContext.currentTime+t)}playSuccess(){this.generateTone(523,.15),setTimeout(()=>this.generateTone(659,.15),100),setTimeout(()=>this.generateTone(784,.2),200)}playError(){this.generateTone(220,.3,"sawtooth"),setTimeout(()=>this.generateTone(196,.4,"sawtooth"),150)}playClick(){this.generateTone(800,.08,"square")}playNotification(){this.generateTone(880,.2),setTimeout(()=>this.generateTone(1047,.3),100)}playStatusChange(){this.generateTone(440,.15),setTimeout(()=>this.generateTone(554,.15),80),setTimeout(()=>this.generateTone(659,.2),160)}playDelete(){this.generateTone(330,.2,"triangle"),setTimeout(()=>this.generateTone(294,.3,"triangle"),100)}playSubmit(){this.generateTone(392,.15),setTimeout(()=>this.generateTone(523,.15),80),setTimeout(()=>this.generateTone(659,.15),160),setTimeout(()=>this.generateTone(784,.25),240)}isEnabled(){return this.config.enabled}setEnabled(e){this.config.enabled=e,this.saveConfig()}getVolume(){return this.config.volume}setVolume(e){this.config.volume=Math.max(0,Math.min(1,e)),this.saveConfig()}toggle(){return this.config.enabled=!this.config.enabled,this.saveConfig(),this.config.enabled}},Dl=(0,r.createContext)(void 0),Al=e=>{let{children:t}=e;const[n,a]=(0,r.useState)(()=>_l.isEnabled()),[s,o]=(0,r.useState)(()=>_l.getVolume()),l={success:()=>_l.playSuccess(),error:()=>_l.playError(),click:()=>_l.playClick(),notification:()=>_l.playNotification(),statusChange:()=>_l.playStatusChange(),delete:()=>_l.playDelete(),submit:()=>_l.playSubmit()};(0,r.useEffect)(()=>{a(_l.isEnabled()),o(_l.getVolume())},[]);const c={isEnabled:n,volume:s,toggleSound:()=>{const e=_l.toggle();a(e)},setVolume:e=>{_l.setVolume(e),o(e)},playSound:l};return(0,i.jsx)(Dl.Provider,{value:c,children:t})},Tl=()=>{const e=(0,r.useContext)(Dl);if(void 0===e)throw new Error("useSound must be used within a SoundProvider");return e},Il=e=>{let{toast:t,onClose:n}=e;const[a,s]=(0,r.useState)(!1),[o,l]=(0,r.useState)(!1),{playSound:c}=Tl(),d=(0,r.useCallback)(()=>{l(!0),setTimeout(()=>{n(t.id)},300)},[n,t.id]);(0,r.useEffect)(()=>{switch(setTimeout(()=>s(!0),10),t.type){case"success":c.success();break;case"error":c.error();break;case"warning":case"info":c.notification()}const e=t.duration||5e3,n=setTimeout(()=>{d()},e);return()=>clearTimeout(n)},[t,c,d]);const u=t.duration||5e3;return(0,i.jsxs)("div",{className:"toast-notification toast-".concat(t.type," ").concat(a?"toast-visible":""," ").concat(o?"toast-leaving":""),children:[(0,i.jsxs)("div",{className:"toast-content",children:[(0,i.jsx)("div",{className:"toast-icon",children:(()=>{switch(t.type){case"success":return"\u2705";case"error":return"\u274c";case"warning":return"\u26a0\ufe0f";default:return"\u2139\ufe0f"}})()}),(0,i.jsxs)("div",{className:"toast-text",children:[(0,i.jsx)("div",{className:"toast-title",children:t.title}),(0,i.jsx)("div",{className:"toast-message",children:t.message})]}),t.action&&(0,i.jsx)("button",{className:"toast-action",onClick:()=>{t.action.handler(),d()},children:t.action.label}),(0,i.jsx)("button",{className:"toast-close",onClick:d,title:"Close notification",children:"\u2715"})]}),(0,i.jsx)("div",{className:"toast-progress",style:{backgroundColor:(()=>{switch(t.type){case"success":return"#28a745";case"error":return"#dc3545";case"warning":return"#ffc107";default:return"#17a2b8"}})(),animationDuration:"".concat(u,"ms")}})]})},Ol=(0,r.createContext)(void 0),Pl=e=>{let{children:t}=e;const[n,a]=(0,r.useState)([]),s=e=>{const t=(0,f.A)((0,f.A)({},e),{},{id:Date.now().toString()+Math.random().toString(36).substr(2,9)});a(e=>[...e,t])},o=e=>{a(t=>t.filter(t=>t.id!==e))},l={showToast:s,showSuccess:(e,t,n)=>{s({title:e,message:t,type:"success",action:n})},showError:(e,t,n)=>{s({title:e,message:t,type:"error",action:n})},showWarning:(e,t,n)=>{s({title:e,message:t,type:"warning",action:n})},showInfo:(e,t,n)=>{s({title:e,message:t,type:"info",action:n})}};return(0,i.jsxs)(Ol.Provider,{value:l,children:[t,(0,i.jsx)("div",{className:"toast-container",children:n.map(e=>(0,i.jsx)(Il,{toast:e,onClose:o},e.id))})]})},Rl=()=>{const e=(0,r.useContext)(Ol);if(void 0===e)throw new Error("useToast must be used within a ToastProvider");return e},Ml=e=>{let{selectedDepartments:t,onChange:n,userCountries:a,disabled:s=!1,compact:o=!1}=e;const[l,c]=(0,r.useState)({}),[d,u]=(0,r.useState)(new Set),[h,p]=(0,r.useState)(!0);(0,r.useEffect)(()=>{a.length>0?(async()=>{p(!0);try{ne(),await Promise.all(a.map(async e=>{try{return re(e),Promise.resolve()}catch(t){return console.error("Error initializing tables for ".concat(e,":"),t),Promise.resolve()}})),console.log("\ud83d\udd04 CountryGroupedDepartments: Loading departments for countries:",a);const e=await Q();console.log("\ud83d\udccb CountryGroupedDepartments: All departments by country:",e);const n=Object.fromEntries(Object.entries(e).filter(e=>{let[t]=e;return a.includes(t)}));console.log("\ud83c\udfaf CountryGroupedDepartments: Filtered departments:",n),c(n);const r=new Set;Object.entries(n).forEach(e=>{let[n,a]=e;a.some(e=>{const r=$(n,e);return t.includes(r)})&&r.add(n)}),u(r)}finally{p(!1)}})():(c({}),u(new Set),p(!1))},[a]);const m=(0,r.useCallback)((e,r,a)=>{if(s)return;const o=$(e,r);let i;if(a){if(t.includes(o))return;i=[...t,o]}else i=t.filter(e=>e!==o);n(i)},[s,t,n]),f=(0,r.useCallback)(e=>{if(s)return;const r=(l[e]||[]).map(t=>$(e,t)),a=new Set([...t,...r]);n(Array.from(a))},[s,l,t,n]),g=(0,r.useCallback)(e=>{if(s)return;const r=(l[e]||[]).map(t=>$(e,t)),a=t.filter(e=>!r.includes(e));n(a)},[s,l,t,n]);if(h)return(0,i.jsx)("div",{className:"country-grouped-departments loading ".concat(o?"compact":""),children:(0,i.jsx)("div",{style:{textAlign:"center",padding:o?"0.5rem":"1rem",color:"#6c757d",fontSize:o?"0.875rem":"1rem"},children:"\ud83d\udd04 Loading departments..."})});const v=Object.entries(l).filter(e=>{let[,t]=e;return t.length>0});return 0===a.length?(0,i.jsx)("div",{className:"country-grouped-departments empty ".concat(o?"compact":""),children:(0,i.jsxs)("div",{style:{textAlign:"center",padding:o?"1.5rem 0.75rem":"2rem 1rem",color:"#6c757d",fontSize:o?"0.875rem":"1rem"},children:[(0,i.jsx)("div",{style:{marginBottom:"0.5rem"},children:"\ud83c\udfe2"}),"Please select countries first to see available departments"]})}):0===v.length?(0,i.jsx)("div",{className:"country-grouped-departments empty ".concat(o?"compact":""),children:(0,i.jsxs)("div",{style:{textAlign:"center",padding:o?"1.5rem 0.75rem":"2rem 1rem",color:"#6c757d",fontSize:o?"0.875rem":"1rem"},children:[(0,i.jsx)("div",{style:{marginBottom:"0.5rem"},children:"\u2699\ufe0f"}),"No departments configured for selected countries"]})}):(0,i.jsxs)("div",{className:"country-grouped-departments ".concat(o?"compact":""),children:[!o&&(0,i.jsxs)("div",{className:"departments-summary",children:[(0,i.jsxs)("span",{className:"selected-count",children:[t.length," department",1!==t.length?"s":""," selected"]}),t.length>0&&(0,i.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-secondary",onClick:()=>n([]),disabled:s,children:"Clear All"})]}),(0,i.jsx)("div",{className:"countries-list",children:v.map(e=>{let[n,r]=e;const a=d.has(n),o=r.filter(e=>{const r=$(n,e);return t.includes(r)}).length,l=o===r.length&&r.length>0;return(0,i.jsxs)("div",{className:"country-group",children:[(0,i.jsxs)("div",{className:"country-header",children:[(0,i.jsxs)("button",{type:"button",className:"country-toggle ".concat(a?"expanded":""),onClick:()=>(e=>{u(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})})(n),disabled:s,children:[(0,i.jsx)("span",{className:"toggle-icon",children:a?"\u25bc":"\u25b6"}),(0,i.jsxs)("span",{className:"country-name",children:["\ud83c\udf0d ",n]}),(0,i.jsxs)("span",{className:"department-count",children:["(",o,"/",r.length,")"]})]}),(0,i.jsxs)("div",{className:"country-actions",children:[!l&&(0,i.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-primary",onClick:()=>f(n),disabled:s,title:"Select all departments in ".concat(n),children:"Select All"}),o>0&&(0,i.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>g(n),disabled:s,title:"Deselect all departments in ".concat(n),children:"Clear"})]})]}),a&&(0,i.jsx)("div",{className:"departments-list",children:0===r.length?(0,i.jsx)("div",{className:"no-departments",children:(0,i.jsxs)("em",{children:["No departments configured for ",n]})}):(0,i.jsx)("div",{className:"departments-grid",children:r.map((e,r)=>{const a=$(n,e),o=t.includes(a),l="toggle-".concat(n,"-").concat(r,"-").concat(e.replace(/\s+/g,"-"));return(0,i.jsxs)("div",{className:"department-checkbox ".concat(o?"selected":""),children:[(0,i.jsx)("span",{className:"department-name",children:e}),(0,i.jsx)("input",{type:"checkbox",id:l,checked:o,onChange:t=>{m(n,e,t.target.checked)},disabled:s,className:"department-checkbox-input"})]},"".concat(n,"-").concat(e,"-").concat(r))})})})]},n)})})]})},Ll="case-booking-custom-roles",Fl="case-booking-custom-permissions",Bl=e=>{try{localStorage.setItem(Ll,JSON.stringify(e))}catch(t){throw console.error("Error saving custom roles:",t),new Error("Failed to save custom roles")}},Ul=()=>{try{const e=localStorage.getItem(Ll);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading custom roles:",e),[]}},zl=()=>{try{const e=localStorage.getItem(Fl);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading custom permissions:",e),[]}},Hl=e=>{try{const t=Ul().filter(t=>t.id!==e);Bl(t);const n=zl();(e=>{try{localStorage.setItem(Fl,JSON.stringify(e))}catch(t){throw console.error("Error saving custom permissions:",t),new Error("Failed to save custom permissions")}})(n.filter(t=>t.roleId!==e))}catch(t){throw console.error("Error deleting custom role:",t),new Error("Failed to delete custom role")}},ql=e=>{var t;let{roles:n,actions:a,permissions:s,onPermissionChange:o,readonly:l=!1}=e;const[c,d]=(0,r.useState)("all"),[u,h]=(0,r.useState)(""),[p,m]=(0,r.useState)(null),f=Array.from(new Set(a.map(e=>e.category))),g=a.filter(e=>{const t="all"===c||e.category===c,n=e.name.toLowerCase().includes(u.toLowerCase())||e.description.toLowerCase().includes(u.toLowerCase());return t&&n}),v=(e,t)=>s.find(n=>n.actionId===e&&n.roleId===t),y=e=>e?"\u2713":"\u2715",b=()=>{m(null)};return(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&p&&b()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[p]),(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"permission-matrix",children:[(0,i.jsxs)("div",{className:"permission-matrix-header",children:[(0,i.jsx)("h2",{children:"Role-Based Permission Matrix"}),(0,i.jsxs)("div",{className:"permission-controls",children:[(0,i.jsxs)("div",{className:"category-filter",children:[(0,i.jsx)("label",{htmlFor:"category-select",children:"Filter by Category:"}),(0,i.jsxs)("select",{id:"category-select",value:c,onChange:e=>d(e.target.value),children:[(0,i.jsx)("option",{value:"all",children:"All Categories"}),f.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]})]}),(0,i.jsxs)("div",{className:"search-filter",children:[(0,i.jsx)("label",{htmlFor:"search-input",children:"Search Actions:"}),(0,i.jsx)("input",{id:"search-input",type:"text",value:u,onChange:e=>h(e.target.value),placeholder:"Search actions..."})]})]})]}),(0,i.jsx)("div",{className:"permission-matrix-table-container scrollable-matrix",children:(0,i.jsxs)("table",{className:"permission-matrix-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"action-column",children:(0,i.jsxs)("div",{className:"action-header",children:[(0,i.jsx)("span",{children:"Actions & Permissions"}),(0,i.jsxs)("small",{children:[g.length," actions ",g.length>10?"(scrollable)":""]})]})}),n.map(e=>(0,i.jsx)("th",{className:"role-column",children:(0,i.jsxs)("div",{className:"role-header",style:{backgroundColor:e.color},children:[(0,i.jsx)("span",{className:"role-name",children:e.displayName}),(0,i.jsx)("button",{className:"role-summary-button",onClick:()=>{return t=e.id,void m(t);var t},title:"View permission summary for ".concat(e.displayName),children:"Details"})]})},e.id))]})}),(0,i.jsx)("tbody",{children:g.map(e=>(0,i.jsxs)("tr",{className:"permission-row",children:[(0,i.jsx)("td",{className:"action-cell",children:(0,i.jsxs)("div",{className:"action-info",children:[(0,i.jsx)("span",{className:"action-name",children:e.name}),(0,i.jsx)("small",{className:"action-description",children:e.description}),(0,i.jsx)("span",{className:"action-category","data-category":e.category,children:e.category})]})}),n.map(t=>{const n=v(e.id,t.id),r=(null===n||void 0===n?void 0:n.allowed)||!1;return(0,i.jsxs)("td",{className:"permission-cell",children:[(0,i.jsx)("button",{className:"permission-toggle ".concat((a=r,a?"permission-allowed":"permission-denied")," ").concat(l?"readonly":""),onClick:()=>((e,t)=>{if(l||!o)return;const n=v(e,t),r=!(null!==n&&void 0!==n&&n.allowed);o(e,t,r)})(e.id,t.id),disabled:l,title:"".concat(r?"Allowed":"Denied"," for ").concat(t.displayName),children:(0,i.jsx)("span",{className:"permission-icon",children:y(r)})}),(null===n||void 0===n?void 0:n.conditions)&&n.conditions.length>0&&(0,i.jsx)("div",{className:"permission-conditions",children:(0,i.jsx)("small",{children:"Conditions apply"})})]},"".concat(e.id,"-").concat(t.id));var a})]},e.id))})]})}),(0,i.jsxs)("div",{className:"permission-matrix-legend",children:[(0,i.jsxs)("div",{className:"legend-item",children:[(0,i.jsx)("span",{className:"legend-icon permission-allowed",children:"\u2713"}),(0,i.jsx)("span",{children:"Allowed"})]}),(0,i.jsxs)("div",{className:"legend-item",children:[(0,i.jsx)("span",{className:"legend-icon permission-denied",children:"\u2715"}),(0,i.jsx)("span",{children:"Denied"})]}),(0,i.jsxs)("div",{className:"legend-item",children:[(0,i.jsx)("span",{className:"legend-text",children:"Conditions apply"}),(0,i.jsx)("span",{children:"Additional requirements must be met"})]})]}),p&&(0,i.jsx)("div",{className:"role-summary-overlay",onClick:b,children:(0,i.jsxs)("div",{className:"role-summary-modal",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"role-summary-header",children:[(0,i.jsx)("h3",{children:null===(t=n.find(e=>e.id===p))||void 0===t?void 0:t.displayName}),(0,i.jsx)("button",{className:"role-summary-close",onClick:b,"aria-label":"Close summary",children:"\u2715"})]}),(0,i.jsx)("div",{className:"role-summary-content",children:(()=>{const e=(e=>{const t=s.filter(t=>t.roleId===e&&t.allowed).map(e=>a.find(t=>t.id===e.actionId)).filter(Boolean),n=t.reduce((e,t)=>t?(e[t.category]||(e[t.category]=[]),e[t.category].push(t),e):e,{});return{total:t.length,byCategory:n,allPermissions:t}})(p),t=n.find(e=>e.id===p);return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"role-summary-stats",children:[(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("div",{className:"stat-number",children:e.total}),(0,i.jsx)("div",{className:"stat-label",children:"Total Permissions"})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsx)("div",{className:"stat-number",children:Object.keys(e.byCategory).length}),(0,i.jsx)("div",{className:"stat-label",children:"Categories"})]}),(0,i.jsxs)("div",{className:"stat-card",children:[(0,i.jsxs)("div",{className:"stat-number",children:[Math.round(e.total/a.length*100),"%"]}),(0,i.jsx)("div",{className:"stat-label",children:"Coverage"})]})]}),(0,i.jsxs)("div",{className:"role-summary-description",children:[(0,i.jsx)("h4",{children:"Role Description"}),(0,i.jsx)("p",{children:null===t||void 0===t?void 0:t.description})]}),(0,i.jsxs)("div",{className:"permissions-by-category",children:[(0,i.jsx)("h4",{children:"Permissions by Category"}),Object.entries(e.byCategory).map(e=>{let[t,n]=e;return(0,i.jsxs)("div",{className:"category-section",children:[(0,i.jsxs)("h5",{className:"category-title",children:[t," (",n.length,")"]}),(0,i.jsx)("div",{className:"permission-list",children:n.map(e=>(0,i.jsxs)("div",{className:"permission-item",children:[(0,i.jsx)("span",{className:"permission-name",children:e.name}),(0,i.jsx)("span",{className:"permission-description",children:e.description})]},e.id))})]},t)}),0===e.total&&(0,i.jsx)("div",{className:"no-permissions",children:(0,i.jsx)("p",{children:"This role has no permissions assigned."})})]})]})})()})]})})]})})},Yl=["#e74c3c","#3498db","#2980b9","#27ae60","#229954","#f39c12","#e67e22","#9b59b6","#8e44ad","#34495e","#2c3e50","#16a085","#1abc9c","#f1c40f","#d35400"],Wl=e=>{var t;let{onRoleUpdate:n}=e;const[a,s]=(0,r.useState)([]),[o,c]=(0,r.useState)(ki),[d,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(!1),[m,g]=(0,r.useState)(null),[v,y]=(0,r.useState)({id:"",name:"",displayName:"",description:"",color:Yl[0],basedOnRole:""}),[b,x]=(0,r.useState)({}),{modal:w,closeModal:S,showConfirm:N}=de(),{showSuccess:j,showError:k}=Rl(),{playSound:C}=Tl();(0,r.useEffect)(()=>{const e=Ul();s(e),c([...ki,...e])},[]);const E=()=>{if(!(()=>{const e=((e,t)=>{var n,r,a;const s=[];return null!==(n=e.name)&&void 0!==n&&n.trim()?/^[a-z0-9-]+$/.test(e.name)?t.some(t=>t.name===e.name)&&s.push("Role name already exists"):s.push("Role name must be lowercase letters, numbers, and hyphens only"):s.push("Role name is required"),null!==(r=e.displayName)&&void 0!==r&&r.trim()?t.some(t=>t.displayName===e.displayName)&&s.push("Display name already exists"):s.push("Display name is required"),null!==(a=e.description)&&void 0!==a&&a.trim()||s.push("Description is required"),e.color||s.push("Color is required"),s})({name:v.name,displayName:v.displayName,description:v.description,color:v.color,id:v.name},o),t=e.reduce((e,t)=>(t.includes("Role name")?e.name=t:t.includes("Display name")?e.displayName=t:t.includes("Description")?e.description=t:t.includes("Color")&&(e.color=t),e),{});return x(t),0===e.length})())return;const e={id:v.name,name:v.name,displayName:v.displayName,description:v.description,color:v.color};(e=>{try{Bl(e),s(e);const t=[...ki,...e];c(t),null===n||void 0===n||n(t)}catch(t){console.error("Error saving custom roles:",t),k("Failed to save custom roles","Error")}})([...a,e]),y({id:"",name:"",displayName:"",description:"",color:Yl[0],basedOnRole:""}),u(!1),x({}),C.success(),j("Role Created",'New role "'.concat(e.displayName,'" has been added successfully.'))},_=e=>{g(e),p(!0)},D=()=>{p(!1),g(null)},A=ki.map(e=>({value:e.id,label:"".concat(e.displayName," - ").concat(e.description)}));return(0,i.jsxs)("div",{className:"role-management",children:[(0,i.jsxs)("div",{className:"role-management-header",children:[(0,i.jsx)("h2",{children:"Role Management Matrix"}),(0,i.jsx)("div",{className:"admin-panel-buttons",children:(0,i.jsx)("button",{onClick:()=>u(!d),className:"btn btn-primary btn-md add-role-button",children:d?"Cancel":"Add New Role"})})]}),d&&(0,i.jsxs)("div",{className:"add-role-form",children:[(0,i.jsx)("h3",{children:"Add New Role"}),(0,i.jsxs)("form",{onSubmit:e=>{e.preventDefault(),E()},children:[(0,i.jsxs)("div",{className:"form-row",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"displayName",className:"required",children:"Display Name"}),(0,i.jsx)("input",{type:"text",id:"displayName",value:v.displayName,onChange:e=>{return t=e.target.value,y(e=>{return(0,f.A)((0,f.A)({},e),{},{displayName:t,name:(n=t,n.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"-").substring(0,20))});var n}),void x(e=>(0,f.A)((0,f.A)({},e),{},{displayName:"",name:""}));var t},placeholder:"e.g., Super Admin, Regional Manager",maxLength:50,required:!0}),b.displayName&&(0,i.jsx)("span",{className:"error-message",children:b.displayName})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"roleName",children:"Role ID (Auto-generated)"}),(0,i.jsx)("input",{type:"text",id:"roleName",value:v.name,onChange:e=>y(t=>(0,f.A)((0,f.A)({},t),{},{name:e.target.value})),placeholder:"Automatically generated from display name",maxLength:20}),b.name&&(0,i.jsx)("span",{className:"error-message",children:b.name})]})]}),(0,i.jsxs)("div",{className:"form-row",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"description",className:"required",children:"Description"}),(0,i.jsx)("textarea",{id:"description",value:v.description,onChange:e=>y(t=>(0,f.A)((0,f.A)({},t),{},{description:e.target.value})),placeholder:"Describe the role's responsibilities and scope",rows:3,maxLength:200,required:!0}),b.description&&(0,i.jsx)("span",{className:"error-message",children:b.description})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"basedOnRole",children:"Base Permissions On (Optional)"}),(0,i.jsx)(l,{options:[{value:"",label:"Start with no permissions"},...A],value:v.basedOnRole||"",onChange:e=>y(t=>(0,f.A)((0,f.A)({},t),{},{basedOnRole:e})),placeholder:"Choose a role to copy permissions from"}),(0,i.jsx)("small",{className:"form-helper-text",children:"Select a role to copy its permissions as a starting point"})]})]}),(0,i.jsx)("div",{className:"form-row",children:(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"color",className:"required",children:"Role Color"}),(0,i.jsx)("div",{className:"color-picker",children:Yl.map(e=>(0,i.jsx)("button",{type:"button",className:"color-option ".concat(v.color===e?"selected":""),style:{backgroundColor:e},onClick:()=>y(t=>(0,f.A)((0,f.A)({},t),{},{color:e})),title:e},e))}),b.color&&(0,i.jsx)("span",{className:"error-message",children:b.color})]})}),(0,i.jsxs)("div",{className:"form-actions",children:[(0,i.jsx)("button",{type:"button",onClick:()=>u(!1),className:"btn btn-outline-secondary btn-lg cancel-button",children:"Cancel"}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg submit-button",disabled:!v.displayName.trim()||!v.description.trim(),children:"Create Role"})]})]})]}),(0,i.jsxs)("div",{className:"roles-table",children:[(0,i.jsx)("h3",{children:"Existing Roles"}),(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Role Name"}),(0,i.jsx)("th",{children:"Description"}),(0,i.jsx)("th",{children:"Role ID"}),(0,i.jsx)("th",{children:"Type"}),(0,i.jsx)("th",{children:"Color"}),(0,i.jsx)("th",{children:"Actions"})]})}),(0,i.jsxs)("tbody",{children:[ki.map(e=>(0,i.jsxs)("tr",{className:"default-role",children:[(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"role-display-name",children:e.displayName})}),(0,i.jsx)("td",{children:e.description}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"role-id-badge",children:e.id})}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"role-type-badge system",children:"System"})}),(0,i.jsx)("td",{children:(0,i.jsx)("div",{className:"role-color-indicator",style:{backgroundColor:e.color},title:e.color})}),(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"role-actions",children:[(0,i.jsx)("button",{className:"btn btn-outline-primary btn-sm",onClick:()=>_(e.id),title:"Manage permissions for this role",children:"Permissions"}),(0,i.jsx)("span",{className:"role-protection-label",children:"System Role"})]})})]},e.id)),a.map(e=>(0,i.jsxs)("tr",{className:"custom-role",children:[(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"role-display-name",children:e.displayName})}),(0,i.jsx)("td",{children:e.description}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"role-id-badge",children:e.id})}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"role-type-badge custom",children:"Custom"})}),(0,i.jsx)("td",{children:(0,i.jsx)("div",{className:"role-color-indicator",style:{backgroundColor:e.color},title:e.color})}),(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"role-actions",children:[(0,i.jsx)("button",{className:"btn btn-outline-primary btn-sm",onClick:()=>_(e.id),title:"Manage permissions for this role",children:"Permissions"}),(0,i.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>(e=>{const t=a.find(t=>t.id===e);if(!t)return;const r='Are you sure you want to delete the "'.concat(t.displayName,'" role?\n\nThis action cannot be undone and will affect all users assigned to this role.');N("Delete Role",r,()=>{try{Hl(e);const r=a.filter(t=>t.id!==e);s(r),c([...ki,...r]),null===n||void 0===n||n([...ki,...r]),C.delete(),j("Role Deleted",'Role "'.concat(t.displayName,'" has been removed successfully.'))}catch(r){k("Failed to delete role","Error")}})})(e.id),title:"Delete role",children:"Delete"})]})})]},e.id))]})]})]}),(0,i.jsx)(le,{isOpen:w.isOpen,onClose:S,title:w.title,message:w.message,type:w.type,actions:"confirm"===w.type?[{label:"Cancel",onClick:S,style:"secondary"},{label:"Delete",onClick:w.onConfirm||S,style:"danger"}]:void 0}),h&&m&&(0,i.jsx)("div",{className:"permission-modal-overlay",onClick:D,children:(0,i.jsxs)("div",{className:"permission-modal-content",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"permission-modal-header",children:[(0,i.jsxs)("h2",{children:["\ud83d\udee1\ufe0f Manage Permissions: ",null===(t=o.find(e=>e.id===m))||void 0===t?void 0:t.displayName]}),(0,i.jsx)("button",{className:"permission-modal-close",onClick:D,title:"Close Permission Manager",children:"\u2715"})]}),(0,i.jsx)("div",{className:"permission-modal-body",children:(0,i.jsx)(ql,{roles:o.filter(e=>e.id===m),actions:Ci,permissions:Ei,onPermissionChange:(e,t,n)=>{console.log("Permission change: ".concat(e," for ").concat(t," = ").concat(n))},readonly:!1})})]})})]})},Vl=()=>{const e=b(),{users:t,loading:n,error:a,addUser:s,updateUser:o,deleteUser:c}=(()=>{const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)(!0),[s,o]=(0,r.useState)(null),i=(0,r.useCallback)(async()=>{try{a(!0),o(null);const e=await d.Ay.userOperations.getAll();t(e)}catch(e){console.error("Error fetching users:",e),o(e instanceof Error?e.message:"Failed to fetch users")}finally{a(!1)}},[]),l=(0,r.useCallback)(async e=>{try{const n=await d.Ay.userOperations.create(e);return t(e=>[...e,n]),n}catch(n){throw console.error("Error creating user:",n),n}},[]),c=(0,r.useCallback)(async(e,n)=>{try{const r=await d.Ay.userOperations.update(e,n);return t(t=>t.map(t=>t.id===e?r:t)),r}catch(r){throw console.error("Error updating user:",r),r}},[]),u=(0,r.useCallback)(async e=>{try{await d.Ay.userOperations.delete(e),t(t=>t.filter(t=>t.id!==e))}catch(n){throw console.error("Error deleting user:",n),n}},[]),h=(0,r.useCallback)(async e=>{try{return await d.Ay.userOperations.getById(e)}catch(t){throw console.error("Error fetching user:",t),t}},[]),p=(0,r.useCallback)(async(e,t,n)=>{try{return await d.Ay.userOperations.authenticate(e,t,n)}catch(r){throw console.error("Error authenticating user:",r),r}},[]);return(0,r.useEffect)(()=>{i()},[i]),{users:e,loading:n,error:s,fetchUsers:i,addUser:l,updateUser:c,deleteUser:u,getUserById:h,authenticateUser:p}})(),[u,h]=(0,r.useState)("users"),[p,m]=(0,r.useState)(!1),[g,v]=(0,r.useState)(null),[y,x]=(0,r.useState)(null),[w,S]=(0,r.useState)({username:"",password:"",name:"",role:"admin"===(null===e||void 0===e?void 0:e.role)?"admin":"operations",departments:[],countries:[],email:"",enabled:!0}),[N,j]=(0,r.useState)(""),[k,C]=(0,r.useState)([]),[E,_]=(0,r.useState)({isOpen:!1,type:null,items:[],userName:""}),[D,A]=(0,r.useState)([]),[T,I]=(0,r.useState)(""),[O,P]=(0,r.useState)(""),[R,M]=(0,r.useState)(""),[L,F]=(0,r.useState)(""),[B,U]=(0,r.useState)({searchQuery:"",selectedRoleFilter:"",selectedStatusFilter:"",selectedCountryFilter:""}),[z,H]=(0,r.useState)(!1),q=!!e&&Pi(e.role,Ji),Y=(0,r.useRef)(null),W=!!e&&Pi(e.role,$i),V=!!e&&Pi(e.role,"edit-countries"),K=!!e&&Pi(e.role,Xi),Q=!!e&&Pi(e.role,el),{addNotification:J}=ol(),{showSuccess:$,showError:X}=Rl(),{playSound:Z}=Tl(),ee=(0,r.useCallback)(()=>{v(null),m(!1),S({username:"",password:"",name:"",role:"admin"===(null===e||void 0===e?void 0:e.role)?"admin":"operations",departments:[],countries:[],email:"",enabled:!0}),j("")},[null===e||void 0===e?void 0:e.role]);(0,r.useEffect)(()=>{(async()=>{try{ne();const e=await G();A(e),te()}catch(N){console.error("Error loading user management data:",N),A([])}})()},[]),(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&p&&ee()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[p,ee]),(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&E.isOpen&&ie()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[E.isOpen]);const te=()=>{const t=_i().map(e=>({value:e.id,label:e.displayName})),n="admin"===(null===e||void 0===e?void 0:e.role)?t:t.filter(e=>"admin"!==e.value);C(n)},re=r.useMemo(()=>{let n=t;return"it"===(null===e||void 0===e?void 0:e.role)&&e.selectedCountry?n=t.filter(t=>t.countries&&t.countries.includes(e.selectedCountry)||"admin"===t.role):"admin"===(null===e||void 0===e?void 0:e.role)&&(n=t),T&&(n=n.filter(e=>e.countries&&e.countries.includes(T))),n},[t,e,T]);if(!(!!e&&Pi(e.role,Zi)))return(0,i.jsx)("div",{className:"permission-denied",children:(0,i.jsxs)("div",{className:"permission-denied-content",children:[(0,i.jsx)("h2",{children:"\ud83d\udeab Access Denied"}),(0,i.jsx)("p",{children:"You don't have permission to access user management."}),(0,i.jsx)("p",{children:"Contact your administrator to request access."})]})});if(n)return(0,i.jsxs)("div",{className:"loading-container",style:{padding:"2rem",textAlign:"center"},children:[(0,i.jsx)("div",{className:"loading-spinner"}),(0,i.jsx)("p",{children:"Loading users..."})]});if(a)return(0,i.jsxs)("div",{className:"error-container",style:{padding:"2rem",textAlign:"center"},children:[(0,i.jsx)("h3",{children:"Error Loading Users"}),(0,i.jsx)("p",{children:a}),(0,i.jsx)("button",{onClick:()=>window.location.reload(),className:"btn btn-primary",children:"Retry"})]});const ae=()=>re.filter(e=>{if(L){const t=L.toLowerCase();if(!(e.username.toLowerCase().includes(t)||e.name.toLowerCase().includes(t)||e.email&&e.email.toLowerCase().includes(t)||e.role.toLowerCase().includes(t)||e.departments&&e.departments.some(e=>e.toLowerCase().includes(t))||e.countries&&e.countries.some(e=>e.toLowerCase().includes(t))))return!1}if(O&&e.role!==O)return!1;if(T&&(!e.countries||!e.countries.includes(T)))return!1;if(R){const t=void 0===e.enabled||e.enabled;if("enabled"===R&&!t)return!1;if("disabled"===R&&t)return!1}return!0}),se=(e,t,n)=>{_({isOpen:!0,type:e,items:t,userName:n})},ie=()=>{_({isOpen:!1,type:null,items:[],userName:""})};return(0,i.jsxs)("div",{className:"user-management",children:[(0,i.jsxs)("div",{className:"user-management-header",children:[(0,i.jsx)("h2",{children:"User Access Matrix"}),(0,i.jsx)("div",{className:"admin-panel-buttons",children:"users"===u&&q&&(0,i.jsx)("button",{onClick:()=>p?ee():m(!0),className:"btn btn-primary btn-md add-user-button",children:p?"Cancel":"Add New User"})})]}),"admin"===(null===e||void 0===e?void 0:e.role)&&(0,i.jsxs)("div",{className:"country-filter-section",children:[(0,i.jsxs)("div",{className:"country-filter-header",children:[(0,i.jsx)("h3",{children:"\ud83c\udf0d Filter Users by Country:"}),(0,i.jsx)("p",{children:"Select a country to preview users assigned to that region"})]}),(0,i.jsx)("div",{className:"country-filter-dropdown",children:(0,i.jsx)(l,{options:["All Countries",...(null===e||void 0===e?void 0:e.countries)||[]],value:T||"All Countries",onChange:e=>I("All Countries"===e?"":e),placeholder:"Select country to filter users...",className:"country-filter-select"})})]}),(0,i.jsxs)("div",{className:"tab-navigation",children:[(0,i.jsx)("button",{className:"tab-button ".concat("users"===u?"active":""),onClick:()=>h("users"),children:"\ud83d\udc65 User Management"}),(0,i.jsx)("button",{className:"tab-button ".concat("roles"===u?"active":""),onClick:()=>h("roles"),children:"\ud83c\udfad Role Management"})]}),"users"===u&&(0,i.jsxs)("div",{className:"tab-content",children:[p&&(0,i.jsxs)("div",{className:"add-user-form",ref:Y,children:[(0,i.jsx)("h3",{children:g?"Edit User":"Add New User"}),(0,i.jsxs)("form",{onSubmit:async n=>{if(n.preventDefault(),j(""),!w.username||!w.password||!w.name||!w.email)return void j("Username, password, email, and full name are required");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(w.email))return void j("Please enter a valid email address");if("admin"===w.role&&"admin"!==(null===e||void 0===e?void 0:e.role))return void j("Only administrators can create admin accounts");if(t.find(e=>e.username===w.username&&e.id!==g))j("Username already exists");else try{g?(await o(g,w),Z.success(),$("User Updated","".concat(w.name,"'s account has been successfully updated.")),J({title:"User Account Updated",message:"".concat(w.name," (").concat(w.username,") account details have been modified."),type:"success"})):(await s(w),Z.success(),$("User Created","Welcome ".concat(w.name,"! New user account has been created successfully.")),J({title:"New User Account Created",message:"".concat(w.name," (").concat(w.username,") has been added to the system with ").concat(w.role," role."),type:"success"})),S({username:"",password:"",name:"",role:"admin"===(null===e||void 0===e?void 0:e.role)?"admin":"operations",departments:[],countries:[],email:"",enabled:!0}),v(null),m(!1)}catch(r){const e=g?"Failed to update user":"Failed to add user";j(e),Z.error(),X("Operation Failed",e)}},children:[(0,i.jsxs)("div",{className:"form-row",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"newUsername",className:"required",children:"Username"}),(0,i.jsx)("input",{type:"text",id:"newUsername",value:w.username,onChange:e=>S(t=>(0,f.A)((0,f.A)({},t),{},{username:e.target.value})),required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"newPassword",className:"required",children:"Password"}),(0,i.jsxs)("div",{className:"password-input-wrapper",children:[(0,i.jsx)("input",{type:"new"===y?"text":"password",id:"newPassword",value:w.password,onChange:e=>S(t=>(0,f.A)((0,f.A)({},t),{},{password:e.target.value})),required:!0}),(0,i.jsx)("button",{type:"button",className:"password-toggle-user",onClick:()=>x("new"===y?null:"new"),"aria-label":"new"===y?"Hide password":"Show password",children:"new"===y?"\ud83d\udc41\ufe0f":"\ud83d\udc41\ufe0f\u200d\ud83d\udde8\ufe0f"})]})]})]}),(0,i.jsxs)("div",{className:"form-row",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"newName",className:"required",children:"Full Name"}),(0,i.jsx)("input",{type:"text",id:"newName",value:w.name,onChange:e=>S(t=>(0,f.A)((0,f.A)({},t),{},{name:e.target.value})),required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"newEmail",className:"required",children:"Email Address"}),(0,i.jsx)("input",{type:"email",id:"newEmail",value:w.email,onChange:e=>S(t=>(0,f.A)((0,f.A)({},t),{},{email:e.target.value})),placeholder:"user@transmedicgroup.com (required)",required:!0})]})]}),(0,i.jsxs)("div",{className:"form-row",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"newRole",className:"required",children:"Role"}),(0,i.jsx)(l,{options:k,value:w.role,onChange:e=>S(t=>(0,f.A)((0,f.A)({},t),{},{role:e})),placeholder:"Select Role"})]}),V&&(0,i.jsx)("div",{className:"form-group",children:(0,i.jsx)(oe,{id:"newCountries",label:"Countries",options:D,value:w.countries,onChange:e=>{S(t=>(0,f.A)((0,f.A)({},t),{},{countries:e}))},placeholder:"Select countries...",required:!1})})]}),(0,i.jsx)("div",{className:"form-row",children:(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"userEnabled",children:"User Status"}),(0,i.jsxs)("div",{className:"checkbox-wrapper",children:[(0,i.jsx)("input",{type:"checkbox",id:"userEnabled",checked:w.enabled,onChange:e=>S(t=>(0,f.A)((0,f.A)({},t),{},{enabled:e.target.checked}))}),(0,i.jsx)("label",{htmlFor:"userEnabled",className:"checkbox-label",children:w.enabled?"Account Enabled":"Account Disabled"})]}),(0,i.jsx)("small",{className:"form-helper-text",children:w.enabled?"User can log in and access the system":"User cannot log in (account disabled)"})]})}),(0,i.jsx)("div",{className:"form-row",children:(0,i.jsxs)("div",{className:"form-group form-group-full",children:[(0,i.jsx)("label",{children:"Departments"}),(0,i.jsx)("p",{className:"form-helper-text departments-hint",children:"Select departments for the assigned countries. Departments are organised by country."}),(0,i.jsx)(Ml,{selectedDepartments:w.departments,onChange:e=>{S(t=>(0,f.A)((0,f.A)({},t),{},{departments:e}))},userCountries:w.countries,compact:!0})]})}),N&&(0,i.jsx)("div",{className:"error-message",children:N}),(0,i.jsxs)("div",{className:"form-actions",children:[(0,i.jsx)("button",{type:"button",onClick:ee,className:"btn btn-outline-secondary btn-lg cancel-button",children:"Cancel"}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg submit-button",children:g?"Update User":"Add User"})]})]})]}),(0,i.jsxs)("div",{className:"users-table",children:[(0,i.jsxs)("div",{className:"users-table-header",children:[(0,i.jsxs)("h3",{children:["Existing Users (",ae().length,")"]}),(0,i.jsxs)("div",{className:"modern-filters-section",children:[(0,i.jsxs)("div",{className:"filters-header",onClick:()=>H(!z),children:[(0,i.jsxs)("div",{className:"filters-title",children:[(0,i.jsx)("h3",{children:"\ud83d\udd0d Advanced Filters"}),(0,i.jsx)("span",{className:"active-filters-count",children:(L||O||T||R)&&"(".concat([L,O,T,R].filter(Boolean).length," active)")})]}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm filters-toggle ".concat(z?"expanded":""),children:z?"\u25b2":"\u25bc"})]}),z&&(0,i.jsxs)("div",{className:"filters-content",children:[(0,i.jsxs)("div",{className:"filters-grid",children:[(0,i.jsxs)("div",{className:"filter-category",children:[(0,i.jsx)("h4",{children:"\ud83d\udd0e Search"}),(0,i.jsx)("div",{className:"filter-row",children:(0,i.jsxs)("div",{className:"modern-filter-group full-width",children:[(0,i.jsx)("label",{children:"Search Users"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)("input",{type:"text",placeholder:"Search users, roles, departments, countries...",value:B.searchQuery,onChange:e=>U(t=>(0,f.A)((0,f.A)({},t),{},{searchQuery:e.target.value})),className:"modern-filter-input"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udc64"})]})]})})]}),(0,i.jsxs)("div",{className:"filter-category",children:[(0,i.jsx)("h4",{children:"\ud83c\udfad Role & Status"}),(0,i.jsxs)("div",{className:"filter-row",style:{gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))"},children:[(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Role"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsxs)("select",{value:B.selectedRoleFilter,onChange:e=>U(t=>(0,f.A)((0,f.A)({},t),{},{selectedRoleFilter:e.target.value})),className:"modern-filter-select",children:[(0,i.jsx)("option",{value:"",children:"All Roles"}),k.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))]}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83c\udfad"})]})]}),(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Status"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsxs)("select",{value:B.selectedStatusFilter,onChange:e=>U(t=>(0,f.A)((0,f.A)({},t),{},{selectedStatusFilter:e.target.value})),className:"modern-filter-select",children:[(0,i.jsx)("option",{value:"",children:"All Status"}),(0,i.jsx)("option",{value:"enabled",children:"Enabled"}),(0,i.jsx)("option",{value:"disabled",children:"Disabled"})]}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udcca"})]})]}),(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Country"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsxs)("select",{value:B.selectedCountryFilter,onChange:e=>U(t=>(0,f.A)((0,f.A)({},t),{},{selectedCountryFilter:e.target.value})),className:"modern-filter-select",children:[(0,i.jsx)("option",{value:"",children:"All Countries"}),D.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83c\udf0d"})]})]})]})]})]}),(0,i.jsxs)("div",{className:"modern-filter-actions",children:[(0,i.jsxs)("div",{className:"filter-stats",children:["Showing ",ae().length," of ",t.length," users"]}),(0,i.jsxs)("div",{className:"filter-buttons",children:[(0,i.jsx)("button",{onClick:()=>{U({searchQuery:"",selectedRoleFilter:"",selectedStatusFilter:"",selectedCountryFilter:""}),F(""),P(""),M(""),I("")},className:"btn btn-outline-secondary btn-md modern-clear-button",disabled:!B.searchQuery&&!B.selectedRoleFilter&&!B.selectedStatusFilter&&!B.selectedCountryFilter,children:"\ud83d\uddd1\ufe0f Clear All"}),(0,i.jsx)("button",{onClick:()=>{F(B.searchQuery),P(B.selectedRoleFilter),M(B.selectedStatusFilter),I(B.selectedCountryFilter)},className:"btn btn-primary btn-md modern-apply-button",children:"\u2728 Apply Filters"})]})]}),(0,i.jsxs)("div",{className:"quick-filters",children:[(0,i.jsx)("span",{className:"quick-filters-label",children:"Quick Filters:"}),(0,i.jsx)("button",{onClick:()=>{U(e=>(0,f.A)((0,f.A)({},e),{},{selectedRoleFilter:"admin"}))},className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\ud83d\udc51 Admin Users"}),(0,i.jsx)("button",{onClick:()=>{U(e=>(0,f.A)((0,f.A)({},e),{},{selectedStatusFilter:"enabled"}))},className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\u2705 Enabled Only"}),(0,i.jsx)("button",{onClick:()=>{U(e=>(0,f.A)((0,f.A)({},e),{},{selectedStatusFilter:"disabled"}))},className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\ud83d\udeab Disabled Only"})]})]})]})]}),(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Username"}),(0,i.jsx)("th",{children:"Full Name"}),(0,i.jsx)("th",{children:"Email"}),(0,i.jsx)("th",{children:"Role"}),(0,i.jsx)("th",{children:"Department"}),(0,i.jsx)("th",{children:"Countries"}),(0,i.jsx)("th",{children:"Status"}),(0,i.jsx)("th",{children:"Actions"})]})}),(0,i.jsx)("tbody",{children:ae().map(e=>{const n=void 0===e.enabled||e.enabled;return(0,i.jsxs)("tr",{className:n?"":"user-disabled",children:[(0,i.jsx)("td",{children:e.username}),(0,i.jsx)("td",{children:e.name}),(0,i.jsx)("td",{children:e.email||"N/A"}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"badge badge-role badge-role-".concat(e.role||""),children:e.role?e.role.replace(/-/g," ").toUpperCase():"Unknown"})}),(0,i.jsx)("td",{className:"department-column",children:(0,i.jsx)("div",{className:"badge-container-vertical",children:e.departments&&e.departments.length>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"badge-grid",children:e.departments.slice(0,4).map((e,t)=>(0,i.jsx)("span",{className:"badge badge-department",title:e,children:e},t))}),e.departments.length>4&&(0,i.jsxs)("button",{className:"badge badge-expandable",onClick:()=>se("departments",e.departments,e.name),title:"Show all departments",children:["+",e.departments.length-4," more"]})]}):(0,i.jsx)("span",{className:"text-muted",children:"No departments"})})}),(0,i.jsx)("td",{className:"countries-column",children:(0,i.jsx)("div",{className:"badge-container-vertical",children:e.countries&&e.countries.length>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"badge-grid",children:e.countries.slice(0,4).map((e,t)=>(0,i.jsx)("span",{className:"badge badge-country",title:e,children:e},t))}),e.countries.length>4&&(0,i.jsxs)("button",{className:"badge badge-expandable",onClick:()=>se("countries",e.countries,e.name),title:"Show all countries",children:["+",e.countries.length-4," more"]})]}):(0,i.jsx)("span",{className:"text-muted",children:"No countries"})})}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"user-status ".concat(n?"enabled":"disabled"),children:n?"Enabled":"Disabled"})}),(0,i.jsx)("td",{children:"Admin"!==e.username&&(0,i.jsxs)("div",{className:"user-actions vertical",children:[W&&(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>(e=>{v(e.id),S({username:e.username,password:e.password,name:e.name,role:e.role,departments:e.departments||[],countries:e.countries||[],email:e.email||"",enabled:void 0===e.enabled||e.enabled}),m(!0),setTimeout(()=>{const e=document.querySelector(".add-user-form");e&&e.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)})(e),children:"Edit"}),Q&&(0,i.jsx)("button",{className:"btn btn-sm ".concat(n?"btn-warning":"btn-success"),onClick:()=>(async(e,n)=>{const r=t.find(t=>t.id===e);if(!r)return;const a=!n,s=a?"enabled":"disabled",i="Are you sure you want to ".concat(a?"enable":"disable",' user "').concat(r.name,'" (').concat(r.username,")?\n\nThis will ").concat(a?"allow":"prevent"," them from logging into the system.");if(window.confirm(i))try{await o(e,{enabled:a}),Z.success(),$("User Status Updated",'User "'.concat(r.name,'" has been ').concat(s,".")),J({title:"User Account ".concat(a?"Enabled":"Disabled"),message:"".concat(r.name," (").concat(r.username,") has been ").concat(s," in the system."),type:a?"success":"warning"})}catch(N){console.error("Error updating user status:",N),j("Failed to update user status. Please try again.")}})(e.id,n),title:n?"Disable User":"Enable User",children:n?"Disable":"Enable"}),K&&(0,i.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>(async e=>{const n=t.find(t=>t.id===e),r='Are you sure you want to delete user "'.concat(null===n||void 0===n?void 0:n.name,'" (').concat(null===n||void 0===n?void 0:n.username,")?\n\nThis action cannot be undone.");if(window.confirm(r))try{await c(e),Z.delete(),$("User Deleted",'User "'.concat(null===n||void 0===n?void 0:n.name,'" has been successfully removed from the system.')),J({title:"User Account Deleted",message:"".concat(null===n||void 0===n?void 0:n.name," (").concat(null===n||void 0===n?void 0:n.username,") has been removed from the user access matrix."),type:"warning"})}catch(N){console.error("Error deleting user:",N),j("Failed to delete user. Please try again.")}})(e.id),children:"Delete"})]})})]},e.id)})})]})]})]}),"roles"===u&&(0,i.jsx)("div",{className:"tab-content",children:(0,i.jsx)(Wl,{onRoleUpdate:()=>{te()}})}),E.isOpen&&(0,i.jsx)("div",{className:"popup-overlay",onClick:ie,children:(0,i.jsxs)("div",{className:"popup-content",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"popup-header",children:[(0,i.jsxs)("h3",{children:["departments"===E.type?"All Departments":"All Countries"," - ",E.userName]}),(0,i.jsx)("button",{className:"popup-close",onClick:ie,children:"\u2715"})]}),(0,i.jsx)("div",{className:"popup-body",children:(0,i.jsx)("div",{className:"popup-badge-grid",children:E.items.map((e,t)=>(0,i.jsx)("span",{className:"badge ".concat("departments"===E.type?"badge-department":"badge-country"),title:e,children:e},t))})}),(0,i.jsx)("div",{className:"popup-footer",children:(0,i.jsx)("p",{className:"popup-info",children:"Press ESC or click outside to close"})})]})})]})},Kl=(e,t,n,r,a)=>{var s,o;const i=e.trim();if(!i)return{isValid:!1,error:"".concat("surgery"===t?"Surgery set":"Implant box"," name is required")};if(i.length<3)return{isValid:!1,error:"Name must be at least 3 characters long"};if(i.length>50)return{isValid:!1,error:"Name must be 50 characters or less"};if(!/^[a-zA-Z0-9\s\-()]+$/.test(i))return{isValid:!1,error:"Name can only contain letters, numbers, spaces, hyphens, and parentheses"};if(("surgery"===t?(null===(s=n[r])||void 0===s?void 0:s.surgerySets)||[]:(null===(o=n[r])||void 0===o?void 0:o.implantBoxes)||[]).some(e=>e!==a&&e===i))return{isValid:!1,error:"This ".concat("surgery"===t?"surgery set":"implant box"," already exists in this procedure type")};if(!a){if(Object.values(n).flatMap(e=>"surgery"===t?e.surgerySets:e.implantBoxes).includes(i))return{isValid:!1,error:"This ".concat("surgery"===t?"surgery set":"implant box"," already exists in another procedure type")}}return{isValid:!0,error:""}},Gl=e=>{let{type:t,show:n,value:r,error:a,onValueChange:s,onSave:o,onCancel:l}=e;if(!n)return null;const c="surgery"===t?"Enter surgery set name...":"Enter implant box name...";return(0,i.jsxs)("div",{className:"add-form",children:[(0,i.jsx)("input",{type:"text",value:r,onChange:e=>s(e.target.value),placeholder:c,className:"add-input ".concat(a?"error":""),maxLength:50}),a&&(0,i.jsx)("div",{className:"error-message",children:a}),(0,i.jsxs)("div",{className:"add-actions",children:[(0,i.jsx)("button",{onClick:o,className:"save-button",children:"Save"}),(0,i.jsx)("button",{onClick:l,className:"cancel-button",children:"Cancel"})]})]})},Ql=e=>{let{name:t,index:n,type:r,isEditing:a,editValue:s,isDragging:o,totalItems:l,onEdit:c,onSave:d,onCancel:u,onDelete:h,onMove:p,onDragStart:m,onEditValueChange:f}=e;return(0,i.jsx)("div",{className:"set-item ".concat(o?"dragging":""),draggable:!a,onDragStart:()=>m(r,n),children:a?(0,i.jsxs)("div",{className:"edit-form",children:[(0,i.jsx)("input",{type:"text",value:s,onChange:e=>f(e.target.value),className:"edit-input"}),(0,i.jsxs)("div",{className:"edit-actions",children:[(0,i.jsx)("button",{onClick:()=>d(t,s),className:"save-button-small",children:"\u2713"}),(0,i.jsx)("button",{onClick:u,className:"cancel-button-small",children:"\u2715"})]})]}):(0,i.jsxs)("div",{className:"set-display",children:[(0,i.jsx)("div",{className:"drag-handle",title:"Drag to reorder",children:(0,i.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:[(0,i.jsx)("rect",{x:"6",y:"4",width:"12",height:"2",rx:"1"}),(0,i.jsx)("rect",{x:"6",y:"8",width:"12",height:"2",rx:"1"}),(0,i.jsx)("rect",{x:"6",y:"12",width:"12",height:"2",rx:"1"}),(0,i.jsx)("rect",{x:"6",y:"16",width:"12",height:"2",rx:"1"})]})}),(0,i.jsx)("span",{className:"set-name",children:t}),(0,i.jsxs)("div",{className:"set-actions",children:[(0,i.jsxs)("div",{className:"arrow-controls",children:[(0,i.jsx)("button",{onClick:()=>p(r,n,"up"),className:"arrow-button",disabled:0===n,title:"Move up one position",children:"\u25b2"}),(0,i.jsx)("button",{onClick:()=>p(r,n,"down"),className:"arrow-button",disabled:n===l-1,title:"Move down one position",children:"\u25bc"})]}),(0,i.jsx)("button",{onClick:()=>c(t),className:"edit-button-small",children:"\u270f\ufe0f"}),(0,i.jsx)("button",{onClick:()=>h(t),className:"delete-button-small",children:"\ud83d\uddd1\ufe0f"})]})]})})},Jl=e=>{let{title:t,type:n,items:r,editingItem:a,editValue:s,draggedItem:o,showAddForm:l,addValue:c,addError:d,onShowAdd:u,onAddValueChange:h,onAdd:p,onCancelAdd:m,onEdit:f,onSave:g,onCancelEdit:v,onDelete:y,onMove:b,onDragStart:x,onDragOver:w,onDrop:S,onDragEnd:N,onEditValueChange:j}=e;return(0,i.jsxs)("div",{className:"sets-section",children:[(0,i.jsxs)("div",{className:"section-header",children:[(0,i.jsx)("h3",{children:t}),(0,i.jsxs)("button",{onClick:u,className:"add-button",children:["+ Add ","surgery"===n?"Surgery Set":"Implant Box"]})]}),(0,i.jsx)(Gl,{type:n,show:l,value:c,error:d,onValueChange:h,onSave:p,onCancel:m}),(0,i.jsx)("div",{className:"sets-list",children:r.map((e,t)=>(0,i.jsx)("div",{onDragOver:w,onDrop:()=>S(n,t),onDragEnd:N,children:(0,i.jsx)(Ql,{name:e,index:t,type:n,isEditing:a===e,editValue:s,isDragging:(null===o||void 0===o?void 0:o.type)===n&&o.index===t,totalItems:r.length,onEdit:f,onSave:g,onCancel:v,onDelete:y,onMove:b,onDragStart:x,onEditValueChange:j})},e))})]})},$l=()=>{var e,t,n;const{modal:a,closeModal:s,showConfirm:l}=de(),[c,d]=(0,r.useState)({}),[u,h]=(0,r.useState)(o.q8[0]),[p,m]=(0,r.useState)(!1),[g,v]=(0,r.useState)(!1),[y,x]=(0,r.useState)(""),[w,S]=(0,r.useState)(""),[N,j]=(0,r.useState)(null),[k,C]=(0,r.useState)(null),[E,_]=(0,r.useState)(""),[D,A]=(0,r.useState)(""),[T,I]=(0,r.useState)(null),[R,M]=(0,r.useState)(""),[H,q]=(0,r.useState)(""),[Y,W]=(0,r.useState)([]),[V,K]=(0,r.useState)(!1),[Q,J]=(0,r.useState)(""),[$,X]=(0,r.useState)(""),[Z,ee]=(0,r.useState)(""),[te,ne]=(0,r.useState)([]),{showError:re,showSuccess:ae}=Rl(),{playSound:se}=Tl(),oe=b(),ie=!!oe&&Pi(oe.role,Ui),ce=(null===oe||void 0===oe?void 0:oe.selectedCountry)||(null===oe||void 0===oe||null===(e=oe.countries)||void 0===e?void 0:e[0]),ue="admin"===(null===oe||void 0===oe?void 0:oe.role),he=ue&&Z?Z:ce;(0,r.useEffect)(()=>{(async()=>{try{const e=await G(),t=e.length>0?e:[...o.FS];ne(t),ue&&!Z&&ee(ce||t[0])}catch(e){console.error("Error loading countries:",e);const t=[...o.FS];ne(t),ue&&!Z&&ee(ce||t[0])}})()},[ue,Z,ce]),(0,r.useEffect)(()=>{(async()=>{const e=await z(he);W(e),e.includes(u)||h(e[0]||o.q8[0])})()},[u,he]),(0,r.useEffect)(()=>{(async()=>{const e=await P(he);if(Object.keys(e).length>0)d(e);else{const e=(()=>{const e={};return o.q8.forEach(t=>{e[t]={surgerySets:[],implantBoxes:[]}}),o.cD.forEach(t=>{const n=t.toLowerCase();let r=!1;o.q8.forEach(a=>{const s=a.toLowerCase();n.includes(s)&&!r&&(e[a].surgerySets.push(t),r=!0)}),r||e[o.q8[0]].surgerySets.push(t)}),o.Me.forEach(t=>{const n=t.toLowerCase();let r=!1;o.q8.forEach(a=>{const s=a.toLowerCase();n.includes(s)&&!r&&(e[a].implantBoxes.push(t),r=!0)}),r||e[o.q8[0]].implantBoxes.push(t)}),e})();d(e),O(e,he)}})()},[he]),(0,r.useEffect)(()=>{Object.keys(c).length>0&&O(c,he)},[c,he]);const pe=e=>{const t='Are you sure you want to delete "'.concat(e,'"?\n\nThis will remove all associated surgery sets and implant boxes. This action cannot be undone.');l("Delete Procedure Type",t,async()=>{if(((e,t)=>{const n=L(t);if(n.includes(e)){const r=n.filter(t=>t!==e);return F(r,t),!0}if(["Knee","Head","Hip","Hands","Neck","Spine"].includes(e)){const n=B(t);if(!n.includes(e))return U([...n,e],t),!0}return!1})(e,he)){const t=await z(he);W(t),d(t=>{const n=(0,f.A)({},t);return delete n[e],n}),u===e&&h(t[0]||o.q8[0]),se.delete(),ae("Procedure Type Deleted",'"'.concat(e,'" has been removed'))}else re("Delete Failed","Failed to delete procedure type")})},me=(e,t)=>{I({type:e,index:t})},fe=e=>{e.preventDefault()},ge=()=>{I(null)},ve=(e,t)=>{if(!T||T.type!==e)return;const{index:n}=T;n!==t&&(d(r=>{const a=(0,f.A)({},r),s=((e,t,n)=>{const r=[...e],[a]=r.splice(t,1),s=t<n?n-1:n;return r.splice(s,0,a),r})("surgery"===e?[...a[u].surgerySets]:[...a[u].implantBoxes],n,t);return"surgery"===e?a[u].surgerySets=s:a[u].implantBoxes=s,a}),I(null))},ye=(e,t,n)=>{var r,a;const s="surgery"===e?(null===(r=c[u])||void 0===r?void 0:r.surgerySets)||[]:(null===(a=c[u])||void 0===a?void 0:a.implantBoxes)||[];let o;switch(n){case"up":o=t-1;break;case"down":o=t+1;break;default:return}o<0||o>=s.length||o===t||d(n=>{const r=(0,f.A)({},n),a=((e,t,n)=>{const r=[...e];return[r[t],r[n]]=[r[n],r[t]],r})(s,t,o);return"surgery"===e?r[u].surgerySets=a:r[u].implantBoxes=a,r})};return(0,i.jsxs)("div",{className:"edit-sets-container",children:[(0,i.jsxs)("div",{className:"edit-sets-header",children:[(0,i.jsxs)("div",{className:"edit-sets-title-row",children:[(0,i.jsx)("h2",{children:"Edit Surgery Sets & Implant Boxes"}),ue&&(0,i.jsxs)("div",{className:"admin-country-selector",children:[(0,i.jsx)("label",{htmlFor:"admin-country-select",children:"Country:"}),(0,i.jsx)("select",{id:"admin-country-select",value:Z||"",onChange:e=>ee(e.target.value),className:"country-select",children:te.map(e=>(0,i.jsx)("option",{value:e,children:e},e))})]})]}),(0,i.jsxs)("p",{children:["Manage available surgery sets and implant boxes for case bookings, organized by procedure type",(0,i.jsxs)("span",{children:[" \u2022 ",(0,i.jsxs)("strong",{children:["Country: ",he]})]})]})]}),(0,i.jsxs)("div",{className:"procedure-type-selector",children:[(0,i.jsxs)("div",{className:"procedure-type-header",children:[(0,i.jsx)("h3",{children:"Select Procedure Type:"}),ie&&(0,i.jsx)("button",{className:"btn btn-primary btn-sm add-procedure-type-button",onClick:()=>K(!0),title:"Add new procedure type",children:"+ Add Procedure Type"})]}),(0,i.jsx)("div",{className:"procedure-tabs",children:Y.map(e=>{const t=!o.q8.includes(e);return(0,i.jsxs)("div",{className:"procedure-tab-container",children:[(0,i.jsxs)("button",{onClick:()=>h(e),className:"procedure-tab ".concat(u===e?"active":""),children:[e,t&&(0,i.jsx)("span",{className:"custom-type-indicator",children:"\u2605"})]}),ie&&(0,i.jsx)("button",{className:"delete-procedure-type-button",onClick:()=>pe(e),title:"".concat(t?"Delete":"Hide"," ").concat(e),children:"\u2715"})]},e)})}),V&&(0,i.jsxs)("div",{className:"add-procedure-type-form",children:[(0,i.jsx)("div",{className:"form-header",children:(0,i.jsx)("h4",{children:"Add New Procedure Type"})}),(0,i.jsxs)("div",{className:"form-content",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"procedureTypeName",children:"Procedure Type Name:"}),(0,i.jsx)("input",{type:"text",id:"procedureTypeName",value:Q,onChange:e=>{J(e.target.value),X("")},placeholder:"Enter procedure type name (e.g., Ankle, Wrist)",maxLength:50}),$&&(0,i.jsx)("span",{className:"error-message",children:$})]}),(0,i.jsxs)("div",{className:"form-actions",children:[(0,i.jsx)("button",{className:"btn btn-primary btn-md",onClick:async()=>{const e=Q.trim();if(e)if(Y.includes(e))X("This procedure type already exists");else if(e.length<2)X("Procedure type name must be at least 2 characters");else if(e.length>50)X("Procedure type name must be less than 50 characters");else if(((e,t)=>{const n=L(t),r=e.trim();if(!r||n.includes(r))return!1;const a=[...n,r];return F(a,t),!0})(e,he)){const t=await z(he);W(t),d(t=>(0,f.A)((0,f.A)({},t),{},{[e]:{surgerySets:[],implantBoxes:[]}})),J(""),K(!1),X(""),h(e),se.success(),ae("Procedure Type Added",'"'.concat(e,'" has been added successfully'))}else X("Failed to add procedure type");else X("Procedure type name is required")},disabled:!Q.trim(),children:"Add Procedure Type"}),(0,i.jsx)("button",{className:"btn btn-secondary btn-md",onClick:()=>{K(!1),J(""),X("")},children:"Cancel"})]})]})]})]}),(0,i.jsxs)("div",{className:"sets-grid",children:[(0,i.jsx)(Jl,{title:"Surgery Sets for ".concat(u),type:"surgery",items:(null===(t=c[u])||void 0===t?void 0:t.surgerySets)||[],editingItem:N,editValue:E,draggedItem:T,showAddForm:p,addValue:y,addError:R,onShowAdd:()=>m(!0),onAddValueChange:e=>{x(e),M("")},onAdd:()=>{const e=Kl(y,"surgery",c,u);if(M(e.error),!e.isValid)return se.error(),void re("Validation Error",e.error);const t=y.trim();d(e=>{var n;return(0,f.A)((0,f.A)({},e),{},{[u]:(0,f.A)((0,f.A)({},e[u]||{surgerySets:[],implantBoxes:[]}),{},{surgerySets:[...(null===(n=e[u])||void 0===n?void 0:n.surgerySets)||[],t]})})}),x(""),m(!1),se.success(),ae("Surgery Set Added",'"'.concat(t,'" has been added to ').concat(u))},onCancelAdd:()=>{m(!1),x(""),M("")},onEdit:e=>{j(e),_(e)},onSave:(e,t)=>{const n=Kl(t,"surgery",c,u,e);if(!n.isValid)return se.error(),void re("Validation Error",n.error);const r=t.trim();d(t=>{var n;return(0,f.A)((0,f.A)({},t),{},{[u]:(0,f.A)((0,f.A)({},t[u]||{surgerySets:[],implantBoxes:[]}),{},{surgerySets:((null===(n=t[u])||void 0===n?void 0:n.surgerySets)||[]).map(t=>t===e?r:t)})})}),j(null),_(""),se.success(),ae("Surgery Set Updated",'"'.concat(e,'" has been renamed to "').concat(r,'"'))},onCancelEdit:()=>{j(null),_("")},onDelete:e=>{const t='Are you sure you want to delete "'.concat(e,'"?\n\nThis action cannot be undone and may affect existing case bookings that reference this surgery set.');l("Delete Surgery Set",t,()=>{d(t=>{var n;return(0,f.A)((0,f.A)({},t),{},{[u]:(0,f.A)((0,f.A)({},t[u]||{surgerySets:[],implantBoxes:[]}),{},{surgerySets:((null===(n=t[u])||void 0===n?void 0:n.surgerySets)||[]).filter(t=>t!==e)})})}),se.delete(),ae("Surgery Set Deleted",'"'.concat(e,'" has been removed from ').concat(u))})},onMove:ye,onDragStart:me,onDragOver:fe,onDrop:ve,onDragEnd:ge,onEditValueChange:_}),(0,i.jsx)(Jl,{title:"Implant Boxes for ".concat(u),type:"implant",items:(null===(n=c[u])||void 0===n?void 0:n.implantBoxes)||[],editingItem:k,editValue:D,draggedItem:T,showAddForm:g,addValue:w,addError:H,onShowAdd:()=>v(!0),onAddValueChange:e=>{S(e),q("")},onAdd:()=>{const e=Kl(w,"implant",c,u);if(q(e.error),!e.isValid)return se.error(),void re("Validation Error",e.error);const t=w.trim();d(e=>{var n;return(0,f.A)((0,f.A)({},e),{},{[u]:(0,f.A)((0,f.A)({},e[u]||{surgerySets:[],implantBoxes:[]}),{},{implantBoxes:[...(null===(n=e[u])||void 0===n?void 0:n.implantBoxes)||[],t]})})}),S(""),v(!1),se.success(),ae("Implant Box Added",'"'.concat(t,'" has been added to ').concat(u))},onCancelAdd:()=>{v(!1),S(""),q("")},onEdit:e=>{C(e),A(e)},onSave:(e,t)=>{const n=Kl(t,"implant",c,u,e);if(!n.isValid)return se.error(),void re("Validation Error",n.error);const r=t.trim();d(t=>{var n;return(0,f.A)((0,f.A)({},t),{},{[u]:(0,f.A)((0,f.A)({},t[u]||{surgerySets:[],implantBoxes:[]}),{},{implantBoxes:((null===(n=t[u])||void 0===n?void 0:n.implantBoxes)||[]).map(t=>t===e?r:t)})})}),C(null),A(""),se.success(),ae("Implant Box Updated",'"'.concat(e,'" has been renamed to "').concat(r,'"'))},onCancelEdit:()=>{C(null),A("")},onDelete:e=>{const t='Are you sure you want to delete "'.concat(e,'"?\n\nThis action cannot be undone and may affect existing case bookings that reference this implant box.');l("Delete Implant Box",t,()=>{d(t=>{var n;return(0,f.A)((0,f.A)({},t),{},{[u]:(0,f.A)((0,f.A)({},t[u]||{surgerySets:[],implantBoxes:[]}),{},{implantBoxes:((null===(n=t[u])||void 0===n?void 0:n.implantBoxes)||[]).filter(t=>t!==e)})})}),se.delete(),ae("Implant Box Deleted",'"'.concat(e,'" has been removed from ').concat(u))})},onMove:ye,onDragStart:me,onDragOver:fe,onDrop:ve,onDragEnd:ge,onEditValueChange:A})]}),(0,i.jsx)(le,{isOpen:a.isOpen,onClose:s,title:a.title,message:a.message,type:a.type,actions:"confirm"===a.type?[{label:"Cancel",onClick:s,style:"secondary"},{label:"Delete",onClick:a.onConfirm||s,style:"danger"}]:void 0})]})},Xl=e=>{let{data:t}=e;return(0,i.jsxs)("div",{className:"overview-dashboard",children:[(0,i.jsxs)("div",{className:"metrics-grid",children:[(0,i.jsxs)("div",{className:"metric-card primary",children:[(0,i.jsx)("div",{className:"metric-icon",children:"\ud83d\udcca"}),(0,i.jsxs)("div",{className:"metric-content",children:[(0,i.jsx)("div",{className:"metric-value",children:t.totalCases}),(0,i.jsx)("div",{className:"metric-label",children:"Total Cases"})]})]}),(0,i.jsxs)("div",{className:"metric-card success",children:[(0,i.jsx)("div",{className:"metric-icon",children:"\u2705"}),(0,i.jsxs)("div",{className:"metric-content",children:[(0,i.jsxs)("div",{className:"metric-value",children:[t.completionRate.toFixed(1),"%"]}),(0,i.jsx)("div",{className:"metric-label",children:"Completion Rate"})]})]}),(0,i.jsxs)("div",{className:"metric-card warning",children:[(0,i.jsx)("div",{className:"metric-icon",children:"\u26a1"}),(0,i.jsxs)("div",{className:"metric-content",children:[(0,i.jsx)("div",{className:"metric-value",children:t.urgentCases}),(0,i.jsx)("div",{className:"metric-label",children:"Urgent Cases"})]})]}),(0,i.jsxs)("div",{className:"metric-card info",children:[(0,i.jsx)("div",{className:"metric-icon",children:"\u23f1\ufe0f"}),(0,i.jsxs)("div",{className:"metric-content",children:[(0,i.jsx)("div",{className:"metric-value",children:t.averageProcessingTime}),(0,i.jsx)("div",{className:"metric-label",children:"Avg. Processing (days)"})]})]})]}),(0,i.jsxs)("div",{className:"charts-grid",children:[(0,i.jsxs)("div",{className:"chart-container",children:[(0,i.jsx)("h4",{children:"\ud83d\udcc8 Status Distribution"}),(0,i.jsx)("div",{className:"status-breakdown",children:Object.entries(t.statusBreakdown).map(e=>{let[t,n]=e;return n>0&&(0,i.jsxs)("div",{className:"status-item",children:[(0,i.jsx)("div",{className:"status-indicator",style:{backgroundColor:bl(t)}}),(0,i.jsx)("span",{className:"status-name",children:t}),(0,i.jsx)("span",{className:"status-count",children:n})]},t)})})]}),(0,i.jsxs)("div",{className:"chart-container",children:[(0,i.jsx)("h4",{children:"\ud83c\udf0d Country Distribution"}),(0,i.jsx)("div",{className:"country-breakdown",children:Object.entries(t.countryBreakdown).map(e=>{let[n,r]=e;return r>0&&(0,i.jsxs)("div",{className:"country-item",children:[(0,i.jsx)("span",{className:"country-name",children:n}),(0,i.jsx)("div",{className:"country-bar",children:(0,i.jsx)("div",{className:"country-bar-fill",style:{width:"".concat(r/t.totalCases*100,"%"),backgroundColor:"#20b2aa"}})}),(0,i.jsx)("span",{className:"country-count",children:r})]},n)})})]})]})]})},Zl=e=>{let{data:t}=e;return(0,i.jsxs)("div",{className:"workflow-analysis",children:[(0,i.jsx)("h3",{children:"\u26a1 Workflow Performance Analysis"}),(0,i.jsxs)("div",{className:"workflow-metrics",children:[(0,i.jsxs)("div",{className:"workflow-stage",children:[(0,i.jsx)("h4",{children:"\ud83d\udcdd Case Booking"}),(0,i.jsx)("div",{className:"stage-count",children:t.statusBreakdown["Case Booked"]}),(0,i.jsx)("div",{className:"stage-description",children:"New cases awaiting processing"})]}),(0,i.jsxs)("div",{className:"workflow-stage",children:[(0,i.jsx)("h4",{children:"\ud83d\udccb Order Processing"}),(0,i.jsx)("div",{className:"stage-count",children:t.statusBreakdown["Order Preparation"]+t.statusBreakdown["Order Prepared"]}),(0,i.jsx)("div",{className:"stage-description",children:"Cases being prepared"})]}),(0,i.jsxs)("div",{className:"workflow-stage",children:[(0,i.jsx)("h4",{children:"\ud83d\ude9a Delivery"}),(0,i.jsx)("div",{className:"stage-count",children:t.statusBreakdown["Pending Delivery (Hospital)"]+t.statusBreakdown["Delivered (Hospital)"]}),(0,i.jsx)("div",{className:"stage-description",children:"Hospital delivery process"})]}),(0,i.jsxs)("div",{className:"workflow-stage",children:[(0,i.jsx)("h4",{children:"\u2705 Completion"}),(0,i.jsx)("div",{className:"stage-count",children:t.statusBreakdown["Case Completed"]+t.statusBreakdown["Delivered (Office)"]+t.statusBreakdown["To be billed"]}),(0,i.jsx)("div",{className:"stage-description",children:"Completed cases"})]})]})]})},ec=e=>{let{data:t}=e;return(0,i.jsxs)("div",{className:"performance-metrics",children:[(0,i.jsx)("h3",{children:"\ud83d\udcc8 Performance Analytics"}),(0,i.jsxs)("div",{className:"performance-section",children:[(0,i.jsx)("h4",{children:"\ud83c\udfc6 Top Performers"}),(0,i.jsx)("div",{className:"top-submitters",children:t.topSubmitters.slice(0,5).map((e,t)=>(0,i.jsxs)("div",{className:"submitter-item",children:[(0,i.jsxs)("div",{className:"submitter-rank",children:["#",t+1]}),(0,i.jsx)("div",{className:"submitter-name",children:e.name}),(0,i.jsxs)("div",{className:"submitter-count",children:[e.count," cases"]})]},e.name))})]}),(0,i.jsxs)("div",{className:"performance-section",children:[(0,i.jsx)("h4",{children:"\ud83d\udcc5 Monthly Trends"}),(0,i.jsx)("div",{className:"monthly-trends",children:Object.entries(t.monthlyTrends).map(e=>{let[n,r]=e;return(0,i.jsxs)("div",{className:"month-item",children:[(0,i.jsx)("div",{className:"month-name",children:n}),(0,i.jsx)("div",{className:"month-bar",children:(0,i.jsx)("div",{className:"month-bar-fill",style:{height:"".concat(Math.max(r/Math.max(...Object.values(t.monthlyTrends))*100,5),"%"),backgroundColor:"#20b2aa"}})}),(0,i.jsx)("div",{className:"month-count",children:r})]},n)})})]})]})},tc=e=>{let{cases:t}=e;return(0,i.jsxs)("div",{className:"detailed-report",children:[(0,i.jsx)("h3",{children:"\ud83d\udccb Detailed Case Report"}),(0,i.jsx)("div",{className:"detailed-table-container",children:(0,i.jsxs)("table",{className:"detailed-table",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Case Reference"}),(0,i.jsx)("th",{children:"Hospital"}),(0,i.jsx)("th",{children:"Department"}),(0,i.jsx)("th",{children:"Surgery Date"}),(0,i.jsx)("th",{children:"Procedure"}),(0,i.jsx)("th",{children:"Status"}),(0,i.jsx)("th",{children:"Country"}),(0,i.jsx)("th",{children:"Submitted By"})]})}),(0,i.jsx)("tbody",{children:t.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"case-ref",children:e.caseReferenceNumber}),(0,i.jsx)("td",{children:e.hospital}),(0,i.jsx)("td",{children:e.department}),(0,i.jsx)("td",{children:xi(new Date(e.dateOfSurgery))}),(0,i.jsx)("td",{children:(0,i.jsxs)("div",{className:"procedure-info",children:[(0,i.jsx)("div",{className:"procedure-type",children:e.procedureType}),(0,i.jsx)("div",{className:"procedure-name",children:e.procedureName})]})}),(0,i.jsx)("td",{children:(0,i.jsx)("span",{className:"status-badge",style:{backgroundColor:bl(e.status),color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"0.8rem"},children:e.status})}),(0,i.jsx)("td",{children:e.country}),(0,i.jsx)("td",{children:e.submittedBy})]},e.id))})]})})]})},nc=()=>{const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)([]),[s]=(0,r.useState)(b()),[c,d]=(0,r.useState)(!0),[u,h]=(0,r.useState)([]),[p,m]=(0,r.useState)({dateFrom:"",dateTo:"",status:"",country:"",department:"",submitter:"",reportType:"overview"}),[g,v]=(0,r.useState)({dateFrom:"",dateTo:"",status:"",country:"",department:"",submitter:"",reportType:"overview"});(0,r.useEffect)(()=>{(async()=>{try{const e=await G();h(e.length>0?e:[...o.FS])}catch(e){console.error("Error loading countries:",e),h([...o.FS])}})()},[]),(0,r.useEffect)(()=>{const e=T().filter(e=>{var t,n;if("admin"===(null===s||void 0===s?void 0:s.role)||"it"===(null===s||void 0===s?void 0:s.role))return!0;const r=!(null!==s&&void 0!==s&&null!==(t=s.countries)&&void 0!==t&&t.length)||s.countries.includes(e.country),a=!(null!==s&&void 0!==s&&null!==(n=s.departments)&&void 0!==n&&n.length)||s.departments.includes(e.department);return r&&a});t(e),a(e)},[s]),(0,r.useEffect)(()=>{v((0,f.A)({},p))},[p]),(0,r.useEffect)(()=>{let t=[...e];p.dateFrom&&(t=t.filter(e=>e.dateOfSurgery>=p.dateFrom)),p.dateTo&&(t=t.filter(e=>e.dateOfSurgery<=p.dateTo)),p.status&&(t=t.filter(e=>e.status===p.status)),p.country&&(t=t.filter(e=>e.country===p.country)),p.department&&(t=t.filter(e=>e.department===p.department)),p.submitter&&(t=t.filter(e=>e.submittedBy.toLowerCase().includes(p.submitter.toLowerCase()))),a(t)},[e,p]);const y=(0,r.useMemo)(()=>{const e=n.length,t={};["Case Booked","Order Preparation","Order Prepared","Pending Delivery (Hospital)","Delivered (Hospital)","Case Completed","Pending Delivery (Office)","Delivered (Office)","To be billed","Case Closed","Case Cancelled"].forEach(e=>{t[e]=n.filter(t=>t.status===e).length});const r={};u.forEach(e=>{r[e]=n.filter(t=>t.country===e).length});const a={};o.uy.forEach(e=>{a[e]=n.filter(t=>t.department===e).length});const s={};for(let o=5;o>=0;o--){const e=new Date;e.setMonth(e.getMonth()-o);const t="".concat(e.getFullYear(),"-").concat((e.getMonth()+1).toString().padStart(2,"0"));s[t]=n.filter(e=>e.dateOfSurgery.startsWith(t)).length}const i={};n.forEach(e=>{i[e.submittedBy]=(i[e.submittedBy]||0)+1});const l=Object.entries(i).map(e=>{let[t,n]=e;return{name:t,count:n}}).sort((e,t)=>t.count-e.count).slice(0,10),c=n.filter(e=>["Case Completed","Delivered (Office)","To be billed","Case Closed"].includes(e.status)).length,d=e>0?c/e*100:0,h=n.filter(e=>{const t=new Date(e.dateOfSurgery),n=new Date,r=Math.ceil((t.getTime()-n.getTime())/864e5);return r<=3&&r>=0&&"Case Completed"!==e.status}).length;return{totalCases:e,statusBreakdown:t,countryBreakdown:r,departmentBreakdown:a,monthlyTrends:s,topSubmitters:l,averageProcessingTime:2.5,urgentCases:h,completionRate:d}},[n,u]),x=(0,r.useMemo)(()=>Array.from(new Set(e.map(e=>e.submittedBy))).sort(),[e]),w=(0,r.useMemo)(()=>{const t="admin"===(null===s||void 0===s?void 0:s.role)||"it"===(null===s||void 0===s?void 0:s.role)?u:(null===s||void 0===s?void 0:s.countries)||[];return Array.from(new Set(e.map(e=>e.country).filter(e=>t.includes(e)))).sort()},[e,s,u]),S=(0,r.useMemo)(()=>{const t="admin"===(null===s||void 0===s?void 0:s.role)||"it"===(null===s||void 0===s?void 0:s.role)?o.uy:(null===s||void 0===s?void 0:s.departments)||[];return Array.from(new Set(e.map(e=>e.department).filter(e=>t.includes(e)))).sort()},[e,s]),N=(e,t)=>{v(n=>(0,f.A)((0,f.A)({},n),{},{[e]:t}))},j=()=>[["Case Reference","Hospital","Department","Date of Surgery","Procedure Type","Procedure Name","Doctor","Status","Country","Submitted By","Submitted At"],...n.map(e=>[e.caseReferenceNumber,e.hospital,e.department,e.dateOfSurgery,e.procedureType,e.procedureName,e.doctorName||"",e.status,e.country,e.submittedBy,xi(new Date(e.submittedAt))])].map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n");return Pi((null===s||void 0===s?void 0:s.role)||"",rl)?(0,i.jsxs)("div",{className:"reports-container",children:[(0,i.jsxs)("div",{className:"reports-header",children:[(0,i.jsxs)("div",{className:"reports-title",children:[(0,i.jsx)("h1",{children:"\ud83d\udcca Reports & Analytics"}),(0,i.jsx)("p",{children:"Comprehensive case booking analytics and insights"})]}),(0,i.jsxs)("div",{className:"reports-actions",children:[(0,i.jsx)("button",{onClick:()=>{const e=j(),t=new Blob([e],{type:"text/csv"}),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="case_report_".concat((new Date).toISOString().split("T")[0],".csv"),r.click(),window.URL.revokeObjectURL(n)},className:"btn btn-outline-primary",title:"Export to CSV",children:"\ud83d\udce4 Export"}),(0,i.jsx)("button",{onClick:()=>{window.print()},className:"btn btn-outline-secondary",title:"Print Report",children:"\ud83d\udda8\ufe0f Print"})]})]}),(0,i.jsxs)("div",{className:"modern-filters-section",children:[(0,i.jsxs)("div",{className:"filters-header",onClick:()=>d(!c),children:[(0,i.jsxs)("div",{className:"filters-title",children:[(0,i.jsx)("h3",{children:"\ud83d\udd0d Advanced Filters"}),(0,i.jsx)("span",{className:"active-filters-count",children:Object.values(g).filter(e=>e&&"overview"!==e).length>0&&"(".concat(Object.values(g).filter(e=>e&&"overview"!==e).length," active)")})]}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm filters-toggle ".concat(c?"expanded":""),children:c?"\u25b2":"\u25bc"})]}),c&&(0,i.jsxs)("div",{className:"filters-content",children:[(0,i.jsxs)("div",{className:"filters-grid",children:[(0,i.jsxs)("div",{className:"filter-category",children:[(0,i.jsx)("h4",{children:"\ud83d\udcca Report Configuration"}),(0,i.jsx)("div",{className:"filter-row",children:(0,i.jsxs)("div",{className:"modern-filter-group full-width",children:[(0,i.jsx)("label",{children:"Report Type"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(l,{options:[{value:"overview",label:"\ud83d\udcca Overview Dashboard"},{value:"workflow",label:"\u26a1 Workflow Analysis"},{value:"performance",label:"\ud83d\udcc8 Performance Metrics"},{value:"detailed",label:"\ud83d\udccb Detailed Report"}],value:g.reportType,onChange:e=>N("reportType",e),placeholder:"Select Report Type"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udcc4"})]})]})})]}),(0,i.jsxs)("div",{className:"filter-category",children:[(0,i.jsx)("h4",{children:"\ud83d\udd0e Search"}),(0,i.jsxs)("div",{className:"filter-row",children:[(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Submitter"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(l,{options:[{value:"",label:"All Submitters"},...x.map(e=>({value:e,label:e}))],value:g.submitter,onChange:e=>N("submitter",e),placeholder:"All Submitters"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udc64"})]})]}),("admin"===(null===s||void 0===s?void 0:s.role)||"it"===(null===s||void 0===s?void 0:s.role))&&(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Country"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(l,{options:[{value:"",label:"All Countries"},...w.map(e=>({value:e,label:e}))],value:g.country,onChange:e=>N("country",e),placeholder:"All Countries"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83c\udf0d"})]})]}),(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Department"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(l,{options:[{value:"",label:"All Departments"},...S.map(e=>({value:e,label:e}))],value:g.department,onChange:e=>N("department",e),placeholder:"All Departments"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83c\udfe5"})]})]})]})]}),(0,i.jsxs)("div",{className:"filter-category",children:[(0,i.jsx)("h4",{children:"\ud83d\udcca Status"}),(0,i.jsx)("div",{className:"filter-row",children:(0,i.jsxs)("div",{className:"modern-filter-group full-width",children:[(0,i.jsx)("label",{children:"Case Status"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(l,{options:[{value:"",label:"All Statuses"},{value:"Case Booked",label:"Case Booked"},{value:"Order Preparation",label:"Order Preparation"},{value:"Order Prepared",label:"Order Prepared"},{value:"Pending Delivery (Hospital)",label:"Pending Delivery (Hospital)"},{value:"Delivered (Hospital)",label:"Delivered (Hospital)"},{value:"Case Completed",label:"Case Completed"},{value:"Pending Delivery (Office)",label:"Pending Delivery (Office)"},{value:"Delivered (Office)",label:"Delivered (Office)"},{value:"To be billed",label:"To be billed"},{value:"Case Closed",label:"Case Closed"},{value:"Case Cancelled",label:"Case Cancelled"}],value:g.status,onChange:e=>N("status",e),placeholder:"All Statuses"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udd04"})]})]})})]}),(0,i.jsxs)("div",{className:"filter-category",children:[(0,i.jsx)("h4",{children:"\ud83d\udcc5 Date Range"}),(0,i.jsxs)("div",{className:"filter-row",children:[(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Start Date"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(bi,{value:g.dateFrom,onChange:e=>N("dateFrom",e),placeholder:"Select start date"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udcc5"})]})]}),(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"End Date"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(bi,{value:g.dateTo,onChange:e=>N("dateTo",e),placeholder:"Select end date",min:g.dateFrom||void 0}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udcc5"})]})]})]})]})]}),(0,i.jsxs)("div",{className:"modern-filter-actions",children:[(0,i.jsxs)("div",{className:"filter-stats",children:["Showing ",n.length," of ",e.length," cases"]}),(0,i.jsxs)("div",{className:"filter-buttons",children:[(0,i.jsx)("button",{onClick:()=>{const e={dateFrom:"",dateTo:"",status:"",country:"",department:"",submitter:"",reportType:"overview"};v(e),m(e)},className:"btn btn-outline-secondary btn-md modern-clear-button",disabled:0===Object.values(g).filter(e=>e&&"overview"!==e).length,children:"\ud83d\uddd1\ufe0f Clear All"}),(0,i.jsx)("button",{onClick:()=>{m((0,f.A)({},g))},className:"btn btn-primary btn-md modern-apply-button",children:"\u2728 Apply Filters"})]})]}),(0,i.jsxs)("div",{className:"quick-filters",children:[(0,i.jsx)("span",{className:"quick-filters-label",children:"Quick Filters:"}),(0,i.jsx)("button",{onClick:()=>N("reportType","overview"),className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\ud83d\udcca Overview"}),(0,i.jsx)("button",{onClick:()=>N("reportType","workflow"),className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\u26a1 Workflow"}),(0,i.jsx)("button",{onClick:()=>N("reportType","performance"),className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\ud83d\udcc8 Performance"}),(0,i.jsx)("button",{onClick:()=>{const e=(new Date).toISOString().split("T")[0];N("dateFrom",e),N("dateTo",e)},className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\ud83d\udcc5 Today"})]})]})]}),(0,i.jsxs)("div",{className:"reports-content",children:["overview"===p.reportType&&(0,i.jsx)(Xl,{data:y}),"workflow"===p.reportType&&(0,i.jsx)(Zl,{data:y}),"performance"===p.reportType&&(0,i.jsx)(ec,{data:y}),"detailed"===p.reportType&&(0,i.jsx)(tc,{cases:n})]})]}):(0,i.jsx)("div",{className:"permission-denied",children:(0,i.jsxs)("div",{className:"permission-denied-content",children:[(0,i.jsx)("h2",{children:"\ud83d\udeab Access Denied"}),(0,i.jsx)("p",{children:"You don't have permission to view reports."}),(0,i.jsx)("p",{children:"Contact your administrator to request access."})]})})},rc=e=>{var t;let{onCaseClick:n}=e;const[a,s]=(0,r.useState)(""),[c,d]=(0,r.useState)([]),[u,h]=(0,r.useState)(new Date),[p,m]=(0,r.useState)([]),[f,g]=(0,r.useState)(!1),[v,y]=(0,r.useState)({date:"",cases:[]}),[x,w]=(0,r.useState)(1),[S,N]=(0,r.useState)(b()),[j,k]=(0,r.useState)(""),[C,E]=(0,r.useState)([]),[_,D]=(0,r.useState)(!1),I=(0,r.useRef)(null),O=(null===S||void 0===S?void 0:S.selectedCountry)||(null===S||void 0===S||null===(t=S.countries)||void 0===t?void 0:t[0]),P="admin"===(null===S||void 0===S?void 0:S.role),R=P&&j?j:O;(0,r.useEffect)(()=>{(async()=>{const e=b();N(e);try{const e=await G();E(e)}catch(n){console.error("Error loading countries:",n),E([...o.FS])}if("admin"===(null===e||void 0===e?void 0:e.role)&&!j){const t=(null===e||void 0===e?void 0:e.selectedCountry)||"Singapore";k(t)}const t=P&&j?j:(null===e||void 0===e?void 0:e.selectedCountry)||"Singapore";if(t)try{const n=(await q(t)).find(e=>"departments"===e.id),r=(null===n||void 0===n?void 0:n.items)||[];let a=r;if("admin"!==(null===e||void 0===e?void 0:e.role)&&"it"!==(null===e||void 0===e?void 0:e.role)){const n=(null===e||void 0===e?void 0:e.departments)||[],s=await ee(n,[t]);a=r.filter(e=>s.includes(e))}d(a.sort()),a.length>0&&s(a[0])}catch(n){console.error("Error loading departments:",n);try{const e=await K();d(e.sort()),e.length>0&&s(e[0])}catch(r){console.error("Error loading fallback departments:",r),d([])}}else try{const t=await K(null===e||void 0===e?void 0:e.departments);d(t.sort()),t.length>0&&s(t[0])}catch(r){console.error("Error loading user departments:",r),d([])}})()},[j]),(0,r.useEffect)(()=>{(async()=>{try{console.log("\ud83d\udcc5 BookingCalendar: Loading cases from both localStorage and Supabase"),await A();const e=await H.caseService.getAllCases(!0);console.log("\ud83d\udcc5 BookingCalendar: Loaded",e.length,"cases from Supabase");const t=T();console.log("\ud83d\udcc5 BookingCalendar: Found",t.length,"cases still in localStorage");const n=new Set(e.map(e=>e.caseReferenceNumber)),r=t.filter(e=>!n.has(e.caseReferenceNumber)),a=[...e,...r];console.log("\ud83d\udcc5 BookingCalendar: Total combined cases:",a.length);const s=a.filter(e=>(!R||e.country===R)&&!("admin"!==(null===S||void 0===S?void 0:S.role)&&"it"!==(null===S||void 0===S?void 0:S.role)&&"operations"!==(null===S||void 0===S?void 0:S.role)&&"operations-manager"!==(null===S||void 0===S?void 0:S.role)&&"operations-manager"!==(null===S||void 0===S?void 0:S.role)&&null!==S&&void 0!==S&&S.departments&&!S.departments.includes(e.department)));console.log("\ud83d\udcc5 BookingCalendar: Filtered to",s.length,"cases for display"),m(s)}catch(e){console.error("\ud83d\udcc5 BookingCalendar: Error loading cases:",e),m([])}})()},[R,S]),(0,r.useEffect)(()=>{const e=e=>{I.current&&!I.current.contains(e.target)&&_&&D(!1)};return _&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[_]);const M=Math.ceil(v.cases.length/10),L=e=>{w(e)},F=e=>{h(t=>{const n=new Date(t);return"prev"===e?n.setMonth(t.getMonth()-1):n.setMonth(t.getMonth()+1),n})},B=e=>{if(!a)return[];const t=u.getFullYear(),n=(u.getMonth()+1).toString().padStart(2,"0"),r=e.toString().padStart(2,"0"),s="".concat(t,"-").concat(n,"-").concat(r);return p.filter(e=>e.dateOfSurgery===s&&e.department===a&&"Case Cancelled"!==e.status)};return(0,i.jsxs)("div",{className:"booking-calendar",children:[(0,i.jsxs)("div",{className:"booking-calendar-header",children:[(0,i.jsxs)("div",{className:"calendar-title-row",children:[(0,i.jsx)("h2",{children:"\ud83d\udcc5 Booking Calendar"}),P&&(0,i.jsxs)("div",{className:"admin-country-selector",children:[(0,i.jsx)("label",{htmlFor:"calendar-country-select",children:"Country:"}),(0,i.jsx)("select",{id:"calendar-country-select",value:j||"",onChange:e=>k(e.target.value),className:"country-select",children:C.map(e=>(0,i.jsx)("option",{value:e,children:e},e))})]})]}),(0,i.jsxs)("p",{children:["View and manage case bookings by department",(0,i.jsxs)("span",{children:[" \u2022 Country: ",(0,i.jsx)("strong",{children:R})]}),"admin"!==(null===S||void 0===S?void 0:S.role)&&"it"!==(null===S||void 0===S?void 0:S.role)&&(0,i.jsx)("span",{children:" \u2022 Filtered by your assigned departments"})]})]}),(0,i.jsxs)("div",{className:"calendar-controls",children:[(0,i.jsxs)("div",{className:"department-selector",children:[(0,i.jsx)("label",{htmlFor:"department-select",children:"Department:"}),(0,i.jsx)(l,{id:"department-select",value:a,onChange:s,options:c,placeholder:"Search and select department",className:"form-control"})]}),(0,i.jsxs)("div",{className:"calendar-navigation",children:[(0,i.jsxs)("div",{className:"nav-arrows",children:[(0,i.jsx)("button",{onClick:()=>F("prev"),className:"nav-button",title:"Previous Month",children:"\u2190 Previous"}),(0,i.jsx)("button",{onClick:()=>F("next"),className:"nav-button",title:"Next Month",children:"Next \u2192"})]}),(0,i.jsxs)("div",{className:"month-year-display",children:[(0,i.jsxs)("h3",{className:"current-month",onClick:()=>D(!_),children:[(U=u,(e=>"".concat(["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]," ").concat(e.getFullYear()))(U)),(0,i.jsx)("span",{className:"dropdown-indicator",children:_?"\u25b2":"\u25bc"})]}),_&&(0,i.jsxs)("div",{className:"date-picker-controls",ref:I,children:[(0,i.jsxs)("div",{className:"month-year-selectors",children:[(0,i.jsxs)("div",{className:"selector-group",children:[(0,i.jsx)("label",{children:"Month:"}),(0,i.jsx)(l,{options:["January","February","March","April","May","June","July","August","September","October","November","December"].map((e,t)=>({value:t.toString(),label:e})),value:u.getMonth().toString(),onChange:e=>{h(t=>{const n=new Date(t);return n.setMonth(parseInt(e)),n})},placeholder:"Select Month",className:"month-selector"})]}),(0,i.jsxs)("div",{className:"selector-group",children:[(0,i.jsx)("label",{children:"Year:"}),(0,i.jsx)(l,{options:(()=>{const e=(new Date).getFullYear(),t=[];for(let n=e-5;n<=e+5;n++)t.push({value:n.toString(),label:n.toString()});return t})(),value:u.getFullYear().toString(),onChange:e=>{h(t=>{const n=new Date(t);return n.setFullYear(parseInt(e)),n})},placeholder:"Select Year",className:"year-selector"})]})]}),(0,i.jsxs)("div",{className:"quick-actions",children:[(0,i.jsx)("button",{onClick:()=>{h(new Date)},className:"today-button",title:"Go to current month",children:"\ud83d\udcc5 Today"}),(0,i.jsx)("button",{onClick:()=>D(!1),className:"close-picker-button",title:"Close date picker",children:"\u2715"})]})]})]})]})]}),(0,i.jsx)("div",{className:"calendar-content",children:a?(0,i.jsxs)("div",{className:"calendar-view",children:[(0,i.jsx)("div",{className:"calendar-department-info",children:(0,i.jsxs)("strong",{children:["Department: ",a]})}),(()=>{const e=(t=u,new Date(t.getFullYear(),t.getMonth()+1,0).getDate());var t;const r=(e=>new Date(e.getFullYear(),e.getMonth(),1).getDay())(u),a=new Date,s=a.getMonth()===u.getMonth()&&a.getFullYear()===u.getFullYear(),o=[],l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,i.jsx)("div",{className:"calendar-day-header",children:e},e));for(let n=0;n<r;n++)o.push((0,i.jsx)("div",{className:"calendar-day calendar-day-empty"},"empty-".concat(n)));for(let c=1;c<=e;c++){const e=s&&c===a.getDate(),t="calendar-day ".concat(e?"calendar-day-today":""),r=B(c);o.push((0,i.jsxs)("div",{className:t,children:[(0,i.jsx)("div",{className:"calendar-day-number",children:c}),(0,i.jsx)("div",{className:"calendar-day-content",children:(()=>{const e=r.sort((e,t)=>{const n=e.timeOfProcedure||"23:59",r=t.timeOfProcedure||"23:59";return n.localeCompare(r)}),t=e.slice(0,2),a=e.slice(2);return(0,i.jsxs)(i.Fragment,{children:[t.map((e,t)=>(0,i.jsxs)("div",{className:"booking-item",style:{backgroundColor:bl(e.status),color:"white"},title:"".concat(e.caseReferenceNumber," - ").concat(e.procedureType," at ").concat(e.hospital," - Dr. ").concat(e.doctorName," - Status: ").concat(e.status),onClick:()=>null===n||void 0===n?void 0:n(e.id),children:[(0,i.jsx)("div",{className:"booking-time",style:{color:"white",fontWeight:"bold"},children:e.timeOfProcedure||"TBD"}),(0,i.jsx)("div",{className:"booking-hospital",style:{fontSize:"9px",fontWeight:"bold",color:"white"},children:e.hospital}),(0,i.jsx)("div",{className:"booking-procedure",style:{fontSize:"10px",fontWeight:"500",color:"white"},children:e.procedureType}),(0,i.jsx)("div",{className:"booking-doctor",style:{fontSize:"9px",color:"white",opacity:.9},children:e.doctorName||"TBD"})]},"".concat(e.id,"-").concat(t))),a.length>0&&(0,i.jsxs)("div",{className:"more-cases-button",onClick:()=>{const e=u.getFullYear(),t=(u.getMonth()+1).toString().padStart(2,"0"),n=c.toString().padStart(2,"0"),r="".concat(n,"/").concat(t,"/").concat(e);y({date:r,cases:a}),w(1),g(!0)},children:["+",a.length," More Case",a.length>1?"s":""]})]})})()})]},c))}return(0,i.jsxs)("div",{className:"calendar-grid",children:[l,o]})})()]}):(0,i.jsx)("div",{className:"no-department-selected",children:(0,i.jsx)("p",{children:"Please select a department to view the booking calendar."})})}),f&&(0,i.jsx)("div",{className:"more-cases-modal-overlay",onClick:()=>g(!1),children:(0,i.jsxs)("div",{className:"more-cases-modal",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"more-cases-header",children:[(0,i.jsxs)("h3",{children:["Additional Cases for ",v.date]}),(0,i.jsx)("button",{className:"close-button",onClick:()=>g(!1),children:"\u2715"})]}),(0,i.jsxs)("div",{className:"more-cases-content",children:[(0,i.jsx)("div",{className:"more-cases-grid",children:(()=>{const e=10*x,t=e-10;return v.cases.slice(t,e)})().map((e,t)=>(0,i.jsxs)("div",{className:"more-case-item",style:{backgroundColor:bl(e.status),color:"white"},onClick:()=>{null===n||void 0===n||n(e.id),g(!1)},children:[(0,i.jsx)("div",{className:"more-case-time",style:{color:"white",fontWeight:"bold"},children:e.timeOfProcedure||"TBD"}),(0,i.jsxs)("div",{className:"more-case-info",children:[(0,i.jsx)("div",{className:"more-case-hospital",style:{fontWeight:"bold",color:"white",fontSize:"12px"},children:e.hospital}),(0,i.jsx)("div",{className:"more-case-procedure",style:{fontWeight:"500",fontSize:"13px",color:"white"},children:e.procedureType}),(0,i.jsxs)("div",{className:"more-case-details",children:[(0,i.jsxs)("span",{style:{color:"white"},children:["Dr. ",e.doctorName||"TBD"]}),(0,i.jsx)("span",{className:"case-ref",style:{color:"white",opacity:.9},children:e.caseReferenceNumber})]}),(0,i.jsx)("div",{className:"more-case-status",style:{color:"white",fontWeight:"bold"},children:e.status})]})]},"more-".concat(e.id,"-").concat(t)))}),M>1&&(0,i.jsxs)("div",{className:"more-cases-pagination",children:[(0,i.jsxs)("div",{className:"pagination-info",children:["Showing ",10*(x-1)+1," to ",Math.min(10*x,v.cases.length)," of ",v.cases.length," cases"]}),(0,i.jsxs)("div",{className:"pagination-controls",children:[(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>L(x-1),disabled:1===x,children:"Previous"}),[...Array(M)].map((e,t)=>{const n=t+1;return 1===n||n===M||n>=x-1&&n<=x+1?(0,i.jsx)("button",{className:"btn btn-sm ".concat(n===x?"btn-primary":"btn-outline-secondary"),onClick:()=>L(n),children:n},n):n===x-2||n===x+2?(0,i.jsx)("span",{className:"pagination-ellipsis",children:"..."},n):null}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>L(x+1),disabled:x===M,children:"Next"})]})]})]})]})})]});var U},ac=e=>{const t=[],n=[];return e.forEach(e=>{"countries"===e.id?n.push(e):("hospitals"===e.id||e.id,t.push(e))}),{countryBased:t,global:n}},sc=(e,t)=>t?"admin"===t.role||"it"===t.role?e:e.map(e=>"countries"===e.id&&t.countries&&t.countries.length>0?(0,f.A)((0,f.A)({},e),{},{items:e.items.filter(e=>{var n;return null===(n=t.countries)||void 0===n?void 0:n.includes(e)})}):e):e,oc=(e,t)=>t?"admin"===t.role||"it"===t.role?e:e.filter(e=>{var n;return null===(n=t.countries)||void 0===n?void 0:n.includes(e)}):[],ic=()=>{const{modal:e,closeModal:t,showConfirm:n,showError:a}=de(),[s,c]=(0,r.useState)([]),[d,u]=(0,r.useState)([]),[h,p]=(0,r.useState)(""),[m,g]=(0,r.useState)(""),[v,y]=(0,r.useState)("global"),[x,w]=(0,r.useState)(!1),[S,N]=(0,r.useState)(""),[j,k]=(0,r.useState)(null),[C,E]=(0,r.useState)(""),[_,D]=(0,r.useState)(""),[A,T]=(0,r.useState)([]),[I,O]=(0,r.useState)(!1),[P,R]=(0,r.useState)(!0),{showSuccess:M}=Rl(),{playSound:L}=Tl(),F=b(),B=!!F&&Ai(F.role,"code-table-setup"),U=!!F&&Ai(F.role,"global-tables"),z=(0,r.useMemo)(()=>("global"===v?d:s).find(e=>e.id===h),[v,d,s,h,I]);(0,r.useEffect)(()=>{if(F&&!m){var e;const t=F.selectedCountry||(null===(e=F.countries)||void 0===e?void 0:e[0])||"Singapore";g(t)}},[null===F||void 0===F?void 0:F.id,m]),(0,r.useEffect)(()=>{(async()=>{R(!0);try{ne();const e=(await q()).find(e=>"countries"===e.id),t=e&&e.items.length>0?e.items:[...o.FS];if(T(t),!m&&F){const e=F.selectedCountry||"Singapore";t.includes(e)?g(e):t.length>0&&g(t[0])}}finally{R(!1)}})()},[]),(0,r.useEffect)(()=>{if(!F||P)return;(async()=>{try{ne();const e=await q(),{global:t}=ac(e),n=sc(t,F);if(u(n),m){p(""),w(!1),k(null),re(m);const e=await q(m),t=sc(e,F);c(t)}else c([])}catch(e){console.error("Error loading code tables:",e)}})()},[m,null===F||void 0===F?void 0:F.id,null===F||void 0===F?void 0:F.role,P]),(0,r.useEffect)(()=>{const e="global"===v?d:s;h&&e.find(e=>e.id===h)||(e.length>0?p(e[0].id):p(""))},[v,d,s,h]),(0,r.useEffect)(()=>{I&&O(!1)},[I]);const H=()=>("global"===v?d:s).find(e=>e.id===h),Y=(e,t)=>{const n=t.trim(),r=H();if(!n)return void D("Item name is required");if(!r)return void D("No table selected");if(n!==e&&r.items.includes(n))return void D("This item already exists in the table");"global"===v?D("Global tables are read-only and cannot be modified"):(O(!0),c(t=>{const r=t.map(t=>t.id===h?(0,f.A)((0,f.A)({},t),{},{items:t.items.map(t=>t===e?n:t)}):t);return te(r,m),r}),k(null),E(""),D(""),L.success(),M("Item Updated",'"'.concat(e,'" has been renamed to "').concat(n,'"')))},W=(e,t)=>{if("global"===v)a("Action Not Allowed","Global tables are read-only and cannot be modified");else{O(!0);try{c(t=>{const n=t.map(t=>t.id===h?(0,f.A)((0,f.A)({},t),{},{items:t.items.filter(t=>t!==e)}):t);return te(n,m),n}),L.delete(),M("Item Deleted",'"'.concat(e,'" has been removed from ').concat(t.name))}catch(n){console.error("Error deleting item:",n),a("Delete Failed",'Failed to delete "'.concat(e,'" from ').concat(t.name))}}};return B?P?(0,i.jsxs)("div",{className:"code-table-setup",children:[(0,i.jsxs)("div",{className:"code-table-header",children:[(0,i.jsx)("h2",{children:"Code Table Setup"}),(0,i.jsx)("p",{children:"Loading code tables..."})]}),(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",fontSize:"1.2rem",color:"#6c757d"},children:"\ud83d\udd04 Loading data..."})]}):(0,i.jsxs)("div",{className:"code-table-setup",children:[(0,i.jsxs)("div",{className:"code-table-header",children:[(0,i.jsx)("h2",{children:"Code Table Setup"}),(0,i.jsx)("p",{children:"Manage system reference data and lookup tables"})]}),F&&F.countries&&F.countries.length>1&&"country"===v&&(0,i.jsxs)("div",{className:"country-selector",children:[(0,i.jsxs)("div",{className:"country-selector-header",children:[(0,i.jsx)("h3",{children:"\ud83c\udf0d Select Country:"}),(0,i.jsx)("p",{children:"Country-based code tables are managed separately for each country"})]}),(0,i.jsx)("div",{className:"country-dropdown",children:(0,i.jsx)(l,{options:oc(A,F),value:m,onChange:e=>g(e),placeholder:"Select a country...",className:"country-select-dropdown"})})]}),(0,i.jsxs)("div",{className:"category-selector",children:[(0,i.jsxs)("div",{className:"category-selector-header",children:[(0,i.jsx)("h3",{children:"\ud83d\udcca Code Table Categories:"}),(0,i.jsx)("p",{children:"Select the type of code tables to manage"})]}),(0,i.jsxs)("div",{className:"category-tabs",children:[(0,i.jsxs)("button",{onClick:()=>{y("country"),p("")},className:"category-tab ".concat("country"===v?"active":""),disabled:0===A.length,title:0===A.length?"No countries available":"Manage country-specific tables",children:["\ud83c\udfe5 Country-Based Tables",(0,i.jsxs)("span",{className:"category-count",children:["(",s.length,")"]})]}),(0,i.jsxs)("button",{onClick:()=>{y("global"),p("")},className:"category-tab ".concat("global"===v?"active":""),disabled:!U,title:U?"Manage tables that apply to all countries":"You need Global Tables permission to access this section",children:["\ud83c\udf0d Global Tables",(0,i.jsxs)("span",{className:"category-count",children:["(",d.length,")"]})]})]})]}),"global"===v&&d.length>0||"country"===v&&m&&s.length>0?(0,i.jsxs)("div",{className:"table-selector",children:[(0,i.jsxs)("div",{className:"table-selector-header",children:[(0,i.jsx)("h3",{children:"global"===v?"\ud83c\udf0d Select Global Code Table:":"\ud83c\udfe5 Select Code Table for ".concat(m,":")}),(0,i.jsx)("p",{children:"global"===v?"These tables apply to all countries":"These tables are specific to the selected country"})]}),(0,i.jsx)("div",{className:"table-dropdown",children:(0,i.jsx)(l,{options:("global"===v?d:s).map(e=>({value:e.id,label:"".concat(e.name," (").concat(e.items.length,")")})),value:h,onChange:p,placeholder:"Select a code table...",className:"table-select-dropdown"})})]}):(0,i.jsx)("div",{className:"table-selector",children:(0,i.jsx)("div",{style:{padding:"2rem",textAlign:"center",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #dee2e6",color:"#6c757d"},children:"global"===v?(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{children:"\ud83c\udf0d No Global Tables Available"}),(0,i.jsx)("p",{children:"Global tables are being loaded or there are no global tables configured."}),(0,i.jsx)("button",{onClick:async()=>{ne();const e=await q(),{global:t}=ac(e),n=sc(t,F);u(n)},className:"btn btn-secondary",children:"Reinitialize Tables"})]}):(0,i.jsxs)("div",{children:[(0,i.jsxs)("h4",{children:["\ud83c\udfe5 ",m?"No Tables Available for ".concat(m):"Select a Country First"]}),(0,i.jsx)("p",{children:m?"Country-based tables are being loaded or there are no tables configured for this country.":"Please select a country above to view and manage country-based tables."}),m&&(0,i.jsxs)("button",{onClick:async()=>{re(m);const e=await q(m),t=sc(e,F);c(t);const n=await q(),{global:r}=ac(n),a=sc(r,F);u(a)},className:"btn btn-secondary",children:["Reinitialize ",m," Tables"]})]})})}),z&&(0,i.jsxs)("div",{className:"table-content",children:[(0,i.jsxs)("div",{className:"table-content-header",children:[(0,i.jsxs)("div",{className:"table-info",children:[(0,i.jsx)("h3",{children:z.name}),(0,i.jsx)("p",{children:z.description}),(0,i.jsxs)("span",{className:"item-count",children:[z.items.length," items"]})]}),"global"!==v&&(0,i.jsx)("button",{className:"btn btn-primary btn-sm add-item-button",onClick:()=>w(!0),title:"Add new item",children:"+ Add Item"}),"global"===v&&(0,i.jsx)("span",{className:"read-only-badge",title:"Global tables are read-only",children:"\ud83d\udcd6 Read-Only"})]}),x&&"global"!==v&&(0,i.jsxs)("div",{className:"add-item-form",children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"itemName",children:"Item Name:"}),(0,i.jsx)("input",{type:"text",id:"itemName",value:S,onChange:e=>{N(e.target.value),D("")},placeholder:"Enter item name",maxLength:100}),_&&(0,i.jsx)("span",{className:"error-message",children:_})]}),(0,i.jsxs)("div",{className:"form-actions",children:[(0,i.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>{const e=S.trim(),t=H();if(!e)return void D("Item name is required");if(!t)return void D("No table selected");if(t.items.includes(e))return void D("This item already exists in the table");if(e.length<1)return void D("Item name must be at least 1 character");"global"===v?D("Global tables are read-only and cannot be modified"):(O(!0),c(t=>{const n=t.map(t=>t.id===h?(0,f.A)((0,f.A)({},t),{},{items:[...t.items,e]}):t);return te(n,m),n}),N(""),w(!1),D(""),L.success(),M("Item Added",'"'.concat(e,'" has been added to ').concat(t.name)))},disabled:!S.trim(),children:"Add Item"}),(0,i.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>{w(!1),N(""),D("")},children:"Cancel"})]})]}),(0,i.jsx)("div",{className:"items-list",children:0===z.items.length?(0,i.jsxs)("div",{className:"empty-state",children:[(0,i.jsx)("p",{children:"No items in this table yet."}),"global"!==v&&(0,i.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>w(!0),children:"Add First Item"})]}):(0,i.jsx)("div",{className:"items-grid",children:z.items.sort().map((e,t)=>(0,i.jsx)("div",{className:"item-card",children:j===e?(0,i.jsxs)("div",{className:"edit-item-form",children:[(0,i.jsx)("input",{type:"text",value:C,onChange:e=>E(e.target.value),onKeyPress:t=>{"Enter"===t.key&&Y(e,C)},autoFocus:!0}),(0,i.jsxs)("div",{className:"edit-actions",children:[(0,i.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>Y(e,C),disabled:!C.trim(),children:"Save"}),(0,i.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:()=>{k(null),E("")},children:"Cancel"})]})]}):(0,i.jsxs)("div",{className:"item-display",children:[(0,i.jsx)("span",{className:"item-name",children:e}),"global"!==v&&(0,i.jsxs)("div",{className:"item-actions",children:[(0,i.jsx)("button",{className:"btn btn-outline-primary btn-sm",onClick:()=>{return k(t=e),void E(t);var t},title:"Edit item",children:"\u270f\ufe0f"}),(0,i.jsx)("button",{className:"btn btn-outline-danger btn-sm",onClick:()=>(e=>{const t=H();if(!t)return;if("global"===v)return void a("Action Not Allowed","Global tables are read-only and cannot be modified");const r=((e,t,n,r)=>!1?{first:{title:"\u26a0\ufe0f Global Table Warning",message:'\u26a0\ufe0f WARNING: You are about to delete "'.concat(e,'" from ').concat(t,".\n\nThis is a GLOBAL table that affects ALL countries!\n\nAre you sure you want to continue?")},second:{title:"\ud83d\udea8 Final Confirmation Required",message:'\ud83d\udea8 FINAL CONFIRMATION\n\nDeleting "'.concat(e,'" from the global ').concat(t," table will:\n\n\u2022 Remove it from ALL countries permanently\n\u2022 Potentially affect existing users and data\n\u2022 Cannot be undone\n\nThis action is irreversible.")}}:{single:{title:"Delete Item",message:'Are you sure you want to delete "'.concat(e,'" from ').concat(t,"?\n\nThis will only affect ").concat(r," and cannot be undone.")}})(e,t.name,0,m);r.single&&n(r.single.title,r.single.message,()=>{W(e,t)})})(e),title:"Delete item",children:"\ud83d\uddd1\ufe0f"})]})]})},t))})})]}),(0,i.jsx)(le,{isOpen:e.isOpen,onClose:t,title:e.title,message:e.message,type:e.type,actions:"confirm"===e.type?[{label:"Cancel",onClick:t,style:"secondary"},{label:"Delete",onClick:e.onConfirm||t,style:"danger"}]:void 0})]}):(0,i.jsx)("div",{className:"code-table-setup",children:(0,i.jsxs)("div",{className:"permission-denied-message",children:[(0,i.jsx)("h3",{children:"Access Denied"}),(0,i.jsx)("p",{children:"You don't have permission to access Code Table Setup."}),(0,i.jsx)("p",{children:"Please contact your administrator to request access."})]})})},lc=e=>{let{user:t,onClose:n}=e;const[a,s]=(0,r.useState)(100);(0,r.useEffect)(()=>{const e=setInterval(()=>{s(t=>t<=0?(clearInterval(e),n(),0):t-2)},100);return()=>clearInterval(e)},[n]),(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&n()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n]);return(0,i.jsx)("div",{className:"popup-overlay",onClick:e=>{e.target===e.currentTarget&&n()},children:(0,i.jsxs)("div",{className:"welcome-popup",children:[(0,i.jsx)("div",{className:"popup-icon",children:(0,i.jsx)("div",{className:"success-icon",children:"\u2713"})}),(0,i.jsxs)("div",{className:"popup-content",children:[(0,i.jsx)("h2",{children:"Welcome to Transmedic Case Booking"}),(0,i.jsxs)("p",{children:["You have successfully logged in to ",t.selectedCountry||"the system","."]}),(0,i.jsx)("div",{className:"security-notice",children:(0,i.jsx)("p",{style:{color:"#666",fontSize:"0.9rem",marginBottom:"16px"},children:"\ud83d\udd12 For your security, automatic logout will occur after 15 minutes of inactivity."})}),(0,i.jsxs)("div",{className:"progress-container",children:[(0,i.jsx)("p",{children:"This popup will automatically close in 5 seconds"}),(0,i.jsx)("div",{className:"progress-bar",children:(0,i.jsx)("div",{className:"progress-fill",style:{width:"".concat(a,"%")}})})]})]}),(0,i.jsx)("button",{onClick:n,className:"btn btn-primary btn-md popup-close-button",children:"Ok"})]})})},cc=()=>{const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)(!1),[s,o]=(0,r.useState)([]),{modal:l,closeModal:c,showConfirm:d,showSuccess:u}=de();(0,r.useEffect)(()=>{const e=_i();o(e);const n=Ii(),r=n.find(e=>"admin"===e.roleId&&"code-table-setup"===e.actionId);if(console.log("Admin code-table-setup permission:",r),r&&r.allowed)t(n);else{console.log("Admin code-table-setup permission missing or disabled, fixing..."),Ri("admin","code-table-setup",!0);const e=Ii();t(e)}},[]);return(0,i.jsxs)("div",{className:"permission-matrix-page",children:[(0,i.jsxs)("div",{className:"page-header",children:[(0,i.jsxs)("div",{className:"header-content",children:[(0,i.jsx)("div",{className:"header-title-section",children:(0,i.jsx)("h1",{children:"Permission Management"})}),(0,i.jsx)("div",{className:"header-description-section",children:(0,i.jsx)("p",{children:"Configure role-based access control for the Case Booking Application"})})]}),(0,i.jsxs)("div",{className:"header-actions",children:[(0,i.jsx)("button",{className:"export-button",onClick:()=>{const t=JSON.stringify(e,null,2),n="data:application/json;charset=utf-8,"+encodeURIComponent(t),r="permissions_".concat((new Date).toISOString().split("T")[0],".json"),a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",r),a.click()},children:"Export Permissions"}),n?(0,i.jsxs)("div",{className:"edit-actions",children:[(0,i.jsx)("button",{className:"save-button",onClick:()=>{const t=e.filter(e=>e.allowed).length,n="Are you sure you want to save the current permission configuration?\n\nThis will update ".concat(t," permission(s) and affect system access immediately.");d("Confirm Save Changes",n,()=>{Oi(e),a(!1),u("Permissions saved successfully!")})},children:"Save Changes"}),(0,i.jsx)("button",{className:"cancel-button",onClick:()=>{localStorage.removeItem(Ti);const e=Ii();t(e),a(!1)},children:"Cancel"})]}):(0,i.jsx)("button",{className:"edit-button",onClick:()=>a(!0),children:"Edit Permissions"})]})]}),(0,i.jsx)(ql,{roles:s,actions:Ci,permissions:e,onPermissionChange:n?(e,n,r)=>{Ri(n,e,r),t(t=>{const a=t.findIndex(t=>t.actionId===e&&t.roleId===n);if(a>=0){const e=[...t];return e[a]=(0,f.A)((0,f.A)({},e[a]),{},{allowed:r}),e}return[...t,{actionId:e,roleId:n,allowed:r}]})}:void 0,readonly:!n}),(0,i.jsxs)("div",{className:"permission-notes",children:[(0,i.jsx)("div",{className:"role-definitions-header",children:(0,i.jsx)("div",{className:"role-definitions-title",children:(0,i.jsx)("h3",{children:"Role Definitions"})})}),(0,i.jsx)("div",{className:"role-definitions",children:s.map(e=>(0,i.jsxs)("div",{className:"role-definition",children:[(0,i.jsx)("div",{className:"role-badge",style:{backgroundColor:e.color},children:e.displayName}),(0,i.jsx)("p",{children:e.description})]},e.id))}),(0,i.jsxs)("div",{className:"system-notes",children:[(0,i.jsx)("div",{className:"role-details-header",children:(0,i.jsx)("h4",{children:"Role Details:"})}),(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Admin"})," role has full access to all system functions"]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"Status transitions"})," follow a strict workflow order"]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"File operations"})," are tied to specific role responsibilities"]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"User management"})," is restricted to Admin role only"]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("strong",{children:"System settings"})," require Admin or IT role access"]})]})]})]}),(0,i.jsx)(le,{isOpen:l.isOpen,onClose:c,title:l.title,message:l.message,type:l.type,actions:"confirm"===l.type?[{label:"Cancel",onClick:c,style:"secondary"},{label:"Confirm",onClick:l.onConfirm||c,style:"primary"}]:void 0,autoClose:"success"===l.type,autoCloseDelay:3e3})]})},dc=()=>{const e=b(),{notifications:t}=ol(),[n,a]=(0,r.useState)([]),[s,o]=(0,r.useState)([]),[c,d]=(0,r.useState)(1),[u]=(0,r.useState)(20),[h,p]=(0,r.useState)(!1),[m,g]=(0,r.useState)({category:"",action:"",user:"",status:"",dateFrom:"",dateTo:""}),[v,y]=(0,r.useState)({category:"",action:"",user:"",status:"",dateFrom:"",dateTo:""}),x=!!e&&Pi(e.role,nl),w=(0,r.useCallback)(()=>{const e=[{id:"sys001",timestamp:(new Date).toISOString(),user:"System",action:"Application Started",category:"System",target:"Application",details:"Case booking application initialized",ipAddress:"127.0.0.1",status:"success"},{id:"sys002",timestamp:new Date(Date.now()-36e5).toISOString(),user:"System",action:"Permission Check",category:"Security",target:"Permission Matrix",details:"Audit logs permission verified",ipAddress:"127.0.0.1",status:"success"}],n=t.map((e,t)=>({id:"notif-".concat(t),timestamp:e.timestamp,user:e.title.includes("User")?"Admin":"System",action:e.title,category:N(e.title),target:j(e.message),details:e.message,ipAddress:"192.168.1.100",status:"error"===e.type?"error":"warning"===e.type?"warning":"success"})),r=[...e,...n].sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime());a(r)},[t]),S=(0,r.useCallback)(()=>{let e=n;m.category&&(e=e.filter(e=>e.category===m.category)),m.action&&(e=e.filter(e=>e.action.toLowerCase().includes(m.action.toLowerCase()))),m.user&&(e=e.filter(e=>e.user.toLowerCase().includes(m.user.toLowerCase()))),m.status&&(e=e.filter(e=>e.status===m.status)),m.dateFrom&&(e=e.filter(e=>new Date(e.timestamp)>=new Date(m.dateFrom))),m.dateTo&&(e=e.filter(e=>new Date(e.timestamp)<=new Date(m.dateTo+"T23:59:59"))),o(e),d(1)},[n,m]);(0,r.useEffect)(()=>{x&&w()},[x,w]),(0,r.useEffect)(()=>{S()},[S]);const N=e=>e.includes("User")?"User Management":e.includes("Case")?"Case Management":e.includes("Status")?"Status Change":e.includes("Permission")?"Security":"System",j=e=>{const t=e.match(/TMC\d+/);if(t)return t[0];const n=e.match(/(\w+\s+\w+)\s*\(/);return n?n[1]:"System"},k=(e,t)=>{y(n=>(0,f.A)((0,f.A)({},n),{},{[e]:t}))},C=()=>{const e={category:"",action:"",user:"",status:"",dateFrom:"",dateTo:""};y(e),g(e)};(0,r.useEffect)(()=>{y((0,f.A)({},m))},[m]);const E=Math.ceil(s.length/u),_=e=>{d(e)},D=e=>{switch(e){case"success":return"status-badge success";case"warning":return"status-badge warning";case"error":return"status-badge error";default:return"status-badge"}},A=e=>{const t=new Date(e);if(isNaN(t.getTime()))return"Invalid Date";const n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()],r=t.getDate().toString().padStart(2,"0"),a=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getFullYear(),o=t.getHours().toString().padStart(2,"0"),i=t.getMinutes().toString().padStart(2,"0");return"".concat(n,", ").concat(r,"/").concat(a,"/").concat(s," ").concat(o,":").concat(i)};return x?(0,i.jsxs)("div",{className:"audit-logs",children:[(0,i.jsxs)("div",{className:"audit-logs-header",children:[(0,i.jsxs)("div",{className:"header-content",children:[(0,i.jsx)("h2",{children:"\ud83d\udcca System Audit Logs"}),(0,i.jsx)("p",{children:"Complete audit trail of all system activities and user actions"})]}),(0,i.jsxs)("div",{className:"header-stats",children:[(0,i.jsxs)("div",{className:"stat-item",children:[(0,i.jsx)("span",{className:"stat-value",children:s.length}),(0,i.jsx)("span",{className:"stat-label",children:"Total Entries"})]}),(0,i.jsxs)("div",{className:"stat-item",children:[(0,i.jsx)("span",{className:"stat-value",children:new Set(s.map(e=>e.user)).size}),(0,i.jsx)("span",{className:"stat-label",children:"Active Users"})]})]})]}),(0,i.jsxs)("div",{className:"modern-filters-section",children:[(0,i.jsxs)("div",{className:"filters-header",onClick:()=>p(!h),children:[(0,i.jsxs)("div",{className:"filters-title",children:[(0,i.jsx)("h3",{children:"\ud83d\udd0d Advanced Filters"}),(0,i.jsx)("span",{className:"active-filters-count",children:Object.values(v).some(e=>e)&&"(".concat(Object.values(v).filter(e=>e).length," active)")})]}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm filters-toggle ".concat(h?"expanded":""),children:h?"\u25b2":"\u25bc"})]}),h&&(0,i.jsxs)("div",{className:"filters-content",children:[(0,i.jsxs)("div",{className:"filters-grid",children:[(0,i.jsxs)("div",{className:"filter-category",children:[(0,i.jsx)("h4",{children:"\ud83d\udd0e Search"}),(0,i.jsxs)("div",{className:"filter-row",children:[(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"User"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(l,{options:[{value:"",label:"All Users"},...Array.from(new Set(n.map(e=>e.user))).map(e=>({value:e,label:e}))],value:v.user,onChange:e=>k("user",e),placeholder:"All Users"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udc64"})]})]}),(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Action"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(l,{options:[{value:"",label:"All Actions"},...Array.from(new Set(n.map(e=>e.action))).map(e=>({value:e,label:e}))],value:v.action,onChange:e=>k("action",e),placeholder:"All Actions"}),(0,i.jsx)("span",{className:"filter-icon",children:"\u26a1"})]})]})]})]}),(0,i.jsxs)("div",{className:"filter-category",children:[(0,i.jsx)("h4",{children:"\ud83d\udcca Status & Category"}),(0,i.jsxs)("div",{className:"filter-row",children:[(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Category"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(l,{options:[{value:"",label:"All Categories"},{value:"User Management",label:"User Management"},{value:"Case Management",label:"Case Management"},{value:"Status Change",label:"Status Change"},{value:"Security",label:"Security"},{value:"System",label:"System"}],value:v.category,onChange:e=>k("category",e),placeholder:"All Categories"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udcc1"})]})]}),(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Status"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(l,{options:[{value:"",label:"All Statuses"},{value:"success",label:"Success"},{value:"warning",label:"Warning"},{value:"error",label:"Error"}],value:v.status,onChange:e=>k("status",e),placeholder:"All Statuses"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83c\udfaf"})]})]})]})]}),(0,i.jsxs)("div",{className:"filter-category",children:[(0,i.jsx)("h4",{children:"\ud83d\udcc5 Date Range"}),(0,i.jsxs)("div",{className:"filter-row",children:[(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"Start Date"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(bi,{value:v.dateFrom,onChange:e=>k("dateFrom",e),placeholder:"Select start date"}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udcc5"})]})]}),(0,i.jsxs)("div",{className:"modern-filter-group",children:[(0,i.jsx)("label",{children:"End Date"}),(0,i.jsxs)("div",{className:"filter-input-wrapper",children:[(0,i.jsx)(bi,{value:v.dateTo,onChange:e=>k("dateTo",e),placeholder:"Select end date",min:v.dateFrom||void 0}),(0,i.jsx)("span",{className:"filter-icon",children:"\ud83d\udcc5"})]})]})]})]})]}),(0,i.jsxs)("div",{className:"modern-filter-actions",children:[(0,i.jsxs)("div",{className:"filter-stats",children:["Showing ",s.length," of ",n.length," log entries"]}),(0,i.jsxs)("div",{className:"filter-buttons",children:[(0,i.jsx)("button",{onClick:C,className:"btn btn-outline-secondary btn-md modern-clear-button",disabled:!Object.values(v).some(e=>e),children:"\ud83d\uddd1\ufe0f Clear All"}),(0,i.jsx)("button",{onClick:()=>{g((0,f.A)({},v))},className:"btn btn-primary btn-md modern-apply-button",children:"\u2728 Apply Filters"}),(0,i.jsx)("button",{onClick:w,className:"btn btn-outline-secondary btn-md",children:"\ud83d\udd04 Refresh"})]})]}),(0,i.jsxs)("div",{className:"quick-filters",children:[(0,i.jsx)("span",{className:"quick-filters-label",children:"Quick Filters:"}),(0,i.jsx)("button",{onClick:()=>g(e=>(0,f.A)((0,f.A)({},e),{},{category:"Case Management"})),className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\ud83d\udccb Cases"}),(0,i.jsx)("button",{onClick:()=>g(e=>(0,f.A)((0,f.A)({},e),{},{category:"User Management"})),className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\ud83d\udc65 Users"}),(0,i.jsx)("button",{onClick:()=>g(e=>(0,f.A)((0,f.A)({},e),{},{status:"error"})),className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\u274c Errors"}),(0,i.jsx)("button",{onClick:()=>{const e=(new Date).toISOString().split("T")[0];g(t=>(0,f.A)((0,f.A)({},t),{},{dateFrom:e,dateTo:e}))},className:"btn btn-outline-secondary btn-sm quick-filter-button",children:"\ud83d\udcc5 Today"})]})]})]}),(0,i.jsxs)("div",{className:"audit-logs-table",children:[(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"Timestamp"}),(0,i.jsx)("th",{children:"User"}),(0,i.jsx)("th",{children:"Action"}),(0,i.jsx)("th",{children:"Category"}),(0,i.jsx)("th",{children:"Target"}),(0,i.jsx)("th",{children:"Status"}),(0,i.jsx)("th",{children:"IP Address"}),(0,i.jsx)("th",{children:"Details"})]})}),(0,i.jsx)("tbody",{children:(()=>{const e=c*u,t=e-u;return s.slice(t,e)})().map(e=>(0,i.jsxs)("tr",{className:"log-row ".concat(e.status),children:[(0,i.jsx)("td",{className:"timestamp-cell",children:A(e.timestamp)}),(0,i.jsx)("td",{className:"user-cell",children:(0,i.jsx)("strong",{children:e.user})}),(0,i.jsx)("td",{className:"action-cell",children:e.action}),(0,i.jsx)("td",{className:"category-cell",children:(0,i.jsx)("span",{className:"category-badge",children:e.category})}),(0,i.jsx)("td",{className:"target-cell",children:e.target}),(0,i.jsx)("td",{className:"status-cell",children:(0,i.jsx)("span",{className:D(e.status),children:e.status.toUpperCase()})}),(0,i.jsx)("td",{className:"ip-cell",children:e.ipAddress}),(0,i.jsx)("td",{className:"details-cell",children:(0,i.jsx)("div",{className:"details-preview",title:e.details,children:e.details.length>50?"".concat(e.details.substring(0,50),"..."):e.details})})]},e.id))})]}),0===s.length&&(0,i.jsxs)("div",{className:"no-logs",children:[(0,i.jsx)("p",{children:"\ud83d\udcdd No audit logs found matching your criteria."}),(0,i.jsx)("button",{onClick:C,className:"btn btn-outline-primary",children:"Clear Filters"})]}),E>1&&(0,i.jsxs)("div",{className:"pagination-container",children:[(0,i.jsxs)("div",{className:"pagination-info",children:["Showing ",(c-1)*u+1," to ",Math.min(c*u,s.length)," of ",s.length," entries"]}),(0,i.jsxs)("div",{className:"pagination-controls",children:[(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>_(1),disabled:1===c,children:"First"}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>_(c-1),disabled:1===c,children:"Previous"}),[...Array(E)].map((e,t)=>{const n=t+1;return 1===n||n===E||n>=c-2&&n<=c+2?(0,i.jsx)("button",{className:"btn btn-sm ".concat(n===c?"btn-primary":"btn-outline-secondary"),onClick:()=>_(n),children:n},n):n===c-3||n===c+3?(0,i.jsx)("span",{className:"pagination-ellipsis",children:"..."},n):null}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>_(c+1),disabled:c===E,children:"Next"}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>_(E),disabled:c===E,children:"Last"})]})]})]})]}):(0,i.jsx)("div",{className:"permission-denied",children:(0,i.jsxs)("div",{className:"permission-denied-content",children:[(0,i.jsx)("h2",{children:"\ud83d\udeab Access Denied"}),(0,i.jsx)("p",{children:"You don't have permission to view audit logs."}),(0,i.jsx)("p",{children:"Contact your system administrator for access."})]})})};var uc=n(324);const hc=()=>{var e,t;const[n,a]=(0,r.useState)(""),[s,l]=(0,r.useState)({}),[c,d]=(0,r.useState)({}),[u,h]=(0,r.useState)(""),[p,m]=(0,r.useState)(!0),[g,v]=(0,r.useState)(!0),[y,x]=(0,r.useState)(!0),[w,S]=(0,r.useState)({}),[N,j]=(0,r.useState)({}),{playSound:k}=Tl(),{showSuccess:C,showError:E}=Rl(),_=b(),D=!!_&&Pi(_.role,tl),[A,T]=r.useState([...o.FS]);r.useEffect(()=>{(async()=>{try{const e=await G();T(e.length>0?e:[...o.FS])}catch(e){console.error("Error loading countries:",e),T([...o.FS])}})()},[]);const I="admin"===(null===_||void 0===_?void 0:_.role),O=r.useCallback(e=>({country:e,rules:[...il.fd,il.sf.CASE_CLOSED,il.sf.CASE_CANCELLED].map(e=>{const t=e===il.sf.CASE_BOOKED||e===il.sf.ORDER_PREPARATION||e===il.sf.ORDER_PREPARED||e===il.sf.PENDING_DELIVERY_HOSPITAL||e===il.sf.DELIVERED_HOSPITAL||e===il.sf.CASE_COMPLETED||e===il.sf.PENDING_DELIVERY_OFFICE||e===il.sf.DELIVERED_OFFICE||e===il.sf.TO_BE_BILLED;let n=[];e===il.sf.CASE_BOOKED||e===il.sf.ORDER_PREPARATION?n=[ll,cl,dl]:e===il.sf.ORDER_PREPARED?n=[ll,cl,dl,pl]:e===il.sf.PENDING_DELIVERY_HOSPITAL?n=[ll,dl,pl]:e===il.sf.DELIVERED_HOSPITAL?n=[ll,dl,pl,ul]:e===il.sf.CASE_COMPLETED?n=[ll,ul,hl,dl]:e===il.sf.PENDING_DELIVERY_OFFICE||e===il.sf.DELIVERED_OFFICE?n=[ll,ul,pl]:e===il.sf.TO_BE_BILLED?n=[ll,ul,hl,dl]:e===il.sf.CASE_CLOSED?n=[ll,hl,dl]:e===il.sf.CASE_CANCELLED&&(n=[ll,dl,ml]);let r={subject:"Case Status Update: ".concat(e),body:"A case has been updated to status: ".concat(e,"\n\nCase Reference: {{caseReference}}\nHospital: {{hospital}}\nDate: {{dateOfSurgery}}\nSubmitted by: {{submittedBy}}\n\nBest regards,\nCase Booking System")};return e===il.sf.CASE_BOOKED?r={subject:"\ud83c\udd95 New Case Booked: {{caseReference}} - {{hospital}}",body:"Dear Team,\n\nA new case has been submitted and is ready for processing.\n\n\ud83d\udccb Case Details:\n\u2022 Case Reference: {{caseReference}}\n\u2022 Hospital: {{hospital}}\n\u2022 Department: {{department}}\n\u2022 Surgery Date: {{dateOfSurgery}}\n\u2022 Surgery Time: {{timeOfProcedure}}\n\u2022 Procedure: {{procedureType}} - {{procedureName}}\n\u2022 Doctor: {{doctorName}}\n\u2022 Submitted by: {{submittedBy}}\n\u2022 Submission Time: {{submittedAt}}\n\n\ud83d\udce6 Equipment Required:\n\u2022 Surgery Sets: {{surgerySetSelection}}\n\u2022 Implant Boxes: {{implantBox}}\n\n\ud83d\udcac Special Instructions:\n{{specialInstruction}}\n\nPlease proceed with order preparation.\n\nBest regards,\n{{country}} Case Booking System"}:e===il.sf.CASE_COMPLETED?r={subject:"\u2705 Case Completed: {{caseReference}} - {{hospital}}",body:"Dear Team,\n\nThe surgical case has been completed successfully.\n\n\ud83d\udccb Case Details:\n\u2022 Case Reference: {{caseReference}}\n\u2022 Hospital: {{hospital}}\n\u2022 Department: {{department}}\n\u2022 Surgery Date: {{dateOfSurgery}}\n\u2022 Doctor: {{doctorName}}\n\u2022 Completed by: {{processedBy}}\n\u2022 Completion Time: {{processedAt}}\n\n\ud83d\udcdd Summary:\n{{orderSummary}}\n\n\ud83d\udcc4 DO Number: {{doNumber}}\n\nPlease proceed with equipment collection and office delivery.\n\nBest regards,\n{{country}} Case Booking System"}:e===il.sf.ORDER_PREPARED?r={subject:"\ud83d\udce6 Order Ready for Delivery: {{caseReference}} - {{hospital}}",body:"Dear Delivery Team,\n\nThe order has been prepared and is ready for delivery to the hospital.\n\n\ud83d\udccb Case Details:\n\u2022 Case Reference: {{caseReference}}\n\u2022 Hospital: {{hospital}}\n\u2022 Department: {{department}}\n\u2022 Surgery Date: {{dateOfSurgery}}\n\u2022 Surgery Time: {{timeOfProcedure}}\n\u2022 Doctor: {{doctorName}}\n\u2022 Prepared by: {{processedBy}}\n\n\ud83d\udce6 Order Details:\n{{processOrderDetails}}\n\n\ud83d\udce6 Equipment Ready:\n\u2022 Surgery Sets: {{surgerySetSelection}}\n\u2022 Implant Boxes: {{implantBox}}\n\n\ud83d\udcac Special Instructions:\n{{specialInstruction}}\n\nPlease proceed with delivery to hospital.\n\nBest regards,\n{{country}} Case Booking System"}:e===il.sf.DELIVERED_HOSPITAL?r={subject:"\ud83c\udfe5 Delivered to Hospital: {{caseReference}} - {{hospital}}",body:"Dear Team,\n\nThe equipment has been successfully delivered to the hospital.\n\n\ud83d\udccb Case Details:\n\u2022 Case Reference: {{caseReference}}\n\u2022 Hospital: {{hospital}}\n\u2022 Department: {{department}}\n\u2022 Surgery Date: {{dateOfSurgery}}\n\u2022 Doctor: {{doctorName}}\n\u2022 Delivered by: {{processedBy}}\n\n\ud83d\udce6 Delivery Details:\n{{deliveryDetails}}\n\nThe surgical team can now proceed with the case.\n\nBest regards,\n{{country}} Case Booking System"}:e===il.sf.ORDER_PREPARATION?r={subject:"\ud83d\udccb Order Preparation Started: {{caseReference}} - {{hospital}}",body:"Dear Operations Team,\n\nOrder preparation has started for the following case.\n\n\ud83d\udccb Case Details:\n\u2022 Case Reference: {{caseReference}}\n\u2022 Hospital: {{hospital}}\n\u2022 Department: {{department}}\n\u2022 Surgery Date: {{dateOfSurgery}}\n\u2022 Surgery Time: {{timeOfProcedure}}\n\u2022 Doctor: {{doctorName}}\n\u2022 Started by: {{processedBy}}\n\n\ud83d\udce6 Equipment to Prepare:\n\u2022 Surgery Sets: {{surgerySetSelection}}\n\u2022 Implant Boxes: {{implantBox}}\n\n\ud83d\udcac Special Instructions:\n{{specialInstruction}}\n\nPlease proceed with order preparation.\n\nBest regards,\n{{country}} Case Booking System"}:e===il.sf.PENDING_DELIVERY_HOSPITAL?r={subject:"\ud83d\ude9a Pending Hospital Delivery: {{caseReference}} - {{hospital}}",body:"Dear Delivery Team,\n\nThe following order is ready and pending delivery to the hospital.\n\n\ud83d\udccb Case Details:\n\u2022 Case Reference: {{caseReference}}\n\u2022 Hospital: {{hospital}}\n\u2022 Department: {{department}}\n\u2022 Surgery Date: {{dateOfSurgery}}\n\u2022 Surgery Time: {{timeOfProcedure}}\n\u2022 Doctor: {{doctorName}}\n\n\ud83d\udce6 Ready for Delivery:\n\u2022 Surgery Sets: {{surgerySetSelection}}\n\u2022 Implant Boxes: {{implantBox}}\n\nPlease coordinate delivery with the hospital.\n\nBest regards,\n{{country}} Case Booking System"}:e===il.sf.PENDING_DELIVERY_OFFICE?r={subject:"\ud83c\udfe2 Pending Office Delivery: {{caseReference}} - Equipment Return",body:"Dear Collection Team,\n\nThe following case equipment is ready for collection and return to office.\n\n\ud83d\udccb Case Details:\n\u2022 Case Reference: {{caseReference}}\n\u2022 Hospital: {{hospital}}\n\u2022 Department: {{department}}\n\u2022 Surgery Date: {{dateOfSurgery}}\n\u2022 Doctor: {{doctorName}}\n\u2022 Completed by: {{processedBy}}\n\n\ud83d\udcdd Case Summary:\n{{orderSummary}}\n\n\ud83d\udcc4 DO Number: {{doNumber}}\n\nPlease coordinate equipment collection from the hospital.\n\nBest regards,\n{{country}} Case Booking System"}:e===il.sf.DELIVERED_OFFICE?r={subject:"\u2705 Equipment Returned to Office: {{caseReference}}",body:"Dear Team,\n\nThe equipment has been successfully returned to the office.\n\n\ud83d\udccb Case Details:\n\u2022 Case Reference: {{caseReference}}\n\u2022 Hospital: {{hospital}}\n\u2022 Department: {{department}}\n\u2022 Surgery Date: {{dateOfSurgery}}\n\u2022 Doctor: {{doctorName}}\n\u2022 Returned by: {{processedBy}}\n\n\ud83d\udcc4 DO Number: {{doNumber}}\n\nThe case is now ready for billing.\n\nBest regards,\n{{country}} Case Booking System"}:e===il.sf.TO_BE_BILLED?r={subject:"\ud83d\udcb0 Ready for Billing: {{caseReference}} - {{hospital}}",body:"Dear Billing Team,\n\nThe following case is ready for billing and invoicing.\n\n\ud83d\udccb Case Details:\n\u2022 Case Reference: {{caseReference}}\n\u2022 Hospital: {{hospital}}\n\u2022 Department: {{department}}\n\u2022 Surgery Date: {{dateOfSurgery}}\n\u2022 Doctor: {{doctorName}}\n\u2022 DO Number: {{doNumber}}\n\u2022 Processed by: {{processedBy}}\n\nPlease proceed with billing process.\n\nBest regards,\n{{country}} Case Booking System"}:e===il.sf.CASE_CLOSED?r={subject:"\ud83d\udcc1 Case Closed: {{caseReference}} - {{hospital}}",body:"Dear Team,\n\nThe following case has been officially closed.\n\n\ud83d\udccb Case Details:\n\u2022 Case Reference: {{caseReference}}\n\u2022 Hospital: {{hospital}}\n\u2022 Department: {{department}}\n\u2022 Surgery Date: {{dateOfSurgery}}\n\u2022 Doctor: {{doctorName}}\n\u2022 Closed by: {{processedBy}}\n\n\ud83d\udcc4 DO Number: {{doNumber}}\n\nThe case has been archived and the billing process is complete.\n\nBest regards,\n{{country}} Case Booking System"}:e===il.sf.CASE_CANCELLED&&(r={subject:"\u274c Case Cancelled: {{caseReference}} - {{hospital}}",body:"Dear Team,\n\nThe following case has been cancelled.\n\n\ud83d\udccb Case Details:\n\u2022 Case Reference: {{caseReference}}\n\u2022 Hospital: {{hospital}}\n\u2022 Department: {{department}}\n\u2022 Surgery Date: {{dateOfSurgery}}\n\u2022 Doctor: {{doctorName}}\n\u2022 Cancelled by: {{processedBy}}\n\n\ud83d\udcac Cancellation Reason:\n{{processOrderDetails}}\n\nPlease take appropriate action regarding any prepared equipment.\n\nBest regards,\n{{country}} Case Booking System"}),{status:e,enabled:t,recipients:{roles:n,specificEmails:[],includeSubmitter:e===il.sf.CASE_BOOKED,departmentFilter:[],requireSameDepartment:!1,adminOverride:!0,adminGlobalAccess:!0,legacyRoleMapping:{"operation-manager":"operations-manager"}},template:r,conditions:{countryRestrictions:[],timeRestrictions:{weekdaysOnly:!1}}}})}),[]);(0,r.useEffect)(()=>{if(!n&&A.length>0&&_){var e;const t=(null===_||void 0===_?void 0:_.selectedCountry)||(null===_||void 0===_||null===(e=_.countries)||void 0===e?void 0:e[0])||A[0];a(t)}},[_,n,A]),(0,r.useEffect)(()=>{var e,t,r,a;if(!n)return;const s=(0,uc.AJ)(n,"google"),o=(0,uc.AJ)(n,"microsoft"),i=(0,uc.Dg)(n,"google"),c=(0,uc.Dg)(n,"microsoft"),d=localStorage.getItem("simplified_email_configs");let u={};if(d)try{u=JSON.parse(d)}catch(g){console.error("Failed to parse saved email configs:",g)}const h=u[n],p={country:n,providers:{google:{provider:"google",isAuthenticated:!!s&&!(0,uc.Hm)(s),tokens:s||void 0,userInfo:i||void 0,fromName:(null===h||void 0===h||null===(e=h.providers)||void 0===e||null===(t=e.google)||void 0===t?void 0:t.fromName)||"Case Booking System"},microsoft:{provider:"microsoft",isAuthenticated:!!o&&!(0,uc.Hm)(o),tokens:o||void 0,userInfo:c||void 0,fromName:(null===h||void 0===h||null===(r=h.providers)||void 0===r||null===(a=r.microsoft)||void 0===a?void 0:a.fromName)||"Case Booking System"}}};p.providers.google.isAuthenticated?p.activeProvider="google":p.providers.microsoft.isAuthenticated&&(p.activeProvider="microsoft"),l(e=>(0,f.A)((0,f.A)({},e),{},{[n]:p}));const m=localStorage.getItem("email-matrix-configs-by-country");if(m)try{const e=JSON.parse(m);if(S(e),!e[n]){const e=O(n);S(t=>(0,f.A)((0,f.A)({},t),{},{[n]:e}))}}catch(g){console.error("Failed to load email matrix configurations:",g);const e=O(n);S(t=>(0,f.A)((0,f.A)({},t),{},{[n]:e}))}else{const e=O(n);S(t=>(0,f.A)((0,f.A)({},t),{},{[n]:e}))}},[n,O]);const P=async e=>{if(!n)return void E("No Country Selected","Please select a country first");if(!("google"===e?"your-prod-google-client-id":"766ea716-3e33-41a9-b780-c23203f5562b")){const t=e.charAt(0).toUpperCase()+e.slice(1);return h("".concat(t," OAuth is not configured. Please check your environment variables.")),void E("OAuth Not Configured","".concat(t," client ID is missing. Please set up OAuth credentials first."))}d(t=>(0,f.A)((0,f.A)({},t),{},{[e]:!0})),h("");try{var t,r,a,o,i;console.log("[OAuth] Starting ".concat(e," authentication for ").concat(n,"...")),console.log("[OAuth] Environment check:",{clientId:"microsoft"===e?(null===(t="766ea716-3e33-41a9-b780-c23203f5562b")?void 0:t.substring(0,8))+"...":(null===(r="your-prod-google-client-id")?void 0:r.substring(0,8))+"...",redirectUri:"".concat(window.location.origin,"/auth/callback"),currentOrigin:window.location.origin});const{tokens:c,userInfo:d}=await(0,uc.YC)(e,n);console.log("[OAuth] Authentication successful:",{provider:e,email:d.email,hasAccessToken:!!c.accessToken});const u=(0,f.A)((0,f.A)({},s),{},{[n]:(0,f.A)((0,f.A)({},s[n]),{},{providers:(0,f.A)((0,f.A)({},null===(a=s[n])||void 0===a?void 0:a.providers),{},{[e]:{provider:e,isAuthenticated:!0,userInfo:d,tokens:c,fromName:(null===(o=s[n])||void 0===o||null===(i=o.providers[e])||void 0===i?void 0:i.fromName)||"Case Booking System"}}),activeProvider:e})});l(u),localStorage.setItem("simplified_email_configs",JSON.stringify(u)),k.success(),C("Authentication Successful","Successfully authenticated with ".concat(e.charAt(0).toUpperCase()+e.slice(1)," as ").concat(d.email))}catch(c){console.error("Authentication failed - Full error:",c);let e="Authentication failed";c instanceof Error&&(e=c.message,c.message.includes("Token exchange failed")?e="Failed to exchange authorization code for tokens. Please check your OAuth configuration.":c.message.includes("Failed to get user info")?e="Authentication succeeded but failed to retrieve user information. Please try again.":c.message.includes("Popup blocked")?e="Popup was blocked. Please allow popups for this site and try again.":c.message.includes("Authentication cancelled")&&(e="Authentication was cancelled. Please try again.")),h(e),E("Authentication Failed",e)}finally{d(t=>(0,f.A)((0,f.A)({},t),{},{[e]:!1}))}},R=e=>{n&&((0,uc.SZ)(n,e),l(t=>{var r,a,s,o,i;return(0,f.A)((0,f.A)({},t),{},{[n]:(0,f.A)((0,f.A)({},t[n]),{},{providers:(0,f.A)((0,f.A)({},null===(r=t[n])||void 0===r?void 0:r.providers),{},{[e]:{provider:e,isAuthenticated:!1,fromName:(null===(a=t[n])||void 0===a||null===(s=a.providers[e])||void 0===s?void 0:s.fromName)||"Case Booking System"}}),activeProvider:(null===(o=t[n])||void 0===o?void 0:o.activeProvider)===e||null===(i=t[n])||void 0===i?void 0:i.activeProvider})})}),k.click(),C("Disconnected","Successfully disconnected from ".concat(e.charAt(0).toUpperCase()+e.slice(1))))},M=(e,t)=>{n&&l(r=>{var a,s;return(0,f.A)((0,f.A)({},r),{},{[n]:(0,f.A)((0,f.A)({},r[n]),{},{providers:(0,f.A)((0,f.A)({},null===(a=r[n])||void 0===a?void 0:a.providers),{},{[e]:(0,f.A)((0,f.A)({},null===(s=r[n])||void 0===s?void 0:s.providers[e]),{},{fromName:t})})})})})},L=(e,t)=>{if(!n||!w[n])return;const r=(0,f.A)((0,f.A)({},w[n]),{},{rules:w[n].rules.map((n,r)=>r===e?(0,f.A)((0,f.A)({},n),t):n)});S(e=>(0,f.A)((0,f.A)({},e),{},{[n]:r}))};if(!D)return(0,i.jsx)("div",{className:"email-config-container",children:(0,i.jsxs)("div",{className:"permission-denied-message",children:[(0,i.jsx)("h3",{children:"Access Denied"}),(0,i.jsx)("p",{children:"You don't have permission to configure email settings."}),(0,i.jsx)("p",{children:"Please contact your administrator to request access."})]})});const F=s[n],B=!0,U=!0;return(0,i.jsxs)("div",{className:"email-config-container",children:[(0,i.jsxs)("div",{className:"email-config-header",children:[(0,i.jsx)("h3",{style:{fontSize:"1.2rem",marginBottom:"0.5rem"},children:"\ud83d\udce7 Email Configuration"}),(0,i.jsx)("p",{style:{fontSize:"0.9rem",color:"#6c757d"},children:"Configure email providers for automated notifications"}),I&&(0,i.jsxs)("div",{className:"country-selection",style:{marginTop:"1rem"},children:[(0,i.jsx)("label",{style:{fontSize:"0.9rem",fontWeight:"500",marginBottom:"0.5rem",display:"block"},children:"Select Country:"}),(0,i.jsxs)("select",{value:n,onChange:e=>a(e.target.value),className:"form-control",style:{maxWidth:"200px"},children:[(0,i.jsx)("option",{value:"",children:"Select a country..."}),A.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]})]}),n&&!I&&(0,i.jsxs)("div",{className:"current-country-badge",children:[(0,i.jsx)("span",{className:"country-label",children:"Configuration for:"}),(0,i.jsx)("span",{className:"country-name",children:n})]})]}),n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"config-section",children:[(0,i.jsxs)("div",{className:"section-header collapsible-header",onClick:()=>m(!p),style:{cursor:"pointer"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,i.jsx)("h3",{children:"\ud83d\udd10 Email Provider Authentication"}),null!==F&&void 0!==F&&F.activeProvider?(0,i.jsxs)("div",{className:"provider-status-badge-inline",children:[(0,i.jsx)("span",{className:"status-icon",children:"\u2705"}),(0,i.jsxs)("span",{style:{fontSize:"0.85rem"},children:[F.activeProvider.charAt(0).toUpperCase()+F.activeProvider.slice(1)," Active"]})]}):(0,i.jsxs)("div",{className:"provider-status-badge-inline",children:[(0,i.jsx)("span",{className:"status-icon",children:"\u26a0\ufe0f"}),(0,i.jsx)("span",{style:{fontSize:"0.85rem"},children:"Not Configured"})]})]}),(0,i.jsx)("span",{className:"chevron ".concat(p?"collapsed":"expanded"),children:p?"\u25b6":"\u25bc"})]}),!p&&(0,i.jsxs)("div",{className:"section-content",children:[(0,i.jsx)("p",{style:{marginBottom:"2rem",color:"#6c757d"},children:"Authenticate with your email provider to enable automated notifications"}),u&&(0,i.jsxs)("div",{className:"alert alert-danger",children:[(0,i.jsx)("strong",{children:"Authentication Error:"})," ",u,(0,i.jsxs)("details",{style:{marginTop:"10px"},children:[(0,i.jsx)("summary",{style:{cursor:"pointer",fontSize:"0.9rem"},children:"Show Debug Info"}),(0,i.jsxs)("div",{style:{marginTop:"8px",fontSize:"0.8rem",fontFamily:"monospace"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Country:"})," ",n]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Google Configured:"})," ","Yes"]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Microsoft Configured:"})," ","Yes"]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"User Agent:"})," ",navigator.userAgent.substring(0,100),"..."]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Popup Support:"})," ","function"===typeof window.open?"Yes":"No"]})]})]})]}),(0,i.jsxs)("div",{className:"provider-card",children:[(0,i.jsxs)("div",{className:"provider-header",children:[(0,i.jsxs)("div",{className:"provider-info",children:[(0,i.jsx)("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTIyLjU2IDEyLjI1QzIyLjU2IDExLjQ3IDIyLjQ5IDEwLjcyIDIyLjM2IDEwSDEyVjE0LjI2SDE3LjkyQzE3LjY2IDE1LjYzIDE2Ljg3IDE2Ljc4IDE1LjY2IDE3LjQ4VjIwLjI2SDE5LjI3QzIxLjMgMTguNDMgMjIuNTYgMTUuNiAyMi41NiAxMi4yNVoiIGZpbGw9IiM0Mjg1RjQiLz4KPHBhdGggZD0iTTEyIDIzQzE1LjI0IDIzIDE3LjQ1IDIxLjkyIDE5LjI3IDE5Ljk4TDE1LjY2IDE3LjJDMTQuNTQgMTcuNzUgMTMuMzIgMTguMDggMTIgMTguMDhDOC44NyAxOC4wOCA2LjM1IDE2LjUgNS40MiAxNC4ySDEuNzJWMTYuOTdDMy41OCAyMC43OSA3LjU0IDIzIDEyIDIzWiIgZmlsbD0iIzM0QTg1MyIvPgo8cGF0aCBkPSJNNS40MiAxMi45MkM1LjIgMTIuMzcgNS4wOCAxMS43OCA1LjA4IDExLjE3QzUuMDggMTAuNTYgNS4yIDkuOTcgNS40MiA5LjQyVjYuNjVIMS43MkMxLjEgOC4xNyAwLjc0IDkuODMgMC43NCAxMS4xN0MwLjc0IDEyLjUxIDEuMSAxNC4xNyAxLjcyIDE1LjY5TDQuNzMgMTMuNDJMNS40MiAxMi45MloiIGZpbGw9IiNGQkJDMDQiLz4KPHBhdGggZD0iTTEyIDQuOTJDMTMuNTcgNC45MiAxNC45NiA1LjUxIDE2LjAzIDYuNTJMMTkuMjUgMy4zQzE3LjQ1IDEuNjQgMTUuMjQgMC41IDEyIDAuNUM3LjU0IDAuNSAzLjU4IDIuNzEgMS43MiA2LjUzTDUuNDIgOS4zQzYuMzUgNyAxMS44NyA0LjkyIDEyIDQuOTJaIiBmaWxsPSIjRUE0MzM1Ii8+Cjwvc3ZnPgo=",alt:"Google",className:"provider-icon"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{children:"Google Gmail"}),(0,i.jsx)("p",{children:"Send emails through Gmail API"})]})]}),null!==F&&void 0!==F&&F.providers.google.isAuthenticated?(0,i.jsxs)("div",{className:"auth-status authenticated",children:[(0,i.jsx)("span",{className:"status-icon",children:"\u2705"}),(0,i.jsxs)("div",{className:"auth-info",children:[(0,i.jsx)("div",{children:"Authenticated as:"}),(0,i.jsx)("strong",{children:null===(e=F.providers.google.userInfo)||void 0===e?void 0:e.email})]})]}):(0,i.jsxs)("div",{className:"auth-status not-authenticated",children:[(0,i.jsx)("span",{className:"status-icon",children:"\u274c"}),(0,i.jsx)("div",{children:"Not authenticated"})]})]}),(0,i.jsx)("div",{className:"provider-actions",children:null!==F&&void 0!==F&&F.providers.google.isAuthenticated?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"From Name:"}),(0,i.jsx)("input",{type:"text",value:F.providers.google.fromName,onChange:e=>M("google",e.target.value),className:"form-control",placeholder:"Case Booking System"})]}),(0,i.jsx)("button",{onClick:()=>R("google"),className:"btn btn-outline-danger btn-sm",children:"Disconnect"})]}):(0,i.jsxs)(i.Fragment,{children:[!1,(0,i.jsx)("button",{onClick:()=>P("google"),disabled:c.google||!1,className:"btn btn-primary",children:c.google?(0,i.jsx)(i.Fragment,{children:"\ud83d\udd04 Authenticating..."}):(0,i.jsx)(i.Fragment,{children:"\ud83d\udd10 Authenticate with Google"})})]})})]}),(0,i.jsxs)("div",{className:"provider-card",children:[(0,i.jsxs)("div",{className:"provider-header",children:[(0,i.jsxs)("div",{className:"provider-info",children:[(0,i.jsx)("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjExIiBoZWlnaHQ9IjExIiBmaWxsPSIjRjI1MDIyIi8+CjxyZWN0IHg9IjEzIiB3aWR0aD0iMTEiIGhlaWdodD0iMTEiIGZpbGw9IiM3RkJBMDAiLz4KPHJlY3QgeT0iMTMiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSIgZmlsbD0iIzAwQTRFRiIvPgo8cmVjdCB4PSIxMyIgeT0iMTMiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSIgZmlsbD0iI0ZGQjkwMCIvPgo8L3N2Zz4K",alt:"Microsoft",className:"provider-icon"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h4",{children:"Microsoft Outlook"}),(0,i.jsx)("p",{children:"Send emails through Outlook/Office 365"})]})]}),null!==F&&void 0!==F&&F.providers.microsoft.isAuthenticated?(0,i.jsxs)("div",{className:"auth-status authenticated",children:[(0,i.jsx)("span",{className:"status-icon",children:"\u2705"}),(0,i.jsxs)("div",{className:"auth-info",children:[(0,i.jsx)("div",{children:"Authenticated as:"}),(0,i.jsx)("strong",{children:null===(t=F.providers.microsoft.userInfo)||void 0===t?void 0:t.email})]})]}):(0,i.jsxs)("div",{className:"auth-status not-authenticated",children:[(0,i.jsx)("span",{className:"status-icon",children:"\u274c"}),(0,i.jsx)("div",{children:"Not authenticated"})]})]}),(0,i.jsx)("div",{className:"provider-actions",children:null!==F&&void 0!==F&&F.providers.microsoft.isAuthenticated?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{children:"From Name:"}),(0,i.jsx)("input",{type:"text",value:F.providers.microsoft.fromName,onChange:e=>M("microsoft",e.target.value),className:"form-control",placeholder:"Case Booking System"})]}),(0,i.jsx)("button",{onClick:()=>R("microsoft"),className:"btn btn-outline-danger btn-sm",children:"Disconnect"})]}):(0,i.jsxs)(i.Fragment,{children:[!1,(0,i.jsx)("button",{onClick:()=>P("microsoft"),disabled:c.microsoft||!1,className:"btn btn-primary",children:c.microsoft?(0,i.jsx)(i.Fragment,{children:"\ud83d\udd04 Authenticating..."}):(0,i.jsx)(i.Fragment,{children:"\ud83d\udd10 Authenticate with Microsoft"})})]})})]}),(0,i.jsxs)("div",{className:"config-actions",style:{marginTop:"2rem",paddingTop:"1.5rem",borderTop:"1px solid #e9ecef"},children:[(0,i.jsx)("button",{onClick:()=>{if(!n)return void E("No Country Selected","Please select a country first");s[n]?(localStorage.setItem("simplified_email_configs",JSON.stringify(s)),k.success(),C("Configuration Saved","Email settings for ".concat(n," have been saved"))):E("No Configuration","No email provider configuration found for this country")},disabled:!(null!==F&&void 0!==F&&F.providers.google.isAuthenticated)&&!(null!==F&&void 0!==F&&F.providers.microsoft.isAuthenticated),className:"btn btn-success",title:null!==F&&void 0!==F&&F.providers.google.isAuthenticated||null!==F&&void 0!==F&&F.providers.microsoft.isAuthenticated?"Save email configuration including From Name settings":"Please authenticate with at least one email provider first",children:"\ud83d\udcbe Save Configuration"}),(0,i.jsx)("button",{onClick:async()=>{var e;if(!n||null===F||void 0===F||!F.activeProvider)return void E("No Provider Selected","Please authenticate with an email provider first");const t=F.activeProvider,r=F.providers[t];if(r.isAuthenticated&&r.tokens)if(null!==(e=r.userInfo)&&void 0!==e&&e.email)try{var a;C("Sending Test Email","Preparing test email..."),console.log("Test Email Details:",{provider:t,country:n,fromName:r.fromName,userEmail:null===(a=r.userInfo)||void 0===a?void 0:a.email,testEmailSubject:"Test Email from Case Booking System",testEmailBody:"This is a test email to verify your email configuration is working correctly."});const e=(0,uc.createOAuthManager)(t);if(!r.tokens||(0,uc.Hm)(r.tokens))throw new Error("Access token has expired. Please re-authenticate.");const s={to:[r.userInfo.email],subject:"Test Email from ".concat(r.fromName),body:"\n          <h2>\u2705 Email Configuration Test</h2>\n          <p>This is a test email to verify your email configuration is working correctly.</p>\n          \n          <h3>Configuration Details:</h3>\n          <ul>\n            <li><strong>Provider:</strong> ".concat(t.charAt(0).toUpperCase()+t.slice(1),"</li>\n            <li><strong>Country:</strong> ").concat(n,"</li>\n            <li><strong>From Name:</strong> ").concat(r.fromName,"</li>\n            <li><strong>Send Time:</strong> ").concat((new Date).toLocaleString(),'</li>\n          </ul>\n          \n          <p><em>If you received this email, your email configuration is working properly!</em></p>\n          \n          <hr>\n          <p style="color: #666; font-size: 12px;">\n            This test email was sent from the Case Booking System email configuration.\n          </p>\n        ')};if(!await e.sendEmail(r.tokens.accessToken,s))throw new Error("Email sending failed - API returned false");k.success(),C("Test Email Sent Successfully! \ud83d\udce7","Test email sent to ".concat(r.userInfo.email," via ").concat(t.charAt(0).toUpperCase()+t.slice(1)))}catch(s){console.error("Test email failed:",s);const e=s instanceof Error?s.message:"Unknown error occurred";e.includes("expired")?E("Authentication Expired","Your authentication has expired. Please re-authenticate and try again."):e.includes("blocked")||e.includes("permission")?E("Permission Denied","Email sending permission denied. Please check your OAuth consent settings."):E("Test Email Failed","Unable to send test email: ".concat(e))}else E("No Email Address","User email address not found. Please re-authenticate to get your email address.");else E("Not Authenticated","Please authenticate with ".concat(t.charAt(0).toUpperCase()+t.slice(1)," first"))},disabled:!(null!==F&&void 0!==F&&F.activeProvider),className:"btn btn-warning",children:"\ud83d\udce7 Test Email"}),(0,i.jsx)("button",{onClick:()=>{console.log("Debug Info:",{selectedCountry:n,currentConfig:F,isGoogleConfigured:B,isMicrosoftConfigured:U,emailConfigs:s}),C("Debug Info","Check console for detailed debug information")},className:"btn btn-outline-secondary btn-sm",children:"\ud83d\udc1b Debug"})]})]})]}),(0,i.jsxs)("div",{className:"config-section",children:[(0,i.jsxs)("div",{className:"section-header collapsible-header",onClick:()=>v(!g),style:{cursor:"pointer"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,i.jsx)("h3",{children:"\ud83d\udcee Email Notification Rules"}),w[n]&&(0,i.jsxs)("div",{className:"provider-status-badge-inline",children:[(0,i.jsx)("span",{className:"status-icon",children:"\ud83d\udcca"}),(0,i.jsxs)("span",{style:{fontSize:"0.85rem"},children:[w[n].rules.filter(e=>e.enabled).length," of ",w[n].rules.length," Active"]})]})]}),(0,i.jsx)("span",{className:"chevron ".concat(g?"collapsed":"expanded"),children:g?"\u25b6":"\u25bc"})]}),!g&&(0,i.jsxs)("div",{className:"section-content",children:[(0,i.jsxs)("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"#e3f2fd",borderRadius:"8px",border:"1px solid #2196f3"},children:[(0,i.jsx)("h4",{style:{color:"#1976d2",margin:"0 0 0.5rem 0"},children:"\ud83d\udccb Configure Status-Based Email Notifications"}),(0,i.jsx)("p",{style:{margin:"0",color:"#37474f",fontSize:"0.9rem"},children:"Set up automatic email notifications for each case status change. Configure who receives notifications and customize email templates."})]}),(0,i.jsxs)("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"#e8f5e8",borderRadius:"8px",border:"2px solid #4caf50",borderLeft:"6px solid #4caf50"},children:[(0,i.jsxs)("h5",{style:{color:"#2e7d32",margin:"0 0 0.5rem 0",display:"flex",alignItems:"center",gap:"0.5rem"},children:["\ud83c\udd95 ",(0,i.jsx)("strong",{children:"New Case Notifications"})]}),(0,i.jsxs)("p",{style:{margin:"0",color:"#1b5e20",fontSize:"0.9rem"},children:[(0,i.jsx)("strong",{children:'"Case Booked"'})," notifications are automatically enabled and pre-configured to notify operations teams when new cases are submitted. This ensures immediate awareness of new case bookings requiring attention."]})]}),w[n]&&(0,i.jsxs)("div",{className:"notification-matrix",children:[w[n].rules.map((e,t)=>{const n=!1!==N[t],r=_i().map(e=>e.id),a=e.status===il.sf.CASE_BOOKED;return(0,i.jsxs)("div",{className:"notification-rule",style:{border:a?"2px solid #4caf50":"1px solid #dee2e6",borderRadius:"8px",marginBottom:"1rem",padding:"1rem",background:e.enabled?a?"#e8f5e8":"#f8f9fa":"#ffffff",position:"relative"},children:[a&&(0,i.jsx)("div",{style:{position:"absolute",top:"-10px",right:"15px",background:"#4caf50",color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"0.75rem",fontWeight:"bold"},children:"\ud83c\udd95 NEW CASES"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:e.enabled&&!n?"1rem":"0",cursor:e.enabled?"pointer":"default"},onClick:e.enabled?()=>{return e=t,j(t=>(0,f.A)((0,f.A)({},t),{},{[e]:!t[e]})),void k.click();var e}:void 0,children:[(0,i.jsxs)("h5",{style:{margin:"0",color:a?"#2e7d32":"#495057",display:"flex",alignItems:"center",gap:"0.5rem",fontWeight:a?"bold":"normal"},children:[a?"\ud83c\udd95":"\ud83d\udcca"," ",e.status,e.enabled&&(0,i.jsx)("span",{style:{fontSize:"0.8rem",transform:n?"rotate(-90deg)":"rotate(0deg)",transition:"transform 0.2s ease",color:"#6c757d",marginLeft:"0.5rem"},children:"\u25bc"})]}),(0,i.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:"0",cursor:"pointer"},children:[(0,i.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:e=>{L(t,{enabled:e.target.checked})},style:{transform:"scale(1.2)"},onClick:e=>e.stopPropagation()}),(0,i.jsx)("span",{style:{fontWeight:"500",color:e.enabled?"#28a745":"#6c757d"},children:e.enabled?"Enabled":"Disabled"})]})]}),e.enabled&&!n&&(0,i.jsxs)("div",{style:{paddingLeft:"1rem",borderLeft:"3px solid #28a745"},children:[(0,i.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,i.jsx)("label",{style:{display:"block",fontWeight:"600",marginBottom:"0.5rem",color:"#495057"},children:"\ud83d\udce7 Email Subject"}),(0,i.jsx)("input",{type:"text",value:e.template.subject,onChange:n=>L(t,{template:(0,f.A)((0,f.A)({},e.template),{},{subject:n.target.value})}),className:"form-control",placeholder:"Email subject line"})]}),(0,i.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,i.jsx)("label",{style:{display:"block",fontWeight:"600",marginBottom:"0.5rem",color:"#495057"},children:"\ud83d\udcdd Email Body Template"}),(0,i.jsx)("textarea",{value:e.template.body,onChange:n=>L(t,{template:(0,f.A)((0,f.A)({},e.template),{},{body:n.target.value})}),className:"form-control",rows:4,placeholder:"Email body template (use {{caseReference}}, {{hospital}}, {{date}} as placeholders)"})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(oe,{id:"roles-".concat(t),label:"\ud83d\udc65 Notify User Roles",options:r,value:e.recipients.roles,onChange:n=>{L(t,{recipients:(0,f.A)((0,f.A)({},e.recipients),{},{roles:n})})},placeholder:"Select user roles to notify..."}),(0,i.jsxs)("div",{style:{marginTop:"1rem"},children:[(0,i.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,i.jsx)("input",{type:"checkbox",checked:e.recipients.includeSubmitter,onChange:n=>L(t,{recipients:(0,f.A)((0,f.A)({},e.recipients),{},{includeSubmitter:n.target.checked})}),style:{transform:"scale(1.1)"}}),(0,i.jsx)("span",{style:{fontWeight:"500",color:"#495057"},children:"\ud83d\udcdd Include Case Submitter"})]}),(0,i.jsx)("small",{style:{color:"#6c757d",fontSize:"0.8rem",marginLeft:"1.5rem"},children:"Automatically notify the person who submitted the case"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",fontWeight:"600",marginBottom:"0.5rem",color:"#495057"},children:"\ud83d\udcee Additional Email Addresses"}),(0,i.jsx)("textarea",{value:e.recipients.specificEmails.join("\n"),onChange:n=>{const r=n.target.value.split("\n").filter(e=>e.trim());L(t,{recipients:(0,f.A)((0,f.A)({},e.recipients),{},{specificEmails:r})})},className:"form-control",rows:4,placeholder:"Enter email addresses (one per line)\nexample@company.com\nmanager@company.com"}),(0,i.jsx)("small",{style:{color:"#6c757d",fontSize:"0.8rem"},children:"One email address per line"})]})]}),(0,i.jsxs)("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:[(0,i.jsx)("h5",{style:{color:"#495057",fontSize:"0.9rem",margin:"0 0 1rem 0",fontWeight:"600"},children:"\ud83c\udfe5 Department-Based Filtering"}),(0,i.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,i.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[(0,i.jsx)("input",{type:"checkbox",checked:e.recipients.requireSameDepartment,onChange:n=>L(t,{recipients:(0,f.A)((0,f.A)({},e.recipients),{},{requireSameDepartment:n.target.checked})}),style:{transform:"scale(1.1)"}}),(0,i.jsx)("span",{style:{fontWeight:"500",color:"#495057"},children:"\ud83c\udfaf Only notify users with access to case department"})]}),(0,i.jsx)("small",{style:{color:"#6c757d",fontSize:"0.8rem",marginLeft:"1.5rem"},children:"Users must have the same department as the case to receive notifications"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(oe,{id:"departments-".concat(t),label:"\ud83c\udfe5 Additional Department Filter (Optional)",options:o.uy,value:e.recipients.departmentFilter,onChange:n=>{L(t,{recipients:(0,f.A)((0,f.A)({},e.recipients),{},{departmentFilter:n})})},placeholder:"Select specific departments to include..."}),(0,i.jsx)("small",{style:{color:"#6c757d",fontSize:"0.8rem"},children:"If specified, only users in these departments will be notified (in addition to department access requirement above)"})]})]})]})]},e.status)}),(0,i.jsx)("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end",marginTop:"2rem",paddingTop:"1rem",borderTop:"2px solid #dee2e6"},children:(0,i.jsx)("button",{onClick:()=>{n&&(localStorage.setItem("email-matrix-configs-by-country",JSON.stringify(w)),k.success(),C("Notification Rules Saved","Email notification rules for ".concat(n," have been saved successfully")))},className:"btn btn-primary btn-lg",style:{padding:"12px 24px",fontSize:"16px",fontWeight:"600",minWidth:"200px",whiteSpace:"nowrap"},title:"Save notification matrix configuration",children:"\ud83d\udcbe Save Notification Rules"})})]})]})]}),(0,i.jsxs)("div",{className:"config-section",children:[(0,i.jsxs)("div",{className:"section-header collapsible-header",onClick:()=>x(!y),style:{cursor:"pointer"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,i.jsx)("h3",{children:"\ud83d\udcdd Template Variables Reference"}),(0,i.jsxs)("div",{className:"provider-status-badge-inline",children:[(0,i.jsx)("span",{className:"status-icon",children:"\ud83d\udca1"}),(0,i.jsx)("span",{style:{fontSize:"0.85rem"},children:"Email Template Helper"})]})]}),(0,i.jsx)("span",{className:"chevron ".concat(y?"collapsed":"expanded"),children:y?"\u25b6":"\u25bc"})]}),!y&&(0,i.jsxs)("div",{className:"section-content",children:[(0,i.jsxs)("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"#f0f8ff",borderRadius:"8px",border:"1px solid #4fc3f7"},children:[(0,i.jsx)("h4",{style:{color:"#0277bd",margin:"0 0 0.5rem 0"},children:"\ud83d\udccb Available Template Variables"}),(0,i.jsx)("p",{style:{margin:"0",color:"#37474f",fontSize:"0.9rem"},children:"Use these variables in your email subject and body templates. They will be automatically replaced with actual case data when emails are sent."})]}),(0,i.jsxs)("div",{className:"template-variables-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[(0,i.jsxs)("div",{className:"variable-category",style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"1rem",background:"#fafafa"},children:[(0,i.jsx)("h5",{style:{color:"#1976d2",marginBottom:"1rem"},children:"\ud83d\udccb Basic Case Information"}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#e3f2fd",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#1565c0"},children:"{{caseReference}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Case Reference Number"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#e3f2fd",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#1565c0"},children:"{{hospital}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Hospital Name"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#e3f2fd",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#1565c0"},children:"{{department}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Department"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#e3f2fd",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#1565c0"},children:"{{country}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Country"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#e3f2fd",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#1565c0"},children:"{{status}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Current Status"})]})]}),(0,i.jsxs)("div",{className:"variable-category",style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"1rem",background:"#fafafa"},children:[(0,i.jsx)("h5",{style:{color:"#1976d2",marginBottom:"1rem"},children:"\ud83c\udfe5 Surgery Details"}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#e8f5e8",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#2e7d32"},children:"{{dateOfSurgery}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Surgery Date"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#e8f5e8",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#2e7d32"},children:"{{timeOfProcedure}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Surgery Time"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#e8f5e8",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#2e7d32"},children:"{{procedureType}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Procedure Type"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#e8f5e8",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#2e7d32"},children:"{{procedureName}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Procedure Name"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#e8f5e8",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#2e7d32"},children:"{{doctorName}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Doctor Name"})]})]}),(0,i.jsxs)("div",{className:"variable-category",style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"1rem",background:"#fafafa"},children:[(0,i.jsx)("h5",{style:{color:"#1976d2",marginBottom:"1rem"},children:"\ud83d\udc64 User & Timestamps"}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#fff3e0",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#f57c00"},children:"{{submittedBy}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Case Submitter"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#fff3e0",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#f57c00"},children:"{{submittedAt}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Submission Date/Time"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#fff3e0",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#f57c00"},children:"{{processedBy}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Last Processed By"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#fff3e0",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#f57c00"},children:"{{processedAt}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Last Processed Date/Time"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#fff3e0",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#f57c00"},children:"{{currentDateTime}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Current Date/Time"})]})]}),(0,i.jsxs)("div",{className:"variable-category",style:{border:"1px solid #e0e0e0",borderRadius:"8px",padding:"1rem",background:"#fafafa"},children:[(0,i.jsx)("h5",{style:{color:"#1976d2",marginBottom:"1rem"},children:"\ud83d\udcdd Additional Information"}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#f3e5f5",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#7b1fa2"},children:"{{specialInstruction}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Special Instructions"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#f3e5f5",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#7b1fa2"},children:"{{surgerySetSelection}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Surgery Sets (List)"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#f3e5f5",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#7b1fa2"},children:"{{implantBox}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Implant Boxes (List)"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#f3e5f5",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#7b1fa2"},children:"{{doNumber}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Delivery Order Number"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#f3e5f5",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#7b1fa2"},children:"{{orderSummary}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Order Summary"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#f3e5f5",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#7b1fa2"},children:"{{deliveryDetails}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Delivery Details"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#f3e5f5",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#7b1fa2"},children:"{{attachments}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Attached Files (List)"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#f3e5f5",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#7b1fa2"},children:"{{amendedBy}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Case Amended By"})]}),(0,i.jsxs)("div",{className:"variable-item",style:{marginBottom:"0.75rem"},children:[(0,i.jsx)("code",{className:"variable-code",style:{background:"#f3e5f5",padding:"2px 6px",borderRadius:"4px",fontSize:"0.9rem",fontWeight:"bold",color:"#7b1fa2"},children:"{{isAmended}}"}),(0,i.jsx)("span",{style:{marginLeft:"0.5rem",fontSize:"0.9rem",color:"#424242"},children:"Is Case Amended (Yes/No)"})]})]})]}),(0,i.jsxs)("div",{style:{background:"#e8f5e8",border:"1px solid #4caf50",borderRadius:"8px",padding:"1.5rem",marginBottom:"1rem"},children:[(0,i.jsx)("h5",{style:{color:"#2e7d32",marginBottom:"1rem"},children:"\ud83d\udca1 Usage Examples"}),(0,i.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,i.jsx)("strong",{style:{color:"#1976d2"},children:"Example Subject:"}),(0,i.jsxs)("div",{style:{background:"#f5f5f5",padding:"8px",borderRadius:"4px",marginTop:"4px",fontFamily:"monospace",fontSize:"0.9rem"},children:["Case Status Update: ","{{status}}"," - ","{{caseReference}}"," at ","{{hospital}}"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{style:{color:"#1976d2"},children:"Example Body:"}),(0,i.jsx)("div",{style:{background:"#f5f5f5",padding:"8px",borderRadius:"4px",marginTop:"4px",fontFamily:"monospace",fontSize:"0.9rem",whiteSpace:"pre-line"},children:"Dear Team,\n\nCase {{caseReference}} has been updated to status: {{status}}\n\nDetails:\n- Hospital: {{hospital}}\n- Department: {{department}}\n- Surgery Date: {{dateOfSurgery}}\n- Doctor: {{doctorName}}\n- Submitted by: {{submittedBy}}\n- Last updated: {{currentDateTime}}\n\nBest regards,\nCase Booking System"})]})]}),(0,i.jsxs)("div",{style:{background:"#fff3e0",border:"1px solid #ff9800",borderRadius:"6px",padding:"0.75rem",fontSize:"0.85rem",color:"#e65100"},children:[(0,i.jsx)("strong",{children:"\ud83d\udccc Note:"}),' Variables that don\'t have values will be replaced with "(Not specified)" or blank in the actual email.']})]})]})]})]})},pc=e=>{let{isOpen:t,onConfirm:n,onCancel:a,userName:s}=e;return(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&t&&a()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,a]),(0,r.useEffect)(()=>{const e=e=>{"Enter"===e.key&&t&&n()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,n]),t?(0,i.jsx)("div",{className:"logout-confirmation-overlay",onClick:a,children:(0,i.jsxs)("div",{className:"logout-confirmation-modal",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"logout-confirmation-header",children:[(0,i.jsx)("div",{className:"logout-icon",children:"\ud83d\udeaa"}),(0,i.jsx)("h3",{children:"Confirm Logout"})]}),(0,i.jsxs)("div",{className:"logout-confirmation-content",children:[(0,i.jsxs)("p",{children:["Are you sure you want to logout",s?", ".concat(s):"","?"]}),(0,i.jsxs)("div",{className:"logout-warning",children:[(0,i.jsx)("div",{className:"warning-icon",children:"\u26a0\ufe0f"}),(0,i.jsxs)("div",{className:"warning-text",children:[(0,i.jsx)("strong",{children:"Important:"})," You will need to log in again to access the system. Any unsaved work may be lost."]})]})]}),(0,i.jsxs)("div",{className:"logout-confirmation-actions",children:[(0,i.jsx)("button",{className:"btn btn-secondary btn-md logout-cancel-button",onClick:a,autoFocus:!0,children:"Cancel"}),(0,i.jsx)("button",{className:"btn btn-danger btn-md logout-confirm-button",onClick:n,children:"Yes, Logout"})]})]})}):null},mc=()=>{const[e,t]=(0,r.useState)("processing"),[n,a]=(0,r.useState)("Processing authentication...");(0,r.useEffect)(()=>{(()=>{try{const e=new URLSearchParams(window.location.search),n=e.get("code"),r=e.get("error"),s=e.get("error_description"),o=e.get("state");r?(t("error"),a("Authentication failed: ".concat(s||r)),window.opener&&window.opener.postMessage({type:"sso_auth_error",error:s||r,state:o},window.location.origin),setTimeout(()=>{window.close()},3e3)):n?(t("success"),a("Authentication successful! Completing setup..."),window.opener&&window.opener.postMessage({type:"sso_auth_success",code:n,state:o},window.location.origin),setTimeout(()=>{window.close()},1e3)):(t("error"),a("No authorization code received. Please try again."),window.opener&&window.opener.postMessage({type:"sso_auth_error",error:"No authorization code received"},window.location.origin),setTimeout(()=>{window.close()},3e3))}catch(e){console.error("Error processing OAuth callback:",e),t("error"),a("An error occurred while processing the authentication callback."),window.opener&&window.opener.postMessage({type:"sso_auth_error",error:"Failed to process callback"},window.location.origin),setTimeout(()=>{window.close()},3e3)}})()},[]);return(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"100vh",fontFamily:"Arial, sans-serif",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",margin:0,padding:"2rem"},children:[(0,i.jsxs)("div",{style:{background:"white",borderRadius:"16px",padding:"3rem",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.2)",textAlign:"center",maxWidth:"500px",width:"100%"},children:[(0,i.jsx)("div",{style:{fontSize:"4rem",marginBottom:"1rem",animation:"processing"===e?"spin 2s linear infinite":"none"},children:(()=>{switch(e){case"processing":default:return"\ud83d\udd04";case"success":return"\u2705";case"error":return"\u274c"}})()}),(0,i.jsxs)("h2",{style:{color:(()=>{switch(e){case"processing":return"#ffc107";case"success":return"#28a745";case"error":return"#dc3545";default:return"#6c757d"}})(),marginBottom:"1rem",fontSize:"1.5rem",fontWeight:"600"},children:["processing"===e&&"Processing Authentication","success"===e&&"Authentication Successful","error"===e&&"Authentication Failed"]}),(0,i.jsx)("p",{style:{color:"#6c757d",fontSize:"1rem",lineHeight:"1.5",marginBottom:"2rem"},children:n}),"processing"===e&&(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"0.5rem",color:"#ffc107"},children:[(0,i.jsx)("div",{style:{width:"20px",height:"20px",border:"2px solid #ffc107",borderTop:"2px solid transparent",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,i.jsx)("span",{children:"Please wait..."})]}),"success"===e&&(0,i.jsx)("p",{style:{color:"#28a745",fontSize:"0.9rem",fontStyle:"italic"},children:"This window will close automatically."}),"error"===e&&(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{onClick:()=>window.close(),style:{background:"#dc3545",color:"white",border:"none",borderRadius:"8px",padding:"0.75rem 1.5rem",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"background-color 0.3s ease"},onMouseOver:e=>e.currentTarget.style.background="#c82333",onMouseOut:e=>e.currentTarget.style.background="#dc3545",children:"Close Window"}),(0,i.jsx)("p",{style:{color:"#6c757d",fontSize:"0.8rem",marginTop:"1rem",fontStyle:"italic"},children:"Window will auto-close in a few seconds."})]})]}),(0,i.jsx)("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})},fc={statusUpdates:!0,caseCreated:!0,caseAmended:!0,orderProcessed:!0,orderDelivered:!0,orderReceived:!0,caseCompleted:!0,toBeBilled:!0,systemAlerts:!0,reminderNotifications:!0,sound:!0,desktop:!1},gc=e=>{let{isOpen:t,onClose:n}=e;const[a,s]=(0,r.useState)(fc),[o]=(0,r.useState)(b()),l=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(o){const t=localStorage.getItem("notificationPreferences_".concat(o.id));if(t)try{const e=JSON.parse(t);s((0,f.A)((0,f.A)({},fc),e))}catch(e){console.error("Error parsing notification preferences:",e)}}},[o]),(0,r.useEffect)(()=>{if(!t)return;const e=e=>{"Escape"===e.key&&n()},r=e=>{l.current&&!l.current.contains(e.target)&&n()};return document.addEventListener("keydown",e),document.addEventListener("mousedown",r),()=>{document.removeEventListener("keydown",e),document.removeEventListener("mousedown",r)}},[t,n]);const c=e=>{o&&(localStorage.setItem("notificationPreferences_".concat(o.id),JSON.stringify(e)),s(e))},d=(e,t)=>{const n=(0,f.A)((0,f.A)({},a),{},{[e]:t});c(n)};return t?(0,i.jsx)("div",{className:"notification-settings-overlay",children:(0,i.jsxs)("div",{className:"notification-settings-modal",ref:l,children:[(0,i.jsxs)("div",{className:"notification-settings-header",children:[(0,i.jsx)("h2",{children:"\ud83d\udd14 Notification Settings"}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm close-settings-button",onClick:n,title:"Close settings",children:"\u2715"})]}),(0,i.jsxs)("div",{className:"notification-settings-content",children:[(0,i.jsxs)("div",{className:"settings-quick-actions",children:[(0,i.jsx)("button",{className:"btn btn-outline-primary btn-sm",onClick:()=>{c({statusUpdates:!0,caseCreated:!0,caseAmended:!0,orderProcessed:!0,orderDelivered:!0,orderReceived:!0,caseCompleted:!0,toBeBilled:!0,systemAlerts:!0,reminderNotifications:!0,sound:!0,desktop:!0})},children:"\u2705 Enable All"}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>{c({statusUpdates:!1,caseCreated:!1,caseAmended:!1,orderProcessed:!1,orderDelivered:!1,orderReceived:!1,caseCompleted:!1,toBeBilled:!1,systemAlerts:!1,reminderNotifications:!1,sound:!1,desktop:!1})},children:"\u274c Disable All"}),(0,i.jsx)("button",{className:"btn btn-outline-warning btn-sm",onClick:()=>{c(fc)},children:"\ud83d\udd04 Reset to Default"})]}),(0,i.jsxs)("div",{className:"settings-section",children:[(0,i.jsx)("h3",{children:"\ud83d\udccb Workflow Notifications"}),(0,i.jsxs)("div",{className:"settings-group",children:[(0,i.jsxs)("label",{className:"setting-item",children:[(0,i.jsx)("input",{type:"checkbox",checked:a.statusUpdates,onChange:e=>d("statusUpdates",e.target.checked)}),(0,i.jsxs)("span",{className:"setting-label",children:[(0,i.jsx)("span",{className:"setting-title",children:"Status Updates"}),(0,i.jsx)("span",{className:"setting-description",children:"Receive notifications when case statuses change"})]})]}),(0,i.jsxs)("label",{className:"setting-item",children:[(0,i.jsx)("input",{type:"checkbox",checked:a.caseCreated,onChange:e=>d("caseCreated",e.target.checked)}),(0,i.jsxs)("span",{className:"setting-label",children:[(0,i.jsx)("span",{className:"setting-title",children:"Case Created"}),(0,i.jsx)("span",{className:"setting-description",children:"New case bookings in your departments"})]})]}),(0,i.jsxs)("label",{className:"setting-item",children:[(0,i.jsx)("input",{type:"checkbox",checked:a.caseAmended,onChange:e=>d("caseAmended",e.target.checked)}),(0,i.jsxs)("span",{className:"setting-label",children:[(0,i.jsx)("span",{className:"setting-title",children:"Case Amended"}),(0,i.jsx)("span",{className:"setting-description",children:"Case details have been modified"})]})]}),(0,i.jsxs)("label",{className:"setting-item",children:[(0,i.jsx)("input",{type:"checkbox",checked:a.orderProcessed,onChange:e=>d("orderProcessed",e.target.checked)}),(0,i.jsxs)("span",{className:"setting-label",children:[(0,i.jsx)("span",{className:"setting-title",children:"Order Processed"}),(0,i.jsx)("span",{className:"setting-description",children:"Orders have been prepared"})]})]}),(0,i.jsxs)("label",{className:"setting-item",children:[(0,i.jsx)("input",{type:"checkbox",checked:a.orderDelivered,onChange:e=>d("orderDelivered",e.target.checked)}),(0,i.jsxs)("span",{className:"setting-label",children:[(0,i.jsx)("span",{className:"setting-title",children:"Order Delivered"}),(0,i.jsx)("span",{className:"setting-description",children:"Orders delivered to hospitals"})]})]}),(0,i.jsxs)("label",{className:"setting-item",children:[(0,i.jsx)("input",{type:"checkbox",checked:a.orderReceived,onChange:e=>d("orderReceived",e.target.checked)}),(0,i.jsxs)("span",{className:"setting-label",children:[(0,i.jsx)("span",{className:"setting-title",children:"Order Received"}),(0,i.jsx)("span",{className:"setting-description",children:"Orders confirmed at hospitals"})]})]}),(0,i.jsxs)("label",{className:"setting-item",children:[(0,i.jsx)("input",{type:"checkbox",checked:a.caseCompleted,onChange:e=>d("caseCompleted",e.target.checked)}),(0,i.jsxs)("span",{className:"setting-label",children:[(0,i.jsx)("span",{className:"setting-title",children:"Case Completed"}),(0,i.jsx)("span",{className:"setting-description",children:"Surgical procedures completed"})]})]}),(0,i.jsxs)("label",{className:"setting-item",children:[(0,i.jsx)("input",{type:"checkbox",checked:a.toBeBilled,onChange:e=>d("toBeBilled",e.target.checked)}),(0,i.jsxs)("span",{className:"setting-label",children:[(0,i.jsx)("span",{className:"setting-title",children:"Ready for Billing"}),(0,i.jsx)("span",{className:"setting-description",children:"Cases ready for invoicing"})]})]})]})]}),(0,i.jsxs)("div",{className:"settings-section",children:[(0,i.jsx)("h3",{children:"\u2699\ufe0f System Notifications"}),(0,i.jsxs)("div",{className:"settings-group",children:[(0,i.jsxs)("label",{className:"setting-item",children:[(0,i.jsx)("input",{type:"checkbox",checked:a.systemAlerts,onChange:e=>d("systemAlerts",e.target.checked)}),(0,i.jsxs)("span",{className:"setting-label",children:[(0,i.jsx)("span",{className:"setting-title",children:"System Alerts"}),(0,i.jsx)("span",{className:"setting-description",children:"Important system messages and updates"})]})]}),(0,i.jsxs)("label",{className:"setting-item",children:[(0,i.jsx)("input",{type:"checkbox",checked:a.reminderNotifications,onChange:e=>d("reminderNotifications",e.target.checked)}),(0,i.jsxs)("span",{className:"setting-label",children:[(0,i.jsx)("span",{className:"setting-title",children:"Reminder Notifications"}),(0,i.jsx)("span",{className:"setting-description",children:"Upcoming surgery reminders and deadlines"})]})]})]})]}),(0,i.jsxs)("div",{className:"settings-section",children:[(0,i.jsx)("h3",{children:"\ud83d\udd0a Notification Methods"}),(0,i.jsxs)("div",{className:"settings-group",children:[(0,i.jsxs)("label",{className:"setting-item",children:[(0,i.jsx)("input",{type:"checkbox",checked:a.sound,onChange:e=>d("sound",e.target.checked)}),(0,i.jsxs)("span",{className:"setting-label",children:[(0,i.jsx)("span",{className:"setting-title",children:"Sound Alerts"}),(0,i.jsx)("span",{className:"setting-description",children:"Play audio when notifications arrive"})]})]}),(0,i.jsxs)("label",{className:"setting-item",children:[(0,i.jsx)("input",{type:"checkbox",checked:a.desktop,onChange:e=>d("desktop",e.target.checked)}),(0,i.jsxs)("span",{className:"setting-label",children:[(0,i.jsx)("span",{className:"setting-title",children:"Desktop Notifications"}),(0,i.jsx)("span",{className:"setting-description",children:"Show browser desktop notifications"})]})]})]})]})]}),(0,i.jsxs)("div",{className:"notification-settings-footer",children:[(0,i.jsx)("p",{className:"settings-note",children:"\ud83d\udca1 Tip: You can customize which notifications you receive to reduce noise and stay focused."}),(0,i.jsx)("button",{className:"btn btn-primary",onClick:n,children:"Done"})]})]})}):null},vc=()=>{const[e,t]=(0,r.useState)(!1),[n,a]=(0,r.useState)(!1),{notifications:s,unreadCount:o,markAsRead:l,markAllAsRead:c,clearNotification:d}=ol(),{playSound:u}=Tl(),h=(0,r.useRef)(null),p=!!b();(0,r.useEffect)(()=>{const e=e=>{h.current&&!h.current.contains(e.target)&&t(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,r.useEffect)(()=>{const n=n=>{"Escape"===n.key&&e&&t(!1)};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[e]);const m=(0,r.useCallback)((e,t)=>{t.stopPropagation(),d(e),u.click()},[d,u]),f=(0,r.useCallback)(e=>{const t=new Date,n=new Date(e),r=Math.floor((t.getTime()-n.getTime())/6e4);if(r<1)return"Just now";if(r<60)return"".concat(r,"m ago");const a=Math.floor(r/60);if(a<24)return"".concat(a,"h ago");const s=Math.floor(a/24);return s<7?"".concat(s,"d ago"):xi(n)},[]),g=(0,r.useCallback)(e=>{switch(e){case"success":return"\u2705";case"warning":return"\u26a0\ufe0f";case"error":return"\u274c";default:return"\u2139\ufe0f"}},[]),v=(0,r.useMemo)(()=>s.slice(0,10),[s]);return(0,i.jsxs)("div",{className:"notification-bell-container",ref:h,children:[(0,i.jsxs)("button",{className:"btn btn-outline-secondary btn-md notification-bell ".concat(o>0?"has-unread":""),onClick:()=>{t(!e),u.click(),!e&&o>0&&c()},title:"".concat(o," unread notifications"),children:["\ud83d\udd14",o>0&&(0,i.jsx)("span",{className:"notification-badge",children:o>99?"99+":o})]}),e&&(0,i.jsxs)("div",{className:"notification-dropdown",children:[(0,i.jsxs)("div",{className:"notification-header",children:[(0,i.jsx)("h3",{children:"Notifications"}),(0,i.jsxs)("div",{className:"notification-header-actions",children:[p&&(0,i.jsx)("button",{onClick:()=>{a(!0),t(!1),u.click()},className:"btn btn-outline-primary btn-sm settings-button",title:"Notification Settings",children:"\u2699\ufe0f Settings"}),s.length>0&&(0,i.jsx)("button",{onClick:()=>{c(),u.click()},className:"btn btn-outline-secondary btn-sm mark-all-read-button",children:"Mark all read"})]})]}),(0,i.jsx)("div",{className:"notification-list",children:0===s.length?(0,i.jsxs)("div",{className:"no-notifications",children:[(0,i.jsx)("div",{className:"no-notifications-icon",children:"\ud83d\udd15"}),(0,i.jsx)("p",{children:"No notifications yet"}),(0,i.jsx)("small",{children:"You'll see important updates here"})]}):v.map(e=>(0,i.jsxs)("div",{className:"notification-item ".concat(e.read?"":"unread"," ").concat(e.urgent?"urgent":""),onClick:()=>{return t=e.id,l(t),void u.click();var t},children:[(0,i.jsxs)("div",{className:"notification-content",children:[(0,i.jsx)("div",{className:"notification-icon",children:g(e.type)}),(0,i.jsxs)("div",{className:"notification-text",children:[(0,i.jsx)("div",{className:"notification-title",children:e.title}),(0,i.jsx)("div",{className:"notification-message",children:e.message}),(0,i.jsx)("div",{className:"notification-time",children:f(e.timestamp)})]}),(0,i.jsx)("button",{className:"btn btn-outline-secondary btn-sm notification-close",onClick:t=>m(e.id,t),title:"Clear notification",children:"\u2715"})]}),!e.read&&(0,i.jsx)("div",{className:"unread-indicator"})]},e.id))}),s.length>10&&(0,i.jsx)("div",{className:"notification-footer",children:(0,i.jsxs)("small",{children:["Showing 10 of ",s.length," notifications"]})})]}),(0,i.jsx)(gc,{isOpen:n,onClose:()=>a(!1)})]})},yc=(0,r.memo)(vc),bc="1.2.2",xc=()=>{const[e,t]=(0,r.useState)(!1),{isEnabled:n,volume:a,toggleSound:s,setVolume:o,playSound:l}=Tl(),{showSuccess:c}=Rl(),d=(0,r.useRef)(null),[u,h]=(0,r.useState)(a),[p,m]=(0,r.useState)(!1),[f,g]=(0,r.useState)("default");(0,r.useEffect)(()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&t(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,r.useEffect)(()=>{const e=e=>{"Escape"===e.key&&t(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[e]),(0,r.useEffect)(()=>{e&&h(a)},[e,a]);return(0,r.useEffect)(()=>{if("Notification"in window){g(Notification.permission);const e=localStorage.getItem("notifications-enabled");e&&m(JSON.parse(e))}},[]),(0,i.jsxs)("div",{className:"settings-container",ref:d,children:[(0,i.jsx)("button",{className:"btn btn-secondary btn-md settings-button",onClick:()=>{t(!e),l.click()},title:"Settings",children:"\u2699\ufe0f"}),e&&(0,i.jsxs)("div",{className:"settings-dropdown",children:[(0,i.jsxs)("div",{className:"settings-header",children:[(0,i.jsx)("h3",{children:"Settings"}),(0,i.jsx)("button",{onClick:()=>t(!1),className:"btn btn-secondary btn-sm settings-close",title:"Close settings",children:"\u2715"})]}),(0,i.jsxs)("div",{className:"settings-content",children:[(0,i.jsxs)("div",{className:"settings-section",children:[(0,i.jsx)("h4",{children:"\ud83d\udd0a Sound Settings"}),(0,i.jsxs)("div",{className:"settings-item",children:[(0,i.jsxs)("div",{className:"settings-item-info",children:[(0,i.jsx)("label",{children:"Enable Sounds"}),(0,i.jsx)("small",{children:"Play audio feedback for user actions"})]}),(0,i.jsx)("button",{className:"btn btn-secondary btn-sm toggle-switch ".concat(n?"enabled":"disabled"),onClick:()=>{s(),l.click();const e=!n;c(e?"Sounds Enabled":"Sounds Disabled",e?"You will now hear audio feedback for actions":"Audio feedback has been disabled")},children:(0,i.jsx)("span",{className:"toggle-slider"})})]}),n&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"settings-item",children:[(0,i.jsxs)("div",{className:"settings-item-info",children:[(0,i.jsx)("label",{children:"Volume"}),(0,i.jsx)("small",{children:"Adjust sound volume level"})]}),(0,i.jsxs)("div",{className:"volume-control",children:[(0,i.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",value:u,onChange:e=>{return t=parseFloat(e.target.value),h(t),o(t),void(n&&l.click());var t},className:"volume-slider"}),(0,i.jsxs)("span",{className:"volume-percentage",children:[Math.round(100*u),"%"]})]})]}),(0,i.jsx)("div",{className:"settings-item",children:(0,i.jsx)("button",{onClick:()=>{l.notification(),c("Sound Test","This is how notifications will sound")},className:"btn btn-info btn-md test-sound-button",children:"\ud83c\udfb5 Test Sound"})})]})]}),(0,i.jsxs)("div",{className:"settings-section",children:[(0,i.jsx)("h4",{children:"\ud83d\udd14 Notification Settings"}),(0,i.jsx)("div",{className:"settings-item",children:(0,i.jsxs)("div",{className:"settings-item-info",children:[(0,i.jsx)("label",{children:"Browser Notifications"}),(0,i.jsx)("small",{children:"Show desktop notifications for important updates"})]})}),(0,i.jsx)("div",{className:"settings-item",children:(0,i.jsx)("div",{className:"notification-control",children:(0,i.jsx)("button",{className:"Notification"in window&&"denied"!==f?"granted"===f&&p?"btn btn-success btn-sm":"btn btn-primary btn-sm":"btn btn-secondary btn-sm notification-disabled",onClick:async()=>{if("Notification"in window)if("denied"!==f){if("default"===f)try{const e=await Notification.requestPermission();g(e),"granted"===e?(m(!0),localStorage.setItem("notifications-enabled","true"),c("Notifications Enabled","You will now receive browser notifications"),new Notification("Case Booking System",{body:"Notifications are now enabled!",icon:"/favicon.ico"})):c("Permission Required","Please allow notifications to enable this feature")}catch(e){console.error("Error requesting notification permission:",e),c("Error","Failed to request notification permission")}else if("granted"===f){const e=!p;m(e),localStorage.setItem("notifications-enabled",JSON.stringify(e)),e?(c("Notifications Enabled","You will now receive browser notifications"),new Notification("Case Booking System",{body:"Notifications are now enabled!",icon:"/favicon.ico"})):c("Notifications Disabled","Browser notifications have been disabled")}l.click()}else c("Permission Denied","Notifications are blocked. Please enable them in your browser settings.");else c("Not Supported","Browser notifications are not supported in this browser")},disabled:!("Notification"in window)||"denied"===f,children:"Notification"in window?"denied"===f?"Blocked":"default"===f?"Allow":p?"Enabled":"Disabled":"Not Supported"})})}),p&&"granted"===f&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"settings-item",children:(0,i.jsxs)("div",{className:"settings-item-info",children:[(0,i.jsx)("label",{children:"Notification Status"}),(0,i.jsx)("small",{children:"Your browser will show notifications for case updates"})]})}),(0,i.jsx)("div",{className:"settings-item",children:(0,i.jsx)("button",{onClick:()=>{"Notification"in window?"granted"===f&&p?(new Notification("Test Notification",{body:"This is a test notification from the Case Booking System",icon:"/favicon.ico",tag:"test-notification"}),l.notification(),c("Test Sent","Test notification has been sent")):c("Enable Notifications","Please enable notifications first"):c("Not Supported","Browser notifications are not supported")},className:"btn btn-info btn-sm",children:"\ud83e\uddea Test Notification"})})]}),"denied"===f&&(0,i.jsx)("div",{className:"settings-item",children:(0,i.jsx)("div",{className:"notification-blocked-info",children:(0,i.jsxs)("small",{style:{color:"#e74c3c"},children:["Notifications are blocked. To enable them:",(0,i.jsx)("br",{}),"1. Click the lock icon in your browser's address bar",(0,i.jsx)("br",{}),'2. Set Notifications to "Allow"',(0,i.jsx)("br",{}),"3. Refresh this page"]})})})]}),(0,i.jsxs)("div",{className:"settings-section",children:[(0,i.jsx)("h4",{children:"\u2139\ufe0f Application Info"}),(0,i.jsx)("div",{className:"settings-item",children:(0,i.jsxs)("div",{className:"app-info",children:[(0,i.jsxs)("div",{className:"info-row",children:[(0,i.jsx)("span",{children:"Version:"}),(0,i.jsx)("span",{children:bc})]}),(0,i.jsxs)("div",{className:"info-row",children:[(0,i.jsx)("span",{children:"Last Updated:"}),(0,i.jsx)("span",{children:"June 2025"})]}),(0,i.jsxs)("div",{className:"info-row",children:[(0,i.jsx)("span",{children:"Build:"}),(0,i.jsx)("span",{children:"Staging"})]})]})})]}),(0,i.jsxs)("div",{className:"settings-section",children:[(0,i.jsx)("h4",{children:"\ud83d\udd27 Actions"}),(0,i.jsx)("div",{className:"settings-actions",children:(0,i.jsx)("button",{onClick:()=>{o(.5),h(.5),n||s(),m(!1),localStorage.removeItem("notifications-enabled"),l.success(),c("Settings Reset","All settings have been restored to defaults")},className:"btn btn-warning btn-md reset-settings-button",children:"\ud83d\udd04 Reset to Defaults"})})]})]})]})]})},wc=()=>{const[e,t]=(0,r.useState)(!1);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{className:"status-legend-button",onClick:()=>t(!0),children:"\ud83d\udcca Status Colors"}),e&&(0,i.jsx)("div",{className:"status-legend-overlay",onClick:()=>t(!1),children:(0,i.jsxs)("div",{className:"status-legend-popup",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"legend-header",children:[(0,i.jsx)("h3",{children:"Status Color Legend"}),(0,i.jsx)("button",{className:"close-button",onClick:()=>t(!1),"aria-label":"Close",children:"\u2715"})]}),(0,i.jsx)("div",{className:"legend-content",children:(0,i.jsx)("div",{className:"legend-grid",children:[{status:"Case Booked",description:"Initial case submission"},{status:"Order Preparation",description:"Processing order details"},{status:"Order Prepared",description:"Ready for delivery"},{status:"Pending Delivery (Hospital)",description:"Pending hospital delivery"},{status:"Delivered (Hospital)",description:"Delivered to hospital"},{status:"Case Completed",description:"Surgery completed"},{status:"Pending Delivery (Office)",description:"Pending office delivery"},{status:"Delivered (Office)",description:"Equipment returned to office"},{status:"To be billed",description:"Ready for billing"},{status:"Case Closed",description:"Case finalized and closed"},{status:"Case Cancelled",description:"Case cancelled"}].map(e=>{let{status:t,description:n}=e;return(0,i.jsxs)("div",{className:"legend-item",children:[(0,i.jsx)("div",{className:"status-indicator",style:{backgroundColor:bl(t)}}),(0,i.jsxs)("div",{className:"status-info",children:[(0,i.jsx)("span",{className:"status-name",children:t}),(0,i.jsx)("span",{className:"status-description",children:n})]})]},t)})})})]})})]})},Sc=()=>{const{user:e,isAuthenticated:t,logout:n}=p();(0,r.useEffect)(()=>{console.log("\ud83c\udfe0 App: Authentication state changed:",{isAuthenticated:t,hasUser:!!e,userId:null===e||void 0===e?void 0:e.id,userName:null===e||void 0===e?void 0:e.name})},[t,e]);const[a,s]=(0,r.useState)("booking"),[o,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),[u,h]=(0,r.useState)(!1),[f,g]=(0,r.useState)(!1),[v,y]=(0,r.useState)(null),b=(0,r.useRef)(null),{playSound:x}=Tl(),{addNotification:w}=ol(),{showSuccess:S}=Rl(),N="/auth/callback"===window.location.pathname||window.location.search.includes("code=");if((0,r.useEffect)(()=>{ne()},[]),(0,r.useEffect)(()=>{const e=e=>{b.current&&!b.current.contains(e.target)&&f&&g(!1)};return f&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[f]),N)return(0,i.jsx)(mc,{});const j=e=>{setTimeout(()=>{d(!0),x.success(),S("Welcome back!","You're now logged in as ".concat(e.name)),w({title:"Successful Login",message:"Welcome back, ".concat(e.name,"! You're logged in as ").concat(e.role,"."),type:"success"})},0)};return t&&e?(0,i.jsxs)("div",{className:"app",children:[(0,i.jsx)("header",{className:"app-header",children:(0,i.jsxs)("div",{className:"header-content",children:[(0,i.jsxs)("div",{className:"header-left",children:[(0,i.jsx)("h1",{children:"\ud83c\udfe5 Transmedic Case Booking"}),(0,i.jsx)("div",{className:"header-info",children:(0,i.jsxs)("div",{className:"role-country-info",children:[(0,i.jsx)("span",{className:"info-label",children:"Role:"}),(0,i.jsx)("span",{className:"role-badge ".concat(e.role||""),children:e.role?e.role.replace("-"," ").toUpperCase():"Unknown"}),e.selectedCountry&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"info-label",children:"Country:"}),(0,i.jsx)("span",{className:"country-badge",children:e.selectedCountry})]}),(e=>!!e&&("admin"===e.role||Pi(e.role,Zi)||"it"===e.role))(e)&&(0,i.jsxs)("div",{className:"header-admin-panel",ref:b,children:[(0,i.jsxs)("button",{className:"header-admin-toggle ".concat(f?"expanded":""),onClick:()=>{g(!f),x.click()},title:"Admin Panel",children:[(0,i.jsx)("span",{className:"admin-icon",children:"\ud83d\udc51"}),(0,i.jsx)("span",{className:"admin-label",children:"Admin"}),(0,i.jsx)("span",{className:"chevron ".concat(f?"down":"right"),children:f?"\u25bc":"\u25b6"})]}),f&&(0,i.jsxs)("div",{className:"header-admin-submenu",children:[Pi(e.role,"code-table-setup")&&(0,i.jsx)("button",{onClick:()=>{s("codetables"),x.click(),g(!1)},className:"header-admin-item ".concat("codetables"===a?"active":""),children:"\ud83d\udcca Code Table Setup"}),"admin"===e.role&&(0,i.jsx)("button",{onClick:()=>{s("permissions"),x.click(),g(!1)},className:"header-admin-item ".concat("permissions"===a?"active":""),children:"\ud83d\udd10 Permissions"}),Pi(e.role,tl)&&(0,i.jsx)("button",{onClick:()=>{s("email-config"),x.click(),g(!1)},className:"header-admin-item ".concat("email-config"===a?"active":""),children:"\ud83d\udce7 Email Configuration"}),Pi(e.role,Zi)&&(0,i.jsx)("button",{onClick:()=>{s("users"),x.click(),g(!1)},className:"header-admin-item ".concat("users"===a?"active":""),children:"\ud83d\udc65 User Management"}),Pi(e.role,nl)&&(0,i.jsx)("button",{onClick:()=>{s("audit-logs"),x.click(),g(!1)},className:"header-admin-item ".concat("audit-logs"===a?"active":""),children:"\ud83d\udcca Audit Logs"})]})]})]})})]}),(0,i.jsxs)("div",{className:"header-right",children:[(0,i.jsxs)("div",{className:"logged-in-info",children:[(0,i.jsx)("span",{className:"logged-in-label",children:"Logged in as:"}),(0,i.jsx)("span",{className:"user-display-name",children:e.name})]}),(0,i.jsxs)("div",{className:"header-actions",children:[(0,i.jsx)(yc,{}),(0,i.jsx)(xc,{}),(0,i.jsx)("button",{onClick:()=>{h(!0)},className:"logout-button",children:"Logout"})]})]})]})}),(0,i.jsx)("nav",{className:"app-nav",children:(0,i.jsxs)("div",{className:"nav-buttons",children:[Pi(e.role,Mi)&&(0,i.jsx)("button",{onClick:()=>{s("booking"),x.click()},className:"booking"===a?"active":"",children:"\ud83d\udcdd New Case Booking"}),(0,i.jsx)("button",{onClick:()=>{s("cases"),x.click()},className:"cases"===a?"active":"",children:"\ud83d\udccb View All Cases"}),(0,i.jsx)(wc,{}),Pi(e.role,"booking-calendar")&&(0,i.jsx)("button",{onClick:()=>{s("calendar"),x.click()},className:"calendar"===a?"active":"",children:"\ud83d\udcc5 Booking Calendar"}),Pi(e.role,Ui)&&(0,i.jsx)("button",{onClick:()=>{s("sets"),x.click()},className:"sets"===a?"active":"",children:"\u2699\ufe0f Edit Sets"}),Pi(e.role,rl)&&(0,i.jsx)("button",{onClick:()=>{s("reports"),x.click()},className:"reports"===a?"active":"",children:"\ud83d\udcca Reports"})]})}),(0,i.jsxs)("main",{className:"app-main",children:["booking"===a&&Pi(e.role,Mi)&&(0,i.jsx)(ji,{onCaseSubmitted:()=>{s("cases"),x.submit(),S("Case Submitted!","Your case booking has been submitted successfully with a reference number."),w({title:"New Case Submitted",message:"A new case booking has been created and assigned a reference number.",type:"success"})}}),"booking"===a&&!Pi(e.role,Mi)&&(0,i.jsx)("div",{className:"permission-denied",children:(0,i.jsxs)("div",{className:"permission-denied-content",children:[(0,i.jsx)("h2",{children:"\ud83d\udeab Access Denied"}),(0,i.jsx)("p",{children:"You don't have permission to create new cases."}),(0,i.jsxs)("p",{children:["Your role (",(0,i.jsx)("span",{className:"role-badge ".concat(e.role||""),children:e.role?e.role.replace("-"," ").toUpperCase():"Unknown"}),") does not allow case booking access."]}),(0,i.jsx)("button",{onClick:()=>{s("cases"),x.click()},className:"btn btn-primary btn-lg",children:"View Cases Instead"})]})}),"cases"===a&&(0,i.jsx)(Cl,{onProcessCase:e=>{l(e),s("process"),x.click()},currentUser:e,highlightedCaseId:v,onClearHighlight:()=>y(null),onNavigateToPermissions:()=>{s("permissions"),x.click()}}),"process"===a&&o&&(0,i.jsx)(El,{caseData:o,onProcessComplete:()=>{l(null),s("cases"),x.statusChange(),S("Order Processed!","The order has been successfully prepared and is ready for delivery."),w({title:"Order Processing Complete",message:"An order has been successfully processed and prepared for delivery.",type:"success"})},onBack:()=>{l(null),s("cases"),x.click()}}),"users"===a&&Pi(e.role,Zi)&&(0,i.jsx)(Vl,{}),"audit-logs"===a&&Pi(e.role,nl)&&(0,i.jsx)(dc,{}),"permissions"===a&&"admin"===e.role&&(0,i.jsx)(cc,{}),"email-config"===a&&Pi(e.role,tl)&&(0,i.jsx)(hc,{}),"calendar"===a&&Pi(e.role,"booking-calendar")&&(0,i.jsx)(rc,{onCaseClick:e=>{y(e),s("cases"),x.click()}}),"sets"===a&&Pi(e.role,Ui)&&(0,i.jsx)($l,{}),"reports"===a&&Pi(e.role,rl)&&(0,i.jsx)(nc,{}),"codetables"===a&&Pi(e.role,"code-table-setup")&&(0,i.jsx)(ic,{})]}),(0,i.jsx)("footer",{className:"app-footer",children:(0,i.jsxs)("div",{className:"footer-content",children:[(0,i.jsx)("p",{children:"\xa9 2025 Transmedic Case Booking. All rights reserved."}),(0,i.jsxs)("p",{children:["Logged in as: ",e.name," (",e.role,")"]})]})}),c&&(0,i.jsx)(lc,{user:e,onClose:()=>d(!1)}),(0,i.jsx)(pc,{isOpen:u,onConfirm:async()=>{await n(),s("booking"),l(null),h(!1),x.click(),S("Logged Out","You have been successfully logged out of the system")},onCancel:()=>{h(!1)},userName:null===e||void 0===e?void 0:e.name})]}):(0,i.jsx)(m,{onLogin:j})},Nc=()=>(0,i.jsx)(h,{children:(0,i.jsx)(Al,{children:(0,i.jsx)(sl,{children:(0,i.jsx)(Pl,{children:(0,i.jsx)(Sc,{})})})})});s.createRoot(document.getElementById("root")).render((0,i.jsx)(r.StrictMode,{children:(0,i.jsx)(Nc,{})}))})();